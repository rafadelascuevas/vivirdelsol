(function() {
  var root;

  root = this;

  if (typeof Backbone === "undefined" || Backbone === null) {
    throw new Error("Backbone should be installed");
  }

  Backbone.App = function(config) {
    var baseApp, conf, lang, loadAnalytics, loadFonts, locale, localeUrl, logger;
    config.rootPath || (config.rootPath = "/");
    window.rootPath = config.rootPath;
    conf = config || {};
    conf.root = conf.rootPath;
    if (conf.namespace == null) {
      conf.namespace = {};
    } else {
      if (_.isString(conf.namespace)) {
        if (root[conf.namespace] != null) {
          conf.namespace = root[conf.namespace];
        } else {
          root[conf.namespace] = {};
          conf.namespace = root[conf.namespace];
        }
      }
    }
    if ((conf.start == null) || !_.isFunction(conf.start)) {
      throw new Error("You need to pass a start function");
    }
    lang = function() {
      if (conf.lang == null) {
        lang = document.getElementsByTagName('html')[0].getAttribute('lang');
      } else {
        if (!_.isFunction(conf.lang)) {
          lang = conf.lang;
        } else {
          lang = conf.lang.call(this);
        }
      }
      return lang || "en";
    };
    localeUrl = function(lang) {
      var url;
      if (conf.localeUrl == null) {
        url = conf.rootPath + ("scripts/locale/strings-" + lang + ".js");
      } else {
        if (!_.isFunction(conf.localeUrl)) {
          url = conf.localeUrl;
        } else {
          url = conf.localeUrl.call(this, lang);
        }
      }
      return url;
    };
    loadFonts = function() {
      var fonts, wf;
      if (conf.fonts == null) {
        return;
      }
      if (!_.isFunction(conf.fonts)) {
        fonts = conf.fonts;
      } else {
        fonts = conf.fonts.call(this);
      }
      if (!_.isArray(fonts)) {
        console.error('fonts should be an array. Check http://www.google.com/webfonts');
      }
      /*
      # TODO: uncoment if any problem with fonts
      window.WebFontConfig =
        custom: {
          families: @families,
          urls: ['../../scripts/managers/fonts.css']
        }
      */

      wf = document.createElement('script');
      wf.src = ('https:' === document.location.protocol ? 'https' : 'http') + '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
      wf.type = 'text/javascript';
      wf.async = 'true';
      return yepnope([
        {
          load: wf.src
        }
      ]);
    };
    loadAnalytics = function() {
      var ga, src;
      if (conf.analytics == null) {
        return;
      }
      ga = window._gaq = window._gaq || [];
      ga.push(['_setAccount', conf.analytics]);
      ga.push(['_trackPageview']);
      src = ('https:' === document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      return yepnope([
        {
          load: src
        }
      ]);
    };
    logger = null;
    if (window.log != null) {
      logger = window.log;
    } else {
      logger = function() {
        return console.log.apply(console, arguments);
      };
    }
    locale = null;
    baseApp = {
      Models: {},
      Collections: {},
      Views: {},
      Managers: {},
      run: function(stage, options) {
        if (options == null) {
          options = {};
        }
        this.lang = lang.call(this);
        this.isDebug = (location.hostname.match(/\.dev$/) != null) || options.forceDebug === true || location.port !== "80" || location.search.match(/forceDebug=true/);
        window.log = _.bind(this.log, this);
        window.elog = _.bind(this.errorlog, this);
        if (this.isDebug) {
          console.log("DEBUG MODE ON");
        }
        this.stage = stage || $('body');
        this.system = Backbone.System;
        if (window.System == null) {
          window.System = this.system;
        }
        /*
        locale = new Backbone.Locale this
        langPath=localeUrl.call this, @lang
        
        @changeLanguage(
          lang: @lang
          path: langPath
          callback: conf.start
          callbackContext: this
          options: options
        )
        */

        conf.start();
        return this;
      },
      log: function() {
        if (!this.isDebug) {
          return;
        }
        return logger.apply(window, arguments);
      },
      errorlog: function(msg) {
        return log("%c" + msg, "color:red");
      },
      on: function(event, method, context) {
        switch (event) {
          case 'language':
            return locale.on(event, method, context);
        }
      },
      off: function(event, method, context) {
        switch (event) {
          case 'language':
            return locale.off(event, method, context);
        }
      },
      changeLanguage: function(options) {
        if (options.lang == null) {
          throw new Error("Language should be defined");
        }
        this.lang = options.lang;
        locale.load(options);
        return this;
      },
      t: function() {
        return locale.t.apply(locale, arguments);
      },
      HandlebarsLog: function(object, context) {},
      isEmail: function(email) {
        var regex;
        regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        return regex.test(email);
      },
      prettyNumber: function(x) {
        var parts;
        if (x === void 0) {
          x = "";
        }
        parts = x.toString().split(".");
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        return parts.join(".");
      },
      prettyCurrency: function(x) {
        var parts;
        parts = Number(x).toFixed(2).toString().split(".");
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        return parts.join(".");
      },
      trackEvent: function() {
        var args, payload;
        if (this.isDebug || (window._gaq == null)) {
          return;
        }
        args = Array.prototype.splice.call(arguments, 0);
        payload = ['_trackEvent'].concat(args);
        console.log("Tracking Event:", payload);
        return window._gaq.push(payload);
      }
    };
    loadFonts();
    loadAnalytics();
    _.extend(conf.namespace, baseApp);
    if (_.isFunction(conf.init)) {
      conf.init.call(conf.namespace);
    } else if (_.isObject(conf.init)) {
      _.extend(conf.namespace, conf.init);
    }
    conf.namespace.modelns = conf.namespace['Models'];
    conf.namespace.collectionns = conf.namespace['Collections'];
    conf.namespace.viewns = conf.namespace['Views'];
    window.AppRoot = conf.namespace;
    Handlebars.registerHelper('log', baseApp.HandlebarsLog);
    Handlebars.registerHelper('t', baseApp.t);
    Handlebars.registerHelper('prettyNumber', baseApp.prettyNumber);
    Handlebars.registerHelper('prettyCurrency', baseApp.prettyCurrency);
    Handlebars.registerHelper('unless_blank', function(string, options) {
      if ((string == null) || string.length === 0) {
        return options.inverse(this);
      } else {
        return options.fn(this);
      }
    });
    Handlebars.registerHelper('if_empty', function(string, options) {
      if ((string == null) || string.length === 0) {
        return options.fn(this);
      } else {
        return options.inverse(this);
      }
    });
    return conf.namespace;
  };

}).call(this);

(function() {
  Backbone.System = (function() {
    function System() {}

    System.Browser = {
      Arora: 'Arora',
      Chrome: 'Chrome',
      Epiphany: 'Epiphany',
      Firefox: 'Firefox',
      MobileSafari: 'Mobile Safari',
      InternetExplorer: 'MSIE',
      Midori: 'Midori',
      Opera: 'Opera',
      Safari: 'Safari'
    };

    System.OS = {
      Android: 'Android',
      ChromeOS: 'CrOS',
      iOS: 'iOS',
      Linux: 'Linux',
      MacOS: 'Mac OS',
      Windows: 'Windows'
    };

    System.Orientation = {
      Portrait: 'Portrait',
      LandscapeRight: 'Landscape right',
      LandscapeLeft: 'Landscape left'
    };

    System.OnlineStatus = {
      Online: 'Online',
      Offline: 'Offline',
      Unknown: 'Unknown'
    };

    System.orientation = function() {
      if (window.orientation == null) {
        return false;
      }
      switch (window.orientation) {
        case 0:
          return this.Orientation.Portrait;
        case 90:
          return this.Orientation.LandscapeLeft;
        case -90:
          return this.Orientation.LandscapeRight;
      }
      return false;
    };

    System.isOnline = function() {
      if (window.navigator.onLine == null) {
        return this.OnlineStatus.Unknown;
      }
      if (window.navigator.onLine) {
        return this.OnlineStatus.Online;
      }
      return this.OnlineStatus.Offline;
    };

    System.isIpad = function() {
      var ua;
      ua = navigator.userAgent;
      if (/iPad/.test(ua)) {
        return true;
      }
    };

    System.browser = function() {
      var ua;
      ua = navigator.userAgent;
      if (/Arora/.test(ua)) {
        return this.Browser.Arora;
      }
      if (/Chrome/.test(ua)) {
        return this.Browser.Chrome;
      }
      if (/Epiphany/.test(ua)) {
        return this.Browser.Epiphany;
      }
      if (/Firefox/.test(ua)) {
        return this.Browser.Firefox;
      }
      if (/Mobile Safari/.test(ua)) {
        return this.Browser.MobileSafari;
      }
      if (/MSIE/.test(ua)) {
        return this.Browser.InternetExplorer;
      }
      if (/Midori/.test(ua)) {
        return this.Browser.Midori;
      }
      if (/Opera/.test(ua)) {
        return this.Browser.Opera;
      }
      if (/Safari/.test(ua)) {
        return this.Browser.Safari;
      }
      return false;
    };

    System.browserVersion = function() {
      var browser, trident, ua, version;
      ua = navigator.userAgent;
      browser = this.getBrowser();
      if (/MSIE (\d+\.\d+);/.test(ua)) {
        version = new Number(RegExp.$1);
        if (/Trident\/(\d+\.\d+);/.test(ua)) {
          trident = new Number(RegExp.$1);
        }
        if ((trident != null) && trident >= 5) {
          return 9;
        } else {
          return parseInt(version);
        }
      }
      return null;
    };

    System.OS = function() {
      var ua;
      ua = navigator.userAgent;
      if (/Android/.test(ua)) {
        return this.OS.Android;
      }
      if (/CrOS/.test(ua)) {
        return this.OS.ChromeOS;
      }
      if (/iP[ao]d|iPhone/.test(ua)) {
        return this.OS.iOS;
      }
      if (/Linux/.test(ua)) {
        return this.OS.Linux;
      }
      if (/Mac OS/.test(ua)) {
        return this.OS.MacOS;
      }
      if (/windows/.test(ua)) {
        return this.OS.Windows;
      }
      return false;
    };

    System.supportCanvas = function() {
      return !!window.CanvasRenderingContext2D;
    };

    System.supportLocalStorage = function() {
      var error;
      try {
        return !!localStorage.getItem;
      } catch (_error) {
        error = _error;
        return false;
      }
    };

    System.supportFile = function() {
      return !!window.File && !!window.FileReader && !!window.FileList && !!window.Blob;
    };

    System.supportFileSystem = function() {
      return !!window.requestFileSystem;
    };

    System.supportRequestAnimationFrame = function() {
      return !!window.mozRequestAnimationFrame || !!window.webkitRequestAnimationFrame || !!window.oRequestAnimationFrame || !!window.msRequestAnimationFrame;
    };

    System.supportSessionStorage = function() {
      var error;
      try {
        return !!sessionStorage.getItem;
      } catch (_error) {
        error = _error;
        return false;
      }
    };

    System.supportWebgl = function() {
      return !!window.WebGLRenderingContext;
    };

    System.supportWorker = function() {
      return !!window.Worker;
    };

    return System;

  })();

}).call(this);

(function() {
  Backbone.Locale = (function() {
    function Locale(options) {
      this.options = options;
      this.strings = {};
      this.lang = options.lang;
      if (options.strings != null) {
        this.strings[this.lang] = options.strings;
      }
      if (Backbone.Events != null) {
        _.extend(this, Backbone.Events);
      }
      this.loadingDicts = false;
    }

    Locale.prototype.load = function(opts) {
      var callback, callbackContext, cb, lang, options, url,
        _this = this;
      if (this.loadingDicts || ((this.lorem == null) && this.checkLorem(opts))) {
        return;
      }
      lang = opts.lang || "en";
      url = opts.path;
      callback = opts.callback;
      callbackContext = opts.callbackContext || this;
      options = opts.options || {};
      if (lang == null) {
        lang = document.getElementsByTagName('html')[0].getAttribute('lang');
      }
      cb = function() {
        _this.lang = lang;
        if (!$('html').hasClass(_this.lang)) {
          $('html').addClass(_this.lang);
        }
        console.info("Strings file for language " + lang + " loaded");
        console.timeEnd('Locale time loading');
        if (_this.strings[lang] == null) {
          _this.strings[lang] = Backbone.Locale.strings;
        }
        if (_this.strings[lang] && (_this.strings[lang].momentjs != null) && (typeof moment !== "undefined" && moment !== null)) {
          moment.lang(lang, _this.strings[lang].momentjs);
        }
        if ((typeof moment !== "undefined" && moment !== null) && lang === 'en') {
          moment.lang('en');
        }
        console.log("OK LANG");
        if (callback != null) {
          callback.call(callbackContext, options);
        }
        if (typeof _this.trigger === 'function') {
          return _this.trigger('language', lang);
        }
      };
      console.time('Locale time loading');
      if (this.strings[lang] != null) {
        cb();
        return;
      }
      if (url == null) {
        url = window.rootPath + ("scripts/locale/strings-" + lang + ".js");
      }
      if (url != null) {
        if (typeof yepnope === 'function') {
          return yepnope([
            {
              load: url,
              callback: function(url, test, key) {
                return cb();
              }
            }
          ]);
        } else {
          throw new Error("yepnope lib not loaded. Check Modernizr version > 2.0");
        }
      } else {
        throw new Error("URL for strings file not defined for lang " + lang);
      }
    };

    Locale.prototype.t = function(locale_string, locale_group, options) {
      var count, dataAttribute, dict, group, p, paragraphs, path, text, type, val;
      if (this.strings == null) {
        throw new Error('No traslation strings loaded');
      }
      if ((options == null) && (locale_group != null) && typeof locale_group === 'object') {
        options = locale_group;
        locale_group = null;
      }
      options = options || {};
      options.span = options.span != null ? options.span : true;
      group = locale_group && this.strings[this.lang][locale_group] || this.strings[this.lang];
      if (group[locale_string] != null) {
        return group[locale_string];
      }
      dataAttribute = "data-locale-string=\"" + locale_string + "\"";
      if (locale_group != null) {
        dataAttribute += " data-locale-group=\"" + locale_group + "\"";
      }
      path = this.lang + '.' + (locale_group != null ? locale_group + '.' : '') + locale_string;
      if ((this.lorem != null) && ((options.lorem != null) || (options.wars != null) || (options.futurama != null))) {
        val = options.lorem || options.wars || options.futurama;
        count = parseInt(val);
        type = Lorem.TYPE.WORD;
        if (/\d+p/.test(val)) {
          type = Lorem.TYPE.PARAGRAPH;
        }
        if (/\d+s/.test(val)) {
          type = Lorem.TYPE.SENTENCE;
        }
        if (/\d+w/.test(val)) {
          type = Lorem.TYPE.WORD;
        }
        if (/\d+ws/.test(val)) {
          type = Lorem.TYPE.WORDSENTENCE;
        }
        if ((options.wars != null) && (Lorem.DICTS.StarWars != null)) {
          dict = Lorem.DICTS.StarWars.master;
        }
        if ((options.futurama != null) && (Lorem.DICTS.Futurama != null)) {
          dict = Lorem.DICTS.Futurama;
          type = Lorem.TYPE.ELEMENT;
        }
        text = this.lorem.createText(count, type, dict);
        if (type === Lorem.TYPE.PARAGRAPH || type === Lorem.TYPE.ELEMENT) {
          paragraphs = text.split("\n");
          paragraphs = (function() {
            var _i, _len, _results;
            _results = [];
            for (_i = 0, _len = paragraphs.length; _i < _len; _i++) {
              p = paragraphs[_i];
              _results.push("<p class=\"translation-missing\" " + dataAttribute + " title=\"Translation missing: " + path + "\">" + p + "</p>");
            }
            return _results;
          })();
          return paragraphs.join(' ');
        }
      } else {
        text = locale_string;
      }
      if (options.span) {
        return "<span class=\"translation-missing\" " + dataAttribute + " title=\"Translation missing: " + path + "\">" + text + "</span>";
      } else {
        return text;
      }
    };

    Locale.prototype.checkLorem = function(opts) {
      var dicts, file,
        _this = this;
      console.log("@checkLorem", opts, opts.options);
      if (location.hostname.split('.').slice(-1).toString() !== 'dev' && !opts.options && !opts.options.forceLorem) {
        return false;
      }
      dicts = ['lorem.js', 'lorem.starwars.js'];
      dicts = (function() {
        var _i, _len, _results;
        _results = [];
        for (_i = 0, _len = dicts.length; _i < _len; _i++) {
          file = dicts[_i];
          _results.push(window.rootPath + ("scripts/locale/" + file));
        }
        return _results;
      })();
      this.loadingDicts = true;
      yepnope({
        load: dicts,
        complete: function(url, test, key) {
          if (typeof Lorem !== "undefined" && Lorem !== null) {
            _this.lorem = new Lorem;
          }
          _this.loadingDicts = false;
          return _this.load(opts);
        }
      });
      return true;
    };

    Locale.extractMissingTranslations = function() {
      var missingTranslations, obj;
      missingTranslations = $('.translation-missing');
      obj = {};
      missingTranslations.each(function() {
        var $el, group, string;
        $el = $(this);
        group = $el.attr('data-locale-group');
        string = $el.attr('data-locale-string');
        if (group != null) {
          if (obj[group] == null) {
            obj[group] = {};
          }
          return obj[group][string] = $el.html();
        } else {
          return obj[string] = $el.html();
        }
      });
      return obj;
    };

    Locale.missingTranslationsFile = function() {
      var filecontent, k, key, obj, st, string, text;
      obj = this.extractMissingTranslations();
      filecontent = "Backbone.Locale.strings = \n\tlang: \"" + INW.lang + "\"\n";
      for (key in obj) {
        string = obj[key];
        if (_.isString(string)) {
          text = "\t";
          text += "\"" + key + "\": \"Edit text\"\n";
          filecontent += text;
        } else if (_.isObject(string)) {
          filecontent += "\t\"" + key + "\":\n";
          for (k in string) {
            st = string[k];
            text = "\t\t";
            text += "\"" + k + "\": \"Edit text\"\n";
            filecontent += text;
          }
        }
      }
      return filecontent;
    };

    return Locale;

  })();

}).call(this);

(function() {
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Backbone.ElementView = (function(_super) {
    __extends(ElementView, _super);

    function ElementView() {
      _ref = ElementView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ElementView.prototype.init = function() {};

    ElementView.prototype.modelDidChange = function() {};

    ElementView.prototype.modelDidDestroy = function() {};

    ElementView.prototype.viewWillRender = function() {};

    ElementView.prototype.viewDidRender = function() {};

    ElementView.prototype.viewWillRemove = function() {};

    ElementView.prototype.viewDidRemove = function() {};

    ElementView.prototype.disableLink = function(e) {
      e.preventDefault();
      return e.stopPropagation();
    };

    ElementView.prototype.initialize = function(options) {
      if (options == null) {
        options = {};
      }
      this._methodBinding();
      this.rendered = false;
      this.binding = options.binding;
      if (options.binding && (this.model != null)) {
        this.model.on('change', this._modelWillChange, this);
        this.model.on('destroy', this._modelWillDestroy, this);
      }
      return this.init(options);
    };

    ElementView.prototype._methodBinding = function() {
      return _.bindAll(this, "render", "_finishRender", "viewDidRender", "modelDidChange", "modelDidDestroy", '_serializeData', '_checkDeviceType', 'viewWillRemove', 'viewDidRemove');
    };

    ElementView.prototype._modelWillChange = function() {
      this.modelDidChange();
      return this.render();
    };

    ElementView.prototype._modelWillDestroy = function() {
      this.modelDidDestroy();
      this.remove();
      return this;
    };

    /*
    _serializeData: ->
      data = {}
      data.models = @collection.toJSON() if @collection?
      data.model = @model.toJSON() if @model?
      _.defaults(@templateData, data)
      @templateData
    */


    ElementView.prototype._serializeData = function() {
      var data;
      data = {};
      if (this.collection != null) {
        if (_.isFunction(this.collection.toTemplateData)) {
          data.models = this.collection.toTemplateData();
        } else {
          data.models = this.collection.toJSON();
        }
      }
      if (this.model != null) {
        if (_.isFunction(this.model.toTemplateData)) {
          data.model = this.model.toTemplateData();
        } else {
          data.model = this.model.toJSON();
        }
      }
      _.defaults(this.templateData, data);
      return this.templateData;
    };

    ElementView.prototype._firstRender = function() {
      /*
      ##oslo:WARNING COMMENTED THIs ONS while debugging for leaks, it was leaking...
      if _.isFunction @resize 
        _.bindAll this, 'resize'
        #$(window).on 'resize', @resize
      
      #$(window).on 'resize', @_checkDeviceType
      
      if _.isFunction @viewOrientationDidChange
        _.bindAll this, 'viewOrientationDidChange'
        #$(window).on 'orientationchange', @viewOrientationDidChange
      
      do @_checkDeviceType
      */

    };

    ElementView.prototype.render = function() {
      var id, template;
      if (!((this.template != null) && _.isFunction(this.template))) {
        throw new Error("Template must be defined");
      }
      this.templateData = {};
      if (!this.rendered) {
        this._firstRender();
      }
      this.viewWillRender();
      this._serializeData();
      template = this._chooseTemplate();
      this.$el.html(template(this.templateData));
      if ((this.$el.attr('id') == null) && (this.idRoot != null)) {
        id = this.idRoot + (this.model.id || this.model.cid);
        this.$el.attr({
          id: id
        });
      }
      _.defer(this._finishRender);
      return this;
    };

    ElementView.prototype._finishRender = function() {
      this.rendered = true;
      this.viewDidRender();
      this.trigger('render', this);
      return this.templateData = {};
    };

    ElementView.prototype._checkDeviceType = function() {
      var w;
      w = $(window).width();
      this.isPhone = w < 768;
      this.isTablet = w > 767 && w < 980;
      if (!this.rendered) {
        this._oldIsPhone = this.isPhone;
      }
      if (_.isFunction(this.phoneTemplate)) {
        if (this.isPhone !== this._oldIsPhone) {
          this.render();
        }
      }
      return this._oldIsPhone = this.isPhone;
    };

    ElementView.prototype._chooseTemplate = function() {
      if (this.isPhone && _.isFunction(this.phoneTemplate)) {
        return this.phoneTemplate;
      } else {
        return this.template;
      }
    };

    ElementView.prototype.remove = function() {
      this.viewWillRemove();
      ElementView.__super__.remove.apply(this, arguments);
      if (this.model) {
        this.model.off('change', this._modelWillChange, this);
        this.model.off('destroy', this._modelWillDestroy, this);
      }
      $(window).off('resize', this._checkDeviceType);
      if (_.isFunction(this.viewOrientationDidChange)) {
        $(window).off('orientationchange', this.viewOrientationDidChange);
      }
      if (_.isFunction(this.resize)) {
        $(window).off('resize', this.resize);
      }
      this.viewDidRemove();
      this.trigger('remove', this);
      return this;
    };

    return ElementView;

  })(Backbone.View);

}).call(this);

(function() {
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Backbone.CollectionView = (function(_super) {
    __extends(CollectionView, _super);

    function CollectionView() {
      this.remove = __bind(this.remove, this);
      this.render = __bind(this.render, this);
      this.elementRemoved = __bind(this.elementRemoved, this);
      this.renderElement = __bind(this.renderElement, this);
      this.elementAdded = __bind(this.elementAdded, this);
      this.initialize = __bind(this.initialize, this);
      this.elementViewDidRemove = __bind(this.elementViewDidRemove, this);
      this.elementViewDidRender = __bind(this.elementViewDidRender, this);
      _ref = CollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    CollectionView.prototype.modelView = Backbone.ElementView;

    CollectionView.prototype.elementViewDidRender = function(view) {};

    CollectionView.prototype.elementViewDidRemove = function(view) {};

    CollectionView.prototype.initialize = function(options) {
      this._methodBinding();
      this.collection.on('add', this.elementAdded);
      this.collection.on('remove', this.elementRemoved);
      return this.init(options);
    };

    CollectionView.prototype.elementAdded = function(model) {
      var e, method, view;
      this.modelViews || (this.modelViews = {});
      view = this.renderElement(model);
      if (view) {
        view.collectionView = this;
        this.modelViews[view.model.cid] = view;
        this.$el.append(view.$el);
        this.elementViewDidRender(view);
        for (e in this.elementEvents) {
          method = this.elementEvents[e];
          if (!_.isFunction(method)) {
            method = this[this.elementEvents[e]];
          }
          if (!method) {
            continue;
          }
          view.on(e, method);
        }
      }
      return view;
    };

    CollectionView.prototype.renderElement = function(model) {
      var view;
      view = new this.modelView({
        model: model,
        binding: this.bindModelViews
      });
      view.render();
      return view;
    };

    CollectionView.prototype.elementRemoved = function(model) {
      var view;
      if (!this.modelViews) {
        return;
      }
      view = this.modelViews[model.cid];
      if (view) {
        view.remove();
        this.elementViewDidRemove(view);
        return delete this.modelViews[view.model.cid];
      }
    };

    CollectionView.prototype.render = function() {
      CollectionView.__super__.render.apply(this, arguments);
      return this.collection.each(this.elementAdded);
    };

    CollectionView.prototype.remove = function() {
      var _this = this;
      CollectionView.__super__.remove.apply(this, arguments);
      this.collection.off('add', this.elementAdded);
      this.collection.off('remove', this.elementRemoved);
      if (this.modelViews) {
        _.each(this.modelViews, function(element) {
          return element.remove();
        });
      }
      this.modelViews = [];
      return this;
    };

    return CollectionView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Backbone.BetterCollectionView = (function(_super) {
    __extends(BetterCollectionView, _super);

    function BetterCollectionView() {
      this.select = __bind(this.select, this);
      this.remove = __bind(this.remove, this);
      this.renderElement = __bind(this.renderElement, this);
      this.detachElement = __bind(this.detachElement, this);
      this.appendElement = __bind(this.appendElement, this);
      this.renderVisible = __bind(this.renderVisible, this);
      this.elementRemoved = __bind(this.elementRemoved, this);
      this.elementAdded = __bind(this.elementAdded, this);
      this.getElementHeight = __bind(this.getElementHeight, this);
      this.render = __bind(this.render, this);
      this.updateFilteredModels = __bind(this.updateFilteredModels, this);
      this._validateFilter = __bind(this._validateFilter, this);
      this._serializeData = __bind(this._serializeData, this);
      this.initialize = __bind(this.initialize, this);
      this.elementViewDidRemove = __bind(this.elementViewDidRemove, this);
      this.elementViewDidRender = __bind(this.elementViewDidRender, this);
      _ref = BetterCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BetterCollectionView.prototype.modelView = Backbone.ElementView;

    BetterCollectionView.prototype._filterModels = null;

    BetterCollectionView.prototype.elementViewDidRender = function(view) {};

    BetterCollectionView.prototype.elementViewDidRemove = function(view) {};

    BetterCollectionView.prototype.initialize = function(options) {
      this._methodBinding();
      this.collection.on('add', this.elementAdded);
      this.collection.on('remove', this.elementRemoved);
      this.collection.on('update-filters', this.updateFilteredModels);
      this.init(options);
      return this.filteredModels = [];
    };

    BetterCollectionView.prototype._serializeData = function() {};

    BetterCollectionView.prototype._validateFilter = function(model) {
      if (this._filterModels != null) {
        if ($.isFunction(this._filterModels)) {
          return this._filterModels(model);
        } else {
          return this._filterModels === model.constructor.name;
        }
      } else {
        return true;
      }
    };

    BetterCollectionView.prototype.updateFilteredModels = function() {
      var m, _i, _len, _ref1, _results;
      if (this.collection.comparator != null) {
        this.collection.sort();
      }
      this.filteredModels = [];
      _ref1 = this.collection.models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        m = _ref1[_i];
        if (this._validateFilter(m)) {
          _results.push(this.filteredModels.push(m));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    BetterCollectionView.prototype.render = function() {
      BetterCollectionView.__super__.render.apply(this, arguments);
      if (!this.elementViewsContainer) {
        this.elementViewsContainer = $("<div class='collection-element-container'><div>");
        this.$el.append(this.elementViewsContainer);
        this.$el.on("scroll", this.renderVisible);
        this.elementViewsContainer.css("position", "relative");
      }
      this.elementViewsContainer.css("height", this.filteredModels.length * this.getElementHeight());
      this.updateFilteredModels();
      this.elementViewsContainer.css("height", this.filteredModels.length * this.getElementHeight());
      return this.renderVisible();
    };

    BetterCollectionView.prototype.getElementHeight = function() {
      if (this.modelView.prototype.defaultHeight) {
        return this.modelView.prototype.defaultHeight;
      }
      return 30;
    };

    BetterCollectionView.prototype.elementAdded = function(model) {
      this.updateFilteredModels();
      this.elementViewsContainer.css("height", this.filteredModels.length * this.getElementHeight());
      return this.renderVisible();
    };

    BetterCollectionView.prototype.elementRemoved = function(model) {
      var view;
      if (this.filteredModels.indexOf(model) >= 0) {
        this.filteredModels.splice(this.filteredModels.indexOf(model), 1);
      }
      if (!this.modelViews) {
        return;
      }
      view = this.modelViews[model.cid];
      if (view) {
        view.remove();
        this.elementViewDidRemove(view);
        delete this.modelViews[view.model.cid];
      }
      return this.renderVisible();
    };

    BetterCollectionView.prototype.renderVisible = function() {
      var h, index, lowestY, mvcid, rowModel, rows, startRow, totalHeight, view, _i, _len, _ref1, _results;
      this.modelViews || (this.modelViews = {});
      totalHeight = this.$el.innerHeight();
      lowestY = this.$el.scrollTop();
      h = this.getElementHeight();
      rows = Math.ceil(totalHeight / h);
      if (totalHeight === 0) {
        rows = 4;
      }
      startRow = Math.floor(lowestY / h);
      _ref1 = this.filteredModels;
      for (index = _i = 0, _len = _ref1.length; _i < _len; index = ++_i) {
        rowModel = _ref1[index];
        if (index < startRow - 1 || index > startRow + rows) {
          if (this.modelViews[rowModel.cid]) {
            this.detachElement(rowModel);
          }
        } else {
          if (!this.modelViews[rowModel.cid]) {
            view = this.appendElement(rowModel);
            view.$el.css({
              position: "absolute",
              top: index * h,
              width: "100%",
              height: h
            });
          } else {
            this.modelViews[rowModel.cid].$el.css({
              top: index * h
            });
            this.modelViews[rowModel.cid].model = rowModel;
          }
        }
      }
      _results = [];
      for (mvcid in this.modelViews) {
        if (_.find(this.filteredModels, function(model) {
          return model.cid === mvcid;
        }) == null) {
          _results.push(this.modelViews[mvcid].remove());
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    BetterCollectionView.prototype.appendElement = function(model) {
      var e, method, view;
      this.modelViews || (this.modelViews = {});
      view = this.renderElement(model);
      if (view) {
        view.collectionView = this;
        this.modelViews[view.model.cid] = view;
        this.elementViewsContainer.append(view.$el);
        this.elementViewDidRender(view);
        for (e in this.elementEvents) {
          method = this.elementEvents[e];
          if (!_.isFunction(method)) {
            method = this[this.elementEvents[e]];
          }
          if (!method) {
            continue;
          }
          view.on(e, method);
        }
      }
      return view;
    };

    BetterCollectionView.prototype.detachElement = function(model) {
      var view;
      view = this.modelViews[model.cid];
      view.remove();
      return this.modelViews[model.cid] = null;
    };

    BetterCollectionView.prototype.renderElement = function(model) {
      var view;
      view = new this.modelView({
        model: model,
        binding: this.bindModelViews
      });
      view.render();
      return view;
    };

    BetterCollectionView.prototype.remove = function() {
      var _this = this;
      BetterCollectionView.__super__.remove.apply(this, arguments);
      this.collection.off('add', this.elementAdded);
      this.collection.off('remove', this.elementRemoved);
      if (this.modelViews) {
        _.each(this.modelViews, function(element) {
          if (element != null) {
            return element.remove();
          }
        });
      }
      this.modelViews = [];
      return this;
    };

    BetterCollectionView.prototype.select = function(model) {
      var _this = this;
      if (model == null) {
        return;
      }
      return _.defer(function() {
        var endPos, index, startPos, view;
        index = _this.filteredModels.indexOf(model);
        startPos = _this.getElementHeight() * (index + 1);
        endPos = _this.getElementHeight() * (index + 2);
        if (startPos < _this.$el.scrollTop()) {
          _this.$el.scrollTop(startPos);
        }
        if (endPos - _this.$el.innerHeight() > _this.$el.scrollTop()) {
          _this.$el.scrollTop(endPos - _this.$el.innerHeight());
        }
        _this.renderVisible();
        view = _this.modelViews[model.cid];
        return view.$el.trigger("click");
      });
    };

    return BetterCollectionView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Backbone.SortableCollectionView = (function(_super) {
    __extends(SortableCollectionView, _super);

    function SortableCollectionView() {
      this.handleStop = __bind(this.handleStop, this);
      this.select = __bind(this.select, this);
      this.renderElement = __bind(this.renderElement, this);
      this.renderVisible = __bind(this.renderVisible, this);
      this.render = __bind(this.render, this);
      _ref = SortableCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SortableCollectionView.prototype.modelView = Backbone.ElementView;

    SortableCollectionView.prototype._filterModels = null;

    SortableCollectionView.prototype.render = function() {
      SortableCollectionView.__super__.render.apply(this, arguments);
      this.elementViewsContainer.css("overflow", "hidden");
      return this.elementViewsContainer.sortable({
        scrollSpeed: 5,
        stop: this.handleStop
      });
    };

    SortableCollectionView.prototype.renderVisible = function() {
      var index, rest, rowModel, sortedViews, view, _i, _j, _k, _len, _len1, _len2, _ref1, _results;
      this.modelViews || (this.modelViews = {});
      sortedViews = [];
      rest = [];
      _ref1 = this.filteredModels;
      for (index = _i = 0, _len = _ref1.length; _i < _len; index = ++_i) {
        rowModel = _ref1[index];
        if (!this.modelViews[rowModel.cid]) {
          view = this.appendElement(rowModel);
          view.$el.css({
            width: "100%"
          });
          if (rowModel.get("groupSortIndex") != null) {
            sortedViews[rowModel.get("groupSortIndex")] = view;
          } else {
            rest.push(view);
          }
        }
      }
      for (_j = 0, _len1 = sortedViews.length; _j < _len1; _j++) {
        view = sortedViews[_j];
        if (view != null) {
          this.elementViewsContainer.append(view.$el);
        }
      }
      _results = [];
      for (_k = 0, _len2 = rest.length; _k < _len2; _k++) {
        view = rest[_k];
        _results.push(this.elementViewsContainer.append(view.$el));
      }
      return _results;
    };

    SortableCollectionView.prototype.renderElement = function(model) {
      var view;
      view = SortableCollectionView.__super__.renderElement.apply(this, arguments);
      view.$el.attr("id", model.get("id"));
      return view;
    };

    SortableCollectionView.prototype.select = function(model) {
      var _this = this;
      return _.defer(function() {
        var endPos, startPos, view;
        view = _this.modelViews[model.cid];
        if (view == null) {
          return;
        }
        startPos = view.$el.offset().top - _this.$el.offset().top;
        endPos = startPos + _this.getElementHeight();
        if (startPos < _this.$el.scrollTop()) {
          _this.$el.scrollTop(startPos);
        }
        if (endPos - _this.$el.innerHeight() > _this.$el.scrollTop()) {
          _this.$el.scrollTop(endPos - _this.$el.innerHeight());
        }
        _this.renderVisible();
        return view.$el.trigger("click");
      });
      /*
      _.defer(()=>
        view = @modelViews[model.cid]
      
        @$el.scrollTop(view.$el.offset().top-@$el.offset().top)
        
        view.$el.trigger("click")
      )
      */

    };

    SortableCollectionView.prototype.handleStop = function() {
      var index, rowModel, sortedIds, _i, _len, _ref1, _results;
      sortedIds = this.elementViewsContainer.sortable("toArray");
      _ref1 = this.filteredModels;
      _results = [];
      for (index = _i = 0, _len = _ref1.length; _i < _len; index = ++_i) {
        rowModel = _ref1[index];
        _results.push(rowModel.set("groupSortIndex", sortedIds.indexOf(rowModel.get("id")), {
          silent: true
        }));
      }
      return _results;
    };

    return SortableCollectionView;

  })(Backbone.BetterCollectionView);

}).call(this);

(function() {
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Backbone.ArrayOfModelsView = (function(_super) {
    __extends(ArrayOfModelsView, _super);

    function ArrayOfModelsView() {
      this.select = __bind(this.select, this);
      this.replaceModels = __bind(this.replaceModels, this);
      this.remove = __bind(this.remove, this);
      this.renderElement = __bind(this.renderElement, this);
      this.detachElement = __bind(this.detachElement, this);
      this.appendElement = __bind(this.appendElement, this);
      this.renderVisible = __bind(this.renderVisible, this);
      this.elementRemoved = __bind(this.elementRemoved, this);
      this.elementAdded = __bind(this.elementAdded, this);
      this.getElementHeight = __bind(this.getElementHeight, this);
      this.render = __bind(this.render, this);
      this.updateFilteredModels = __bind(this.updateFilteredModels, this);
      this._validateFilter = __bind(this._validateFilter, this);
      this._serializeData = __bind(this._serializeData, this);
      this.initialize = __bind(this.initialize, this);
      this.elementViewDidRemove = __bind(this.elementViewDidRemove, this);
      this.elementViewDidRender = __bind(this.elementViewDidRender, this);
      _ref = ArrayOfModelsView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ArrayOfModelsView.prototype.modelView = Backbone.ElementView;

    ArrayOfModelsView.prototype._filterModels = null;

    ArrayOfModelsView.prototype.elementViewDidRender = function(view) {};

    ArrayOfModelsView.prototype.elementViewDidRemove = function(view) {};

    ArrayOfModelsView.prototype.initialize = function(options) {
      this._methodBinding();
      this.init(options);
      return this.filteredModels = [];
    };

    ArrayOfModelsView.prototype._serializeData = function() {};

    ArrayOfModelsView.prototype._validateFilter = function(model) {
      if (this._filterModels != null) {
        if ($.isFunction(this._filterModels)) {
          return this._filterModels(model);
        } else {
          return this._filterModels === model.constructor.name;
        }
      } else {
        return true;
      }
    };

    ArrayOfModelsView.prototype.updateFilteredModels = function() {
      var m, _i, _len, _ref1, _results;
      this.filteredModels = [];
      _ref1 = this.collection;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        m = _ref1[_i];
        if (this._validateFilter(m)) {
          _results.push(this.filteredModels.push(m));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
      /*
      if @collection.comparator?
        @collection.sort()
      @filteredModels = []
      for m in @collection.models
        if @_validateFilter(m)
          @filteredModels.push(m)
      */

    };

    ArrayOfModelsView.prototype.render = function() {
      ArrayOfModelsView.__super__.render.apply(this, arguments);
      if (!this.elementViewsContainer) {
        this.elementViewsContainer = $("<div class='collection-element-container'><div>");
        this.$el.append(this.elementViewsContainer);
        this.$el.on("scroll", this.renderVisible);
        this.elementViewsContainer.css("position", "relative");
      }
      this.elementViewsContainer.css("height", this.filteredModels.length * this.getElementHeight());
      this.updateFilteredModels();
      this.elementViewsContainer.css("height", this.filteredModels.length * this.getElementHeight());
      return this.renderVisible();
    };

    ArrayOfModelsView.prototype.getElementHeight = function() {
      if (this.modelView.prototype.defaultHeight) {
        return this.modelView.prototype.defaultHeight;
      }
      return 30;
    };

    ArrayOfModelsView.prototype.elementAdded = function(model) {
      this.updateFilteredModels();
      this.elementViewsContainer.css("height", this.filteredModels.length * this.getElementHeight());
      return this.renderVisible();
    };

    ArrayOfModelsView.prototype.elementRemoved = function(model) {
      var view;
      if (this.filteredModels.indexOf(model) >= 0) {
        this.filteredModels.splice(this.filteredModels.indexOf(model), 1);
      }
      if (!this.modelViews) {
        return;
      }
      view = this.modelViews[model.cid];
      if (view) {
        view.remove();
        this.elementViewDidRemove(view);
        delete this.modelViews[view.model.cid];
      }
      return this.renderVisible();
    };

    ArrayOfModelsView.prototype.renderVisible = function() {
      var h, index, lowestY, mvcid, rowModel, rows, startRow, totalHeight, view, _i, _len, _ref1, _results;
      this.modelViews || (this.modelViews = {});
      totalHeight = this.$el.innerHeight();
      lowestY = this.$el.scrollTop();
      h = this.getElementHeight();
      rows = Math.ceil(totalHeight / h);
      if (totalHeight === 0) {
        rows = 4;
      }
      startRow = Math.floor(lowestY / h);
      _ref1 = this.filteredModels;
      for (index = _i = 0, _len = _ref1.length; _i < _len; index = ++_i) {
        rowModel = _ref1[index];
        if (index < startRow || index > startRow + rows) {
          if (this.modelViews[rowModel.cid]) {
            this.detachElement(rowModel);
          }
        } else {
          if (!this.modelViews[rowModel.cid]) {
            view = this.appendElement(rowModel);
            view.$el.css({
              position: "absolute",
              top: index * h,
              width: "100%",
              height: h
            });
          } else {
            this.modelViews[rowModel.cid].$el.css({
              top: index * h
            });
            this.modelViews[rowModel.cid].model = rowModel;
          }
        }
      }
      _results = [];
      for (mvcid in this.modelViews) {
        if (_.find(this.filteredModels, function(model) {
          return model.cid === mvcid;
        }) == null) {
          _results.push(this.modelViews[mvcid].$el.detach());
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    ArrayOfModelsView.prototype.appendElement = function(model) {
      var e, method, view;
      this.modelViews || (this.modelViews = {});
      view = this.renderElement(model);
      if (view) {
        view.collectionView = this;
        this.modelViews[view.model.cid] = view;
        this.elementViewsContainer.append(view.$el);
        this.elementViewDidRender(view);
        for (e in this.elementEvents) {
          method = this.elementEvents[e];
          if (!_.isFunction(method)) {
            method = this[this.elementEvents[e]];
          }
          if (!method) {
            continue;
          }
          view.on(e, method);
        }
      }
      return view;
    };

    ArrayOfModelsView.prototype.detachElement = function(model) {
      var view;
      view = this.modelViews[model.cid];
      view.remove();
      return this.modelViews[model.cid] = null;
    };

    ArrayOfModelsView.prototype.renderElement = function(model) {
      var view;
      view = new this.modelView({
        model: model,
        binding: this.bindModelViews
      });
      view.render();
      return view;
    };

    ArrayOfModelsView.prototype.remove = function() {
      var _this = this;
      ArrayOfModelsView.__super__.remove.apply(this, arguments);
      if (this.modelViews) {
        _.each(this.modelViews, function(element) {
          if (element != null) {
            return element.remove();
          }
        });
      }
      this.modelViews = [];
      return this;
    };

    ArrayOfModelsView.prototype.replaceModels = function(newCollection) {
      this.collection = newCollection;
      return this.updateFilteredModels();
    };

    ArrayOfModelsView.prototype.select = function(model) {
      var endPos, index, startPos,
        _this = this;
      if (model == null) {
        return;
      }
      index = this.collection.indexOf(model);
      startPos = this.getElementHeight() * index;
      endPos = this.getElementHeight() * (index + 1);
      if (startPos < this.$el.scrollTop()) {
        this.$el.scrollTop(startPos);
      }
      if (endPos - this.$el.innerHeight() > this.$el.scrollTop()) {
        this.$el.scrollTop(endPos - this.$el.innerHeight());
      }
      return _.defer(function() {
        var view;
        view = _this.modelViews[model.cid];
        return view.$el.trigger("click");
      });
    };

    return ArrayOfModelsView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Backbone.d3View = (function(_super) {
    __extends(d3View, _super);

    function d3View() {
      _ref = d3View.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    d3View.prototype.init = function() {};

    d3View.prototype.modelDidChange = function() {};

    d3View.prototype.modelDidDestroy = function() {};

    d3View.prototype.viewWillRender = function() {};

    d3View.prototype.viewDidRender = function() {};

    d3View.prototype.viewWillRemove = function() {};

    d3View.prototype.viewDidRemove = function() {};

    d3View.prototype.viewWillUpdate = function() {};

    d3View.prototype.viewDidUpdate = function() {};

    d3View.prototype.initialize = function(options) {
      if (options == null) {
        options = {};
      }
      this._methodBinding();
      _.bindAll(this, "viewWillUpdate", "viewDidUpdate", "_viewUpdate");
      this.rendered = false;
      options.binding = this.binding = true;
      if (options.binding && (this.model != null)) {
        this.model.on('change', this._modelWillChange, this);
        this.model.on('destroy', this._modelWillDestroy, this);
      }
      return this.init(options);
    };

    d3View.prototype._modelWillChange = function() {
      this.modelDidChange();
      if (this.rendered == null) {
        return this.render();
      } else {
        return this._viewUpdate();
      }
    };

    d3View.prototype._viewUpdate = function() {
      this.viewWillUpdate();
      return _.defer(this.viewDidUpdate);
    };

    d3View.prototype.render = function() {
      var id, template;
      if (!((this.template != null) && _.isFunction(this.template))) {
        throw new Error("Template must be defined");
      }
      this.templateData = {};
      if (!this.rendered) {
        this._firstRender();
        this.viewWillRender();
        this._serializeData();
        template = this._chooseTemplate();
        this.$el.html(template(this.templateData));
        if ((this.$el.attr('id') == null) && (this.idRoot != null)) {
          id = this.idRoot + (this.model.id || this.model.cid);
          this.$el.attr({
            id: id
          });
        }
        _.defer(this._finishRender);
        return this;
      } else {
        this.viewWillUpdate();
        return _.defer(this.viewDidUpdate);
      }
    };

    return d3View;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Backbone.SmoothElementView = (function(_super) {
    __extends(SmoothElementView, _super);

    function SmoothElementView() {
      _ref = SmoothElementView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SmoothElementView.prototype.render = function() {
      this.setHidden(true);
      return SmoothElementView.__super__.render.call(this);
    };

    SmoothElementView.prototype._finishRender = function() {
      SmoothElementView.__super__._finishRender.call(this);
      this.$el.addClass("smooth-view");
      return this.setHidden(false);
    };

    SmoothElementView.prototype.remove = function() {
      this.setHidden(true);
      return SmoothElementView.__super__.remove.call(this);
    };

    SmoothElementView.prototype.setHidden = function(value) {
      if (value) {
        return this.$el.css("opacity", 0);
      } else {
        return this.$el.css("opacity", 1);
      }
    };

    return SmoothElementView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  var BlockUtils,
    _this = this;

  BlockUtils = {
    isEmpty: function(block) {
      if (block instanceof quadrigram.Models.PreFunctionBlockModel) {
        if (block.state === "dead") {
          return true;
        } else {
          return false;
        }
      } else {
        return (block.get("data") == null) || block.get("data") === void 0 || block.get("data").length === 0 || (block.get("data").length === 1 && block.get("data")[0].value === "");
      }
    },
    viewModeToLevel: function(mode) {
      switch (mode) {
        case "list":
          return 0;
        case "table":
          return 1;
      }
    },
    levelToViewMode: function(level) {
      switch (mode) {
        case 0:
          return "list";
        case 1:
          return "table";
      }
    },
    getBlockDepth: function(block) {
      var depth;
      depth = this.depth_recloop(block);
      return depth;
    },
    depth_recloop: function(block) {
      var childDepth, data, depth, qv, _i, _len;
      depth = 0;
      if (block.get && block.get("data") && block.get("data").length > 0) {
        data = block.get("data");
      } else if (block.data && block.data.length > 0) {
        data = block.data;
      }
      if (data != null) {
        for (_i = 0, _len = data.length; _i < _len; _i++) {
          qv = data[_i];
          if (qv.value != null) {
            childDepth = this.depth_recloop(qv.value);
          } else {
            childDepth = 0;
          }
          if (depth < childDepth) {
            depth = childDepth;
          }
        }
        return depth + 1;
      } else {
        return 0;
      }
    },
    isBlockOrData: function(block) {
      if (block instanceof Backbone.Model && block.get("data")) {
        return true;
      } else {
        return block instanceof quadrigram.Models.DataBlockData || block instanceof quadrigram.Models.DataBlockModel;
      }
    },
    isTable: function(block) {
      var bottomIds, qqv, qv, _i, _j, _len, _len1, _ref, _ref1;
      if (this.getBlockDepth(block) !== 2) {
        return false;
      } else if (block.get("data").length === 1) {
        return true;
      } else {
        bottomIds = {};
        _ref = block.get("data");
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          qv = _ref[_i];
          _ref1 = qv.value.get("data");
          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
            qqv = _ref1[_j];
            if (bottomIds[qqv.id] != null) {
              return true;
            }
            bottomIds[qqv.id] = true;
          }
        }
      }
      return false;
    },
    flattenBlock: function(block) {
      return BlockUtils.flattenBlockRecursive(block);
    },
    flattenBlockRecursive: function(block) {
      var qv, result, _i, _len, _ref;
      result = [];
      if (block.get("data") && block.get("data").length === 0) {
        return null;
      }
      if (block.get("data").length > 1) {
        _ref = block.get("data");
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          qv = _ref[_i];
          if (this.isBlockOrData(qv.value)) {
            result.push(new quadrigram.Models.QValue(BlockUtils.flattenBlockRecursive(qv.value), qv.id));
          } else {
            result.push(qv);
          }
        }
        return result;
      } else {
        return block.get("data")[0].value;
      }
    },
    flattenBlock2: function(block) {
      return BlockUtils.flattenBlockRecursive2(block);
    },
    flattenBlockRecursive2: function(block) {
      var qv, result, _i, _len, _ref;
      result = {};
      result.data = [];
      result.label = block.get("label");
      result.metaData = block.get("metaData");
      _ref = block.get("data");
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        qv = _ref[_i];
        if (this.isBlockOrData(qv.value)) {
          result.data.push(new quadrigram.Models.QValue(BlockUtils.flattenBlockRecursive2(qv.value), qv.id));
        } else {
          result.data.push(new quadrigram.Models.QValue(qv.value, qv.id));
        }
      }
      return result;
    },
    adaptFlattenBlockToVisualizers: function(block, requireMeta) {
      return BlockUtils.adaptFlattenBlockToVisualizersRecursive(block, requireMeta);
    },
    adaptFlattenBlockToVisualizersRecursive: function(block, requireMeta) {
      var childrenBlock, output, _i, _len, _ref;
      if ((block != null) && (block.data != null)) {
        if (!requireMeta && block.data.length === 1) {
          return output = BlockUtils.adaptFlattenBlockToVisualizersRecursive(block.data[0].value, requireMeta);
        } else {
          output = [];
          output.label = block.label;
          output.metadata = block.metaData;
          _ref = block.data;
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            childrenBlock = _ref[_i];
            if (childrenBlock != null) {
              output.push({
                id: childrenBlock.id,
                value: BlockUtils.adaptFlattenBlockToVisualizersRecursive(childrenBlock.value, requireMeta)
              });
            }
          }
          return output;
        }
      } else {
        return block;
      }
    },
    unflattenBlock: function(object) {
      return BlockUtils.unflattenBlockRecursive(object);
    },
    unflattenBlockRecursive: function(object) {
      var qv, result, resultData, _i, _len, _ref;
      result = new quadrigram.Models.DataBlockData;
      resultData = [];
      if (object == null) {
        elog("Error: operator did not return an object. Autosave disabled");
        quadrigram.router.dataModels.currentProject.autoSaveEnabled = false;
        return result;
      }
      if (_.isArray(object.data)) {
        _ref = object.data;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          qv = _ref[_i];
          if ((qv != null) && qv.value && (qv.value.data != null)) {
            resultData.push(new quadrigram.Models.QValue(BlockUtils.unflattenBlockRecursive(qv.value), qv.id));
          } else {
            resultData.push(qv);
          }
        }
      } else {
        resultData.push(object.data);
      }
      result.set("data", resultData);
      result.set("label", object.label);
      result.set("metaData", object.metaData);
      return result;
    },
    swapIds: function(block) {
      var qv, resultBlockData, resultData, resultQV, _i, _len, _ref;
      resultBlockData = new quadrigram.Models.DataBlockData;
      resultData = [];
      _ref = block.get("data");
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        qv = _ref[_i];
        resultQV = {
          id: qv.value,
          value: qv.id
        };
        resultData.push(resultQV);
      }
      resultBlockData.set("data", resultData);
      return resultBlockData;
    },
    getIdsAtLevel: function(block, targetLevel) {
      var allIds, blockDepth, idLabel, result, resultBlockData, trueResult;
      result = [];
      resultBlockData = new quadrigram.Models.DataBlockData;
      blockDepth = this.getBlockDepth(block);
      targetLevel = blockDepth - targetLevel;
      this.getNames_recLoop(block, result, targetLevel, blockDepth);
      trueResult = [];
      allIds = {};
      $.each(result, function(index, value) {
        if (allIds[value.id] == null) {
          allIds[value.id] = value.id;
          return trueResult.push(value);
        }
      });
      resultBlockData.set("data", trueResult);
      switch (targetLevel) {
        case 0:
          idLabel = "Rows";
          break;
        case 1:
          idLabel = "Columns";
          break;
        default:
          idLabel = "-";
      }
      resultBlockData.set("metaData", {
        "idLabel": idLabel,
        "valueLabel": "Names"
      });
      return resultBlockData;
    },
    getNames_recLoop: function(block, result, targetLevel, level) {
      var currentArray, qv, _i, _len, _results;
      currentArray = block.get("data");
      _results = [];
      for (_i = 0, _len = currentArray.length; _i < _len; _i++) {
        qv = currentArray[_i];
        if (targetLevel + 1 === level) {
          _results.push(result.push(new quadrigram.Models.QValue(qv.id, qv.id)));
        } else {
          if (this.isBlockOrData(qv.value)) {
            _results.push(this.getNames_recLoop(qv.value, result, targetLevel, level - 1));
          } else {
            _results.push(void 0);
          }
        }
      }
      return _results;
    },
    blockToDataObject: function(block) {
      var result;
      result = this.dataArrayToObject(block);
      return JSON.stringify(result);
    },
    checkIsDate: function(string, format) {
      return TimeUtils.checkIsDate(string, format);
    },
    /*
    checkIsDate_OLD:(string)->
      ##ESTAN MAL...
      #DD/MM/YYYY
      `
      var pattern1 = /^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-./])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$/
      `
      #MM/DD/YYYY
      `
      var pattern2 = /((0?[13578]|10|12)(-|\/)((0[0-9])|([12])([0-9]?)|(3[01]?))(-|\/)((\d{4})|(\d{2}))|(0?[2469]|11)(-|\/)((0[0-9])|([12])([0-9]?)|(3[0]?))(-|\/)((\d{4}|\d{2})))/   
      `
      #January 3 (chapuzilla) [[TENDRIA QUE COMPROVAR TANTO POR DELANTE COMO POR DETRAS....]]
      `
      var pattern3 = /^(?:(((Jan(uary)?|Ma(r(ch)?|y)|Jul(y)?|Aug(ust)?|Oct(ober)?|Dec(ember)?)\ 31)|((Jan(uary)?|Ma(r(ch)?|y)|Apr(il)?|Ju((ly?)|(ne?))|Aug(ust)?|Oct(ober)?|(Sept|Nov|Dec)(ember)?)\ (0?[1-9]|([12]\d)|30))|(Feb(ruary)?\ (0?[1-9]|1\d|2[0-8]|(29(?=,\s?))))))/
      `
      string = String(string).trim()
      if string.match(pattern1)
        return "valid"
      else if string.match(pattern2) || string.match(pattern3)
        return "invalid"
      else
        return null
    */

    dataArrayToObject: function(block) {
      var attr, attributes, d, dataObject, i, key, resultObject;
      resultObject = {};
      if ((block != null) && (block.get != null) && (block.get("data") != null)) {
        if (block.attributes != null) {
          attributes = block.attributes;
        } else {
          attributes = block;
        }
        for (key in attributes) {
          attr = attributes[key];
          if (key !== "data") {
            resultObject[key] = attr;
          } else {
            dataObject = {};
            for (i in attr) {
              d = attr[i];
              dataObject[d.id] = this.dataArrayToObject(d.value);
            }
            resultObject[key] = dataObject;
          }
        }
        return resultObject;
      } else {
        return block;
      }
    },
    isEqual: function(a, b, omit) {
      var el, i, key, result, _i, _len;
      if (omit == null) {
        omit = [];
      }
      if (_.isObject(a) && _.isObject(b)) {
        result = true;
        if (_.isArray(a) && _.isArray(b)) {
          if (a.length !== b.length) {
            return false;
          }
          for (i = _i = 0, _len = a.length; _i < _len; i = ++_i) {
            el = a[i];
            result = result && (b[i] != null) && this.isEqual(a[i], b[i], omit);
          }
        } else {
          for (key in a) {
            if (omit.indexOf(key) >= 0) {
              continue;
            } else {
              result = result && (key in b) && this.isEqual(a[key], b[key], omit);
            }
          }
        }
        return result;
      } else {
        return a === b;
      }
    }
  };

  try {
    window.BlockUtils = BlockUtils;
  } catch (_error) {
    this.BlockUtils = BlockUtils;
  }

}).call(this);

(function() {
  'use strict';
  var _this = this;

  window.QValueUtils = {
    addValues: function(a, b) {
      var type;
      if ((a === null || $.isNumeric(a)) && (b === null || $.isNumeric(b))) {
        type = "Number";
      } else {
        type = "String";
      }
      if (type === "String") {
        if (a === null) {
          return b;
        }
        if (b === null) {
          return a;
        } else {
          return a + ", " + b;
        }
      } else {
        return window[type](a) + window[type](b);
      }
    },
    aggregateInit: function(currentId) {
      var cached, value;
      value = new quadrigram.Models.QValue(null, currentId);
      cached = {
        "value": value,
        "meta": {}
      };
      return cached;
    },
    aggregateFirst: function(cached, newValue, mode) {
      if (mode === "add" || mode === "mean" || mode === "count" || mode === "none") {
        return cached.value.value = null;
      } else if (mode === "asblock") {
        newValue = new quadrigram.Models.DataBlockData;
        newValue.get("data").push(new quadrigram.Models.QValue(cached.value.value, cached.value.value));
        return cached.value.value = newValue;
      }
    },
    aggregateStep: function(cached, newValue, mode) {
      var _base, _base1;
      if (mode === "add" || mode === "none") {
        cached.value.value = QValueUtils.addValues(cached.value.value, newValue);
      } else if (mode === "mean") {
        (_base = cached.meta).count || (_base.count = 0);
        cached.meta.count += 1;
        cached.value.value = +cached.value.value + +newValue;
      } else if (mode === "count") {
        (_base1 = cached.meta).count || (_base1.count = 0);
        cached.meta.count += 1;
      } else if (mode === "asblock") {
        if (cached.value.value == null) {
          cached.value.value = newValue;
        } else if (!BlockUtils.isBlockOrData(cached.value.value)) {
          QValueUtils.aggregateFirst(cached, newValue, mode);
          cached.value.value.get("data").push(new quadrigram.Models.QValue(newValue, newValue));
        } else {
          cached.value.value.get("data").push(new quadrigram.Models.QValue(newValue, newValue));
        }
      }
      if (cached == null) {
        cached.value.value = "aggregateError";
      }
      return cached;
    },
    aggregateEnd: function(cached, mode, label) {
      if (mode === "none") {
        return cached.value;
      } else if (mode === "add") {
        return cached.value;
      } else if (mode === "mean") {
        if (cached.meta && cached.meta.count) {
          cached.value.value = cached.value.value / cached.meta.count;
          return cached.value;
        } else {
          return cached.value;
        }
      } else if (mode === "count") {
        if (cached.meta && cached.meta.count) {
          cached.value.value = cached.meta.count;
          return cached.value;
        } else {
          cached.value.value = 1;
          return cached.value;
        }
      } else if (mode === "asblock") {
        if (BlockUtils.isBlockOrData(cached.value.value)) {
          cached.value.value.set("label", label);
          cached.value.value.set("metaData", {
            "label": label,
            "valueLabel": label,
            "idLabel": label
          });
        }
        return cached.value;
      }
    },
    chooseBestAggregation: function(table, colKey) {
      var notNumbers, ob, _i, _len;
      notNumbers = false;
      for (_i = 0, _len = table.length; _i < _len; _i++) {
        ob = table[_i];
        if (!$.isNumeric(ob[colKey])) {
          notNumbers = true;
          break;
        }
      }
      if (notNumbers) {
        return "count";
      } else {
        return "add";
      }
    },
    needsAggregation: function(table, colKey) {
      var allIds, ob, _i, _len;
      allIds = {};
      for (_i = 0, _len = table.length; _i < _len; _i++) {
        ob = table[_i];
        if (allIds[ob[colKey]] != null) {
          return true;
        }
        allIds[ob[colKey]] = true;
      }
      return false;
    }
  };

}).call(this);

(function() {
  var LayoutUtils,
    _this = this;

  LayoutUtils = {
    presets: {
      "Web": {
        "layoutFormat": "web-layout",
        "maxWidth": "900px",
        "minWidth": "600px",
        "width": "900px",
        "height": "0px",
        "minHeight": "322px",
        "numCols": "12",
        "numRows": "6",
        "margins": "5",
        "sideMargins": "50",
        "topMargin": "Auto",
        "heightMode": "Presentation",
        "backgroundColor": "#DDD",
        "foregroundColor": "#FFF"
      },
      "Phone": {
        "layoutFormat": "web-layout",
        "maxWidth": "414px",
        "minWidth": "414px",
        "minHeight": "628px",
        "width": "414px",
        "height": "0px",
        "numCols": "10",
        "numRows": "6",
        "margins": "5"
      },
      "Embedded Graphic": {
        "layoutFormat": "embed-layout",
        "width": "400px",
        "height": "300px",
        "numCols": "12",
        "numRows": "9",
        "margins": "5"
      }
    },
    forcePreset: function(settings) {
      var preset, propName, result;
      if (settings.layoutPreset == null) {
        return settings;
      } else {
        preset = this.presets[settings.layoutPreset];
        result = settings;
        for (propName in preset) {
          result[propName] = preset[propName];
        }
        return result;
      }
    },
    validatePreset: function(settings) {
      var preset, propName, result;
      if (settings.layoutPreset == null) {
        settings.layoutPreset = "custom";
      } else {
        preset = this.presets[settings.layoutPreset];
        result = settings;
        for (propName in preset) {
          if (result[propName] !== preset[propName]) {
            settings.layoutPreset = "custom";
          }
        }
      }
      return settings;
    },
    validateLayoutSettings: function(settings, forcePreset) {
      var defaultTimeStamp, propName, result;
      result = {};
      defaultTimeStamp = 0;
      for (propName in settings) {
        if (!settings[propName]) {
          result[propName] = settings[propName];
        } else {
          if (settings[propName].value) {
            settings[propName] = settings[propName].value;
          }
          result[propName] = settings[propName];
        }
      }
      if (!result["foregroundColor"]) {
        result["foregroundColor"] = "#FFFFFF";
      }
      if (!result["width"]) {
        result["width"] = 900;
      }
      if (!result["height"]) {
        result["height"] = 300;
      }
      if (!result["sideMargins"]) {
        result["sideMargins"] = 0;
      }
      if (!result["topMargin"]) {
        result["topMargin"] = "Auto";
      }
      if (forcePreset) {
        result = this.forcePreset(result);
      } else {
        result = this.validatePreset(result);
      }
      this.validateExtremeValues(result);
      return result;
    },
    validateExtremeValues: function(settings) {
      if (this.scrapPx(settings.numCols) > 50) {
        settings.numCols = 50;
      }
      if (this.scrapPx(settings.numCols) < 1) {
        settings.numCols = 1;
      }
      if (this.scrapPx(settings.numRows) > 50) {
        settings.numRows = 50;
      }
      if (this.scrapPx(settings.numRows) < 1) {
        settings.numRows = 1;
      }
      if (this.scrapPx(settings.margins) > 25) {
        settings.margins = 25;
      }
      if (this.scrapPx(settings.margins) < 0) {
        settings.margins = 0;
      }
      if (this.scrapPx(settings.maxWidth) > 1920) {
        settings.maxWidth = 1920;
      }
      if (this.scrapPx(settings.maxWidth) < 100) {
        settings.maxWidth = 100;
      }
      if (this.scrapPx(settings.minWidth) > 1920) {
        settings.minWidth = 1920;
      }
      if (this.scrapPx(settings.minWidth) < 100) {
        settings.minWidth = 100;
      }
      if (this.scrapPx(settings.width) > 1920) {
        settings.width = 1920;
      }
      if (this.scrapPx(settings.width) < 100) {
        settings.width = 100;
      }
      if (this.scrapPx(settings.maxWidth) < this.scrapPx(settings.sideMargins)) {
        return settings.sideMargins = this.scrapPx(settings.maxWidth) / 4;
      }
      /*
      if @scrapPx(settings.height) > 1080
        settings.height = 1080
      if @scrapPx(settings.height) < 100
        settings.height = 100
      */

    },
    constrainLayoutSettings: function(settings) {
      var targetId, widthArray;
      widthArray = [
        {
          "id": "width",
          "object": settings.width
        }, {
          "id": "colWidth",
          "object": settings.colWidth
        }, {
          "id": "numCols",
          "object": settings.numCols
        }, {
          "id": "margins",
          "object": settings.margins
        }
      ];
      widthArray.sort(function(a, b) {
        if (a.object === "") {
          return false;
        }
        if (b.object === "") {
          return true;
        }
      });
      targetId = widthArray[0].id;
      if (targetId === "margins") {
        targetId = widthArray[1].id;
      }
      if (targetId === "numCols") {
        settings.numCols = this.scrapPx(settings.width) / (this.scrapPx(settings.colWidth) + 2 * this.scrapPx(settings.margins));
      } else if (targetId === "colWidth" || targetId === "margins") {
        settings.colWidth = ((this.scrapPx(settings.width) / settings.numCols) - 2 * this.scrapPx(settings.margins)) + "px";
      } else if (targetId === "width") {
        settings.width = settings.numCols * (this.scrapPx(settings.colWidth) + 2 * this.scrapPx(settings.margins));
      }
      return settings;
    },
    scrapPx: function(str) {
      var result;
      result = String(str);
      result = result.replace("px", "").replace("%", "");
      return Number(result);
    },
    sortArrayOfVizForGridster: function(array, pages) {
      array = array.sort(function(a, b) {
        var Acol, Apage, ApageIndex, Arow, Asize_x, Asize_y, Bcol, Bpage, BpageIndex, Brow, Bsize_x, Bsize_y;
        Arow = a.getProperty("row").getValues();
        Acol = a.getProperty("col").getValues();
        Asize_x = a.getProperty("size_x").getValues();
        Asize_y = a.getProperty("size_y").getValues();
        Apage = a.getProperty("page").getValues();
        Brow = b.getProperty("row").getValues();
        Bcol = b.getProperty("col").getValues();
        Bsize_x = b.getProperty("size_x").getValues();
        Bsize_y = b.getProperty("size_y").getValues();
        Bpage = b.getProperty("page").getValues();
        ApageIndex = pages.indexOf(pages.findWhere({
          "id": Apage
        }));
        BpageIndex = pages.indexOf(pages.findWhere({
          "id": Bpage
        }));
        if (ApageIndex === BpageIndex) {
          if (Arow > Brow || Arow === Brow && Acol > Bcol) {
            return 1;
          } else {
            return -1;
          }
        } else {
          if (Apage === "_headerPage") {
            return -1;
          } else if (Bpage === "_headerPage") {
            return 1;
          }
          if (ApageIndex > BpageIndex) {
            return 1;
          } else {
            return -1;
          }
        }
      });
      return array;
    }
  };

  try {
    window.LayoutUtils = LayoutUtils;
  } catch (_error) {
    this.LayoutUtils = LayoutUtils;
  }

}).call(this);

(function() {
  var NetworkUtils;

  NetworkUtils = {
    fillBlocks: function(mainBlock, nodesBlock, relsBlock, format, allBlock) {
      var checkResult, idkey;
      nodesBlock.set("data", []);
      relsBlock.set("data", []);
      if (format === "pairsTable") {
        checkResult = this.checkIfPairsTable(mainBlock);
        this.fillFromPairsTable(mainBlock, nodesBlock, relsBlock);
        idkey = "__Index__";
      } else if (format === "adjMatrix") {
        checkResult = this.checkIfAdjMatrix(mainBlock);
        this.fillFromAdjMatrix(mainBlock, nodesBlock, relsBlock);
        idkey = "-";
      }
      allBlock.get("operator").setExpressionValues({
        "keySelector": {
          value: idkey
        },
        "originalBlock": mainBlock
      });
      allBlock.runOperator();
      nodesBlock.set("fetchState", "ready");
      return relsBlock.set("fetchState", "ready");
    },
    checkIfNetwork: function(mainBlock) {
      var result;
      result = {};
      if (this.checkIfPairsTable(mainBlock).valid) {
        result.pairsTable = true;
      }
      if (this.checkIfAdjMatrix(mainBlock).valid) {
        result.adjMatrix = true;
      }
      if (!result.pairsTable && !result.adjMatrix) {
        result = null;
      }
      return result;
    },
    checkIfPairsTable: function(mainBlock) {
      var col, destinationOK, originOK, valid, _i, _len, _ref;
      valid = false;
      originOK = false;
      destinationOK = false;
      _ref = mainBlock.get("data");
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        col = _ref[_i];
        if (col.id === "Origin" || col.id === "origin") {
          originOK = true;
        }
        if (col.id === "Destination" || col.id === "destination") {
          destinationOK = true;
        }
      }
      if (originOK && destinationOK) {
        valid = true;
      }
      return {
        valid: valid
      };
    },
    fillFromPairsTable: function(mainBlock, nodesBlock, relsBlock) {
      var dest, destId, j, nodesIds, relationId, relsDestinations, relsIds, relsOrigins, relsValues, row, source, sourceId, usedIds, usedRels, weight, _i, _len, _ref;
      nodesIds = new quadrigram.Models.DataBlockData;
      relsIds = new quadrigram.Models.DataBlockData;
      relsValues = new quadrigram.Models.DataBlockData;
      relsOrigins = new quadrigram.Models.DataBlockData;
      relsDestinations = new quadrigram.Models.DataBlockData;
      usedIds = {};
      usedRels = {};
      source = mainBlock.get("data")[0].value;
      dest = mainBlock.get("data")[1].value;
      if (mainBlock.get("data")[2] != null) {
        weight = mainBlock.get("data")[2].value;
      }
      _ref = source.get("data");
      for (j = _i = 0, _len = _ref.length; _i < _len; j = ++_i) {
        row = _ref[j];
        /*
        if j==0
          continue
        */

        sourceId = row.value;
        destId = dest.get("data")[j].value;
        if (!usedIds[sourceId]) {
          usedIds[sourceId] = true;
          nodesIds.get("data").push({
            "id": sourceId,
            "value": sourceId
          });
        }
        if (!usedIds[destId]) {
          usedIds[destId] = true;
          nodesIds.get("data").push({
            "id": destId,
            "value": destId
          });
        }
        relationId = sourceId + "->" + destId;
        if (!usedRels[relationId]) {
          usedRels[relationId] = true;
          relsIds.get("data").push({
            "id": relationId,
            "value": relationId
          });
          relsOrigins.get("data").push({
            "id": relationId,
            "value": sourceId
          });
          relsDestinations.get("data").push({
            "id": relationId,
            "value": destId
          });
        }
        if (weight != null) {
          relsValues.get("data").push({
            "id": relationId,
            "value": weight.get("data")[j].value
          });
        }
      }
      relsIds.metaData = {
        "viewMode": "list",
        "idLabel": "Relation id",
        "valueLabel": "Name"
      };
      relsValues.metaData = {
        "viewMode": "list",
        "idLabel": "Relation id",
        "valueLabel": "Weight"
      };
      relsOrigins.metaData = {
        "viewMode": "list",
        "idLabel": "Relation id",
        "valueLabel": "Origin"
      };
      relsDestinations.metaData = {
        "viewMode": "list",
        "idLabel": "Relation id",
        "valueLabel": "Destination"
      };
      relsBlock.get("data").push({
        "id": "Name",
        "value": relsIds
      });
      if (weight != null) {
        relsBlock.get("data").push({
          "id": "Weight",
          "value": relsValues
        });
      }
      relsBlock.get("data").push({
        "id": "Origin",
        "value": relsOrigins
      });
      relsBlock.get("data").push({
        "id": "Destination",
        "value": relsDestinations
      });
      nodesIds.metaData = {
        "viewMode": "list",
        "idLabel": "Node id"
      };
      return nodesBlock.get("data").push({
        "id": "Name",
        "value": nodesIds
      });
    },
    checkIfAdjMatrix: function(mainBlock) {
      var col, i, matched, _i, _len, _ref;
      if (mainBlock.get("data").length - 1 !== mainBlock.get("data")[0].value.get("data").length) {
        return {
          valid: false,
          reason: "Matrix must be square!"
        };
      }
      matched = true;
      _ref = mainBlock.get("data");
      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
        col = _ref[i];
        if (i !== 0) {
          if (mainBlock.get("data")[i].id !== mainBlock.get("data")[0].value.get("data")[i - 1].value) {
            matched = false;
          }
        }
      }
      if (!matched) {
        return {
          valid: false,
          reason: "Column headers and row headers dont match!"
        };
      }
      return {
        valid: true
      };
    },
    fillFromAdjMatrix: function(mainBlock, nodesBlock, relsBlock) {
      var col, destId, hasNodeWeights, i, j, nodesIds, nodesValues, relId, relsDestinations, relsIds, relsOrigins, relsValues, row, sourceId, _i, _j, _len, _len1, _ref, _ref1;
      nodesIds = new quadrigram.Models.DataBlockData;
      nodesValues = new quadrigram.Models.DataBlockData;
      relsIds = new quadrigram.Models.DataBlockData;
      relsValues = new quadrigram.Models.DataBlockData;
      relsOrigins = new quadrigram.Models.DataBlockData;
      relsDestinations = new quadrigram.Models.DataBlockData;
      _ref = mainBlock.get("data");
      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
        col = _ref[i];
        if (i === 0) {
          continue;
        }
        nodesIds.get("data").push({
          "id": col.value.get("label"),
          "value": col.value.get("label")
        });
        _ref1 = col.value.get("data");
        for (j = _j = 0, _len1 = _ref1.length; _j < _len1; j = ++_j) {
          row = _ref1[j];
          if (j > i - 1) {
            continue;
          } else if (j === i - 1) {
            if (Number(row.value)) {
              hasNodeWeights = true;
            }
            nodesValues.get("data").push({
              "id": sourceId,
              "value": row.value
            });
          } else if (Number(row.value) > 0) {
            sourceId = col.value.get("label");
            destId = mainBlock.get("data")[0].value.get("data")[j].value;
            relId = sourceId + "->" + destId;
            relsIds.get("data").push({
              "id": relId,
              "value": relId
            });
            relsValues.get("data").push({
              "id": relId,
              "value": row.value
            });
            relsOrigins.get("data").push({
              "id": relId,
              "value": sourceId
            });
            relsDestinations.get("data").push({
              "id": relId,
              "value": destId
            });
          }
        }
      }
      relsIds.metaData = {
        "viewMode": "list",
        "idLabel": "Relation name",
        "valueLabel": "Name"
      };
      relsValues.metaData = {
        "viewMode": "list",
        "idLabel": "Relation name",
        "valueLabel": "Weight"
      };
      relsOrigins.metaData = {
        "viewMode": "list",
        "idLabel": "Relation name",
        "valueLabel": "Origin"
      };
      relsDestinations.metaData = {
        "viewMode": "list",
        "idLabel": "Relation name",
        "valueLabel": "Destination"
      };
      relsBlock.get("data").push({
        "id": "Name",
        "value": relsIds
      });
      relsBlock.get("data").push({
        "id": "Weight",
        "value": relsValues
      });
      relsBlock.get("data").push({
        "id": "Origin",
        "value": relsOrigins
      });
      relsBlock.get("data").push({
        "id": "Destination",
        "value": relsDestinations
      });
      nodesIds.metaData = {
        "viewMode": "list",
        "idLabel": "Node id"
      };
      nodesBlock.get("data").push({
        "id": "Name",
        "value": nodesIds,
        "valueLabel": "Name"
      });
      if (hasNodeWeights) {
        return nodesBlock.get("data").push({
          "id": "Weight",
          "value": nodesValues,
          "valueLabel": "Weight"
        });
      }
    }
  };

  try {
    window.NetworkUtils = NetworkUtils;
  } catch (_error) {
    this.NetworkUtils = NetworkUtils;
  }

}).call(this);

(function() {
  'use strict';
  var svgUtils;

  svgUtils = {};

  svgUtils.svgToUrl = function(source) {
    var blobSource, url;
    blobSource = new XMLSerializer().serializeToString(source);
    url = window.URL.createObjectURL(new Blob([blobSource], {
      "type": "text\/xml"
    }));
    return url;
  };

  svgUtils.svgToImageUrl = function(source) {
    var blobSource, url;
    blobSource = new XMLSerializer().serializeToString(source);
    url = window.URL.createObjectURL(new Blob([blobSource], {
      "type": 'image/svg+xml;charset=utf-8'
    }));
    return url;
  };

  svgUtils.getSVGWithStyles = function(element, forceFont) {
    var clone, emptySvg, emptySvgDeclarationComputed, htmlSource;
    emptySvg = window.document.createElementNS("http://www.w3.org/2000/svg", 'svg');
    window.document.body.appendChild(emptySvg);
    emptySvgDeclarationComputed = getComputedStyle(emptySvg);
    clone = $(element.cloneNode(true));
    clone.find(".dont-render").remove();
    htmlSource = clone.attr("version", 1.1).attr("xmlns", "http://www.w3.org/2000/svg")[0];
    $("body").append(htmlSource);
    svgUtils.setInlineStyles(htmlSource, emptySvgDeclarationComputed, forceFont);
    htmlSource.remove();
    emptySvg.remove();
    return htmlSource;
  };

  /*
  explicitlySetStyleRoot:(element,cSSStyleDeclarationComputed)=>
    i = undefined
    len = undefined
    key = undefined
    value = undefined
    computedStyleStr = ''
    i = 0
    len = cSSStyleDeclarationComputed.length
    while i < len
      key = cSSStyleDeclarationComputed[i]
      value = cSSStyleDeclarationComputed.getPropertyValue(key)
      if !element.hasAttribute(key) #key!="width" && key!="height"
        computedStyleStr += key + ':' + value + ';'
  
      i++
    element.setAttribute 'style', computedStyleStr
  */


  
svgUtils.setInlineStyles = function(svg, emptySvgDeclarationComputed,forceFont) {

  function explicitlySetStyle (element) {
    var cSSStyleDeclarationComputed = getComputedStyle(element);
    var i, len, key, value;
    var computedStyleStr = "";
    for (i=0, len=cSSStyleDeclarationComputed.length; i<len; i++) {
      key=cSSStyleDeclarationComputed[i];
      value=cSSStyleDeclarationComputed.getPropertyValue(key);
      if (key=="font-family")
      {
        if (forceFont==true)
        {
        }
        value="Arial"
        
      }
      if (value!==emptySvgDeclarationComputed.getPropertyValue(key) && value != "auto") {
        computedStyleStr+=key+":"+value+";";
      }
    }
    element.setAttribute('style', computedStyleStr);
  }
  function traverse(obj){
    var tree = [];
    tree.push(obj);
    visit(obj);
    function visit(node) {
      if (node && node.hasChildNodes()) {
        var child = node.firstChild;
        while (child) {
          if (child.nodeType === 1 && child.nodeName != 'SCRIPT'){
            tree.push(child);
            visit(child);
          }
          child = child.nextSibling;
        }
      }
    }
    return tree;
  }
  // hardcode computed css styles inside svg
  var allElements = traverse(svg);
  var i = allElements.length;
  while (i--){
    explicitlySetStyle(allElements[i]);
  }
}
;

  window.svgUtils = svgUtils;

}).call(this);

(function() {
  var TimeUtils,
    _this = this;

  TimeUtils = {
    formatDefinitions: {
      dmy: {
        d3formatter: function() {
          return [
            [
              ".%L", function(d) {
                return d.getMilliseconds();
              }
            ], [
              ":%S", function(d) {
                return d.getSeconds();
              }
            ], [
              "%I:%M", function(d) {
                return d.getMinutes();
              }
            ], [
              "%I %p", function(d) {
                return d.getHours();
              }
            ], [
              "%a %d", function(d) {
                return d.getDay() && d.getDate() !== 1;
              }
            ], [
              "%b %d", function(d) {
                return d.getDate() !== 1;
              }
            ], [
              "%B", function(d) {
                return d.getMonth();
              }
            ], [
              "%Y", function() {
                return true;
              }
            ]
          ];
        },
        momentFormatter: ["DD-MM-YYYY", "DD-MM-YYYY hh:mm:ss", "YYYY", "hh:mm:ss", "hh:mm"],
        patterns: [/^(0?[1-9]|[12][0-9]|3[01])[\/\-\. ](0?[1-9]|1[012])[\/\-\. ](?:\d{4}|\d{2})$/, /^(?:(?:([01]\d|2[0-3]):)([0-5]\d))(:[0-5]\d)?$/, /^(0?[1-9]|[12][0-9]|3[01])[\/\-\.](0?[1-9]|1[012])[\/\-\.](?:\d{4}|\d{2})[ \/\-\.](?:(?:([01]\d|2[0-3]):)([0-5]\d))(:[0-5]\d)?$/, /^(19[0-9]\d|20[0-9]\d)$/]
      },
      mdy: {
        d3formatter: function() {
          return [
            [
              ".%L", function(d) {
                return d.getMilliseconds();
              }
            ], [
              ":%S", function(d) {
                return d.getSeconds();
              }
            ], [
              "%I:%M", function(d) {
                return d.getMinutes();
              }
            ], [
              "%I %p", function(d) {
                return d.getHours();
              }
            ], [
              "%a %d", function(d) {
                return d.getDay() && d.getDate() !== 1;
              }
            ], [
              "%b %d", function(d) {
                return d.getDate() !== 1;
              }
            ], [
              "%B", function(d) {
                return d.getMonth();
              }
            ], [
              "%Y", function() {
                return true;
              }
            ]
          ];
        },
        momentFormatter: ["MM-DD-YYYY", "MM-DD-YYYY hh:mm:ss", "YYYY", "hh:mm:ss", "hh:mm"],
        patterns: [/^(0?[1-9]|1[012])[\/\-\. ](0?[1-9]|[12][0-9]|3[01])[\/\-\. ](?:\d{4}|\d{2})$/, /^(?:(?:([01]\d|2[0-3]):)([0-5]\d))(:[0-5]\d)?$/, /^(0?[1-9]|1[012])[\/\-\. ](0?[1-9]|[12][0-9]|3[01])[\/\-\. ](?:\d{4}|\d{2})[ \/\-\.](?:(?:([01]\d|2[0-3]):)([0-5]\d))(:[0-5]\d)?$/, /^(19[0-9]\d|20[0-9]\d)$/]
      },
      iso: {
        d3formatter: function() {
          return [
            [
              ".%L", function(d) {
                return d.getMilliseconds();
              }
            ], [
              ":%S", function(d) {
                return d.getSeconds();
              }
            ], [
              "%I:%M", function(d) {
                return d.getMinutes();
              }
            ], [
              "%I %p", function(d) {
                return d.getHours();
              }
            ], [
              "%a %d", function(d) {
                return d.getDay() && d.getDate() !== 1;
              }
            ], [
              "%b %d", function(d) {
                return d.getDate() !== 1;
              }
            ], [
              "%B", function(d) {
                return d.getMonth();
              }
            ], [
              "%Y", function() {
                return true;
              }
            ]
          ];
        },
        momentFormatter: moment.ISO_8601,
        patterns: [/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):?(\d\d))?$/]
      }
    },
    getTimeFormat: function(identiier) {
      /*
      multiFormat = d3.time.format.multi([
          ["%0d/%0m/%Y", (d) -> return d.getDate() ]
          ["%Y", (d) -> return true ]
        ]);
      */

      var d3format, d3formatter, format, formatDef;
      formatDef = TimeUtils.formatDefinitions.dmy;
      d3formatter = formatDef.d3formatter();
      if (d3formatter.length === 1) {
        d3format = d3.time.format(d3formatter[0]);
      } else {
        d3format = d3.time.format.multi(d3formatter);
      }
      /*
      d3format = d3.time.format.multi([
        [".%L", (d)->  return d.getMilliseconds() ]
        [":%S", (d)->  return d.getSeconds() ]
        ["%I:%M", (d)->  return d.getMinutes() ]
        ["%I %p", (d)->  return d.getHours() ]
        ["%a %d", (d)->  return d.getDay() && d.getDate() != 1 ]
        ["%b %d", (d)->  return d.getDate() != 1 ]
        ["%B", (d)->  return d.getMonth() ]
        ["%Y", ()->  return true ]
      ])
      */

      format = function(date) {
        return d3format(date);
      };
      /*
      format.parse = (str)->
        #MAL!!! EL MOMENT TARDA DEMASIADO
        if TimeUtils.matchDate(str,formatDef.patterns) then return moment(str,formatDef.momentFormatter)._d 
        else return null
      */

      format.parse = function(str) {
        if (format.__cache__[str] == null) {
          if (TimeUtils.matchDate(str, formatDef.patterns)) {
            format.__cache__[str] = moment(str, formatDef.momentFormatter)._d;
          } else {
            format.__cache__[str] = null;
          }
        }
        return format.__cache__[str];
      };
      format.__cache__ = {};
      format.momentFormatter = formatDef.momentFormatter;
      return format;
    },
    matchDate: function(str, patterns) {
      var p, _i, _len;
      for (_i = 0, _len = patterns.length; _i < _len; _i++) {
        p = patterns[_i];
        if (String(str).match(p) != null) {
          return true;
        }
      }
      return false;
    },
    checkIsDate: function(string, currentFormat) {
      var loosePatterns;
      loosePatterns = [/(?:\d{2}|\d{1})[\/\-\. ](?:\d{2}|\d{1})[\/\-\.](?:\d{4}|\d{2})/, /(?:(((Jan(uary)?|Ma(r(ch)?|y)|Jul(y)?|Aug(ust)?|Oct(ober)?|Dec(ember)?)\ 31)|((Jan(uary)?|Ma(r(ch)?|y)|Apr(il)?|Ju((ly?)|(ne?))|Aug(ust)?|Oct(ober)?|(Sept|Nov|Dec)(ember)?)\ (0?[1-9]|([12]\d)|30))|(Feb(ruary)?\ (0?[1-9]|1\d|2[0-8]|(29(?=,\s?))))))/];
      if (currentFormat.parse(string) != null) {
        return "valid";
      } else if (TimeUtils.matchDate(string, loosePatterns)) {
        return "invalid";
      } else {
        return null;
      }
    }
  };

  try {
    window.TimeUtils = TimeUtils;
  } catch (_error) {
    this.TimeUtils = TimeUtils;
  }

}).call(this);

(function() {
  window.quadrigram = new Backbone.App({
    lang: "en",
    environment: "exported",
    version: "1.5",
    start: function(options) {
      var _this = this;
      $(document).unbind('keydown').bind('keydown', function(event) {
        var d, doPrevent;
        doPrevent = false;
        if (event.keyCode === 8) {
          d = event.srcElement || event.target;
          if (d.tagName.toUpperCase() !== 'INPUT' && d.tagName.toUpperCase() !== 'TEXTAREA') {
            event.preventDefault();
          }
        }
      });
      log("STARTING BACKBONE WITH ENV:", this.environment);
      if (this.environment !== "editor" && this.environment !== "exported") {
        this.environment = "editor";
      }
      quadrigram.environment = this.environment;
      quadrigram.version = this.version;
      quadrigram.baseUrl = "http://www.quadrigram.com/";
      quadrigram.googleUrl = quadrigram.baseUrl + "rs/google/";
      quadrigram.userUrl = quadrigram.baseUrl + "rs/user/";
      quadrigram.webUrl = quadrigram.baseUrl;
      quadrigram.webUserUrl = quadrigram.baseUrl + "user/";
      quadrigram.router = new quadrigram.Router;
      quadrigram.tracker = new quadrigram.Tracker;
      quadrigram.milestoneTracker = new quadrigram.MilestoneTracker;
      quadrigram.achievementTracker = new quadrigram.AchievementTracker;
      quadrigram.rootPath = "/editor/";
      if (this.environment === "editor") {
        quadrigram.fonts = quadrigram.baseUrl + "editor/";
      } else {
        quadrigram.fonts = "./";
      }
      moment.locale("en-UK");
      window.onerror = function(message, filename, lineno, colno, error) {
        if (error != null) {
          return quadrigram.tracker.sendEvent({
            event_type: 101,
            event_subtype: 0,
            error_code: message,
            error_data: {
              stack: error.stack
            }
          });
        } else {
          return quadrigram.tracker.sendEvent({
            event_type: 101,
            event_subtype: 0,
            error_code: message,
            error_data: {
              filename: filename,
              lineno: lineno
            }
          });
        }
      };
      /*
      proxiedSync = Backbone.sync
      Backbone.sync = (method, model, options) =>
        options || (options = {});
      
      
        if !options.crossDomain
          options.crossDomain = true;
      
        if !options.xhrFields
          options.xhrFields = {withCredentials:true};
        return proxiedSync(method, model, options);
      */

      
    if (Function.prototype.name === undefined && Object.defineProperty !== undefined) {
      Object.defineProperty(Function.prototype, 'name', {
          get: function() {
              var funcNameRegex = /function\s([^(]{1,})\(/;
              var results = (funcNameRegex).exec((this).toString());
              return (results && results.length > 1) ? results[1].trim() : "";
          },
          set: function(value) {}
      });
    }
    ;
      Backbone.history.start({
        pushState: false,
        root: quadrigram.rootPath
      });
    }
  });

  $(function() {
    $.ajaxSetup({
      url: "ping.php",
      cache: false,
      xhrFields: {
        withCredentials: true
      }
    });
    $.widget("custom.selectmenuWithTooltips", $.ui.selectmenu, {
      _renderItem: function(ul, item) {
        var li;
        li = this._super(ul, item);
        li.attr("data-ui-tip-id", item.element.attr("data-ui-tip-id"));
        return li.addClass("ui-tip-target");
      }
    });
    quadrigram.run($('#content'), {
      forceDebug: true
    });
    return _.deepObjectExtend = function(target, source) {
      var prop;
      if (_.isArray(target) || _.isString(target) || _.isNumber(target)) {
        target = source;
        return;
      }
      for (prop in source) {
        if (target[prop] != null) {
          _.deepObjectExtend(target[prop], source[prop]);
        } else {
          target[prop] = source[prop];
        }
      }
      return target;
    };
  });

  $.fn.convertToDynamicSvg = function($img, callback) {
    var imgClass, imgID, imgURL,
      _this = this;
    imgClass = $img.attr("class");
    imgID = $img.attr("id");
    imgURL = $img.attr("src") || $img.attr("href");
    return jQuery.get(imgURL, (function(data) {
      var $svg;
      $svg = jQuery(data).find('svg');
      if (typeof imgID !== 'undefined') {
        $svg = $svg.attr('id', imgID);
      }
      if (typeof imgClass !== 'undefined') {
        $svg = $svg.attr('class', imgClass + ' replaced-svg');
      }
      $svg = $svg.removeAttr('xmlns:a');
      $img.replaceWith($svg);
      if (callback != null) {
        callback();
      }
    }), 'xml');
  };

  /*
  `
  $.fn.textWidth = function(text, font) {
      if (!$.fn.textWidth.fakeEl) $.fn.textWidth.fakeEl = $('<span>').hide().appendTo(document.body);
      var originalEl = $(text);
      var originalText = ""
      if (originalEl[0].tagName == "INPUT")
      {
        originalText = String(originalEl.val())
      }
      else
      {
        originalText = String(originalEl.html())
      }
      $.fn.textWidth.fakeEl.text(originalText)
      $.fn.textWidth.fakeEl.css('font', font || originalEl.css('font'));
      return $.fn.textWidth.fakeEl.width()+1;
  };
  `
  
  `
  $.fn.textHeight = function(text, font) {
      if (!$.fn.textHeight.fakeEl) $.fn.textHeight.fakeEl = $('<span>').hide().appendTo(document.body);
      var originalEl = $(text);
      var originalText = ""
      if (originalEl[0].tagName == "INPUT")
      {
        originalText = String(originalEl.val())
      }
      else
      {
        originalText = String(originalEl.html())
      }
      $.fn.textHeight.fakeEl.text(originalText)
      $.fn.textHeight.fakeEl.css('font', font || originalEl.css('font'));
      return $.fn.textHeight.fakeEl.height();
  };
  `
  */


  $.fn.textWidth = function(text, font) {
    var originalEl, originalText;
    if (!$.fn.textWidth.fakeEl) {
      $.fn.textWidth.fakeEl = $('<span>').hide().appendTo(document.body);
    }
    originalEl = $(text);
    originalText = '';
    if (originalEl[0].tagName === 'INPUT') {
      originalText = String(originalEl.val());
    } else {
      originalText = String(originalEl.html());
    }
    $.fn.textWidth.fakeEl.text(originalText);
    $.fn.textWidth.fakeEl.css('font', font || originalEl.css('font'));
    return $.fn.textWidth.fakeEl.width() + 1;
  };

  $.fn.textHeight = function(text, font) {
    var originalEl, originalText;
    if (!$.fn.textHeight.fakeEl) {
      $.fn.textHeight.fakeEl = $('<span>').hide().appendTo(document.body);
    }
    originalEl = $(text);
    originalText = '';
    if (originalEl[0].tagName === 'INPUT') {
      originalText = String(originalEl.val());
    } else {
      originalText = String(originalEl.html());
    }
    $.fn.textHeight.fakeEl.text(originalText);
    $.fn.textHeight.fakeEl.css('font', font || originalEl.css('font'));
    return $.fn.textHeight.fakeEl.height();
  };

  $.fn.isInheritedStyle = function(style) {
    var current, inherited;
    current = this.css(style);
    this.css(style, 'inherit');
    inherited = this.css(style);
    if (current === inherited) {
      this.css(style, '');
    } else {
      this.css(style, current);
    }
    return current === inherited;
  };

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Router = (function(_super) {
    __extends(Router, _super);

    function Router() {
      this.compareVersions = __bind(this.compareVersions, this);
      this.startProject = __bind(this.startProject, this);
      this.checkProjectIntegrity = __bind(this.checkProjectIntegrity, this);
      this.actualRenameCurrentProject = __bind(this.actualRenameCurrentProject, this);
      this.actualSaveAsCurrentProject = __bind(this.actualSaveAsCurrentProject, this);
      this.actualSaveCurrentProject = __bind(this.actualSaveCurrentProject, this);
      this.actualShareCurrentProject = __bind(this.actualShareCurrentProject, this);
      this.renameCurrentProject = __bind(this.renameCurrentProject, this);
      this.shareCurrentProject = __bind(this.shareCurrentProject, this);
      this.saveAsCurrentProject = __bind(this.saveAsCurrentProject, this);
      this.saveCurrentProject = __bind(this.saveCurrentProject, this);
      this.optimizeCurrentProjectData = __bind(this.optimizeCurrentProjectData, this);
      this.startNewProject = __bind(this.startNewProject, this);
      this.showLoadingError = __bind(this.showLoadingError, this);
      this.abortedProjectLoad = __bind(this.abortedProjectLoad, this);
      this.loadProject = __bind(this.loadProject, this);
      this.cleanPrevieousProject = __bind(this.cleanPrevieousProject, this);
      this.resizeProjectToScreen = __bind(this.resizeProjectToScreen, this);
      this.resizeProjectToFrame = __bind(this.resizeProjectToFrame, this);
      this.resizeProject = __bind(this.resizeProject, this);
      this.startApp = __bind(this.startApp, this);
      this.composeLayout = __bind(this.composeLayout, this);
      this.before_any = __bind(this.before_any, this);
      this.getDevice = __bind(this.getDevice, this);
      this.setTagManagerScript = __bind(this.setTagManagerScript, this);
      this.setAnalyticsScript = __bind(this.setAnalyticsScript, this);
      this.navigate = __bind(this.navigate, this);
      _ref = Router.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Router.prototype.appViews = {};

    Router.prototype.dataModels = {};

    Router.prototype.managers = {};

    Router.prototype.routes = {
      '?state=:state': 'start',
      'p/:page': 'gotoPage',
      'v/:viz': 'gotoViz',
      '*path': 'start'
    };

    Router.prototype.navigate = function(path, options) {
      if ((this.appViews.projectView != null) && this.appViews.projectView.isInIframe()) {
        options.replace = true;
      }
      return Router.__super__.navigate.call(this, path, options);
    };

    Router.prototype.gotoPage = function(pageId) {
      if (this.appViews.projectView == null) {
        return this.start();
      } else {
        return this.appViews.projectView.layoutManager.gotoPage(pageId);
      }
    };

    Router.prototype.gotoViz = function(vizId) {
      if (this.appViews.projectView == null) {
        return this.start();
      } else {
        return this.appViews.projectView.layoutManager.gotoViz(vizId);
      }
    };

    Router.prototype.start = function(state) {
      var device, openProjectId;
      this.before_any();
      device = this.getDevice();
      openProjectId = null;
      if (quadrigram.environment === "exported") {
        this.setTagManagerScript("GTM-MCWNWB");
        this.setAnalyticsScript("UA-26978704-5");
      }
      if (quadrigram.environment === "editor") {
        this.setTagManagerScript("GTM-WNLWSQ");
        this.setAnalyticsScript("UA-26978704-4");
      }
      if (quadrigram.environment === "editor") {
        if (device === "Tablet" || device === "Mobile") {
          this.appViews.disclaimerDeviceView = new quadrigram.Views.DisclaimerDeviceView({
            el: $('#pre-loader-container'),
            binding: false
          });
          this.appViews.disclaimerDeviceView.render();
          return;
        }
        if (state != null) {
          state = JSON.parse(state);
          if (state.action === "open" && state.ids.length > 0) {
            openProjectId = state.ids[0];
          } else if (state.action === "create") {
            openProjectId = "newProject";
          }
        }
      }
      if (device === "Tablet" || device === "Mobile") {
        this.hammer = new Hammer(document.body);
      }
      return this.startApp(openProjectId);
    };

    Router.prototype.setAnalyticsScript = function(id) {
      var code, e, s;
      s = document.createElement('script');
      s.type = 'text/javascript';
      code = "(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');          ga('create', '" + id + "', 'auto');          ga('send', 'pageview');";
      try {
        s.appendChild(document.createTextNode(code));
        return document.body.insertBefore(s, document.body.firstChild);
      } catch (_error) {
        e = _error;
        s.text = code;
        return document.body.appendChild(s);
      }
    };

    Router.prototype.setTagManagerScript = function(id) {
      d3.select("body").insert("script", ":first-child").text("(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);        })(window,document,'script','dataLayer','" + id + "');");
      return d3.select("body").insert("noscript", ":first-child").text('<iframe src="//www.googletagmanager.com/ns.html?id=' + id + '" height="0" width="0" style="display:none;visibility:hidden"></iframe>');
    };

    Router.prototype.getDevice = function() {
      if (!this.device) {
        if (device.mobile()) {
          this.device = "Mobile";
        }
        if (device.tablet()) {
          this.device = "Tablet";
        }
        if (device.desktop()) {
          this.device = "Desktop";
        }
      }
      return this.device;
      /*
      if !@device
        @device = "Desktop"
        mark = $("#device-detector").css("width")
        switch mark
          when "1px" then @device = "Desktop"
          when "2px" then @device = "Tablet"
          when "3px" then @device = "Mobile"
      return @device
      */

    };

    Router.prototype.before_any = function() {
      this.doOnce || (this.doOnce = _.once(this.composeLayout));
      return this.doOnce();
    };

    Router.prototype.composeLayout = function() {
      return this.performance = new quadrigram.Managers.PerformanceManager;
    };

    Router.prototype.startApp = function(openProjectId) {
      var _this = this;
      this.managers.fontManager = new quadrigram.Managers.FontManager();
      this.managers.serverManager = new quadrigram.Managers.ServerManager();
      this.managers.formatManager = new quadrigram.Managers.FormatManager();
      this.managers.workerManager = new quadrigram.Managers.WorkerManager();
      this.managers.keyboardShortcutsManager = new quadrigram.Managers.KeyboardShortcutsManager();
      this.managers.uiTooltipManager = new quadrigram.Managers.UiTooltipManager($("body"));
      this.appViews.loaderView = new quadrigram.Views.LoaderView({
        el: $('#loader-container'),
        model: new Backbone.Model(),
        binding: false
      });
      this.appViews.loaderView.render();
      if (quadrigram.environment === "editor") {
        this.dataModels.user = new quadrigram.Models.User();
        this.appViews.headerView = new quadrigram.Views.HeaderView({
          el: $('#header-container'),
          model: this.dataModels.user,
          binding: true
        });
        this.appViews.uiView = new quadrigram.Views.UIView({
          model: this.dataModels.currentProject,
          binding: false
        });
        this.dataModels.achievementsModel = new quadrigram.Models.Achievements();
        localStorage.removeItem('optimizedData');
        this.dataModels.user.on("change", function() {
          _this.dataModels.user.off("change");
          if (openProjectId == null) {
            _this.loadProject(_this.dataModels.user.get("lastOpenedProject"));
          } else if (openProjectId === "newProject") {
            _this.startNewProject();
          } else {
            _this.loadProject({
              id: openProjectId
            });
          }
          return _this.dataModels.achievementsModel.fetch();
        });
        this.dataModels.user.fetch();
      } else {
        this.loadProject("local");
        $(".back-container").remove();
        $(".front-container").remove();
        $("#header-container").remove();
      }
      return window.addEventListener("resize", function() {
        return _this.resizeProject();
      });
    };

    Router.prototype.resizeProject = function() {
      if (this.appViews.projectView.isInIframe()) {
        this.resizeProjectToFrame(window.self.innerWidth, window.self.innerHeight);
        this.dataModels.currentProject.get("layout-settings").backgroundColor = this.dataModels.currentProject.get("layout-settings").foregroundColor;
      } else {
        this.resizeProjectToScreen();
      }
      if (this.appViews.projectView.layoutManager != null) {
        this.appViews.projectView.layoutManager.resizeHeader();
        this.appViews.projectView.layoutManager.updatePageButtons();
        return this.appViews.projectView.layoutManager.updateWatermark();
      }
    };

    Router.prototype.resizeProjectToFrame = function(width, height) {
      var ch, cw, marginLeft, marginTop, mw, scale, settingsWidth;
      mw = this.dataModels.currentProject.get("layout-settings").maxWidth;
      mw = Number(String(mw).replace("px", ""));
      settingsWidth = mw;
      if (width >= settingsWidth) {
        scale = 1;
      } else {
        scale = width / settingsWidth;
      }
      this.dataModels.currentProject.viewportScale = scale;
      this.dataModels.currentProject.projectScale = scale;
      cw = $(".pages-collection-container").width();
      ch = $(".pages-collection-container").height();
      marginLeft = -cw * (1 - scale) / 2 + (width - cw * scale) / 2;
      marginTop = 0;
      $(".project-container").addClass("transformed");
      $(".transform-target").css("transform-origin", "0% 0%");
      return $(".transform-target").css("transform", "translate(" + 0 + "px , 0px) scale(" + scale + ")");
    };

    Router.prototype.resizeProjectToScreen = function() {
      var ch, cw, marginLeft, marginTop, minScale, mw, projectWidth, properOuterWidth, scale, settingsWidth, viewport;
      mw = this.dataModels.currentProject.get("layout-settings").maxWidth;
      mw = Number(String(mw).replace("px", ""));
      settingsWidth = mw;
      if (this.getDevice() === "Desktop") {
        properOuterWidth = $(".project-content").width();
      } else {
        if (device.portrait()) {
          properOuterWidth = window.screen.availWidth;
        } else {
          properOuterWidth = window.screen.availHeight;
        }
      }
      projectWidth = settingsWidth;
      if (properOuterWidth >= projectWidth) {
        projectWidth = projectWidth;
        scale = 1;
        minScale = properOuterWidth / projectWidth;
      } else {
        projectWidth = projectWidth;
        scale = properOuterWidth / projectWidth;
        minScale = scale;
      }
      if (this.getDevice() === "Desktop") {
        this.dataModels.currentProject.viewportScale = scale;
        this.dataModels.currentProject.projectScale = scale;
        if (scale < 1) {
          cw = $(".pages-collection-container").width();
          ch = $(".pages-collection-container").height();
          marginLeft = -cw * (1 - scale) / 2 + (properOuterWidth - cw * scale) / 2;
          if (this.dataModels.currentProject.get("layout-settings").topMargin === "Auto") {
            marginTop = -ch * (1 - scale) / 2;
          } else {
            marginTop = 0;
          }
          $(".project-container").addClass("transformed");
          $(".project-content").css("margin-top", "0px");
          $(".transform-target").css("transform-origin", "0% 0%");
          return $(".transform-target").css("transform", "translate(" + 0 + "px , 0px) scale(" + scale + ")");
        } else {
          $(".project-container").removeClass("transformed");
          $(".transform-target").css("transform", "");
          if (this.dataModels.currentProject.get("layout-settings").topMargin === "Auto") {
            marginTop = Math.min(50, (properOuterWidth - projectWidth) / 2);
          } else {
            marginTop = 0;
          }
          return $(".project-content").css("margin-top", marginTop + "px");
        }
      } else {
        this.dataModels.currentProject.viewportScale = scale;
        this.dataModels.currentProject.projectScale = 1;
        $(".project-container").addClass("mobile");
        $("#content").addClass("mobile");
        viewport = document.querySelector("meta[name=viewport]");
        viewport.setAttribute('content', 'initial-scale=' + scale.toFixed(4) + ' minimum-scale=' + minScale.toFixed(4));
        return $(".project-container").css("overflow", "visible");
      }
    };

    Router.prototype.cleanPrevieousProject = function() {
      var _tempSMT;
      quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
        mode: 2,
        "class": "reset"
      });
      if (this.dataModels.currentProject) {
        this.dataModels.currentProject.trigger("killProject");
        _tempSMT = Backbone.Relational.store._subModels;
        Backbone.Relational.store.reset();
        Backbone.Relational.store._subModels = _tempSMT;
      }
      if (this.appViews.projectView) {
        return this.appViews.projectView.remove();
      }
    };

    Router.prototype.loadProject = function(metaData) {
      var _this = this;
      this.performance.trackStep("Start Loading Project", ["project", "load", "qdr"], {});
      this.cleanPrevieousProject();
      quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
        message: 3,
        type: 0,
        priority: 0,
        timeout: 0,
        mode: 0,
        "class": "loadingProject"
      });
      if (metaData === "local") {
        this.dataModels.currentProject = new quadrigram.Models.ProjectModel({
          id: "localProject"
        });
        this.dataModels.currentProject.url = "data/project.qdr";
        return this.dataModels.currentProject.fetch({
          success: function() {
            _this.startProject();
            return _this.resizeProject();
          }
        });
      } else if ((metaData != null) && (metaData.id != null)) {
        if (this.appViews.headerView != null) {
          this.appViews.headerView.showProjectName("");
        }
        this.dataModels.currentProject = new quadrigram.Models.ProjectModel({
          id: metaData.id
        });
        this.dataModels.currentProject.on("abort", this.abortedProjectLoad);
        return this.dataModels.currentProject.fetch({
          success: function() {
            if (quadrigram.router.compareVersions(_this.dataModels.currentProject.get("pversion"), quadrigram.version) > 0) {
              _this.showLoadingError("Sorry, this project was created with a newer version of quadrigram so it can't be loaded. Please open another project or create a new one.");
              return;
            }
            if (_this.dataModels.currentProject.get("id") !== metaData.id) {
              _this.dataModels.currentProject.set("id", metaData.id);
            }
            _this.performance.trackStep("Project Loaded", ["project", "load", "qdr"], {});
            _this.startProject();
            return _this.resizeProject();
          },
          error: function() {
            return _this.showLoadingError("Sorry, there was an error while loading the project from Google Drive. Please open another project or create a new one.");
          }
        });
      } else {
        return this.startNewProject();
      }
    };

    Router.prototype.abortedProjectLoad = function() {
      return quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
        message: 4,
        type: 2,
        priority: 2,
        timeout: 0,
        mode: 0,
        "class": "projectError"
      });
    };

    Router.prototype.showLoadingError = function(message_text, autoCreateProject) {
      return quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
        message: message_text,
        type: 2,
        priority: 2,
        timeout: 0,
        mode: 0,
        "class": "projectError"
      });
    };

    Router.prototype.startNewProject = function() {
      this.cleanPrevieousProject();
      this.dataModels.currentProject = new quadrigram.Models.ProjectModel();
      this.startProject();
      return this.saveCurrentProject();
    };

    Router.prototype.optimizeCurrentProjectData = function() {
      try {
        return localStorage.setItem('optimizedData', JSON.stringify({
          id: this.dataModels.currentProject.get("id"),
          data: this.dataModels.currentProject.getInitialData()
        }));
      } catch (_error) {
        return quadrigram.tracker.sendEvent({
          event_type: 101,
          event_subtype: 3
        });
      }
    };

    Router.prototype.saveCurrentProject = function() {
      var saveAs;
      if (this.dataModels.currentProject.get("id")) {
        return this.actualSaveCurrentProject();
      } else {
        saveAs = new quadrigram.Views.SaveAsDialog({
          type: "save",
          callBack: this.actualSaveCurrentProject
        });
        return saveAs.render();
      }
    };

    Router.prototype.saveAsCurrentProject = function() {
      var saveAs;
      saveAs = new quadrigram.Views.SaveAsDialog({
        type: "saveas",
        callBack: this.actualSaveAsCurrentProject
      });
      return saveAs.render();
    };

    Router.prototype.shareCurrentProject = function() {
      var share;
      share = new quadrigram.Views.ShareDialog({
        type: "share",
        callBack: this.actualShareCurrentProject
      });
      return share.render();
    };

    Router.prototype.renameCurrentProject = function() {
      var saveAs;
      saveAs = new quadrigram.Views.SaveAsDialog({
        type: "rename",
        callBack: this.actualRenameCurrentProject
      });
      return saveAs.render();
    };

    Router.prototype.actualShareCurrentProject = function(options) {
      return quadrigram.router.dataModels.currentProject.requestShare(options.mails);
    };

    Router.prototype.actualSaveCurrentProject = function(options) {
      var realSize;
      if (options && options.newName) {
        quadrigram.router.dataModels.currentProject.set("pname", options.newName);
      }
      realSize = this.appViews.projectView.getRealSize();
      this.dataModels.currentProject.get("layout-settings").width = realSize.width;
      this.dataModels.currentProject.get("layout-settings").height = realSize.height;
      return quadrigram.router.dataModels.currentProject.requestSave();
    };

    Router.prototype.actualSaveAsCurrentProject = function(options) {
      if (options && options.newName) {
        quadrigram.router.dataModels.currentProject.set("pname", options.newName);
      }
      return quadrigram.router.managers.serverManager.saveAsCurrentProject(options.newName);
    };

    Router.prototype.actualRenameCurrentProject = function(options) {
      if (options && options.newName) {
        quadrigram.router.dataModels.currentProject.set("pname", options.newName);
      }
      quadrigram.router.dataModels.currentProject.requestSave();
      return quadrigram.router.managers.serverManager.renameCurrentProject(options.newName);
    };

    Router.prototype.checkProjectIntegrity = function(p) {
      if (p.get("layoutData").length !== p.get("visualizersCollection").models.length) {
        elog("Missing visualizer");
        return false;
      }
      return true;
    };

    Router.prototype.startProject = function() {
      /*
      if !@checkProjectIntegrity(@dataModels.currentProject)
        @showLoadingError("The project file is corrupt. Please open another project or create a new one.")
        return
      */

      this.appViews.projectView = new quadrigram.Views.ProjectView({
        model: this.dataModels.currentProject,
        binding: false
      });
      if (this.appViews.uiView) {
        this.appViews.uiView.model = this.dataModels.currentProject;
        this.appViews.uiView.render();
      } else {
        this.dataModels.currentProject.mode = "preview";
      }
      $(".project-container").append(this.appViews.projectView.$el);
      this.appViews.projectView.render();
      /*
      if !@dataModels.currentProject.hasPendingResources()
        #@appViews.loaderView.trigger("loaderMessage","")
      
        quadrigram.router.appViews.loaderView.trigger("loaderMessage",
          mode: 1
          class: "loadingProject"
        )
      */

      this.dataModels.currentProject.startTracking();
      this.dataModels.currentProject.startAutosave();
      return this.dataModels.currentProject.set("layout-settings", LayoutUtils.validateLayoutSettings(this.dataModels.currentProject.get("layout-settings")), {
        silent: true
      });
    };

    Router.prototype.compareVersions = function(a, b) {
      var a_components, b_components, i, len, _i;
      if (a == null) {
        return -1;
      }
      if (b == null) {
        return 1;
      }
      if (a === b) {
        return 0;
      }
      a_components = a.split(".");
      b_components = b.split(".");
      len = Math.min(a_components.length, b_components.length);
      for (i = _i = 0; 0 <= len ? _i <= len : _i >= len; i = 0 <= len ? ++_i : --_i) {
        if (parseInt(a_components[i]) > parseInt(b_components[i])) {
          return 1;
        }
        if (parseInt(a_components[i]) < parseInt(b_components[i])) {
          return -1;
        }
      }
      if (a_components.length > b_components.length) {
        return 1;
      }
      if (a_components.length < b_components.length) {
        return -1;
      }
      return 0;
    };

    return Router;

  })(Backbone.Router);

}).call(this);

this["JST"] = this["JST"] || {};

this["JST"]["app/scripts/templates/Grid.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class=\"layout-guides\">\n  <div class=\"layout-cols\"></div>\n  <div class=\"layout-rows\"></div>\n</div>\n\n\n\n";
  });

this["JST"]["app/scripts/templates/PageCollection.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class = \"header-page-container transform-target\">\n\n</div>\n\n<div class =\"pages-container transform-target\"></div>\n\n<div class = \"limbo-layer\"></div>\n\n<div class =\"hidden-pages-wrapper\">\n  <div class =\"hidden-pages-container\"></div>\n</div>\n\n";
  });

this["JST"]["app/scripts/templates/Project.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class =\"header-overlay\">\n</div>\n<div class=\"pages-collection-container\">\n</div>\n<div class=\"tooltip-layer\">\n</div>\n\n\n";
  });

this["JST"]["app/scripts/templates/UI/UI.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/UI/achievementUnlocked.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"achievements-unlocked-header\">\n  <div class=\"bell-icon\"></div>\n  <span> Achievement unlocked!</span>\n  <div class=\"right-items\">\n    <!--<div class=\"turn-off-button\"> TURN OFF </div>-->\n    <div class=\"close\"></div> \n  </div>\n</div>\n<div class=\"achievements-unlocked-content\">\n  <div class=\"status-icon\"></div>\n  <div class=\"achievement-message\">\n    Nice! You ";
  if (stack1 = helpers.actionLabel) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.actionLabel; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + ". \n  </div>\n  <div class=\"more-button\"> LEARN MORE </div>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/achievementsView.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class=\"achievements-panel\">\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/blockInspector.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "", stack1, stack2;
  buffer += "\n          <li class=\"operator-selector-item button-"
    + escapeExpression(((stack1 = ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " ui-tip-target\" data-ui-tip-id =\"operator-"
    + escapeExpression(((stack1 = ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" value=\""
    + escapeExpression(((stack1 = ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">";
  if (stack2 = helpers.label) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.label; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</li>\n          ";
  return buffer;
  }

  buffer += "<div class=\"block-inspector-content ui-front\">\n\n    <div class=\"block-selector block-inspector-item\">\n\n      <div class=\"selected-block-container slot-body\"></div>\n    </div>\n\n    <div class=\"equal-char-block-container block-inspector-item\">\n      <div class=\"equal-icon\"></div>\n    </div>\n\n    <div class=\"operator-selector-container block-inspector-item\">\n      <div class=\"dropdown operator-selector\">\n        <div id=\"operator-selector-button-1\" class=\"operator-selector-button\" data-toggle=\"dropdown\">\n          <span class=\"caret\"></span>\n        </div>\n        <ul class=\"dropdown-menu main-selector\" name=\"format-selector\" role=\"menu\" aria-labelledby=\"operator-selector-button-1\">\n          ";
  stack1 = helpers.each.call(depth0, depth0.functionsLibrary, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n        </ul>\n      </div>\n    </div>\n\n    <div class=\"mega-slot-container block-inspector-item\">\n    </div>\n    <div class=\"clear\"></div>\n </div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dataFactory.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"data-manager-content\">\n\n\n    <div class=\"col one\">\n      <div class=\"btn-group data-container-menu\">\n        <div type=\"button\" menu=\"file\" class=\"btn btn-default data-container-menu-item files\">\n          <div class=\"menu-item-icon\">\n            Files\n          </div>\n        </div>\n        <!-- deprecated! <button type=\"button\" menu=\"custom\" class=\"btn btn-default data-container-menu-item\">Blocks</button> -->\n        <div type=\"button\" menu=\"urls\" class=\"btn btn-default data-container-menu-item disabled urls\">\n          <div class=\"menu-item-icon\">\n            URLs\n          </div>\n        </div>\n        <div type=\"button\" menu=\"custom\" class=\"btn btn-default data-container-menu-item formulas\">\n          <div class=\"menu-item-icon\">\n              Formulas\n          </div>\n        </div>\n        <div type=\"button\" menu=\"charts\" class=\"btn btn-default data-container-menu-item outputs\">\n          <div class=\"menu-item-icon\">\n            Outputs\n          </div>\n        </div>\n      </div>\n      \n      \n      <div class=\"block-group-list-container\"></div>\n\n    </div>\n    \n    <div class=\"col two\">\n     \n      <div class=\"block-group-container\"></div>\n    </div>\n    <!--<div class=\"col three\"></div>-->\n\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/BlockPreview.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog\">\n  <div class=\"preview-container\"></div>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/dataTableOptionsTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"builder-options-inline text\">Use the column</div>  \n<div class=\"id-selector-container builder-options-inline selector\" ></div> \n<div class=\"builder-options-inline text\">as item identifiers (rows names).</div>  ";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/dataTypeOptionsTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class=\"data-type-selector-container builder-options-item\">\n\n  <div class=\"is-network-checkbox-container hidden\">\n    <input class=\"checkbox-input\" type=\"checkbox\"> </input>\n    <div class=\"builder-options-inline text\"> Interpret the data as a Network (detected <b class=\"detected-format\"></b> format) </div>\n    <a class=\"learn-more-link\">Click here to learn more</a>\n  </div>\n</div> \n\n<div class=\"specific-options-container builder-options-item hidden\">\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/dynamicCheckboxTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<input class=\"dyanimc-checkbox\" type=\"checkbox\">\n<span>By checking this box we will link this document as a dynamic Google Sheet in the project.</span>\n\n\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/fileTypeOptions.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class = \"tabs-container\">\n  <ul class=\"tabs-list\">\n\n  </ul>  \n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/multiTablePreviewTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"super-table-content\">\n  \n<div class = \"list-selector\">\n  <ul>\n\n  </ul>\n</div>\n\n<div class = \"table-container\">\n  <table class=\"table\">\n  </table>\n</div>\n  \n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/networkOptionsTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"builder-options-inline text\">Network is formated as </div>  \n<div class=\"format-selector-container builder-options-inline selector\">\n  <select class=\"format-selector\">\n    <!--\n    <option value=\"pairsTable\">Pairs table</option>\n    <option value=\"adjMatrix\">Adjacency matrix</option>\n    -->\n  </select>\n</div> ";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/noDataTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"no-data-table\">\n  <div class=\"no-data-yet-label\">\n    NO DATA\n  </div>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/noDataYetTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"no-data-yet-table\">\n  <div class=\"no-data-yet-label\">\n    Calculating...\n  </div>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/processingTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"processing-table\">\n  <div class=\"processing-message\">\n    Processing data...\n  </div>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/singleValuePreviewTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class = \"value-container\">\n\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/singleValueTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"single-value-table\">\n  "
    + escapeExpression(((stack1 = depth0.value),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\n  <div class=\"one-value-warning\">\n    This cell has a single value (with id: "
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ")\n  </div>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/tableContentTemplate - Copy.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, functionType="function", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;

function program1(depth0,data) {
  
  var buffer = "", stack1, stack2, options;
  buffer += "\n        ";
  options = {hash:{},inverse:self.program(4, program4, data),fn:self.program(2, program2, data),data:data};
  stack2 = ((stack1 = helpers.ifEq || depth0.ifEq),stack1 ? stack1.call(depth0, ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.index), 0, options) : helperMissing.call(depth0, "ifEq", ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.index), 0, options));
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n      \n      ";
  return buffer;
  }
function program2(depth0,data) {
  
  var buffer = "";
  buffer += "\n          <div class=\"table-viewer-content-header-cell table-viewer-content-header-id-cell table-viewer-cell\" data-id=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "\"> "
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + " </div>\n        ";
  return buffer;
  }

function program4(depth0,data) {
  
  var buffer = "";
  buffer += "\n          <div class=\"table-viewer-content-header-cell table-viewer-cell\" data-id=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "\"> "
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + " </div>\n        ";
  return buffer;
  }

function program6(depth0,data,depth1) {
  
  var buffer = "", stack1, stack2, options;
  buffer += "\n      <div class=\"table-viewer-content-row table-viewer-row\">\n\n        ";
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.setIndex || depth0.setIndex),stack1 ? stack1.call(depth0, ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.index), options) : helperMissing.call(depth0, "setIndex", ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.index), options)))
    + "\n        ";
  stack2 = helpers.each.call(depth0, depth0, {hash:{},inverse:self.noop,fn:self.programWithDepth(7, program7, data, depth0, depth1),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n      </div>\n    ";
  return buffer;
  }
function program7(depth0,data,depth1,depth2) {
  
  var buffer = "", stack1, stack2, options;
  buffer += "\n          ";
  options = {hash:{},inverse:self.programWithDepth(10, program10, data, depth1, depth2),fn:self.program(8, program8, data),data:data};
  stack2 = ((stack1 = helpers.ifEq || depth0.ifEq),stack1 ? stack1.call(depth0, ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.index), 0, options) : helperMissing.call(depth0, "ifEq", ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.index), 0, options));
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n        ";
  return buffer;
  }
function program8(depth0,data) {
  
  var buffer = "";
  buffer += "\n            <div class=\"table-viewer-content-row-id-cell table-viewer-cell\" data-id=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "\"> "
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + " </div>\n          ";
  return buffer;
  }

function program10(depth0,data,depth2,depth3) {
  
  var buffer = "", stack1, stack2, options;
  buffer += "\n            <div class=\"table-viewer-content-cell table-viewer-cell\">";
  options = {hash:{},data:data};
  stack2 = ((stack1 = helpers.getFromTable || depth3.getFromTable),stack1 ? stack1.call(depth0, ((stack1 = depth3.tableData),stack1 == null || stack1 === false ? stack1 : stack1.contentData), depth2.index, ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.index), options) : helperMissing.call(depth0, "getFromTable", ((stack1 = depth3.tableData),stack1 == null || stack1 === false ? stack1 : stack1.contentData), depth2.index, ((stack1 = data),stack1 == null || stack1 === false ? stack1 : stack1.index), options));
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "</div>\n          ";
  return buffer;
  }

  buffer += "\n<div class=\"table-viewer-content\">\n  \n    <div class=\"table-viewer-content-header table-viewer-row\">\n      \n      ";
  stack2 = helpers.each.call(depth0, ((stack1 = depth0.tableData),stack1 == null || stack1 === false ? stack1 : stack1.headerData), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n      \n    </div>\n \n    <div class=\"table-viewer-content-header-dropdowns table-viewer-row\">\n    </div>\n    ";
  stack2 = helpers.each.call(depth0, ((stack1 = depth0.tableData),stack1 == null || stack1 === false ? stack1 : stack1.contentData), {hash:{},inverse:self.noop,fn:self.programWithDepth(6, program6, data, depth0),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n</div>\n\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/tablePreviewTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<table class = \"table-viewer\">\n\n</table>\n\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/tableView.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, self=this;

function program1(depth0,data) {
  
  
  return "\n  \n  <div class=\"all-options-container\">\n    \n    \n    <div class=\"data-type-options-container builder-options-container\">\n     \n    </div>\n  </div>\n \n  \n  <div class=\"warning-container hidden\"></div>\n";
  }

  buffer += "<div class=\"toggler-container\">\n  \n</div>\n";
  stack1 = helpers['if'].call(depth0, depth0.isBuilder, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n<div  class=\"hot-container\">\n\n</div>\n<div class=\"file-type-options-container\">\n\n</div>\n<div class=\"checkbox-container\">\n  \n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/viewModeTogglerTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"view-mode-toggle ui-tip-target\" data-ui-tip-id=\"view-mode-toggle\">\n  <div class=\"dropdown view-mode-selector\">\n    <div class=\"view-mode-selector-button\" data-toggle=\"dropdown\">\n      <div class=\"selected-instance table-icon\" value=\"table\"></div>\n    </div>\n    <ul class=\"dropdown-menu\" name=\"format-selector\" role=\"menu\">\n      <li class=\"view-mode-item \" value=\"col\"> \n        <div class = \"dropdown-icon col-icon\"> </div> \n        <span> Column </span> \n      </li>\n      <li class=\"view-mode-item \" value=\"row\"> \n        <div class = \"dropdown-icon row-icon\"> </div> \n        <span> Row </span> \n      </li>\n      <li class=\"view-mode-item \" value=\"table\"> \n        <div class = \"dropdown-icon table-icon\"> </div> \n        <span> Table </span> \n      </li>\n      \n\n    </ul>\n  </div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/warningAggregateTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"warning-content yellow-warning\">\n  <div class=\"warning-message\">\n    The column selected as item's identifier (";
  if (stack1 = helpers.idKey) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.idKey; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + ") has repeated elements. All the other columns must be aggregated.\n  </div>\n  <div class=\"dismiss-btn\">I know, its ok!</div>\n\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/warningBadDataTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"warning-content yellow-warning\">\n  <div class=\"warning-message\">\n    Maybe your data is not propertly formated: <b> "
    + escapeExpression(((stack1 = depth0.reason),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " </b>\n  </div>\n  <div class=\"dismiss-btn\">I kow, its ok!</div>\n  <a class=\"learn-more-link\">Click here to learn more</a>\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/warningIndexesTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"warning-content yellow-warning\">\n  <div class=\"warning-message\">\n    The first column (";
  if (stack1 = helpers.firstKey) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.firstKey; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + ") had repetitions so we added an extra column with unique identifiers (Indexes). You can change that with the dropdwon above.\n  </div>\n  <div class=\"dismiss-btn\">I know, its ok!</div>\n  <!--<a class=\"learn-more-link\">Click here to learn more</a> -->\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/BlockPreview/warningInvalidDataTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"warning-content red-warning\">\n  <div class=\"warning-message\">\n    Sorry, we were unable to propertly parse your file...\n  </div>\n  <a class=\"learn-more-link\">Click here to learn more</a>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/blockBuilder.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog\">\n  <div class=\"table-container\"></div>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/dropzonePreviewTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class=\"dz-preview dz-file-preview\">\n  <div class=\"dz-details\">\n    <div class=\"dz-filename\"><span data-dz-name></span></div>\n    <div class=\"dz-size\" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class=\"dz-progress\"><span class=\"dz-upload\" data-dz-uploadprogress></span></div>\n  \n  <div class=\"dz-success-mark\"><span></span></div>\n  <div class=\"dz-error-mark\"><span></span></div>\n  <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n  \n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/exportOptions.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog export-options-dialog\">\n \n    <div class=\"export-description\">\n      Choose an option to publish your project\n    </div>\n    <div class=\"export-options-container\">\n      <a class=\"export-a\" data-type=\"web\" target=\"_blank\">\n        <div class=\"export-option web-option\" data-type=\"web\">\n          <div class=\"option-icon web-option\"></div>\n          <div class=\"option-title\"> Publish as a Web</div>\n          <div class=\"option-description\">\n            The web will be hosted at quadrigram.com and you can share the link with your audience\n          </div>\n          \n        </div>\n      </a>\n      <a class=\"export-a\" data-type=\"embed\" target=\"_blank\">\n        <div class=\"export-option embed-option\" data-type=\"embed\">\n          <div class=\"option-icon embed-option\"></div>\n          <div class=\"option-title\"> Publish for Embedding</div>\n          <div class=\"option-description\">\n            You will get an embed code that you can paste into any html editor\n          </div>\n          \n        </div>\n      </a>\n      <a class=\"export-a\" data-type=\"zip\" target=\"_blank\">\n        <div class=\"export-option zip-option\" data-type=\"zip\">\n          <div class=\"option-icon zip-option\"></div>\n          <div class=\"option-title\"> Download source code</div>\n          <div class=\"option-description\">\n            Download a zip file containing the source code of your project.\n          </div>\n          \n        </div>\n      </a>\n    </div>\n\n</div>\n\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/exportResourceCollection.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/exportResourceItem.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<span class=\"icon\"></span>\n<div class=\"block-group\" groupId=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n  <a class=\"block-group-label\"> "
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.label)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " </a>\n</div>\n<div class=\"checkbox\">\n  <label>\n    <!--<input type=\"checkbox\" class=\"include-checkbox\"> Make a copy of this file to the build folder </input>-->\n    <span class=\"export-file-message field-label\">this file will be downloaded onto the build project, within the app/data folder</span>\n  </label>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/filePicker.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"dialog\">\n\n  <ul class=\"source-selector\">\n    <li class=\"source source-q\">Quadrigram</li>\n    <li class=\"source source-google\"> Google drive </li>\n     <a href=\"";
  if (stack1 = helpers.folderUrl) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.folderUrl; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "\" target=\"_blank\" class=\"google-drive-link\">Go to my drive</a>\n  </ul>\n  <div class=\"file-list list-container\">\n    <div class=\"file-list-search\">\n      <input type=\"text\" class=\"file-list-search-input disabled\" placeholder=\" Search a file\">\n    </div>\n    <div class=\"file-list-header\">\n        <ul>\n          <li class=\"file-list-header-item\">Name</li>\n          <li class=\"file-list-header-item\">Created</li>\n          <li class=\"file-list-header-item\">Modified</li>\n        </ul>\n    </div>\n  </div>\n  <div class=\"clear\"></div>\n  <div class=\"dropzone file-upload ui-tip-target\" data-ui-tip-id=\"dropzone\">\n    <div class=\"pb-container\">\n      <div class=\"error-container hidden\"></div>\n      <div class=\"fake-progress-container hidden\">\n        <div class=\"fake-progress\"></div>\n\n        <!-- <div class=\"loading-icon q-loading\"><span>Loading</span></div> -->\n        <div class=\"loading-icon\">\n          <img  src=\"images/loader.gif\"></img>\n          <span> Loading </span>\n        </div>\n      </div>\n    </div>\n  </div>\n\n\n\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/helpAskusPopup.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog askus-dialog\">\n  <div class=\"instructions\">Write a question and we will email you back!</div>\n  <div class=\"text-area-container\">\n    <textarea class=\"mail-content\"></textarea>\n  </div>\n  <div class=\"feedback-button\"> Give us your feedback!</div>\n</div>\n\n\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/layoutSettingsTab.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class=\"layout-settings tab-settings\">\n  <div class=\"prop\">\n    <p class=\"property-title collapsable-toggle \">Size</p>\n    <div class=\"propertyBody\">\n\n      <div class=\"layout-properties\" data-id=\"web-layout\">\n        <div class=\"property-group\">\n          <p> Width </p>\n          <input data-id = \"maxWidth\" class=\"settings-input project-width-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p> Lateral Margin </p>\n          <input data-id = \"sideMargins\" class=\"settings-input project-width-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        \n        <div class=\"property-group\">\n          <p> Height Mode </p>\n          <input data-id = \"heightMode\" class=\"settings-input project-width-input\" qm-input-type=\"input-with-options\" qm-option-options = \"Presentation|Dynamic|Fixed\" qm-option-default-value=\"normal\" qm-option-no-write=\"true\"></input>\n          <div class=\"Presentation\"></div>\n        </div>\n\n        <div class=\"property-group height-prop\">\n          <p> Height </p>\n          <input data-id = \"height\" class=\"settings-input project-width-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n\n        <div class=\"property-group\">\n          <p> Top Margin </p>\n          <input data-id = \"topMargin\" class=\"settings-input project-width-input\" qm-input-type=\"input-with-options\" qm-option-options = \"Auto|None\" qm-option-default-value=\"normal\" qm-option-no-write=\"true\"></input>\n          <div class=\"Auto\"></div>\n        </div>\n        \n\n        <div class=\"property-group\">\n        </div>\n        \n\n        <div class=\"property-group\">\n          <p> Number of columns </p>\n          <input data-id = \"numCols\" class=\"settings-input project-cols-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d*[\\.,]?\\d*)\"></input>\n          <div class=\"clear\"></div>\n        </div>\n\n        \n\n        <div class=\"property-group\">\n          <p> Grid Margins </p>\n          <input data-id = \"margins\" class=\"settings-input grid-margin-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(%)?\" qm-option-format-defaults=\"|%\"></input>\n          <div class=\"clear\"></div>\n        </div>\n\n      </div>\n\n\n      <div class=\"layout-properties\" data-id=\"full-screen-layout\">\n        <div class=\"property-group\">\n          <p> Number of columns </p>\n          <input data-id = \"numCols\" class=\"settings-input project-cols-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d*[\\.,]?\\d*)\"></input>\n          <div class=\"clear\"></div>\n        </div>\n\n        <div class=\"property-group\">\n          <p> Number of rows</p>\n          <input data-id = \"numRows\" class=\"settings-input project-rows-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d*[\\.,]?\\d*)\"></input>\n          <div class=\"clear\"></div>\n        </div>\n\n        <div class=\"property-group\">\n          <p> Margins </p>\n          <input data-id = \"margins\" class=\"settings-input grid-margin-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(%)?\" qm-option-format-defaults=\"|%\"></input>\n          <div class=\"clear\"></div>\n        </div>\n      </div>\n\n      <div class=\"layout-properties\" data-id=\"embed-layout\">\n        <div class=\"property-group\">\n          <p> Space width </p>\n          <input data-id = \"width\" class=\"settings-input project-width-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p> Space Height </p>\n          <input data-id = \"height\" class=\"settings-input project-height-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p> Number of columns </p>\n          <input data-id = \"numCols\" class=\"settings-input project-cols-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d*[\\.,]?\\d*)\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p> Number of rows</p>\n          <input data-id = \"numRows\" class=\"settings-input project-rows-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d*[\\.,]?\\d*)\"></input>\n          <div class=\"clear\"></div>\n        </div>\n\n        <div class=\"property-group last\">\n          <p> Margins </p>\n          <input data-id = \"margins\" class=\"settings-input grid-margin-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(%)?\" qm-option-format-defaults=\"|%\"></input>\n          <div class=\"clear\"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"prop\">\n  <div class=\"property layout-color\">\n    <p class=\"property-title collapsable-toggle \">Color</p>\n    <div class=\"propertyBody\">\n      <div class=\"property-group\">\n        <p> Canvas Color </p>\n        <input data-id = \"foregroundColor\" class=\"fg-color\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#000000\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n        <div class=\"clear\"></div>\n      </div>\n      <div class=\"property-group last\" >\n        <p> Background Color </p>\n        <input data-id = \"backgroundColor\" class=\"bkg-color\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n        <div class=\"clear\"></div>\n      </div>\n      \n      <div class=\"clear\"></div>\n    </div>\n  </div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/pagesSettingsTab.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"page-settings tab-settings\">\n  <div class=\"prop\">\n    <p class=\"property-title collapsable-toggle \">Pages</p>\n    \n    <div class=\"propertyBody\">\n\n      <div class=\"clear\"></div>\n      <div class=\"property-group selector\">\n        <p> Type of transition </p>\n        <!--\n        <select class=\"transition-selector\" data-id = \"transitionType\">\n          <option data-id=\"slide\"> Slide </option>\n          <option data-id=\"reload\"> Reload </option>\n        </select>\n        -->\n        <input class=\"transition-selector\"  data-id = \"transitionType\" qm-input-type=\"input-with-options\" qm-option-options = \"slide|reload\" qm-option-auto-open-contextual=\"true\" qm-option-no-write=\"true\"></input>\n\n      </div>\n      <div class=\"property-group\">\n        <p> Show Arrow Buttons </p>\n        <input class=\"buttons-checkbox\" name=\"showbuttons\" data-id = \"showPageButtons\" qm-input-type=\"boolean-input\"></input>\n        \n\n      </div>\n      <div class=\"clear\"></div>\n    </div>\n  </div>\n\n\n  <div class=\"prop\">\n    <p class=\"property-title collapsable-toggle \">Header</p>\n    <div class=\"clear\"></div>\n    <div class=\"property-group ui-tip-target\" data-ui-tip-id=\"toggle-header\">\n      <p> Use static header</p>\n      <input class=\"header-checkbox\" name=\"useheader\" data-id = \"useHeader\" qm-input-type=\"boolean-input\"></input>\n    </div>  \n    <div class=\"clear\"></div>\n    <div class=\"header-properties\">\n      <div class=\"propertyBody\">\n        <div class=\"property-group last\">\n          <p> Canvas Color </p>\n          <input data-id = \"foregroundColor\" class=\"fg-color\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#000000\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"clear\"></div>\n      </div>\n\n\n      <!-- \n      <div class=\"pages-wrapper\">\n        <div class=\"pages-scroll\">\n          <ul class=\"header-ul pages-collection-container\">\n          </ul>\n        </div>\n      </div>\n      -->\n    </div>\n  </div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/projectsPicker.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog project-picker\">\n  <div class=\"file-list-search\">\n    <input type=\"text\" class=\"file-list-search-input disabled\" placeholder=\" Search a project\">\n  </div>\n  <div class=\"projects-header\">\n    <ul>\n      <li class=\"header-item\">Name</li>\n      <li class=\"header-item\">Created</li>\n      <li class=\"header-item\">Modified</li>\n    </ul>\n  </div>\n  <div class=\"list-container projects-list\"></div>\n  <!--<div class=\"new-btn-container\">\n    <button type = \"button\" class=\"new-btn ok-button\"> Create new project </button>\n  </div>-->\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/saveAsDialog.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog\">\n	<div class=\"save-as\">\n    <span> Name: </span>\n		<input class=\"pname-input\"> </input>\n	</div>\n</div>\n\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/settingsDialog.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog\">\n\n  <!-- Estas classes estan male, xk no son layout-menu ni layout-btn sino, settings-menu y settings-btn!!!! -->\n  <ul class=\"layout-menu\">\n    <li class=\"layout-btn settings-tab-btn current-tab\" data-id=\"layout\">Layout</li>\n    <li class=\"layout-btn settings-tab-btn\" data-id=\"pages\">Pages</li>\n    <li class=\"layout-btn settings-tab-btn\" data-id=\"tooltip\">Tooltip</li>\n    \n  </ul>\n  <div class=\"clear\"></div>\n\n  <div class=\"settings-container\"></div>\n\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/settingsTabs/styleSettings.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"style-settings tab-settings\">\n  Style\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/settingsTabs/tooltipSettings.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "";
  buffer += "\n          <option data-id=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "\"> "
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + " </option>\n        ";
  return buffer;
  }

function program3(depth0,data) {
  
  var buffer = "";
  buffer += "\n          <option data-id=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "\" style=\"font-family:"
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "\"> "
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + " </option>\n        ";
  return buffer;
  }

function program5(depth0,data) {
  
  var buffer = "";
  buffer += escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "|";
  return buffer;
  }

  buffer += "<div class=\"tooltip-settings tab-settings\">\n  <p class=\"property-title\">General</p>\n  <div class=\"tooltip-box\"><div class=\"tooltip-box-target\"></div></div>\n  <div class=\"general-tooltip-properties layout-properties\">\n    <div class=\"property-group selector base-style-selector-container selector-container half-selector-container ui-front\">\n      <p>Base style</p>\n      <select class=\"base-style-selector preset-selector half-preset-selector\">\n        ";
  stack1 = helpers.each.call(depth0, depth0.styles, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n      </select>\n    </div>\n    <div class=\"property-group font-selector-container selector-container ui-front\">\n      <p>Font family</p>\n      <!--<select class=\"font-selector preset-selector half-preset-selector\">\n        ";
  stack1 = helpers.each.call(depth0, depth0.fonts, {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n      </select>-->      \n        <input title=\"Font\" class=\"ql-font font-selector preset-selector half-preset-selector\" qm-input-type=\"input-with-options\" qm-option-options = \"";
  stack1 = helpers.each.call(depth0, depth0.fonts, {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "default\" qm-option-auto-open-contextual=\"true\" qm-option-force-value-to-option=\"true\" qm-option-default-value=\"Roboto\"></input>      \n    </div>\n    <div class=\"clear\"></div>\n    \n    <div class=\"property-group\">\n      <p>Border Color</p>\n      <input data-id = \"borderColor\" class=\"border-color-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n    </div>\n    <div class=\"property-group border-line-property selector-container ui-front\">\n      <p>Border width</p>\n      <input data-id = \"borderWidth\" class=\"settings-input border-width-value\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n    </div>\n    \n    \n    \n    <div class=\"property-group rounded-corner-property selector-container ui-front\">\n      <p>Rounded Corners</p>\n      <input data-id = \"roundedCorner\" class=\"settings-input font-size-value\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n    </div>\n    <div class=\"property-group\">\n      <p>Separator Color</p>\n      <input data-id = \"separatorColor\" class=\"separator-color-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n    </div>\n\n  </div>\n\n  <div class=\"prop\">\n    <p class=\"property-title collapsable-toggle \">Title</p>\n    <div class=\"propertyBody\">\n      <div class=\"layout-properties\" data-id=\"web-layout\">\n        <div class=\"property-group\">\n          <p>Text Color</p>\n          <input data-id = \"textColorTitle\" class=\"text-color-title-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p>Background Color</p>\n          <input data-id = \"backgroundColorTitle\" class=\"bkg-color-title-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n        </div>\n        <div class=\"property-group\">\n          <p>Font Size</p>\n          <input data-id = \"fontSizeTitle\" class=\"settings-input font-size-title-value\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group font-style-title-container selector-container ui-front\">\n          <p>Font Style</p>\n          <!--<select preset-id=\"fontWeightTitle\" class=\"font-weight-title-selector font-weight-selector preset-selector half-preset-selector\">            \n              <option data-id=\"light\"> light </option>\n              <option data-id=\"normal\"> normal </option>\n              <option data-id=\"bold\"> bold </option>              \n          </select>-->\n          <input title=\"Font style\" data-id = \"fontStyleTitle\"  class=\"ql-fontstyle font-style-title-selector font-weight-selector preset-selector half-preset-selector\" qm-input-type=\"input-with-options\" qm-option-options = \"Thin|Semi-Light|Light|Regular|Medium|Semi-Bold|Bold|Extra-Bold|Black|Thin-Italic|Semi-Light-Italic|Light-Italic|Italic|Medium-Italic|Semi-Bold-Italic|Bold-Italic|Extra-Bold-Italic|Black-Italic|default\" qm-option-auto-open-contextual=\"true\" qm-option-force-value-to-option=\"true\" qm-option-default-value=\"Regular\"></input>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"prop\">\n  <div class=\"property layout-color\">\n    <p class=\"property-title collapsable-toggle \">Value</p>\n    <div class=\"propertyBody\">\n        <div class=\"property-group\">\n          <p>Text Color</p>\n          <input data-id = \"textColorValue\" class=\"text-color-title-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p>Background Color</p>\n          <input data-id = \"backgroundColorValue\" class=\"bkg-color-title-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n        </div>\n        <div class=\"property-group\">\n          <p>Font Size</p>\n          <input data-id = \"fontSizeValue\" class=\"settings-input font-size-title-value\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group font-weight-value-container selector-container ui-front\">\n          <p>Font Style</p>\n          <!--<select preset-id=\"fontWeightValue\" class=\"font-weight-value-selector font-weight-selector preset-selector half-preset-selector\">                        \n              <option data-id=\"light\"> light </option>\n              <option data-id=\"normal\"> normal </option>\n              <option data-id=\"bold\"> bold </option>\n          </select>-->\n          <input title=\"Font style\" data-id = \"fontStyleValue\" class=\"ql-fontstyle font-style-value-selector font-style-selector preset-selector half-preset-selector\" qm-input-type=\"input-with-options\" qm-option-options = \"Thin|Semi-Light|Light|Regular|Medium|Semi-Bold|Bold|Extra-Bold|Black|Thin-Italic|Semi-Light-Italic|Light-Italic|Italic|Medium-Italic|Semi-Bold-Italic|Bold-Italic|Extra-Bold-Italic|Black-Italic|default\" qm-option-auto-open-contextual=\"true\" qm-option-force-value-to-option=\"true\" qm-option-default-value=\"Regular\"></input>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"prop\">\n  <div class=\"property layout-color\">\n    <p class=\"property-title collapsable-toggle \">Label</p>\n    <div class=\"propertyBody\">\n        <div class=\"property-group\">\n          <p>Text Color</p>\n          <input data-id = \"textColorLabel\" class=\"text-color-title-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p>Font Size</p>\n          <input data-id = \"fontSizeLabel\" data-id = \"fontStyleLabel\" class=\"settings-input font-size-value\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group font-style-label-container selector-container ui-front\">\n          <p>Font Style</p>\n          <!--<select preset-id=\"fontWeightLabel\" class=\"font-weight-label-selector font-weight-selector preset-selector half-preset-selector half-preset-selector\">                          \n              <option data-id=\"light\"> light </option>\n              <option data-id=\"normal\"> normal </option>\n              <option data-id=\"bold\"> bold </option>              \n          </select>-->\n          <input title=\"Font style\" data-id = \"fontStyleLabel\" class=\"ql-fontstyle font-style-label-selector font-style-selector preset-selector half-preset-selector half-preset-selector\" qm-input-type=\"input-with-options\" qm-option-options = \"Thin|Semi-Light|Light|Regular|Medium|Semi-Bold|Bold|Extra-Bold|Black|Thin-Italic|Semi-Light-Italic|Light-Italic|Italic|Medium-Italic|Semi-Bold-Italic|Bold-Italic|Extra-Bold-Italic|Black-Italic|default\" qm-option-auto-open-contextual=\"true\" qm-option-force-value-to-option=\"true\" qm-option-default-value=\"Regular\"></input>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"prop\">\n  <div class=\"property layout-color\">\n    <p class=\"property-title collapsable-toggle \">Description</p>\n    <div class=\"propertyBody\">\n        <div class=\"property-group\">\n          <p>Background Color</p>\n          <input data-id = \"backgroundColorDescription\" class=\"bkg-color-description-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n        </div>\n        <div class=\"property-group\">\n          <p>Text Color</p>\n          <input data-id = \"textColorDescription\" class=\"text-color-description-value\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\" qm-option-contextual-container=\".front-container\" qm-option-z-index=\"3003\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p>Line Height</p>\n          <input data-id = \"lineHeightDescription\" class=\"settings-input line-height-description-value\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group\">\n          <p>Font Size</p>\n          <input data-id = \"fontSizeDescription\" class=\"settings-input font-size-description-value\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n          <div class=\"clear\"></div>\n        </div>\n        <div class=\"property-group font-style-description-container selector-container ui-front\">\n          <p>Font family</p>\n          <input preset-id=\"fontStyleDescription\" data-id = \"fontStyleDescription\" title=\"Font style\" class=\"ql-fontstyle font-style-description-selector font-style-selector preset-selector half-preset-selector\" qm-input-type=\"input-with-options\" qm-option-options = \"Thin|Semi-Light|Light|Regular|Medium|Semi-Bold|Bold|Extra-Bold|Black|Thin-Italic|Semi-Light-Italic|Light-Italic|Italic|Medium-Italic|Semi-Bold-Italic|Bold-Italic|Extra-Bold-Italic|Black-Italic|default\" qm-option-auto-open-contextual=\"true\" qm-option-force-value-to-option=\"true\" qm-option-default-value=\"Regular\"></input>\n          <!--<select preset-id=\"fontWeightDescription\" class=\"font-weight-description-selector font-weight-selector preset-selector half-preset-selector\">            \n              <option data-id=\"light\"> light </option>\n              <option data-id=\"normal\"> normal </option>\n              <option data-id=\"bold\"> bold </option>              \n          </select>-->\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"tooltip-bottom-clear\"/>\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/dialogs/shareDialog.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog share-dialog\">\n  <div class=\"disclaimer\">A copy of the current project will be sent to the following addresses.\nImported files will be shared.</div>\n  <div class=\"share\">\n    <div class=\"share-container\">\n      <span> Email list: </span>\n      <input type=\"text\" class=\"form-control\" id=\"tokenfield\" value=\"\"/>\n    </div>\n  </div>\n  <div class=\"message-error\"></div>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/dialogs/styleSettingsTab.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog\">\n\n  <div class=\"property\">\n    <p class=\"property-title\">Layout</p>\n    <div class=\"propertyBody\">\n      <ul class=\"layout-menu\">\n        <li class=\"layout-btn web-layout\" data-id=\"web-layout\">Web</li>\n        <li class=\"layout-btn full-screen-layout\" data-id=\"full-screen-layout\">Fullscreen</li>\n        <li class=\"layout-btn embed-layout\" data-id=\"embed-layout\">Embed</li>\n        <li class=\"layout-btn custom-layout\" data-id=\"embed-layout\">Custom</li>\n      </ul>\n      <div class=\"clear\"></div>\n    </div>\n\n\n    <div class=\"propertyBody\">\n      <div class=\"property-group\">\n        <p> Space width </p>\n        <input data-id = \"width\" class=\"settings-input project-width-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n        <div class=\"clear\"></div>\n      </div>\n      <div class=\"property-group\">\n        <p> Space Height </p>\n        <input data-id = \"height\" class=\"settings-input project-height-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n        <div class=\"clear\"></div>\n      </div>\n    </div>\n\n    <div class=\"propertyBody\">\n      <div class=\"property-group\">\n        <p> Number of columns </p>\n        <input data-id = \"numCols\" class=\"settings-input project-cols-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d*[\\.,]?\\d*)\"></input>\n        <div class=\"clear\"></div>\n      </div>\n      <div class=\"property-group\">\n        <p> Number of rows</p>\n        <input data-id = \"numRows\" class=\"settings-input project-rows-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d*[\\.,]?\\d*)\"></input>\n        <div class=\"clear\"></div>\n      </div>\n\n    </div>\n\n  </div>\n  <div class=\"property\">\n    <p class=\"property-title\">Grid Settings</p>\n    <div class=\"propertyBody\">\n      <div class=\"property-group\">\n        <p> Column width </p>\n        <input data-id = \"colWidth\" class=\"settings-input grid-width-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n        <div class=\"clear\"></div>\n      </div>\n      <div class=\"property-group\">\n      <p> Margins </p>\n      <input data-id = \"margins\" class=\"settings-input grid-margin-input\" qm-input-type=\"input-with-format\" qm-option-force-value-to-format=\"(\\d+)\\s?(px)?\" qm-option-format-defaults=\"|px\"></input>\n      </div>\n    </div>\n  </div>\n  <div class=\"property\">\n    <p class=\"property-title\">Color</p>\n    <div class=\"propertyBody\">\n      <div class=\"property-group\">\n        <p> Background Color </p>\n        <input data-id = \"backgroundColor\" class=\"bkg-color\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#ffffff\"></input>\n        <div class=\"clear\"></div>\n      </div>\n      <div class=\"property-group\">\n        <p> Foreground Color </p>\n        <input data-id = \"foregroundColor\" class=\"fg-color\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#000000\"></input>\n      </div>\n      <div class=\"clear\"></div>\n    </div>\n  </div>\n\n\n\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/dialogs/tosDialog.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dialog tos-dialog\">\n  <div class=\"title\">Please read and accept our terms of service</div>\n  <div class=\"tos-container\">\n    <div class=\"tos-content\">\n      <h1>Quadrigram: Terms of service</h1>\n        <ol>\n            <li>\n                <h2>1. Preface</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>1.1.</strong> <strong>QUADRIGRAM</strong> provides infrastructure and services to its users, which enables them to work with digital content stored in internet servers or third party services and require a registration at an optional charge by the user.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>1.2.</strong> Subject to the terms and conditions of this Agreement, <strong>QUADRIGRAM</strong> makes certain services available to users. For the purposes of this Agreement: (a) \"user\" means the individual or public or private organization entity that is using or registering to use the Services, including its employees and agents; (b) <strong>QUADRIGRAM</strong> \"Services\" means those electronic or interactive services offered by <strong>QUADRIGRAM</strong> or third party providers. <strong>QUADRIGRAM</strong> Online reserves the right to change or discontinue any of the Services at any time.The user acknowledges that all materials (except those property of the user) provided on this Web site, including but not limited to information, documents, products, logos, graphics, sounds, data, software, and services (collectively \"Materials\"), are provided either by <strong>QUADRIGRAM</strong> or by their respective third party authors, developers and vendors (collectively \"Third Party Providers\") and the underlying intellectual property rights are owned by <strong>QUADRIGRAM</strong> and/or its Third Party Providers. Elements of the Web site are protected by the correspondent intellectual property laws and may not be copied or imitated in whole or in part. <strong>QUADRIGRAM</strong>, the <strong>QUADRIGRAM</strong> logo, and other <strong>QUADRIGRAM</strong> products referenced herein are trademarks of <strong>QUADRIGRAM</strong>, and may be registered in certain jurisdictions. All other product names, company names, marks, logos, and symbols may be the trademarks of their respective owners.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>2. Third party providers</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>2.1.</strong> The user is solely responsible and liable for any and all access to and use of the Services of the Third party providers content (including all activities and transactions) by any Authorized User and/or User ID registered under us account. It is Customer's responsibility to set the appropriate access for each of Customer's Authorized Users.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>2.2.</strong> Hereby the user undertakes to comply with the terms and conditions set forth by the third party providers and release from liability and to indemnify and hold <strong>QUADRIGRAM</strong>, and any of its employees or agents representing.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>3. Usage Rules</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>3.1.</strong> The users are permitted to create freely content with <strong>QUADRIGRAM</strong> about any topic, except irrespective, racist or offensive material. <strong>QUADRIGRAM</strong> reserves the right to delete the stored publications from the <strong>QUADRIGRAM</strong> Hosting server.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>3.2.</strong> The users are not allowed to create content or manage data files with <strong>QUADRIGRAM</strong> whose possession and/or distribution is illegal. <strong>QUADRIGRAM</strong> will immediately block the access to such content after having been notified. Furthermore illegal publications stored at the <strong>QUADRIGRAM</strong> hosting will be deleted.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>4. Services</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>4.1.</strong> <strong>QUADRIGRAM</strong> provides information on the <strong>QUADRIGRAM</strong>.com website about the services provided, such as the pricing and payment options, and additional conditions for the usage. <strong>QUADRIGRAM</strong> is entitled to remove individual services at any time, to change the services contained within the packages or to offer new packages as part of its services.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>4.2.</strong> The commercial sale of accounts with or without chargeable services together with any other products and services requires the authorization of <strong>QUADRIGRAM</strong>. <strong>QUADRIGRAM</strong> reserves the right to block accounts, which are used by several persons, or to block accounts, which have been illegally resold in a commercial manner without the authorization of <strong>QUADRIGRAM</strong>.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>5. Plans and Prices</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>5.1.</strong> Plans and prices of <strong>QUADRIGRAM</strong> services are available in our website.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>5.2.</strong> <strong>QUADRIGRAM</strong> hereby refers expressively to the fact that it will immediately block accounts if the prepaid credit acquired for these accounts is reversed, if charges or credit card debits \"bounce\", or if the payment provider reverses a payment as a preventative measure due to irregularities (fraudulent behavior) and all the stored data will be deleted after 25 days from the date on which the account was blocked without previous notice.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>5.3.</strong> The \"free\" plan available in our website is uniquely meant for non-profit use. \"Non-profit use\" means that no compensations can be charged or accepted for the use of <strong>QUADRIGRAM</strong> \"academic\" or any services provided with it. It is limitated to the following users: (a) individual users who use <strong>QUADRIGRAM</strong> for non-commercial (hobby, learning, or entertainment) or academic (students, scholars) use only , (b) non-profit organizations (charities and other organizations created for the promotion of social welfare), and (c) independent contractors who are under contract by the above-stated organizations and using <strong>QUADRIGRAM</strong> exclusively for such non-profit clients. We will immediately block and delete the stored data of \"academic\" accounts used by or for a for-profit organization, or used to generate income for personal benefit.<br>\n                            <strong>QUADRIGRAM</strong> reserves the right to further clarify the terms of Non-Commercial Use at its sole determination.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>6. Availability</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>6.1.</strong> <strong>QUADRIGRAM</strong> uses third party providers to store, manage and authenticate users. <strong>QUADRIGRAM</strong> uses reliable storage providers but <strong>QUADRIGRAM</strong> is not responsible for possible issues caused by third party faults or discontinued services.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>6.2.</strong> <strong>QUADRIGRAM</strong> will only modify and add files on third party storage providers to guarantee the proper application workflow. No needed changes or queries will be done by <strong>QUADRIGRAM</strong>.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>7. Backup Your Content</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>7.1.</strong> The user is responsible for the backing up (to his own computer or other devices) of the files that he stores or accesses on <strong>QUADRIGRAM</strong>s servers. <strong>QUADRIGRAM</strong> does not guarantee or warrant that any content that the user saves, stores or accesses through the service will not be subject to inadvertent damage, corruption or loss.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>8. Miscellaneous</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>8.1.</strong> <strong>QUADRIGRAM</strong> will inform registered users about changes to the Terms of Use before they become effective. If the user has acquired a chargeable product and changes are made to this product with a disadvantage towards the user, then the user shall be entitled to terminate the contractual relationship within a period of four weeks after receiving notice of the changes. If the user does not make use of his/her right to terminate the contract, then the changes shall be considered accepted and will become effective components of the contract. <strong>QUADRIGRAM</strong> shall be obligated to refer the user to this rule again when providing notification of the new Terms of Use.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>8.2.</strong> If any part of these Terms of Use is held invalid or unenforceable, that portion shall be construe in a manner consistent with applicable law to reflect, as nearly as possible, the original intentions of the parties and the remaining portions shall remain in full force and effect. The absence of <strong>QUADRIGRAM</strong> to exercise or enforce any right or provision of these Terms of use shall not constitute a waiver of such right or provision.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>8.3.</strong> The validity, construction and performance of these terms of use shall be governed by Spanish law. Any dispute, controversy or claim arising under, out of or relating to this contract and any subsequent amendments of this document, including, without limitation, its formation, validity, binding effect, interpretation, performance, breach or termination, as well as non-contractual claims, shall be submitted to the Spanish tribunals of Barcelona.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>9. Collection of Information</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>9.1.</strong> <strong>QUADRIGRAM</strong> collects personal information on sign up process: your real name, e-mail address. And url thumbnail information. <strong>QUADRIGRAM</strong> collects information about the user's performance.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>9.2.</strong> Under the provisions of Organic Law 15/1999 on Protection of Personal Data, we inform you that your data will be incorporated in automated files owned by <strong>QUADRIGRAM</strong> SL, in order to inform operational and service improvements. You may exercise your rights of access, rectification, cancellation and opposition by writing to <strong>QUADRIGRAM</strong> SL, Pasaje Mercader n 8, 08008 Barcelona or support@quadrigram.com\n                        </p>\n                    </li>\n                </ol>\n            </li>\n            <li>\n                <h2>10. Information uses</h2>\n                <ol>\n                    <li>\n                        <p>\n                            <strong>10.1.</strong> We use PII for internal uses. The Personal Information is for to contact you, improve, operate, and maintain the Application and services, and for other administrative purposes.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>10.2.</strong> We reserve the right to send you certain communications relating to ours products and services: special offers, announcements, new services, etc.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>10.3.</strong> Your account password is never stored has plain text in our database. Only a encrypted value of this password is stored. The only way to reset or change your current password is using our Application.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>10.4.</strong> We may disclose PII in response to a law enforcement agency's request, or where we believe it is necessary to investigate, prevent, or take action regarding illegal activities and suspected fraud.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>10.5.</strong> We reserve the right to provide anonymous information reporting for internal and external clients.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>10.6.</strong> We reserve right to share PII about you with our partners, under confidentiality agreements, to help us improve our product and service. However, these companies do not have any independent right to share this information.\n                        </p>\n                    </li>\n                    <li>\n                        <p>\n                            <strong>10.7.</strong> We reserve the right to transfer all PII in our system if <strong>QUADRIGRAM</strong> or one of our business units is acquired, sold or merged with another company.\n                        </p>\n                    </li>\n                </ol>\n            </li>\n        </ol>\n\n    </div>\n  </div>\n</div>\n\n\n";
  });

this["JST"]["app/scripts/templates/UI/disclaimerDeviceView.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"disclaimer-device-view-container\">\n  <div class=\"disclaimer-device-view-content\">\n    <div class=\"disclaimer-device-view-logo\"></div>\n    <div class=\"disclaimer-device-view-paragraph\">\n      <p>Hello there!!</p>\n      <p>With this device you can visit projects published with Quadrigram but you can not edit them.</p><a class=\"disclaimer-gallery-link\" href=\"http://www.quadrigram.com/#gallery\">\n      Checkout some Quadrigram projects here</a>\n    </div>\n  </div>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/errors/messageError.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"message-server-error\">\n  <span class=\"message-container\">"
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "</span>\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/errors/pickerError.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "	<div class=\"retry-overlay\"> \n		<div class=\"retry-overlay-message\">Retry</div>\n	</div>\n";
  });

this["JST"]["app/scripts/templates/UI/header.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  
  return "Disable notifications";
  }

function program3(depth0,data) {
  
  
  return "Enable notifications";
  }

  buffer += "<div id=\"header\">\n  <div class=\"header-left-container\">\n  <div id=\"user-info\" class=\"header-item\">\n      <div class=\"avatar-container\">\n        <span class=\"avatar user-info-item\" style=\"background-image:url('"
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.avatarURL)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "')\"></span>\n      </div>\n      <div class=\"dropdown user-info-item\">\n        <button class=\"btn btn-default dropdown-toggle\" type=\"button\" id=\"dropdownMenu1\" data-toggle=\"dropdown\">\n          <div class=\"user-name\">"
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.name)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "</div>\n          <span class=\"caret\"></span>\n        </button>\n        <ul class=\"dropdown-menu user-options\" role=\"menu\" aria-labelledby=\"dropdownMenu1\">\n          <li role=\"presentation\" class=\"user-profile\">User profile</li>\n          <li class=\"logout-button\" role=\"presentation\" >Logout</li>\n        </ul>\n      </div>\n    </div>\n\n    <div id=\"project-info\" class=\"header-item project-info-button\">\n      <div class=\"dropdown user-info-item\">\n        <button class=\"btn btn-default dropdown-toggle\" type=\"button\" id=\"dropdownMenu1\" data-toggle=\"dropdown\">\n          <div id=\"dropdownMenu1-text\">Project</div>\n          <span class=\"caret\"></span>\n        </button>\n        <ul class=\"dropdown-menu\" role=\"menu\" aria-labelledby=\"dropdownMenu1\">\n          <li class=\"new-button\" role=\"presentation\">New project</li>\n          <li class=\"open-button\" role=\"presentation\">Open project</li>\n          <li class=\"save-button\" role=\"presentation\">Save...</li>\n          <li class=\"save-as-button\" role=\"presentation\">Save As...</li>\n          <li class=\"rename-button\" role=\"presentation\">Rename...</li>\n          <li class=\"share-button\" role=\"presentation\">Share</li>\n        </ul>\n      </div>\n      <div id=\"project-title\" class=\"user-info-item\">Project name</div>\n    </div>\n    <div class=\"save-component\">\n\n      <div class=\"save-btn\"><a>\n        <span class=\"label\">Save</span>\n        <span class=\"icon\"></span>\n      </a></div>\n\n    </div>\n  </div>\n  <div class=\"header-center-container\">\n    <div class=\"header-title header-item\">\n      <div class=\"title\"></div>\n      <div class=\"version\">"
    + escapeExpression(((stack1 = depth0.version),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "</div>\n    </div>\n  </div>\n  <div class=\"header-right-container\">\n    <div class=\"header-tools action-buttons\">\n      <!--<div class=\"tool ui-tip-target help\" data-ui-tip-id=\"help-button\"><span class=\"icon\"> ? </span><span class=\"tool-name\"> Help </span></div>-->\n      <div id=\"help-info\" class=\"header-item help-info-button\">\n        <div class=\"dropdown help-info-item\">\n          <button class=\"btn btn-default dropdown-toggle\" type=\"button\" id=\"dropdownMenu1\" data-toggle=\"dropdown\">\n            <div id=\"dropdownMenu1-text\">Help</div>\n            <span class=\"caret\"></span>\n          </button>\n          <ul class=\"dropdown-menu\" role=\"menu\" aria-labelledby=\"dropdownMenu1\">\n            <li class=\"open-help-button\" role=\"presentation\">Help panel</li>\n            <li class=\"toggle-notif-button\" role=\"presentation\">";
  stack2 = helpers['if'].call(depth0, depth0.notifActive, {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "</li>\n            <li class=\"askus-help-button\" role=\"presentation\">Ask us</li>\n            <li class=\"feedback-help-button\" role=\"presentation\">Feedback form</li>\n            <li class=\"external-help-button\" role=\"presentation\">Tutorials</li>\n            <li class=\"terms-help-button\" role=\"presentation\">Terms and conditions</li>\n          </ul>\n        </div>\n      </div>\n      <!--<li class=\"ui-tip-target\" data-ui-tip-id=\"undo-button\"><div class=\"undo\"><span class=\"icon\"></span></div></li>\n      <li class=\"ui-tip-target\" data-ui-tip-id=\"redo-button\"><div class=\"redo\"><span class=\"icon\"></span></div></li>-->\n    </div>\n    <div class=\"header-tools header-edit-tools\">\n      <div class=\"tool preview-button toggle-preview-btn ui-tip-target\" class=\"ui-tip-target\" data-ui-tip-id=\"preview-button\"><a><span class=\"icon\"></span></span><span class=\"tool-name\">Preview</span></a></div>\n      \n      <div class=\"tool share export-button ui-tip-target\" data-ui-tip-id=\"export-button\"><a><span class=\"icon\"></span><span class=\"tool-name\">Publish</span></a></div>\n    </div>\n  </div>\n\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/helpPopup.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, self=this, functionType="function", escapeExpression=this.escapeExpression;

function program1(depth0,data) {
  
  
  return "completed";
  }

  buffer += "\n<div class=\"header\">\n  <div class=\"help-title\">Help</div>\n  <div class=\"navigation\">\n    <div class=\"back\"></div>\n    <div class=\"forward\"></div>\n  </div>\n  <!-- <div class=\"askus\">Ask us...</div> -->\n	<div class=\"close\">Close</div>\n  <div class=\"minimize\"></div>\n\n</div>\n\n\n\n\n<div class=\"help-popup-content\">\n  \n\n  <div class=\"navigation\">\n    <!--\n    <div class=\"back\"></div>\n    <div class=\"forward\"></div>\n    -->\n    <!--\n    <div class=\"title ";
  stack1 = helpers['if'].call(depth0, depth0.completed, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\">\n      <span>";
  if (stack1 = helpers.goalLabel) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.goalLabel; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</span>\n      <div class=\"status-icon\"></div>\n    </div>\n    -->\n \n    <div class=\"search-container\">\n      <div class=\"search-icon\"></div>\n      <input type=\"text\" class=\"help-search search-input\" placeholder=\"Search...\">\n    </div>\n    <!--\n    \n    <div class=\"search\">SearchIcon</div>\n    -->\n  </div>\n  \n\n\n  <div class=\"help-item-content\">\n  </div>\n  <div class=\"fake-loader\">\n    <div class=\"center-wrapper\">\n      <img class=\"loader-logo\" src=\"images/FinalLoader-2_2.gif\"/>\n      <span>Loading...</span>\n    </div>\n  </div>\n</div>\n\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/helpPopupContent.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  
  return "completed";
  }

function program3(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n      <div class=\"video-thumb\" data-id=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.content),stack1 == null || stack1 === false ? stack1 : stack1.videoID)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n        <div class=\"watch-me-label\">WATCH</div>\n        <img src=\"http://img.youtube.com/vi/"
    + escapeExpression(((stack1 = ((stack1 = depth0.content),stack1 == null || stack1 === false ? stack1 : stack1.videoID)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "/0.jpg\"></img>\n        <div class=\"play-icon\"></div>\n      </div>\n      ";
  return buffer;
  }

function program5(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n        <div class=\"link-container\">\n          <a class=\"link\" href=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.content),stack1 == null || stack1 === false ? stack1 : stack1.linkURL)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" target=\"_blank\">\n            <div class=\"icon\"></div>\n            <span>READ MORE</span>\n          </a>\n        </div>\n        ";
  return buffer;
  }

function program7(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n      <li class=\"recomended ";
  stack1 = helpers['if'].call(depth0, depth0.completed, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\" data-id=\""
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\"> \n        <div class=\"status-icon\"></div>\n        <div class=\"goal-label\"> "
    + escapeExpression(((stack1 = depth0.goalLabel),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " </div>\n      </li>\n      ";
  return buffer;
  }

  buffer += "<!--\n<div class=\"title ";
  stack1 = helpers['if'].call(depth0, depth0.completed, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\">\n  \n  <span>";
  if (stack1 = helpers.goalLabel) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.goalLabel; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</span>\n  <div class=\"status-icon\"></div>\n</div>\n-->\n\n<div class=\"description-section section\">\n  <div class=\"section-content\">\n    <div class=\"main-content\">\n      ";
  stack2 = helpers['if'].call(depth0, ((stack1 = depth0.content),stack1 == null || stack1 === false ? stack1 : stack1.videoID), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n      <div class=\"title ";
  stack2 = helpers['if'].call(depth0, depth0.completed, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\">\n        <span>";
  if (stack2 = helpers.goalLabel) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.goalLabel; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</span>\n        <div class=\"status-icon\"></div>\n      </div>\n      <div class=\"description-container\">\n        <div class=\"description\">";
  stack2 = ((stack1 = ((stack1 = depth0.content),stack1 == null || stack1 === false ? stack1 : stack1.description)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1);
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "</div>\n        ";
  stack2 = helpers['if'].call(depth0, ((stack1 = depth0.content),stack1 == null || stack1 === false ? stack1 : stack1.linkURL), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n      </div>\n    </div>\n\n    \n\n  </div>\n</div>\n\n<div class=\"section-header\">What's next</div>\n\n<div class=\"whatsnext-section section\">\n  \n  <div class=\"section-content\">\n    <ul class=\"recomendeds\">\n      ";
  stack2 = helpers.each.call(depth0, depth0.recomended, {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n    </ul>\n  <div>\n</div>\n\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/helpSearchContent.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, self=this, functionType="function", escapeExpression=this.escapeExpression;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n    <li class=\"";
  stack1 = helpers['if'].call(depth0, depth0.completed, {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\" data-id=\""
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" data-search-words=\""
    + escapeExpression(((stack1 = depth0.goalLabel),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + escapeExpression(((stack1 = depth0.goalAction),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\"> \n      <div class=\"status-icon\"></div>\n      <div class=\"goal-label\"> "
    + escapeExpression(((stack1 = depth0.goalLabel),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " </div>\n    </li>\n    ";
  return buffer;
  }
function program2(depth0,data) {
  
  
  return "completed";
  }

  buffer += "\n<div class=\"search-results\">\n  <div class=\"result-count\"></div>\n  <ul class=\"results-ul\">\n    ";
  stack1 = helpers.each.call(depth0, depth0.achievements, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n  </ul>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/helpVideoPopup.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"video-container\">\n  <div class=\"close\"></div>\n  <div class=\"iframe-container\">\n    <iframe allowfullscreen></iframe>\n  </div>\n</div>\n\n\n";
  });

this["JST"]["app/scripts/templates/UI/imageMetadataItem.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, options, functionType="function", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;

function program1(depth0,data) {
  
  
  return "\n  	<div class=\"delete-btn btn\"> Delete </div>\n  ";
  }

  buffer += "<div class=\"image-meta-data-item\" data-id=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" data-name=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.name)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n  <!-- <span class=\"icon type-";
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.convertToType || depth0.convertToType),stack1 ? stack1.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.mimeType), options) : helperMissing.call(depth0, "convertToType", ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.mimeType), options)))
    + "\"></span> -->\n  <!-- thumbnailPath, NO EXISTE!!!, pero es que ademas, filePath no funciona la mayoria de veces (403)-->\n  <div class=\"image-preview\" style=\"background-image: url("
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.thumbnailPath)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ")\"></div>\n  <div class=\"white-overlay\"></div>\n  <div class=\"action-btn btn hidden\"> Load image </div>\n  <a class=\"item-label\"> "
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.name)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " </a>\n  <!--\n  <a class=\"item-created\"> ";
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.convertToDate || depth0.convertToDate),stack1 ? stack1.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.created), options) : helperMissing.call(depth0, "convertToDate", ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.created), options)))
    + " </a>\n  <a class=\"item-modified\"> ";
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.convertToDate || depth0.convertToDate),stack1 ? stack1.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.modified), options) : helperMissing.call(depth0, "convertToDate", ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.modified), options)))
    + " </a>\n\n  \n  ";
  stack2 = helpers.unless.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.readOnly), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n  -->\n  \n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/listItem.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "\n<span class=\"icon\"></span>\n<div class=\"block-group\" groupId=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n  <input class=\"item-label\" value=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.label)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\"></input>\n</div>\n<div class=\"list-item-actions\">\n  <a class=\"delete\"></a>\n  <a class=\"edit\"></a>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/loadableCollectionView.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class=\"items-container\"></div>\n<div class=\"overlay-container\"> </div>";
  });

this["JST"]["app/scripts/templates/UI/loadableView.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/UI/loader/errorLoader.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"loader\">\n  <img class=\"loader-animation\" src=\"images/loader.gif\"/>\n  <div class=\"loader-message\"><img src=\"images/loader.gif\"/>Content<div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/loader/loader.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"loader\">\n  <img class=\"loader-animation\" src=\"images/loader.gif\"/>\n  <div class=\"loader-message under-gif\"></div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/loader/loaderOver.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"loader-over\">\n  <img class=\"loader-animation\" src=\"images/loader.gif\"/>\n  <div class=\"loader-over-message\"></div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/loadingOverlay.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"loading-overlay\">\n  <div class=\"center-wrapper\">\n    <img src=\"images/loader.gif\"/>\n    <span> Loading... </span>\n  </div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/UI/messageOverlay.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"message-overlay\">\n  <div class=\"center-wrapper\">\n    <span class=\"message-conatiner\">"
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "</span>\n  </div>\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/metadataItem.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, options, functionType="function", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;

function program1(depth0,data) {
  
  
  return "\n    <div class=\"action-btn btn\"> NONE </div>\n  ";
  }

function program3(depth0,data) {
  
  
  return "\n    <div class=\"too-large-btn btn ui-tip-target\" data-ui-tip-id=\"file-too-large\"> Too large </div>\n  ";
  }

function program5(depth0,data) {
  
  
  return "\n  	<div class=\"delete-btn btn\"> Delete </div>\n  ";
  }

  buffer += "<div class=\"meta-data-item\" data-id=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" data-name=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.name)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n  <span class=\"icon type-";
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.convertToType || depth0.convertToType),stack1 ? stack1.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.mimeType), options) : helperMissing.call(depth0, "convertToType", ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.mimeType), options)))
    + "\"></span>\n\n  <a class=\"item-label\"> "
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.name)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " </a>\n  <a class=\"item-created\"> ";
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.convertToDate || depth0.convertToDate),stack1 ? stack1.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.created), options) : helperMissing.call(depth0, "convertToDate", ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.created), options)))
    + " </a>\n  <a class=\"item-modified\"> ";
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.convertToDate || depth0.convertToDate),stack1 ? stack1.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.modified), options) : helperMissing.call(depth0, "convertToDate", ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.modified), options)))
    + " </a>\n  ";
  options = {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data};
  stack2 = ((stack1 = helpers.ifNotToolarge || depth0.ifNotToolarge),stack1 ? stack1.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.fileSize), options) : helperMissing.call(depth0, "ifNotToolarge", ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.fileSize), options));
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n  ";
  stack2 = helpers.unless.call(depth0, ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.readOnly), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n  \n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/pageFeedback.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class = \"page-navigator\">\n  <div class = \"nav-item-arrow left\"> </div>\n  <div class = \"nav-center-container\">\n    <div class = \"nav-center-label\">\n\n    </div>\n  </div>\n  <div class = \"nav-item-arrow right\"> </div>\n</div>\n<div class = \"icon ui-tip-target\" data-ui-tip-id=\"pages-shortcut\"> Pages\n</div>";
  });

this["JST"]["app/scripts/templates/UI/pagesToolbar.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"pages-toggle-conatiner\">\n  <div class=\"pages-toggle\"></div>\n</div>\n\n<div class=\"pages-toolbar-content\">\n  <div class=\"thumbs-wrapper\">\n    <div class=\"button-container\">\n      <div class=\"new-page-button\"> \n        <div class=\"button-text\">Create new page </div>\n      </div>\n      \n    </div>\n    <div class=\"thumbs-scroll\">\n      <ul class=\"thumbs-ul thumbs-collection-container\"></ul>\n    </div>\n  </div>\n  <div class=\"page-settings-button\"></div>\n</div>";
  });

this["JST"]["app/scripts/templates/UI/propertiesFamily.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n";
  });

this["JST"]["app/scripts/templates/UI/textBar.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"toolbar-container\">\n</div>";
  });

this["JST"]["app/scripts/templates/UI/textBarToolBar.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "";
  buffer += escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "|";
  return buffer;
  }

  buffer += "<div class=\"quill-bar toolbar\">\n<div class=\"prop\">\n  <p class=\"property-title\">Character</p>\n\n  <div class=\"propertyBody\">\n      <div class=\"ql-font-container\">\n        <input title=\"Font\" class=\"ql-font\" qm-input-type=\"input-with-options\" qm-option-options = \"";
  stack1 = helpers.each.call(depth0, depth0.fontFamilies, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "default\" qm-option-auto-open-contextual=\"true\" qm-option-force-value-to-option=\"true\" qm-option-default-value=\"Roboto\"></input>\n      </div>\n      <div class=\"ql-fontstyle-container\">\n        <input title=\"Font style\" class=\"ql-fontstyle\" qm-input-type=\"input-with-options\" qm-option-options = \"Thin|Semi-Light|Light|Regular|Medium|Semi-Bold|Bold|Extra-Bold|Black|Thin-Italic|Semi-Light-Italic|Light-Italic|Italic|Medium-Italic|Semi-Bold-Italic|Bold-Italic|Extra-Bold-Italic|Black-Italic|default\" qm-option-auto-open-contextual=\"true\" qm-option-force-value-to-option=\"true\" qm-option-default-value=\"Regular\"></input>\n      </div>\n\n      <div class=\"ql-line-spacing-container\">\n        <input title=\"Line spacing\" class=\"ql-linespacing\" qm-input-type=\"input-with-options\" qm-option-options = \"normal|6px|8px|9px|10px|11px|12px|14px|18px|24px|30px|36px|48px|60px|72px\" qm-option-force-value-to-format=\"(-+)?(\\d+)\\s?(px)?\" qm-option-format-defaults=\"||px\" qm-option-special-value=\"normal\" qm-option-default-value=\"normal\"></input>\n      </div>\n      <div class=\"ql-size-container\">\n        <input title=\"Size\" class=\"ql-size\" qm-input-type=\"input-with-options\" qm-option-options = \"6px|8px|9px|10px|11px|12px|14px|18px|24px|30px|36px|48px|60px|72px\" qm-option-force-value-to-format=\"(\\d+)\\s?(px|pt)?\" qm-option-format-defaults=\"|px\" qm-option-default-value=\"18px\"></input>\n      </div>\n\n      <div class=\"ql-letter-spacing-container\">\n        <input title=\"Letter spacing\" class=\"ql-letterspacing\" qm-input-type=\"input-with-options\" qm-option-options = \"0px|10px|25px|50px|75px|100px|200px\" qm-option-force-value-to-format=\"(-+)?(\\d+)\\s?(px)?\" qm-option-format-defaults=\"||px\" qm-option-default-value=\"0px\"></input>\n      </div>\n      <div class=\"ql-color-container\">\n        <input title=\"Text color\" class=\"ql-color\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"#000000\" qm-option-z-index=\"909\" qm-option-contextual-container=\".front-container\" qm-option-icon=\"text-color-icon\"></input>\n      </div>\n\n      <div class=\"clear\"></div>\n      <span class=\"ql-format-group\">\n        <!--<span title=\"Bold\" class=\"ql-format-button ql-bold\">Bold</span>\n        <span title=\"Italic\" class=\"ql-format-button ql-italic\">Italic</span>-->\n        <span title=\"Underline\" class=\"ql-format-button ql-underline\">Underline</span>\n        <span title=\"Strikethrough\" class=\"ql-format-button ql-strike\">Linethrough</span>\n        <!--<span title=\"fake\" class=\"ql-format-button \"></span>-->\n        <span title=\"Link\" class=\"ql-format-button ql-link\"></span>\n        <div class=\"ql-color-container\" style=\"margin-top: -3px;\">\n          <input title=\"Text highlight\" class=\"ql-background\" qm-input-type=\"color-input\" qm-option-options = \"rgb(255,0,0)|rgb(0,255,0)|rgb(0,0,255)\" qm-option-default-value=\"none\" qm-option-z-index=\"909\" qm-option-contextual-container=\".front-container\" qm-option-icon=\"bkg-color-icon\"></input>\n        </div>\n      </span>\n      <div class=\"clear\"></div>\n  </div>\n</div>\n<div class=\"prop\">\n  <p class=\"property-title\"> Paragraph Align </p>\n  <div class=\"propertyBody\">\n    <input title=\"Align\" class=\"ql-align\" qm-input-type=\"icon-selector\" qm-option-options = \"left|center|right|justify\"  qm-option-auto-open-contextual=\"true\" qm-option-default-value=\"left\"></input>\n    <div class=\"clear\"></div>\n  </div>\n</div>\n<div class=\"prop\">\n  <p class=\"property-title\">Text Format</p>\n  <div class=\"propertyBody\">\n    <span class=\"ql-format-group\">\n      <span title=\"List\" class=\"ql-format-button ql-list\">List</span>\n      <span title=\"Bullet\" class=\"ql-format-button ql-bullet\">Bullets</span>\n    </span>\n\n    </div>\n</div>\n<div class=\"prop\">\n  <p class=\"property-title\">Vertical align</p>\n  <div class=\"propertyBody\">\n    <input title=\"Align\" class=\"ql-valign\" qm-input-type=\"icon-selector\" qm-option-options = \"top|middle|bottom\"  qm-option-auto-open-contextual=\"true\" qm-option-default-value=\"top\"></input>\n  </div>\n</div>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/toolbar.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"tools-menu\">\n    <div class=\"tools leftSide\">\n      <div class=\"data-manager-toggle manager-toggle ui-tip-target\" data-ui-tip-id=\"data-manager\">\n        <p class=\"title\"><span class=\"title-icon\"></span><span class=\"title-name\">Manage Data</span></p>\n      </div>\n<!--\n      <div class=\"function-manager-toggle manager-toggle\">\n        <p class=\"title\"><span class=\"title-icon\"></span><span class=\"title-name\">Formula</span></p>\n      </div>\n-->\n    </div>\n\n\n    <div class=\"tools edit-tools rightSide\">\n      <ul>\n        <li class=\"layout ui-tip-target\" data-ui-tip-id=\"layout-settings\"><a><span class=\"icon\"></span><span class=\"tool-name\">Layout Settings</span></a></li>\n      </ul>\n    </div>\n\n    <div class=\"tools visualizers-tools center\">\n      <ul class=\"centered-content\">\n        <li class=\"basic\"><a><span class=\"icon\"></span><span class=\"tool-name\">Charts</span></a></li>\n        <li class=\"text\"><a id=\"text-btn\"><span class=\"icon\"></span><span class=\"tool-name\">Text</span></a></li>\n        <li class=\"draw\"><a><span class=\"icon\"></span><span class=\"tool-name\">Shapes</span></a></li>\n        <li class=\"media\"><a><span class=\"icon\"></span><span class=\"tool-name\">Media</span></a></li>\n        <li class=\"controls\"><a><span class=\"icon\"></span><span class=\"tool-name\">Controls</span></a></li>\n      </ul>\n    </div>\n</div>\n\n<div class=\"tools-submenu\">\n</div>\n<div class=\"clear\"></div>\n";
  });

this["JST"]["app/scripts/templates/UI/toolsDragList.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data,depth1) {
  
  var buffer = "", stack1;
  buffer += "\n<li class=\""
    + escapeExpression(((stack1 = depth0.stateClass),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\"><a data-group = \""
    + escapeExpression(((stack1 = ((stack1 = depth1.model),stack1 == null || stack1 === false ? stack1 : stack1.group)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" data-class=\""
    + escapeExpression(((stack1 = depth0.dataClass),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\"> "
    + escapeExpression(((stack1 = depth0.label),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "<img src=\"images/visualizers_thumbnails/"
    + escapeExpression(((stack1 = depth0.icon),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\"></a></li>\n";
  return buffer;
  }

  buffer += "\n<ul class=\"tool-sub-menu basic-menu visualizers-menu\" >\n\n";
  stack1 = helpers.each.call(depth0, depth0.dragOptions, {hash:{},inverse:self.noop,fn:self.programWithDepth(1, program1, data, depth0),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n\n</ul>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/toolsDragTipList.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data,depth1) {
  
  var buffer = "", stack1;
  buffer += "\n\n<li class=\""
    + escapeExpression(((stack1 = depth0.stateClass),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n  <div class=\"viz-drag-button ui-tip-target\" data-ui-tip-id=\"viz-"
    + escapeExpression(((stack1 = depth0.dataClass),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\"data-group = \""
    + escapeExpression(((stack1 = ((stack1 = depth1.model),stack1 == null || stack1 === false ? stack1 : stack1.group)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" data-class=\""
    + escapeExpression(((stack1 = depth0.dataClass),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n    <img src=\"images/"
    + escapeExpression(((stack1 = depth0.icon),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n    <p>"
    + escapeExpression(((stack1 = depth0.label),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "</p>\n  </div>\n</li>\n\n";
  return buffer;
  }

  buffer += "<div class=\"tooltip-content\">\n\n<ul class=\"tooltip-element-area\">\n";
  stack1 = helpers.each.call(depth0, depth0.dragOptions, {hash:{},inverse:self.noop,fn:self.programWithDepth(1, program1, data, depth0),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n</ul>\n\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/UI/topMenu.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"toolbar-container\"></div>\n";
  });

this["JST"]["app/scripts/templates/UI/vizInspector.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div id=\"vizInspector\">\n	<div class=\"header\">\n		<input class=\"viz-label\"></input>\n		<div class=\"close\">Close</div>\n	</div>\n</div>\n\n<div id=\"viz-inspector-content\">\n</div>\n\n<div class=\"viz-inspector-ui-front ui-front\">\n</div>\n  \n\n";
  });

this["JST"]["app/scripts/templates/UI/vizInspectorContent.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n      <li class=\"viz-inspector-"
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " ui-tip-target\" data-ui-tip-id=\"family-"
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" data=\""
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">"
    + escapeExpression(((stack1 = depth0.label),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "</li>\n    ";
  return buffer;
  }

  buffer += "<div class=\"vizInspectorMenu\">\n  <ul>\n    ";
  stack1 = helpers.each.call(depth0, depth0.families, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n  </ul>\n</div>\n\n<div class=\"family-container\">\n\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/QValueEditable.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<td>\n<input class=\"id-input\"> </input>\n</td>\n<td>\n<div class=\"value-input-container\"> </div>\n</td>";
  });

this["JST"]["app/scripts/templates/blocks/blockColumn.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"block-stack flex-column ";
  if (stack1 = helpers.role) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.role; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "-stack ";
  if (stack1 = helpers.type) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.type; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "-stack\">\n    <h5 class=\"col-name\">";
  if (stack1 = helpers.title) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.title; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</h5>\n    <div class=\"flex-column block-list cols-list\"></div>\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/blockGroup - Copy (2).hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"block-group-column flex-column\">\n\n</div>";
  });

this["JST"]["app/scripts/templates/blocks/blockGroup - Copy.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, options, self=this, helperMissing=helpers.helperMissing;

function program1(depth0,data) {
  
  
  return "\n<a class=\"add-block-button new_item\"><span>New block</span></a>\n";
  }

function program3(depth0,data) {
  
  
  return "\n\n<div class=\"flex-column block-stack\">\n  \n    <h5 class=\"first-col-name\"></h5>\n    <div class=\"data-block-container main-block\">\n    </div>\n\n</div>\n<div class=\"flex-column block-stack\">\n\n    <h5>Column names</h5>\n    <div class=\"data-block-container level-0-names\">\n    </div>\n\n    <h5>Row names</h5>\n    <div class=\"data-block-container level-1-names\">\n    </div>\n  \n</div>\n";
  }

  options = {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data};
  stack2 = ((stack1 = helpers.hasAddFunction || depth0.hasAddFunction),stack1 ? stack1.call(depth0, depth0.model, options) : helperMissing.call(depth0, "hasAddFunction", depth0.model, options));
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n";
  options = {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data};
  stack2 = ((stack1 = helpers.hasSpecialBlocks || depth0.hasSpecialBlocks),stack1 ? stack1.call(depth0, depth0.model, options) : helperMissing.call(depth0, "hasSpecialBlocks", depth0.model, options));
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n\n\n<div class=\"flex-column block-stack cols level-0\">\n  <h5 class=\"second-col-name\"></h5>\n  <div class=\"block-list cols-list\"></div>\n</div>\n\n<div class=\"flex-column block-stack rows level-1\">\n  <h5 class=\"third-col-name\"></h5>\n  <div class=\"block-list rows-list\"></div>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/blockGroup.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/blockGroupBlockStack.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"flex-column block-stack\">\n  <div class=\"column-title\"><span class=\"title name\"></h5></div>\n  <div class=\"block-list\"></div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/blocks/blockGroupCollection.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n<div class=\"add-group-button-area\"><div class=\"add-group-button new_item button\"><div class=\"button-text\">";
  if (stack1 = helpers.newText) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.newText; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</div></div></div>\n";
  return buffer;
  }

  stack1 = helpers['if'].call(depth0, depth0.newText, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/blockGroupColumn.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"block-group-column flex-column\">\n\n</div>";
  });

this["JST"]["app/scripts/templates/blocks/customBlockCollection.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"dropdown block-dropdown block-options\">\n    <div id=\"block-options-button-1\" class=\"block-options-button\" data-toggle=\"dropdown\">\n    	<span class=\"hit-area\">\n	      <div class=\"selected-block-container slot-body\"></div>\n	      <span class=\"caret\"></span>\n  		</span>\n    </div>\n	<ul class=\"dropdown-menu custom-block-menu\" role=\"menu\" aria-labelledby=\"block-options-button-1\">\n      <div class=\"new-block-button\">New Block</div>\n    </ul>\n</div>";
  });

this["JST"]["app/scripts/templates/blocks/customBlockCollectionElement.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<li class='list-item' block-id='"
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "'>\n  <div class='delete data-block-button'></div>\n  <div class='edit data-block-button draw'></div>\n</li>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/dataBlock.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"data-block-body ui-tip-target\" data-ui-tip-id=\"data-block\">\n  <div class=\"data-block-background\">\n    <div class=\"data-block-processing\">\n      <div class=\"processing-bar\"></div>\n    </div>\n  </div>\n\n  <div class=\"data-block-name\"><span> "
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.label)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " </span></div>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/dataBlockCollection.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/dataBlockCollectionElement.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class='data-block-item-container'>\n\n</div>";
  });

this["JST"]["app/scripts/templates/blocks/dataBlockEditable.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"data-drop-value\"> \n  <div class=\"input-component\">\n\n  </div>\n  <div class=\"list-editor-toggle\">\n\n  </div>\n</div>";
  });

this["JST"]["app/scripts/templates/blocks/dataBlockEditableTable.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/blocks/dataBlockFunction.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"scroll-left scroller\"><div class=\"format-arrow-left\"></div></div>\n<div class=\"expression-container\">\n</div>\n<div class=\"scroll-right scroller\"><div class=\"format-arrow-right\"></div></div>\n";
  });

this["JST"]["app/scripts/templates/blocks/dataBlockLabelable.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\"data-block-body\">\n  <input class=\"data-block-name\" value=\""
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.label)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">  </input>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/dataBlockReference.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/blocks/dataBlockStatic.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/blocks/editableQValueCollection.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/editors/colorEditor.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<!-- hay que deciridir si usamos un plugin o lo hacemos nosotros, de momento usa minicolors, que necesita un <input> -->\n<input class=\"text-input\"/>";
  });

this["JST"]["app/scripts/templates/blocks/editors/dateEditor.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<!-- implementar en el viewDidRender de dateEditorView.coffee las funciones para que se abra el date picker popup -->\n<input type=\"text\" class=\"datepicker\"/>";
  });

this["JST"]["app/scripts/templates/blocks/editors/optionsEditor.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<select>\n  <!-- estas optiones seran creadas por handlebars, de momento puede ser superhardcoded como ahora -->\n  <option> CartoDB </option>\n  <option> GooglMaps </option>\n  <option> OpenStreetMap </option>\n</select>";
  });

this["JST"]["app/scripts/templates/blocks/editors/percentageEditor.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<!-- poner aqui el el texto con slider al lado -->\n<div> percentage slider </div>";
  });

this["JST"]["app/scripts/templates/blocks/editors/textEditor.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<input class=\"text-input\"/>";
  });

this["JST"]["app/scripts/templates/blocks/operators/addLoopButton.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"expression-part\">\n  <div class=\"add-more\"></div>\n</div>";
  });

this["JST"]["app/scripts/templates/blocks/operators/expressionPart.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/operators/expressionPartCollection.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/operators/operatorOptions.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, options, functionType="function", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n  <span class=\"operator-conector\"> ";
  if (stack1 = helpers.label) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.label; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + " </span>\n  ";
  return buffer;
  }

function program3(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n      ";
  stack1 = helpers.unless.call(depth0, depth0.hidden, {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n    ";
  return buffer;
  }
function program4(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n        <option data-opt-id=\""
    + escapeExpression(((stack1 = depth0.optId),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\"> "
    + escapeExpression(((stack1 = depth0.label),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + " </option>\n      ";
  return buffer;
  }

  buffer += "  \n  ";
  options = {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data};
  stack2 = ((stack1 = helpers.unless_blank || depth0.unless_blank),stack1 ? stack1.call(depth0, depth0.label, options) : helperMissing.call(depth0, "unless_blank", depth0.label, options));
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n\n  <select class=\"expression-part-selector\" data-id=";
  if (stack2 = helpers.partId) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.partId; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + ">\n    ";
  stack2 = helpers.each.call(depth0, depth0.options, {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n  </select>";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/property.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n			<option class = \"ui-tip-target\" data-ui-tip-id=\""
    + escapeExpression(((stack1 = depth0.value),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\" value=\""
    + escapeExpression(((stack1 = depth0.value),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">"
    + escapeExpression(((stack1 = depth0.label),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "</option>\n		";
  return buffer;
  }

  buffer += "<div class=\"property property-list-item\">\n	<h5 class=\"property-label ui-tip-target\">"
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.label)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "<span class=\"contract\"></span></h5>\n	<div class=\"propertyBody\">\n		<select class=\"format-selector\" name=\"format-selector\">\n		";
  stack2 = helpers.each.call(depth0, depth0.formats, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n		</select>\n		<select class=\"hidden-select\" style=\"font-size: 10px; display:none;\">\n        <option class=\"hidden-option\"></option>\n    </select>\n		<div class=\"property-container\" property=\"property name\"> </div>\n		<div class=\"clear\"></div>\n	</div>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/slot.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n  <div class=\"slot-label ui-tip-target\">";
  if (stack1 = helpers.label) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.label; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</div>\n  ";
  return buffer;
  }

  buffer += "\n  ";
  stack1 = helpers['if'].call(depth0, depth0.needsLabel, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n\n  <div class=\"slot-container\">\n      <div class=\"slot-body\"> </div>\n  </div>\n  \n  <div class=\"function-btn not-available\"> </div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/blocks/tableEditor.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n<div class=\"header\">\n  <span class=\"block-label-span\"> Create date range list</span>\n  <div class=\"close\">Close</div>\n</div>\n\n<div class=\"table-editor-content\">\n  <div class=\"table-container\">\n    <table>\n      <thead class=\"table-editor-head\">\n        <tr>\n          <th> Id Name <div class=\"ids-copy-button ui-tip-target\" data-ui-tip-id=\"copy-ids\"></div> </th>\n          <th> Value </th>\n        </tr>\n      </thead>\n      <tbody class=\"table-editor-body\">\n      </tbody>\n    </table>\n  </div>\n  <div class=\"button-container\">\n    <button class=\"ok-button btn\"> Ok </button>\n  </div>\n  <!-- <button class=\"cancel-button btn\"> Cancel </button> -->\n\n</div>\n\n\n\n";
  });

this["JST"]["app/scripts/templates/navButtonsTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"page-buttons-container\">\n  \n  <div class=\"page-button-wrapper prev\">\n    <div class=\"page-button prev\"></div>\n  </div>\n  <div class=\"fake-project-filler\">\n  </div>\n  <div class=\"page-button-wrapper next\">\n    <div class=\"page-button next\"></div>\n  </div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/pageTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class='canvas-container'>\n  <div class='layout-guides-container'>\n  </div>\n</div>\n\n<ul class='gridster' id='gridster-"
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "'>\n</ul>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/pageThumbTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class='index-container'> 1. </div>\n<div class='thumb-container'>\n  <div class='page-thumb-canvas'>\n  </div>\n</div>\n<div class='label-container'>\n  <input class='page-label-editable'></input>\n</div>\n<div class='delete-button disabled ui-tip-target' data-ui-tip-id=\"page-remove\"></div>\n";
  });

this["JST"]["app/scripts/templates/smoothElementView.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/List.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/VisualizersList.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/barChart.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/downloadButtons.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"download-menu\">\n  <canvas class=\"cover\"/>\n  <div class=\"button-container\">\n    <div class=\"text\">\n      Save this image as:\n    </div>\n    <div class=\"button svg\">\n      SVG\n    </div>\n    <div class=\"button png\">\n      PNG\n    </div>\n  </div>\n</div>\n";
  });

this["JST"]["app/scripts/templates/visualizers/empty.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/lineChart.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n";
  });

this["JST"]["app/scripts/templates/visualizers/linkControl.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/network.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/pieChart.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/playPauseButton.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<div class=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "-btn control-btn\" data-id=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "\">\n  <img class=\"svg-control-icon\" src=\"./images/control_parts/animator_icons_"
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + ".svg\"></img>\n  <div class=\"control-label hidden\">"
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "</div>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/pointsInAMap.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/rectangle.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "\n";
  });

this["JST"]["app/scripts/templates/visualizers/scatterPlot.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/shareButton.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<a class=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "-btn control-btn\" data-id=\""
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "\" target=\"_blank\">\n  <div class=\"circle\"/>\n  <div class=\"svg-container "
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + "-container default\">\n    <img class=\"svg-control-icon\" src=\"./images/control_parts/share_"
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))
    + ".svg\"></img>\n  </div>\n</a>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/stackedBarChart.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/stacksOnTime.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<p>Your content here.</p>\n\n";
  });

this["JST"]["app/scripts/templates/visualizers/textArea.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"quill-container\"></div>\n<div class=\"fake-container ql-container\"></div>\n";
  });

this["JST"]["app/scripts/templates/visualizers/tooltipBody.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, options, functionType="function", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;

function program1(depth0,data) {
  
  
  return " display:none ";
  }

function program3(depth0,data,depth1) {
  
  var buffer = "", stack1, stack2;
  buffer += "\n    <div class='tooltip-body-id-entry'>\n      <div class='tooltip-body-item-id' style='font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth1.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth1.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";'>";
  if (stack2 = helpers.item) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.item; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n    </div>\n  ";
  return buffer;
  }

function program5(depth0,data,depth1) {
  
  var buffer = "", stack1;
  buffer += "\n    ";
  stack1 = helpers['if'].call(depth0, depth0.value, {hash:{},inverse:self.noop,fn:self.programWithDepth(6, program6, data, depth1),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n  ";
  return buffer;
  }
function program6(depth0,data,depth2) {
  
  var buffer = "", stack1, stack2;
  buffer += "\n      <div class='tooltip-body-value-entry'    style=\"color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";font-weight:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontWeight)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";font-style:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontStyle)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; \">\n        <div class='tooltip-body-value-entry-main'>\n          <div class='tooltip-body-value-entry-label tooltip-body-value-entry-item' style='line-height:normal;";
  stack2 = helpers['if'].call(depth0, ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.label), {hash:{},inverse:self.programWithDepth(9, program9, data, depth2),fn:self.programWithDepth(7, program7, data, depth2),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "  '>";
  if (stack2 = helpers.label) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.label; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n          ";
  stack2 = helpers['if'].call(depth0, depth0.prefix, {hash:{},inverse:self.noop,fn:self.program(11, program11, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n          <div class='tooltip-body-value-entry tooltip-body-value-entry-item' style='line-height:normal;'>";
  if (stack2 = helpers.value) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.value; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n          ";
  stack2 = helpers['if'].call(depth0, depth0.sufix, {hash:{},inverse:self.noop,fn:self.program(13, program13, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n        </div>\n      </div>\n    ";
  return buffer;
  }
function program7(depth0,data,depth3) {
  
  var buffer = "", stack1;
  buffer += " font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.label)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";  font-weight:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.label)),stack1 == null || stack1 === false ? stack1 : stack1.fontWeight)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; font-style:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.label)),stack1 == null || stack1 === false ? stack1 : stack1.fontStyle)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.label)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; ";
  return buffer;
  }

function program9(depth0,data,depth3) {
  
  var buffer = "", stack1;
  buffer += "font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";";
  return buffer;
  }

function program11(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n            <div class='tooltip-body-value-entry-prefix tooltip-body-value-entry-item' style='line-height:normal;'>";
  if (stack1 = helpers.prefix) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.prefix; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</div>\n          ";
  return buffer;
  }

function program13(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n            <div class='tooltip-body-value-entry-sufix tooltip-body-value-entry-item' style='line-height:normal;'>";
  if (stack1 = helpers.sufix) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.sufix; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</div>\n          ";
  return buffer;
  }

function program15(depth0,data) {
  
  var buffer = "", stack1, stack2;
  buffer += "\n    <div class='tooltip-body-description' style='font-family:"
    + escapeExpression(((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.fontFamily)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";line-height:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.lineHeight)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; background-color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.backgroundColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; font-style:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.fontStyle)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; font-weight:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.fontWeight)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";  color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; border-top:solid 1px; border-color: "
    + escapeExpression(((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.separatorColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "'>";
  if (stack2 = helpers.description) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.description; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n  ";
  return buffer;
  }

  buffer += "<div class='tooltip-body-content' style='font-family:"
    + escapeExpression(((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.fontFamily)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";background-color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.backgroundColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; border-top:solid 1px; border-color: "
    + escapeExpression(((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.separatorColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; ";
  options = {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data};
  stack2 = ((stack1 = helpers.if_empty || depth0.if_empty),stack1 ? stack1.call(depth0, depth0.value, options) : helperMissing.call(depth0, "if_empty", depth0.value, options));
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "' >\n  ";
  stack2 = helpers['if'].call(depth0, depth0.item, {hash:{},inverse:self.noop,fn:self.programWithDepth(3, program3, data, depth0),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n\n  ";
  stack2 = helpers.each.call(depth0, depth0.value, {hash:{},inverse:self.noop,fn:self.programWithDepth(5, program5, data, depth0),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n  </div>\n  ";
  stack2 = helpers['if'].call(depth0, depth0.description, {hash:{},inverse:self.noop,fn:self.program(15, program15, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/tooltipBody2.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data,depth1) {
  
  var buffer = "", stack1, stack2;
  buffer += "\n    <div class='tooltip-body-item-id' style='font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth1.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth1.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";'>";
  if (stack2 = helpers.item) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.item; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n  ";
  return buffer;
  }

function program3(depth0,data,depth1) {
  
  var buffer = "", stack1;
  buffer += "\n    ";
  stack1 = helpers['if'].call(depth0, depth0.value, {hash:{},inverse:self.noop,fn:self.programWithDepth(4, program4, data, depth1),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n  ";
  return buffer;
  }
function program4(depth0,data,depth2) {
  
  var buffer = "", stack1, stack2;
  buffer += "\n      <div class='tooltip-body-value-entry'    style=\"color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";font-weight:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontWeight)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";font-style:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontStyle)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; border-top:solid 1px; border-color: "
    + escapeExpression(((stack1 = ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.separatorColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n        <div class='tooltip-body-value-entry-main'>\n          <div class='tooltip-body-value-entry-label tooltip-body-value-entry-item' style='line-height:normal;";
  stack2 = helpers['if'].call(depth0, ((stack1 = depth2.style),stack1 == null || stack1 === false ? stack1 : stack1.label), {hash:{},inverse:self.programWithDepth(7, program7, data, depth2),fn:self.programWithDepth(5, program5, data, depth2),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "  '>";
  if (stack2 = helpers.label) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.label; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n          ";
  stack2 = helpers['if'].call(depth0, depth0.prefix, {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n          <div class='tooltip-body-value-entry tooltip-body-value-entry-item' style='line-height:normal;'>";
  if (stack2 = helpers.value) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.value; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n          ";
  stack2 = helpers['if'].call(depth0, depth0.sufix, {hash:{},inverse:self.noop,fn:self.program(11, program11, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n        </div>\n      </div>\n    ";
  return buffer;
  }
function program5(depth0,data,depth3) {
  
  var buffer = "", stack1;
  buffer += " font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.label)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";  font-weight:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.label)),stack1 == null || stack1 === false ? stack1 : stack1.fontWeight)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; font-style:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.label)),stack1 == null || stack1 === false ? stack1 : stack1.fontStyle)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.label)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; ";
  return buffer;
  }

function program7(depth0,data,depth3) {
  
  var buffer = "", stack1;
  buffer += "font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth3.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";";
  return buffer;
  }

function program9(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n            <div class='tooltip-body-value-entry-prefix tooltip-body-value-entry-item' style='line-height:normal;'>";
  if (stack1 = helpers.prefix) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.prefix; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</div>\n          ";
  return buffer;
  }

function program11(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n            <div class='tooltip-body-value-entry-sufix tooltip-body-value-entry-item' style='line-height:normal;'>";
  if (stack1 = helpers.sufix) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.sufix; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "</div>\n          ";
  return buffer;
  }

function program13(depth0,data) {
  
  var buffer = "", stack1, stack2;
  buffer += "\n    <div class='tooltip-body-description' style='font-family:"
    + escapeExpression(((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.fontFamily)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";line-height:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.lineHeight)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; background-color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.backgroundColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; font-size:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.fontSize)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; font-style:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.fontStyle)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; font-weight:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.fontWeight)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";  color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.description)),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; border-top:solid 1px; border-color: "
    + escapeExpression(((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.separatorColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "'>";
  if (stack2 = helpers.description2) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.description2; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n  ";
  return buffer;
  }

  buffer += "<div class='tooltip-body-content' style='font-family:"
    + escapeExpression(((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.fontFamily)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";background-color:"
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.style),stack1 == null || stack1 === false ? stack1 : stack1.value)),stack1 == null || stack1 === false ? stack1 : stack1.backgroundColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + ";' >\n  ";
  stack2 = helpers['if'].call(depth0, depth0.item, {hash:{},inverse:self.noop,fn:self.programWithDepth(1, program1, data, depth0),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n\n  ";
  stack2 = helpers.each.call(depth0, depth0.value2, {hash:{},inverse:self.noop,fn:self.programWithDepth(3, program3, data, depth0),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n  </div>\n  ";
  stack2 = helpers['if'].call(depth0, depth0.description2, {hash:{},inverse:self.noop,fn:self.program(13, program13, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/tooltipTitle.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n      <div class='tooltip-title-image' style=\"background-image:url('";
  if (stack1 = helpers.image) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.image; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "') ";
  if (stack1 = helpers.imagecss) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.imagecss; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "\"></div>\n  ";
  return buffer;
  }

function program3(depth0,data) {
  
  var buffer = "", stack1;
  buffer += " font-weight:";
  if (stack1 = helpers.fontWeight) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.fontWeight; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1);
  return buffer;
  }

  buffer += "<div class='tooltip-title-background' style=\"background-color:"
    + escapeExpression(((stack1 = ((stack1 = depth0.titleStyle),stack1 == null || stack1 === false ? stack1 : stack1.backgroundColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; color:"
    + escapeExpression(((stack1 = ((stack1 = depth0.titleStyle),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n  ";
  stack2 = helpers['if'].call(depth0, depth0.image, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n  <div class='tooltip-title-content' style='font-size:";
  if (stack2 = helpers.fontSize) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.fontSize; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "; font-style:";
  if (stack2 = helpers.fontStyle) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.fontStyle; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "; line-height:normal; font-family:";
  if (stack2 = helpers.fontFamily) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.fontFamily; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "; ";
  stack2 = helpers['if'].call(depth0, depth0.fontWeight, {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += " '>";
  if (stack2 = helpers.title) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.title; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/tooltipTitle2.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, stack2, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n      <div class='tooltip-title-image' style=\"background-image:url('";
  if (stack1 = helpers.image) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.image; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "')\"></div>\n  ";
  return buffer;
  }

function program3(depth0,data) {
  
  var buffer = "", stack1;
  buffer += " font-weight:";
  if (stack1 = helpers.fontWeight) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.fontWeight; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1);
  return buffer;
  }

  buffer += "<div class='tooltip-title-background' style=\"background-color:"
    + escapeExpression(((stack1 = ((stack1 = depth0.titleStyle),stack1 == null || stack1 === false ? stack1 : stack1.backgroundColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "; color:"
    + escapeExpression(((stack1 = ((stack1 = depth0.titleStyle),stack1 == null || stack1 === false ? stack1 : stack1.textColor)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "\">\n  ";
  stack2 = helpers['if'].call(depth0, depth0.image, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += "\n  <div class='tooltip-title-content' style='font-size:";
  if (stack2 = helpers.fontSize) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.fontSize; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "; font-style:";
  if (stack2 = helpers.fontStyle) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.fontStyle; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "; line-height:normal; font-family:";
  if (stack2 = helpers.fontFamily) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.fontFamily; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "; ";
  stack2 = helpers['if'].call(depth0, depth0.fontWeight, {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += " '>";
  if (stack2 = helpers.title) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.title; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + "</div>\n</div>";
  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/treemap.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/visualizer.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/visualizerContainer.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression;


  buffer += "<!-- <div class=\"context-menu\">\n  <p class=\"viz-name\">"
    + escapeExpression(((stack1 = ((stack1 = depth0.model),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + "</p>\n</div> -->\n\n<div class=\"commands-container\">\n  \n  \n  <div class=\"delete-viz-button command-viz-button ui-tip-target\" data-ui-tip-id=\"delete-viz-button\"></div>\n  <div class=\"output-viz-button command-viz-button ui-tip-target\" data-ui-tip-id=\"output-viz-button\"></div>\n  <!-- <div class=\"print-viz-button command-viz-button ui-tip-target\" data-ui-tip-id=\"print-viz-button\"></div> -->\n  <div class=\"download-viz-button command-viz-button ui-tip-target\" data-ui-tip-id=\"download-viz-button\"></div>\n</div>\n<div class=\"viz-view-gridster\"></div>\n<div class=\"viz-view-container\"></div>\n<div class=\"viz-label-container\">\n  <div class=\"viz-label-centering\">\n    <div class=\"viz-label\"></div>\n  </div>\n</div>\n<div class=\"size-feedback-container\">\n  <div class=\"size-feedback\"></div>\n</div>\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/visualizers/visualizerMessage.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "", stack1, functionType="function", escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n      <div class=\"viz-loading-square collapsed\">\n        <img class=\"viz-loader-animation\" src=\"images/FinalLoader-2_2.gif\"/>\n        <div class=\"viz-loader-message under-gif\" style=\"color:";
  if (stack1 = helpers.messageColor) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.messageColor; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + ";background-color:rgba(255,255,255,";
  if (stack1 = helpers.opacityBox) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.opacityBox; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + ");\">";
  if (stack1 = helpers.message) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.message; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "<div>\n      </div>\n      \n      \n    ";
  return buffer;
  }

function program3(depth0,data) {
  
  var buffer = "", stack1;
  buffer += "\n      <div class=\"onlytext-loader-message viz-loader-message\" style=\"color:";
  if (stack1 = helpers.messageColor) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.messageColor; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + ";background-color:rgba(255,255,255,";
  if (stack1 = helpers.opacityBox) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.opacityBox; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + ");\">";
  if (stack1 = helpers.message) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.message; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + "<div>\n    ";
  return buffer;
  }

  buffer += "<div class=\"message-container\">\n  <div class=\"viz-loader\" style=\"background-color:rgba(255,255,255,";
  if (stack1 = helpers.backgroundOpacity) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.backgroundOpacity; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + ")\">\n    ";
  stack1 = helpers['if'].call(depth0, depth0.loaderGif, {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});
  if(stack1 || stack1 === 0) { buffer += stack1; }
  buffer += "\n    \n  </div>\n</div>\n\n";
  return buffer;
  });

this["JST"]["app/scripts/templates/vizThumbTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = "";


  return buffer;
  });

this["JST"]["app/scripts/templates/watermarkTemplate.hbs"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,'>= 1.0.0'];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  


  return "<div class=\"watermark-container\">\n  <div class=\"watermark\">\n    <div class=\"watermark-logo\">\n    </div>\n  </div>\n</div>";
  });
(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Tracker = (function() {
    function Tracker() {
      this._sendEventData = __bind(this._sendEventData, this);
      this.sendEvent = __bind(this.sendEvent, this);
      this.currentStack = [];
      this.debouncedSend = _.throttle(this._sendEventData, 15000, {
        leading: false
      });
    }

    Tracker.prototype.sendEvent = function(e) {
      var exception;
      if (quadrigram.environment === "exported") {
        return;
      }
      this.currentStack.push(e);
      e.browser_info = navigator.userAgent;
      e.version = quadrigram.version;
      try {
        if ((e.client_data != null) && JSON.stringify(e.client_data).length > 10000) {
          e.client_data = JSON.stringify(e.client_data).substring(0, 10000);
        }
        if ((e.error_data != null) && JSON.stringify(e.error_data).length > 5000) {
          e.error_data = JSON.stringify(e.error_data).substring(0, 5000);
        }
      } catch (_error) {
        exception = _error;
        e.client_data = null;
        e.error_data = null;
      }
      return this.debouncedSend();
    };

    Tracker.prototype._sendEventData = function() {
      $.ajax({
        type: "POST",
        url: quadrigram.baseUrl + "rs/logtrace",
        data: JSON.stringify(this.currentStack),
        dataType: "text",
        contentType: "application/json; charset=utf-8"
      });
      return this.currentStack = [];
    };

    return Tracker;

  })();

}).call(this);

(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.MilestoneTracker = (function() {
    function MilestoneTracker() {
      this.sendGAEvent = __bind(this.sendGAEvent, this);
      this.trackMilestone = __bind(this.trackMilestone, this);
    }

    MilestoneTracker.prototype.trackMilestone = function(category, action) {
      return this.sendGAEvent(category, action);
    };

    MilestoneTracker.prototype.sendGAEvent = function(category, action, label, value) {
      return ga('send', 'event', category, action);
    };

    return MilestoneTracker;

  })();

}).call(this);

(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.AchievementTracker = (function() {
    AchievementTracker.prototype.currentDict = {};

    function AchievementTracker() {
      this.getNotificationState = __bind(this.getNotificationState, this);
      this.toggleNotifications = __bind(this.toggleNotifications, this);
      this.checkBlockDimension = __bind(this.checkBlockDimension, this);
      this.checkSlotProp = __bind(this.checkSlotProp, this);
      this.checkBlockProp = __bind(this.checkBlockProp, this);
      this.checkUseViz = __bind(this.checkUseViz, this);
      this.checkBlockInSlot = __bind(this.checkBlockInSlot, this);
      this.trackDirectAction = __bind(this.trackDirectAction, this);
      this.dispatchAchieventUnlocked = __bind(this.dispatchAchieventUnlocked, this);
      this.storeAchievemnt = __bind(this.storeAchievemnt, this);
      this.trackAchievement = __bind(this.trackAchievement, this);
      this.getDefs = __bind(this.getDefs, this);
      var _this = this;
      this.getDefs();
      quadrigram.clearAchievements = function() {
        return quadrigram.router.dataModels.achievementsModel.clearAll();
      };
    }

    AchievementTracker.prototype.getDefs = function() {
      var _this = this;
      return $.getJSON("./scripts/managers/achievementDefs.json", null, function(data) {
        return _this.achievementDefs = data.achievementDefs;
      });
    };

    AchievementTracker.prototype.trackAchievement = function(adef, stepIndex) {
      var i, result, s, _base, _i, _len, _name, _ref;
      if (adef.steps.length === 1) {
        log("::ACHIEVEMENT UNLOKCED::", adef.id);
        return this.storeAchievemnt(adef);
      } else {
        (_base = this.currentDict)[_name = adef.id] || (_base[_name] = []);
        this.currentDict[adef.id][stepIndex] = true;
        result = true;
        _ref = adef.steps;
        for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
          s = _ref[i];
          result = result && this.currentDict[adef.id][i];
        }
        if (result) {
          log("::ACHIEVEMENT UNLOKCED::", adef.id);
          return this.storeAchievemnt(adef);
        } else {
          return log("::ACHIEVEMENT STEP::", adef.id, ":", stepIndex);
        }
      }
    };

    AchievementTracker.prototype.storeAchievemnt = function(adef) {
      var autoOpenHelp, showNotification;
      autoOpenHelp = quadrigram.router.dataModels.achievementsModel.checkAutoOpen(adef);
      showNotification = quadrigram.router.dataModels.achievementsModel.checkAndStore(adef);
      if (showNotification) {
        this.dispatchAchieventUnlocked(adef);
      }
      if (autoOpenHelp) {
        return quadrigram.router.appViews.uiView.helpPopup.loadContentById("loadData");
      }
    };

    AchievementTracker.prototype.dispatchAchieventUnlocked = function(adef) {
      return quadrigram.router.appViews.headerView.achievementsView.showAchievement(adef);
    };

    AchievementTracker.prototype.trackDirectAction = function(action) {
      var adef, step, stepIndex, _i, _len, _ref, _results;
      if (this.achievementDefs == null) {
        return;
      }
      _ref = this.achievementDefs;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        adef = _ref[_i];
        _results.push((function() {
          var _j, _len1, _ref1, _results1;
          _ref1 = adef.steps;
          _results1 = [];
          for (stepIndex = _j = 0, _len1 = _ref1.length; _j < _len1; stepIndex = ++_j) {
            step = _ref1[stepIndex];
            if (step.type === "directAction" && step.actionProps.action === action) {
              _results1.push(this.trackAchievement(adef, stepIndex));
            } else {
              _results1.push(void 0);
            }
          }
          return _results1;
        }).call(this));
      }
      return _results;
    };

    AchievementTracker.prototype.checkBlockInSlot = function(block, slot) {
      var adef, propId, propValues, result, step, stepIndex, _i, _j, _len, _len1, _ref, _ref1, _ref2, _ref3;
      if (this.achievementDefs == null) {
        return;
      }
      _ref = this.achievementDefs;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        adef = _ref[_i];
        _ref1 = adef.steps;
        for (stepIndex = _j = 0, _len1 = _ref1.length; _j < _len1; stepIndex = ++_j) {
          step = _ref1[stepIndex];
          if (step.type === "blockInSlot") {
            result = true;
            if (step.blockProps != null) {
              _ref2 = step.blockProps;
              for (propId in _ref2) {
                propValues = _ref2[propId];
                result = this.checkBlockProp(block, propId, propValues) && result;
              }
            }
            if (step.slotProps != null) {
              _ref3 = step.slotProps;
              for (propId in _ref3) {
                propValues = _ref3[propId];
                result = this.checkSlotProp(slot, propId, propValues) && result;
              }
            }
            if (result) {
              this.trackAchievement(adef, stepIndex);
            }
          }
        }
      }
    };

    AchievementTracker.prototype.checkUseViz = function(viz) {
      var adef, result, step, stepIndex, _i, _j, _len, _len1, _ref, _ref1;
      if (this.achievementDefs == null) {
        return;
      }
      _ref = this.achievementDefs;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        adef = _ref[_i];
        _ref1 = adef.steps;
        for (stepIndex = _j = 0, _len1 = _ref1.length; _j < _len1; stepIndex = ++_j) {
          step = _ref1[stepIndex];
          if (step.type === "useViz") {
            result = step.vizProps.vizType.length === 0 || step.vizProps.vizType.indexOf(viz.get("type")) >= 0;
            if (result) {
              this.trackAchievement(adef, stepIndex);
            }
          }
        }
      }
    };

    AchievementTracker.prototype.checkBlockProp = function(block, prop, values) {
      var fn, val, _i, _len,
        _this = this;
      if (!values || values.length === 0) {
        return true;
      }
      switch (prop) {
        case "type":
          fn = function(block, value) {
            return block instanceof value;
          };
          break;
        case "role":
          fn = function(block, value) {
            return block.get("role") === value;
          };
          break;
        case "origin":
          fn = function(block, value) {
            return block.get("origin") === value;
          };
          break;
        case "vizType":
          fn = function(block, value) {
            return (block.get("blockGroup") != null) && (block.get("blockGroup").get("ownerViz") != null) && block.get("blockGroup").get("ownerViz").get("type") === value;
          };
          break;
        case "dimension":
          fn = function(block, value) {
            return _this.checkBlockDimension(block, value);
          };
      }
      for (_i = 0, _len = values.length; _i < _len; _i++) {
        val = values[_i];
        if (fn(block, val)) {
          return true;
        }
      }
      return false;
    };

    AchievementTracker.prototype.checkSlotProp = function(slot, prop, values) {
      var fn, val, _i, _len;
      if (!values || values.length === 0) {
        return true;
      }
      switch (prop) {
        case "slotId":
          fn = function(slot, value) {
            return slot.get("slotId") === value;
          };
          break;
        case "propId":
          fn = function(slot, value) {
            return (slot.get("ownerSlotGroup") != null) && slot.get("ownerSlotGroup").get("propId") === value;
          };
          break;
        case "vizType":
          fn = function(slot, value) {
            return (slot.get("ownerSlotGroup") != null) && (slot.get("ownerSlotGroup").get("ownerViz") != null) && slot.get("ownerSlotGroup").get("ownerViz").get("type") === value;
          };
      }
      for (_i = 0, _len = values.length; _i < _len; _i++) {
        val = values[_i];
        if (fn(slot, val)) {
          return true;
        }
      }
      return false;
    };

    AchievementTracker.prototype.checkBlockDimension = function(block, dim) {
      log("is this block", block, "of dimension", dim, "?");
      if (dim === 0) {
        if (block.get("data").length > 1) {
          return false;
        }
      }
      if (dim === 1) {
        if (!(block.get("data").length > 1)) {
          return false;
        } else {
          if ((block.get("data")[0].value == null) || block.get("data")[0].value === "") {
            return false;
          }
        }
      }
      if (dim === 2) {
        if (block.get("data")[0].value.get == null) {
          return false;
        }
      }
      return true;
    };

    AchievementTracker.prototype.toggleNotifications = function(value) {
      var result;
      result = quadrigram.router.dataModels.achievementsModel.toggleNotifications(value);
      quadrigram.router.appViews.headerView.updateNotificationsButton();
      return result;
    };

    AchievementTracker.prototype.getNotificationState = function() {
      return quadrigram.router.dataModels.achievementsModel.getNotificationState();
    };

    return AchievementTracker;

  })();

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Managers.PerformanceManager = (function() {
    PerformanceManager.prototype.stack = [];

    function PerformanceManager() {
      this.getStepsWithTag = __bind(this.getStepsWithTag, this);
      this.trackStep = __bind(this.trackStep, this);
      this.startTime = new Date();
      this.stack = [];
    }

    PerformanceManager.prototype.trackStep = function(stepTitle, stepTags, stepExtraInfo) {
      var eventInfo;
      this.eventTime = new Date();
      eventInfo = {};
      eventInfo.timeSinceStart = this.eventTime.getTime() - this.startTime.getTime();
      eventInfo.stamp = this.eventTime;
      eventInfo.title = stepTitle;
      eventInfo.tags = stepTags;
      eventInfo.extraInfo = stepExtraInfo;
      return this.stack.push(eventInfo);
    };

    PerformanceManager.prototype.getStepsWithTag = function(tag) {
      var output,
        _this = this;
      output = _.filter(this.stack, function(stackEntry) {
        return stackEntry.tags.indexOf(tag) !== -1;
      });
      return output;
    };

    return PerformanceManager;

  })();

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Managers.ServerManager = (function() {
    function ServerManager() {
      this.acceptTos = __bind(this.acceptTos, this);
      this.getImageUrl = __bind(this.getImageUrl, this);
      this.getExportUrl = __bind(this.getExportUrl, this);
      this.fetchFileFromURL = __bind(this.fetchFileFromURL, this);
      this.fetchFile = __bind(this.fetchFile, this);
      this.getResourceConfig = __bind(this.getResourceConfig, this);
      this.logout = __bind(this.logout, this);
      this.onPickerCallback = __bind(this.onPickerCallback, this);
      this.deleteFile = __bind(this.deleteFile, this);
      this.saveAsCurrentProject = __bind(this.saveAsCurrentProject, this);
      this.renameCurrentProject = __bind(this.renameCurrentProject, this);
      this.deleteProject = __bind(this.deleteProject, this);
      this.shareProject = __bind(this.shareProject, this);
      this.getProjectsList = __bind(this.getProjectsList, this);
      this.getResourcesList = __bind(this.getResourcesList, this);
      this.createPicker = __bind(this.createPicker, this);
    }

    ServerManager.prototype.createPicker = function() {
      return quadrigram.router.appViews.uiView.showFilePicker(this.onPickerCallback);
    };

    ServerManager.prototype.getResourcesList = function() {
      var resList;
      resList = new quadrigram.Collections.metaResourceCollection();
      return resList;
    };

    ServerManager.prototype.getProjectsList = function() {
      var projectsList;
      projectsList = new quadrigram.Collections.metaProjectCollection();
      return projectsList;
    };

    ServerManager.prototype.shareProject = function(mails, projectId) {
      var mailJSON, shareUrl;
      log("ServerManager,id", mails, projectId);
      mailJSON = JSON.stringify(mails);
      shareUrl = quadrigram.baseUrl + "rs/google/share/" + projectId;
      return $.ajax({
        url: shareUrl,
        contentType: "application/json",
        type: 'POST',
        data: mailJSON
      });
    };

    ServerManager.prototype.deleteProject = function(metadata, callback, errorCallback) {
      var deleteUrl;
      deleteUrl = quadrigram.baseUrl + "rs/google/project/" + metadata.id;
      return $.ajax({
        url: deleteUrl,
        type: 'DELETE',
        success: callback,
        error: errorCallback
      });
    };

    ServerManager.prototype.renameCurrentProject = function(newName) {
      var renameUrl;
      renameUrl = quadrigram.baseUrl + "rs/google/project/" + quadrigram.router.dataModels.currentProject.get("id");
      return $.ajax({
        url: renameUrl,
        type: 'PUT',
        headers: {
          'pname': newName
        }
      });
    };

    ServerManager.prototype.saveAsCurrentProject = function(newName) {
      quadrigram.router.dataModels.currentProject.unset("id");
      return quadrigram.router.dataModels.currentProject.requestSave();
    };

    ServerManager.prototype.deleteFile = function(metadata, callback, errorCallback) {
      var deleteUrl;
      deleteUrl = quadrigram.baseUrl + "rs/google/resource/" + metadata.id;
      return $.ajax({
        url: deleteUrl,
        type: 'DELETE',
        success: callback,
        error: errorCallback
      });
    };

    ServerManager.prototype.onPickerCallback = function(metadata) {
      return quadrigram.router.dataModels.currentProject.createExternalGroup(metadata);
    };

    ServerManager.prototype.logout = function() {
      var url,
        _this = this;
      url = quadrigram.userUrl + "logout";
      return $.getJSON(url, function(data) {}).done(function() {
        return window.location.href = quadrigram.webUrl;
      }).fail(function(error) {
        return window.location.href = quadrigram.webUrl;
      });
    };

    ServerManager.prototype.getResourceConfig = function() {
      var _this = this;
      if (this.resourcesConfig == null) {
        this.resourcesConfig = new Backbone.Model;
        this.resourcesConfig.url = "data/resourcesconf.json";
        this.resourcesConfig.fetch();
        this.resourcesConfig.on("change", function() {
          return _this.resourcesConfig.trigger("ready");
        });
      } else if (this.resourcesConfig.get("resourceList") != null) {
        _.defer(function() {
          return _this.resourcesConfig.trigger("ready");
        });
      }
      return this.resourcesConfig;
    };

    ServerManager.prototype.fetchFile = function(rid, id, callback) {
      var url,
        _this = this;
      if (quadrigram.environment === "editor") {
        url = quadrigram.baseUrl + "rs/google/resource/" + rid;
        return this.fetchFileFromURL(rid, url, callback);
      } else {
        this.resourcesConfig = this.getResourceConfig();
        return this.resourcesConfig.on("ready", function() {
          var resource, resourceCandidates;
          resourceCandidates = $.grep(_this.resourcesConfig.get("resourceList"), function(res) {
            if (res.exportedProvider !== "local") {
              return res.id === rid;
            } else {
              return res.id === id;
            }
          });
          if (resourceCandidates.length < 1) {
            elog("resource not found!!!!");
          } else {
            resource = resourceCandidates[0];
          }
          if (resource.exportedProvider !== "local") {
            url = resource.filePath;
            return _this.fetchFileFromURL(rid, url, callback);
          } else {
            url = resource.filePath;
            return $.ajax({
              dataType: "json",
              url: url,
              cache: true,
              success: function(data, status) {
                var responseObject;
                responseObject = {
                  providerName: "local",
                  rid: rid,
                  id: id,
                  status: status
                };
                responseObject.data = _.findWhere(data.data, {
                  "id": id
                });
                return callback(responseObject);
              }
            });
            /*
            $.getJSON(url,(data,status)->
              responseObject = {providerName:"local", rid:rid, status:status}
              responseObject.data = _.findWhere(data.data,{"rid":rid})
              callback(responseObject)
            )
            */

          }
        });
      }
    };

    ServerManager.prototype.fetchFileFromURL = function(rid, url, callback) {
      var oReq,
        _this = this;
      oReq = new XMLHttpRequest();
      oReq.open('GET', url, true);
      oReq.withCredentials = true;
      oReq.responseType = "arraybuffer";
      oReq.onload = function() {
        var responseObject;
        responseObject = {
          providerName: "google",
          rid: rid,
          mimeType: this.getResponseHeader('content-type'),
          data: oReq.response,
          status: this.status
        };
        return callback(responseObject);
      };
      oReq.onreadystatechange = function() {
        if (this.status !== 200 && (this.error == null)) {
          elog("Error receiving file");
          return this.error = 1;
        }
      };
      oReq.onerror = function() {
        var responseObject;
        elog("Error receiving file");
        responseObject = {
          providerName: "google",
          rid: rid,
          mimeType: _this.getResponseHeader('content-type'),
          data: oReq.response,
          status: _this.status
        };
        return callback(responseObject);
      };
      return oReq.send();
    };

    /*
    #CREO QUE YA NO HACE FALTA NADA DE ESO, sino, debe ir en UI.coffe: showExportOptions
    requestExportWindow:()=>
      
      if (quadrigram.router.dataModels.currentProject.get("id"))
        _.defer(()=>
          win = window.open(quadrigram.webUrl+"#export/"+quadrigram.router.dataModels.currentProject.get("id"), '_blank')
        )  
        quadrigram.router.saveCurrentProject()
      else
        quadrigram.router.appViews.loaderView.trigger("loaderMessage","Give your project a name before publishing it")
        _.delay(() =>
          quadrigram.router.appViews.loaderView.hide()
        ,2000)
        quadrigram.router.saveCurrentProject()
    */


    ServerManager.prototype.getExportUrl = function(type) {
      var url;
      switch (type) {
        case "web":
          url = quadrigram.webUserUrl + '#publish-website/' + quadrigram.router.dataModels.currentProject.get("id");
          break;
        case "embed":
          url = quadrigram.webUserUrl + '#publish-embed/' + quadrigram.router.dataModels.currentProject.get("id");
          break;
        case "zip":
          url = quadrigram.webUserUrl + '#publish-download/' + quadrigram.router.dataModels.currentProject.get("id");
      }
      return url;
    };

    ServerManager.prototype.getImageUrl = function(rid, callback) {
      var _this = this;
      if (rid.indexOf("http") >= 0 || rid === "") {
        callback(rid);
        return;
      }
      if (quadrigram.environment === "editor") {
        callback("https://docs.google.com/uc?id=" + rid + "&export=view");
      } else {
        this.resourcesConfig = this.getResourceConfig();
        this.resourcesConfig.on("ready", function() {
          var resource, resourceCandidates, url;
          resourceCandidates = $.grep(_this.resourcesConfig.get("resourceList"), function(res) {
            return res.id === rid;
          });
          if (resourceCandidates.length < 1) {
            elog("local image not found!, tryig public url...");
            return callback("https://docs.google.com/uc?id=" + rid + "&export=view");
          } else {
            resource = resourceCandidates[0];
            url = resource.filePath;
            return callback(url);
          }
        });
      }
    };

    ServerManager.prototype.acceptTos = function() {
      quadrigram.router.dataModels.user.set("termsSigned", 1);
      return quadrigram.router.dataModels.user.save();
    };

    return ServerManager;

  })();

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Managers.ToolTipManager = (function() {
    ToolTipManager.listStyles = function() {
      var temp;
      temp = new quadrigram.Managers.ToolTipManager();
      return temp.listStyles();
    };

    ToolTipManager.prototype.styles = {
      "Avocado": {
        name: "Avocado",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#a8a927"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#cddc39",
          textColor: "#555555",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#f4ff7f",
            textColor: "#555555",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#555555",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#cddc39",
            textColor: "#555555",
            fontStyle: "Bold"
          }
        }
      },
      "Bluths Original": {
        name: "Bluths Original",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#ffd600"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#ffeb00",
          textColor: "#555555",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#ffd600",
            textColor: "#555555",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#555555",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#ffeb00",
            textColor: "#555555",
            fontStyle: "Bold"
          }
        }
      },
      "Brixton": {
        name: "Brixton",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#444444"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#e0e0e0",
          textColor: "#444444",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#eeeeee",
            textColor: "#444444",
            fontStyle: "Bold"
          },
          label: {
            fontSize: "12px",
            textColor: "#444444",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "18px",
            backgroundColor: "#fafafa",
            textColor: "#444444",
            fontStyle: "Regular"
          }
        }
      },
      "Brownie": {
        name: "Brownie",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "0px",
          color: "#a8a927"
        },
        roundedCorner: "5px",
        separatorColor: "transparent",
        title: {
          fontSize: "18px",
          backgroundColor: "#5d4038",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#a0887e",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#5d4038",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Bubbles": {
        name: "Bubbles",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "0px",
          color: "#c9e6ca"
        },
        roundedCorner: "5px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#b2dfdc",
          textColor: "#555555",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#c9e6ca",
            textColor: "#555555",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#555555",
            fontStyle: "Regular"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#ddedc8",
            textColor: "#555555",
            fontStyle: "Bold"
          }
        }
      },
      "Camo": {
        name: "Camo",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#1c5e20"
        },
        roundedCorner: "5px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#014d41",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#1c5e20",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#33691e",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Cherry Bomb": {
        name: "Cherry Bomb",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#d60000"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#ff1844",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#d60000",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#ff1844",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Clouds": {
        name: "Clouds",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#40adf0"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#efebe8",
          textColor: "#555555",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#0191ea",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#00affe",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Coal": {
        name: "Coal",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#2a373f"
        },
        roundedCorner: "5px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#546f7a",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#465a65",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#36474f",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Classic": {
        name: "Classic",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "0px",
          color: "none"
        },
        roundedCorner: "0px",
        separatorColor: "#dddddd",
        title: {
          fontSize: "14px",
          backgroundColor: "#2E307A",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#ffffff",
            textColor: "#2E307A",
            fontStyle: "Regular"
          },
          label: {
            fontSize: "12px",
            textColor: "#2E307A",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#ffffff",
            textColor: "#000",
            fontStyle: "Regular"
          }
        }
      },
      "Dark Matter": {
        name: "Dark Matter",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "0px",
          color: "#ffffff"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#231f20",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#1c1c1c",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#231f20",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Five 0": {
        name: "Five 0",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#1976d3"
        },
        roundedCorner: "5px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#1465c0",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#1976d3",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#1d89e4",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Financial": {
        name: "Financial",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#33691d"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#ddedc9",
          textColor: "#555555",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#f1f7e9",
            textColor: "#555555",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#555555",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#c5e1a6",
            textColor: "#555555",
            fontStyle: "Regular"
          }
        }
      },
      "Grapefruit": {
        name: "Grapefruit",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#ddba90"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#feb74d",
          textColor: "#555555",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#fdce80",
            textColor: "#555555",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#555555",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#ffe0b2",
            textColor: "#555555",
            fontStyle: "Bold"
          }
        }
      },
      "Green Tea": {
        name: "Green Tea",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "2px",
          color: "#dde776"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#aed582",
          textColor: "#555555",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#dde776",
            textColor: "#555555",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#555555",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#fff176",
            textColor: "#555555",
            fontStyle: "Bold"
          }
        }
      },
      "Greyscale Rounded": {
        name: "Greyscale Rounded",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#878787"
        },
        roundedCorner: "5px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#575757",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#3c3c3c",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#231f20",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Label Purple": {
        name: "Label Purple",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#3f51b5"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#ffffff",
          textColor: "#3f51b5",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#3f51b5",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#ffffff",
            textColor: "#3f51b5",
            fontStyle: "Bold"
          }
        }
      },
      "Lochness": {
        name: "Lochness",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#43a047"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#00695b",
          textColor: "#ffffff",
          fontStyle: "Bold"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#43a047",
            textColor: "#ffffff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#9ccc66",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Organic": {
        name: "Organic",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#5d8a49"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#ddedc8",
          textColor: "#424242",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#aed582",
            textColor: "#424242",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#424242",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#33691e",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      },
      "Sunburn": {
        name: "Sunburn",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#f09a9b"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#ffcdd2",
          textColor: "#555555",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#ee9a9a",
            textColor: "#555555",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#555555",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#e57373",
            textColor: "#555555",
            fontStyle: "Bold"
          }
        }
      },
      "Sunrise": {
        name: "Sunrise",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#ffd33f"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#ffea00",
          textColor: "#424242",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#fec400",
            textColor: "#424242",
            fontStyle: "Light"
          },
          label: {
            fontSize: "12px",
            textColor: "#424242",
            fontStyle: "Medium"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#ff9000",
            textColor: "#424242",
            fontStyle: "Bold"
          }
        }
      },
      "Swissmiss": {
        name: "Swissmiss",
        classes: "qtip-visualizer",
        fontFamily: "Roboto",
        border: {
          width: "1px",
          color: "#82b1ff"
        },
        roundedCorner: "0px",
        separatorColor: "transparent",
        title: {
          fontSize: "14px",
          backgroundColor: "#5d4038",
          textColor: "#ffffff",
          fontStyle: "Regular"
        },
        body: {
          value: {
            fontSize: "12px",
            backgroundColor: "#8c6e63",
            textColor: "#82b1ff",
            fontStyle: "Medium"
          },
          label: {
            fontSize: "12px",
            textColor: "#ffffff",
            fontStyle: "Light"
          },
          description: {
            fontSize: "10px",
            lineHeight: "normal",
            backgroundColor: "#a1897f",
            textColor: "#ffffff",
            fontStyle: "Regular"
          }
        }
      }
    };

    ToolTipManager.prototype.customProperties = {};

    function ToolTipManager(project, tooltipSettings) {
      this.resetCustomProperties = __bind(this.resetCustomProperties, this);
      this.getStyle = __bind(this.getStyle, this);
      this.listStyles = __bind(this.listStyles, this);
      this.changeStyle = __bind(this.changeStyle, this);
      this.setToolTipSettings = __bind(this.setToolTipSettings, this);
      _.extend(this, Backbone.Events);
      this.project = project;
      if (this.project == null) {
        return;
      }
      if (!this.project.get("tooltip-settings")) {
        this.changeStyle("Dark Matter", false);
      } else {
        this.setToolTipSettings(tooltipSettings);
      }
    }

    ToolTipManager.prototype.setToolTipSettings = function(tooltipSettings) {
      this.currentStyle = tooltipSettings.name;
      if (!tooltipSettings.body.value) {
        return this.setToolTipSettings(this.getStyle("default"));
      }
      if (this.project.get("tooltip-settings") !== tooltipSettings) {
        return this.project.set("tooltip-settings", tooltipSettings);
      }
    };

    ToolTipManager.prototype.changeStyle = function(styleName, resetProperties) {
      var newStyle;
      this.currentStyle = styleName;
      newStyle = this.styles[styleName];
      if (newStyle === void 0) {
        newStyle = this.styles["default"];
      }
      if (resetProperties) {
        this.customProperties = {};
      }
      newStyle.customProperties = this.customProperties;
      return this.project.set("tooltip-settings", newStyle);
    };

    ToolTipManager.prototype.listStyles = function() {
      return _.keys(this.styles);
    };

    ToolTipManager.prototype.getStyle = function(styleName) {
      return this.styles[styleName];
    };

    ToolTipManager.prototype.resetCustomProperties = function() {
      return this.changeStyle(this.currentStyle, true);
    };

    return ToolTipManager;

  }).call(this);

}).call(this);

(function() {
  'use strict';
  quadrigram.Managers.FormatManager = (function() {
    function FormatManager() {}

    FormatManager.prototype.formatDefinitions = {
      "Number": {
        "uiTipContent": "Simple number input",
        "label": "Numbers",
        "slots": [
          {
            "uiTipContent": "Number input",
            "id": "value",
            "label": "Value",
            "type": "number"
          }
        ]
      },
      "Px": {
        "uiTipContent": "Number of pixels",
        "label": "Pixels",
        "slots": [
          {
            "uiTipContent": "Pixels input",
            "id": "value",
            "label": "Value",
            "type": "number_px"
          }
        ]
      },
      "Boolean": {
        "uiTipContent": "Boolean input, can be Yes or No (true or false)",
        "label": "Yes or no",
        "slots": [
          {
            "uiTipContent": "Boolean input",
            "id": "value",
            "label": "Value",
            "type": "boolean"
          }
        ]
      },
      "Color": {
        "uiTipContent": "Select a color from the palette",
        "label": "Colors",
        "slots": [
          {
            "uiTipContent": "Click on the color preview to open the palette",
            "id": "value",
            "label": "Color",
            "type": "color"
          }
        ]
      },
      "Text": {
        "uiTipContent": "Text input",
        "label": "Text",
        "slots": [
          {
            "uiTipContent": "Type any text",
            "id": "value",
            "label": "String of text",
            "type": "text"
          }
        ]
      },
      "Percentage": {
        "label": "Percentage",
        "uiTipContent": "Percentge input for values between 0 and 100",
        "slots": [
          {
            "uiTipContent": "Type of select a percentage value",
            "id": "value",
            "label": "Value",
            "type": "percentage"
          }
        ]
      },
      "Options": {
        "label": "Options",
        "uiTipContent": "Options input",
        "slots": [
          {
            "uiTipContent": "Select one of the options",
            "id": "value",
            "label": "Value",
            "type": "options"
          }
        ]
      },
      "OptionsByCategories": {
        "label": "Options by category",
        "uiTipContent": "Maps a set of values into a set of options according to the defined categories",
        "slots": [
          {
            "uiTipContent": "Insert or edit a list that defines a category for each of the items",
            "id": "categories",
            "label": "Categories",
            "type": "Text"
          }, {
            "uiTipContent": "Edit or insert a list that assigns one color to each of the categories",
            "id": "catoptions",
            "label": "Options",
            "type": "options"
          }, {
            "uiTipContent": "Select a default color for items without a defined category or categories without a defined color",
            "id": "defaultOption",
            "label": "Default Option",
            "type": "options"
          }
        ]
      },
      "Date": {
        "label": "Date",
        "uiTipContent": "Date input",
        "slots": [
          {
            "uiTipContent": "Type a date or click on the icon to open the calendar",
            "id": "value",
            "label": "Value",
            "type": "date"
          }
        ]
      },
      "ColorsByValues": {
        "label": "Colors by value",
        "uiTipContent": "Maps diferent values to diferent colors",
        "slots": [
          {
            "uiTipContent": "Insert the values that represent the colors",
            "id": "values",
            "label": "Values",
            "type": "number"
          }, {
            "uiTipContent": "Select a color scale to map your values into. The lowest value will get the leftmost color and the hightest value the rightmost color",
            "id": "colorscale",
            "label": "Color Scale",
            "type": "colorscale"
          }, {
            "uiTipContent": "Select a default color for items without a defined value",
            "id": "defaultColor",
            "label": "Default Color",
            "type": "color"
          }
        ]
      },
      "PercentageByValues": {
        "label": "Percentages by value",
        "uiTipContent": "Maps a set of values into a range of percentages",
        "slots": [
          {
            "uiTipContent": "Insert the values that will be converted to percentages",
            "id": "values",
            "label": "Values",
            "type": "number"
          }, {
            "uiTipContent": "Select the percentage to assign to the minimum of the values",
            "id": "min",
            "label": "Minimum value",
            "type": "percentage"
          }, {
            "uiTipContent": "Select the percentage to assign to the maximum of the values",
            "id": "max",
            "label": "Maximum value",
            "type": "percentage"
          }
        ]
      },
      "ByValues": {
        "label": "Numbers by value",
        "uiTipContent": "Maps a set of values into a range of numbers",
        "slots": [
          {
            "uiTipContent": "Insert the values that will be converted to other numbers",
            "id": "values",
            "label": "Values",
            "type": "number"
          }, {
            "uiTipContent": "Type the number to assign to the minimum of the values",
            "id": "min",
            "label": "Minimum value",
            "type": "number"
          }, {
            "uiTipContent": "Type the number to assign to the maximum of the values",
            "id": "max",
            "label": "Maximum value",
            "type": "number"
          }
        ]
      },
      "PxByValues": {
        "label": "Pixels by value",
        "uiTipContent": "Maps a set of values into a range of pixel values",
        "slots": [
          {
            "uiTipContent": "Insert the values that will be converted to pixel values",
            "id": "values",
            "label": "Values",
            "type": "number"
          }, {
            "uiTipContent": "Type the number of pixels to assign to the minimum of the values",
            "id": "min",
            "label": "Minimum in px",
            "type": "number_px"
          }, {
            "uiTipContent": "Type the number of pixels to assign to the maximum of the values",
            "id": "max",
            "label": "Maximum in px",
            "type": "number_px"
          }
        ]
      },
      "PxByValuesAndDomain": {
        "label": "Pixels by value and domain",
        "uiTipContent": "Maps a set of values into a range of pixel values",
        "slots": [
          {
            "uiTipContent": "Insert the values that will be converted to pixel values",
            "id": "values",
            "label": "Values",
            "type": "number"
          }, {
            "uiTipContent": "Fix the minimum value. It is very useful if values are going to change dynamically",
            "id": "minValues",
            "label": "Minimum value",
            "type": "number"
          }, {
            "uiTipContent": "Fix the maximum value. It is very useful if values are going to change dynamically",
            "id": "maxValues",
            "label": "Maximum value",
            "type": "number"
          }, {
            "uiTipContent": "Type the number of pixels to assign to the minimum of the values",
            "id": "min",
            "label": "Minimum in px",
            "type": "number_px"
          }, {
            "uiTipContent": "Type the number of pixels to assign to the maximum of the values",
            "id": "max",
            "label": "Maximum in px",
            "type": "number_px"
          }
        ]
      },
      "PxRange": {
        "label": "Range of pixels",
        "uiTipContent": "Defines a range of pixels",
        "slots": [
          {
            "uiTipContent": "Type the number of pixels to assign to the minimum of the values",
            "id": "min",
            "label": "Minimum in px",
            "type": "number_px"
          }, {
            "uiTipContent": "Type the number of pixels to assign to the maximum of the values",
            "id": "max",
            "label": "Maximum in px",
            "type": "number_px"
          }
        ]
      },
      "ColorsByCategories": {
        "label": "Colors by category",
        "uiTipContent": "Maps a set of values into a set of colors according to the defined categories",
        "slots": [
          {
            "uiTipContent": "Insert or edit a list that defines a category for each of the items",
            "id": "categories",
            "label": "Categories",
            "type": "Text"
          }, {
            "uiTipContent": "Edit or insert a list that assigns one color to each of the categories",
            "id": "colors",
            "label": "Colors",
            "type": "color"
          }, {
            "uiTipContent": "Select a default color for items without a defined category or categories without a defined color",
            "id": "defaultColor",
            "label": "Default Color",
            "type": "color"
          }
        ]
      },
      "ColorsByScale": {
        "label": "Scale of colors",
        "uiTipContent": "Automatically assigns colors to the set of values",
        "slots": [
          {
            "uiTipContent": "Select a color scale to automatically map the values into",
            "id": "value",
            "label": "Color Scale",
            "type": "colorscale"
          }
        ]
      },
      "Rectangle": {
        "label": "Rectangle",
        "uiTipContent": "Rectangle input",
        "slots": [
          {
            "uiTipContent": "Define a rectangle (?)",
            "id": "value",
            "label": "Rectangle",
            "type": "noinput"
          }
        ]
      },
      "Place": {
        "label": "Places",
        "uiTipContent": "Place input defined by latitude and longitude",
        "slots": [
          {
            "uiTipContent": "Drop the latitude",
            "id": "lat",
            "label": "Latitude",
            "type": "Number"
          }, {
            "uiTipContent": "drop the longitude",
            "id": "lon",
            "label": "Longitude",
            "type": "Number"
          }
        ]
      },
      "PlaceUTM": {
        "label": "UTM Places",
        "uiTipContent": "Place input defined by latitude and longitude",
        "slots": [
          {
            "uiTipContent": "Drop the UTM-X coordinate",
            "id": "utmx",
            "label": "UTM X coordinate",
            "type": "Number"
          }, {
            "uiTipContent": "Drop the UTM-Y coordinate",
            "id": "utmy",
            "label": "UTM Y coordinate",
            "type": "Number"
          }, {
            "uiTipContent": "Drop the UTM Zone ",
            "id": "utmzone",
            "label": "UTM Zone",
            "type": "Number"
          }
        ]
      },
      "Network": {
        "label": "Nodes and relations",
        "uiTipContent": 'Network input defined by its nodes and relations. Learn more about networks <a href="http://www.quadrigram.com/help/#content/networks" target="_blank">here.</a>',
        "slots": [
          {
            "uiTipContent": "Drop nodes",
            "id": "nodes",
            "label": "Nodes",
            "type": "noinput"
          }, {
            "uiTipContent": "Drop relations",
            "id": "relations",
            "label": "Relations",
            "type": "noinput"
          }
        ]
      },
      "MapView": {
        "label": "Center and zoom",
        "uiTipContent": "Defines how to view a map",
        "slots": [
          {
            "uiTipContent": "Type the zoom level to control the scale of the map",
            "id": "zoom",
            "label": "Zoom",
            "type": "Number"
          }, {
            "uiTipContent": "Type the center of the map as two comma separated values: (latitude,longitude) (?)",
            "id": "center",
            "label": "Center",
            "type": "text"
          }
        ]
      },
      "JustDrop": {
        "label": "List of values",
        "uiTipContent": "Only accepts blocks",
        "slots": [
          {
            "uiTipContent": "Drag and drop a block here",
            "id": "value",
            "label": "Input",
            "type": "noinput"
          }
        ]
      },
      "PrefixSufix": {
        "label": "Prefix and sufix",
        "uiTipContent": "Adds prefixes and sufixes to a set of values. Useful for adding units to values.",
        "slots": [
          {
            "uiTipContent": "Insert a set of texts or numbers",
            "id": "label",
            "label": "Label",
            "type": "text"
          }, {
            "uiTipContent": "Insert a single text to be prefixed to all labels or a list of texts to be mapped",
            "id": "prefix",
            "label": "Prefix",
            "type": "text"
          }, {
            "uiTipContent": "Insert a single text to be sufixed to all labels or a list of texts to be mapped",
            "id": "sufix",
            "label": "Sufix",
            "type": "text"
          }
        ]
      },
      "Deactivated": {
        "label": "Deactivated",
        "uiTipContent": "Deactivates the property",
        "slots": []
      },
      "Transition": {
        "label": "Transition",
        "uiTipContent": "Defines a transition method",
        "slots": [
          {
            "uiTipContent": "Select the type of transition animation",
            "id": "easeType",
            "label": "Ease type of transition",
            "type": "options"
          }, {
            "uiTipContent": "Type the duration of the transition",
            "id": "time",
            "label": "Transition duration in Milliseconds",
            "type": "Number"
          }
        ]
      },
      "SimpleRange": {
        "label": "Range",
        "uiTipContent": "Defines a range with a min and max value",
        "slots": [
          {
            "uiTipContent": "Number input",
            "id": "min",
            "label": "Min",
            "type": "number"
          }, {
            "uiTipContent": "Number input",
            "id": "max",
            "label": "Max",
            "type": "number"
          }
        ]
      },
      "StringRange": {
        "label": "Range",
        "uiTipContent": "Defines a range with a min and max value",
        "slots": [
          {
            "uiTipContent": "Number input",
            "id": "min",
            "label": "Min",
            "type": "string"
          }, {
            "uiTipContent": "Number input",
            "id": "max",
            "label": "Max",
            "type": "string"
          }
        ]
      },
      "Range": {
        "label": "Range and step",
        "uiTipContent": "Defines a range with a min and max values and a step",
        "slots": [
          {
            "uiTipContent": "Number input",
            "id": "start",
            "label": "Min",
            "type": "number"
          }, {
            "uiTipContent": "Number input",
            "id": "end",
            "label": "Max",
            "type": "number"
          }, {
            "uiTipContent": "Number input",
            "id": "step",
            "label": "Step",
            "type": "number"
          }
        ]
      },
      "ImageUrl": {
        "label": "Image",
        "uiTipContent": "Url to an image file",
        "slots": [
          {
            "uiTipContent": "Open the image picker to select an image from your drive or paste an external url",
            "id": "value",
            "label": "Image url",
            "type": "imageurl"
          }, {
            "uiTipContent": "Select the type scaling",
            "id": "scale",
            "label": "Image scaling",
            "type": "options"
          }, {
            "uiTipContent": "Select wether the image should be tiled",
            "id": "repeat",
            "label": "Image repetition",
            "type": "boolean"
          }
        ]
      },
      "IntensitiesByValues": {
        "label": "Percentages by value",
        "uiTipContent": "Maps a set of values into a range of percentage values",
        "slots": [
          {
            "uiTipContent": "Insert the values that will be converted to percent values",
            "id": "values",
            "label": "Values",
            "type": "number"
          }, {
            "uiTipContent": "Set the percentage to assign to the minimum of the values",
            "id": "min",
            "label": "Minimum intensity",
            "type": "percentage"
          }, {
            "uiTipContent": "Set the percentage to assign to the maximum of the values",
            "id": "max",
            "label": "Maximum intensity",
            "type": "percentage"
          }
        ]
      },
      "Font": {
        "label": "Font",
        "uiTipContent": "Defines a transition method",
        "slots": [
          {
            "uiTipContent": "Select the font family",
            "id": "fontFamily",
            "label": "Font family",
            "type": "options"
          }, {
            "uiTipContent": "Select the font style",
            "id": "fontStyle",
            "label": "Font style",
            "type": "options"
          }
        ]
      }
    };

    return FormatManager;

  })();

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Managers.FontManager = (function() {
    function FontManager() {
      this.quillInjections = __bind(this.quillInjections, this);
      this.initTextBars = __bind(this.initTextBars, this);
      this.loadInFrame = __bind(this.loadInFrame, this);
      this.getFontStyles = __bind(this.getFontStyles, this);
      this.fontsList = __bind(this.fontsList, this);
      this.families = ['Oswald', 'Kreon', 'Roboto', 'Droid Sans', 'Lato', 'Titillium Web', 'Open Sans Condensed', 'Open Sans', 'Verdana', 'Ubuntu', 'Droid Serif', 'Roboto Slab', 'EB Garamond', 'Libre Baskerville', 'Merriweather', 'Georgia', 'Playfair Display', 'Playfair Display SC', 'Old Standard TT'];
      this.wflFamilies = ['Oswald:n3,n4,n7', 'Kreon:n3,n4,n7', 'Roboto:n1,n3,n4,n5,n7,n9,i1,i3,i4,i5,i7,i9', 'Droid Sans:n4,n7', 'Lato:n1,n3,n4,n7,n9,i1,i3,i4,i7,i9', 'Titillium Web:n2,n3,n4,n6,n7,n9,i2,i3,i4,i6,i7', 'Open Sans Condensed:n3,n7,i3', 'Open Sans:n3,n4,n6,n7,n8,i3,i4,i6,i7,i8', 'Verdana:n4,n7,i4,i7', 'Ubuntu:n3,n4,n5,n7,i3,i4,i5,i7', 'Droid Serif:n4,n7,i4,i7', 'Roboto Slab:n1,n3,n4,n7', 'EB Garamond:n4', 'Libre Baskerville:n4,n7,i4', 'Merriweather:n3,n4,n7,n9,i3,i4,i7,i9', 'Georgia:n4,n7,i4,i7', 'Playfair Display:n4,n7,n9,i4,i7,i9', 'Playfair Display SC:n4,n7,n9,i4,i7,i9', 'Old Standard TT:n4,n7,i4'];
      this.familyStyles = {
        "Oswald": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }
        ],
        "Kreon": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }
        ],
        "Roboto": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Thin",
            fontStyle: "normal",
            fontWeight: "100"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Medium",
            fontStyle: "normal",
            fontWeight: "500"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Black",
            fontStyle: "normal",
            fontWeight: "900"
          }, {
            styleName: "Thin-Italic",
            fontStyle: "italic",
            fontWeight: "100"
          }, {
            styleName: "Light-Italic",
            fontStyle: "italic",
            fontWeight: "300"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Medium-Italic",
            fontStyle: "italic",
            fontWeight: "500"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }, {
            styleName: "Black-Italic",
            fontStyle: "italic",
            fontWeight: "900"
          }
        ],
        "Droid Sans": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }
        ],
        "Lato": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Thin",
            fontStyle: "normal",
            fontWeight: "100"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Black",
            fontStyle: "normal",
            fontWeight: "900"
          }, {
            styleName: "Thin-Italic",
            fontStyle: "italic",
            fontWeight: "100"
          }, {
            styleName: "Light Italic",
            fontStyle: "italic",
            fontWeight: "300"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Black-Italic",
            fontStyle: "italic",
            fontWeight: "900"
          }
        ],
        "Titillium Web": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Semi-Light",
            fontStyle: "normal",
            fontWeight: "200"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Semi-Bold",
            fontStyle: "normal",
            fontWeight: "600"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Black",
            fontStyle: "normal",
            fontWeight: "900"
          }, {
            styleName: "Semi-Light-Italic",
            fontStyle: "italic",
            fontWeight: "200"
          }, {
            styleName: "Light-Italic",
            fontStyle: "italic",
            fontWeight: "300"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Semi-Bold-Italic",
            fontStyle: "italic",
            fontWeight: "600"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }
        ],
        "Open Sans Condensed": [
          {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Light-Italic",
            fontStyle: "italic",
            fontWeight: "300"
          }
        ],
        "Open Sans": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Semi-Bold",
            fontStyle: "normal",
            fontWeight: "600"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Extra-Bold",
            fontStyle: "normal",
            fontWeight: "800"
          }, {
            styleName: "Light-Italic",
            fontStyle: "italic",
            fontWeight: "300"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Semi-Bold-Italic",
            fontStyle: "italic",
            fontWeight: "600"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }, {
            styleName: "Extra-Bold-Italic",
            fontStyle: "italic",
            fontWeight: "800"
          }
        ],
        "Verdana": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }
        ],
        "Ubuntu": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Medium",
            fontStyle: "normal",
            fontWeight: "500"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Light-Italic",
            fontStyle: "italic",
            fontWeight: "300"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Medium-Italic",
            fontStyle: "italic",
            fontWeight: "500"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }
        ],
        "Droid Serif": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Italic",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "normal",
            fontWeight: "700"
          }
        ],
        "Roboto Slab": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Thin",
            fontStyle: "normal",
            fontWeight: "100"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }
        ],
        "EB Garamond": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }
        ],
        "Libre Baskerville": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }
        ],
        "Merriweather": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Light",
            fontStyle: "normal",
            fontWeight: "300"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Black",
            fontStyle: "normal",
            fontWeight: "900"
          }, {
            styleName: "Light-Italic",
            fontStyle: "italic",
            fontWeight: "300"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }, {
            styleName: "Black-Italic",
            fontStyle: "italic",
            fontWeight: "900"
          }
        ],
        "Georgia": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }
        ],
        "Playfair Display": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Black",
            fontStyle: "normal",
            fontWeight: "900"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }, {
            styleName: "Black-Italic",
            fontStyle: "italic",
            fontWeight: "900"
          }
        ],
        "Playfair Display SC": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Black",
            fontStyle: "normal",
            fontWeight: "900"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }, {
            styleName: "Bold-Italic",
            fontStyle: "italic",
            fontWeight: "700"
          }, {
            styleName: "Black-Italic",
            fontStyle: "italic",
            fontWeight: "900"
          }
        ],
        "Old Standard TT": [
          {
            styleName: "Regular",
            fontStyle: "normal",
            fontWeight: "400"
          }, {
            styleName: "Bold",
            fontStyle: "normal",
            fontWeight: "700"
          }, {
            styleName: "Italic",
            fontStyle: "italic",
            fontWeight: "400"
          }
        ]
      };
      WebFont.load({
        custom: {
          families: this.wflFamilies,
          urls: [quadrigram.fonts + 'scripts/managers/fonts2.css?' + $.now()]
        }
      });
      this.quillInjections();
      this.initTextBars();
    }

    FontManager.prototype.fontsList = function() {
      return this.families;
    };

    FontManager.prototype.getFontStyles = function(fontFamily) {
      return this.familyStyles[fontFamily];
    };

    FontManager.prototype.loadInFrame = function(iframe, callback) {
      return WebFont.load({
        custom: {
          families: this.wflFamilies,
          urls: [quadrigram.fonts + 'scripts/managers/fonts2.css?' + $.now()]
        },
        context: iframe,
        timeout: 100,
        active: callback
      });
    };

    FontManager.prototype.initTextBars = function() {
      return this.textbarManager = new quadrigram.Views.Textbar({
        model: null
      });
    };

    FontManager.prototype.quillInjections = function() {
      
      Quill.prototype.getSelection = function() {
      this.editor.checkUpdate();
      return this.editor.selection.getRange(true);
      };
    ;
      
      Quill.modules["toolbar"].prototype.setActive = function(format, value) {
        var $input, input, selectValue, _ref;
        input = this.inputs[format];
        if (input == null) {
          return;
        }
        $input = $(input);
        if (input.tagName === 'INPUT') {
          this.triggering = true;
          if (value == null) {
            value = $input.attr("qm-internal-default")
          }
          if (_.isArray(value))
          {
            $input.val("")
          }
          else
          {
            $input.val(value.replace(/['"]+/g, ''))
          }

          return this.triggering = false;

        }
        else if (input.tagName === 'SELECT') {
          this.triggering = true;
          if (_.isArray(value)) {
            $input.find("option:selected").removeAttr("selected");
          }
          else
          {
            if(value)
              {
                 $input.val(value.replace(/['"]+/g, ''));
              }

          }

          return this.triggering = false;
        } else {
          return $input.toggleClass('ql-active', value || false);
        }
      };
    ;
      return Quill.modules["toolbar"].prototype.initFormat = 
      function(format, callback) {
        var dom = Quill.require("dom")

        var eventName, input, selector;
        selector = ".ql-" + format;
        if (Quill.modules["toolbar"].formats.SELECT[format] != null) {
          selector = "select" + selector;
          eventName = 'change';
        }else if (Quill.modules["toolbar"].formats.INPUT[format] != null) {
          selector = "input" + selector;
          eventName = 'change';
        }else {
          eventName = 'click';
        }
        input = this.container.querySelector(selector);
        if (input == null) {
          return;
        }
        this.inputs[format] = input;

        var self = this
        $(input).on(eventName, function() {

          var value
          if (eventName == "change")
          {
            value = $(input).val()
          }
          else
          {
            value = !$(input).hasClass('ql-active')
          }
          self.preventUpdate = true;

          //REVISE: To comment or not to comment... (?)
          self.quill.focus();

          var range = self.quill.getSelection();
          if (range != null) {
            callback(range, value);
          }
          self.preventUpdate = false;

          return this;
        })
      };
    ;
    };

    return FontManager;

  })();

}).call(this);

(function() {
  'use strict';
  quadrigram.Managers.KeyboardShortcutsManager = (function() {
    function KeyboardShortcutsManager() {
      Mousetrap.bind(['command+z', 'ctrl+z'], function() {
        quadrigram.router.dataModels.currentProject.undo();
        return false;
      });
      Mousetrap.bind(['command+shift+z', 'ctrl+shift+z'], function() {
        quadrigram.router.dataModels.currentProject.redo();
        return false;
      });
      Mousetrap.bind(['command+s', 'ctrl+s'], function() {
        quadrigram.router.saveCurrentProject();
        return false;
      });
      Mousetrap.bind(['command+alt+n', 'ctrl+alt+n'], function() {
        quadrigram.router.loadProject();
        return false;
      });
      Mousetrap.bind(['command+shift+s', 'ctrl+shift+s'], function() {
        quadrigram.router.saveAsCurrentProject();
        return false;
      });
      Mousetrap.bind(['command+shift+r', 'ctrl+shift+r'], function() {
        quadrigram.router.renameCurrentProject();
        return false;
      });
      Mousetrap.bind(['command+m', 'ctrl+m'], function() {
        quadrigram.router.appViews.uiView.toolbar.datamanagerClicked();
        return false;
      });
      Mousetrap.bind(['f10', 'f10'], function() {
        quadrigram.router.appViews.uiView.setDevMode();
        return false;
      });
    }

    return KeyboardShortcutsManager;

  })();

}).call(this);

(function() {
  'use strict';
  quadrigram.Managers.WorkerManager = (function() {
    var allWorkers, pendingJobs, workersPool;

    function WorkerManager() {}

    workersPool = [];

    pendingJobs = [];

    allWorkers = [];

    WorkerManager.prototype.startWorker = function(worker, onmessage) {
      worker.addEventListener('message', onmessage, false);
      return worker.postMessage({
        t: "isReady"
      });
    };

    WorkerManager.prototype.getWorker = function(workerUrl) {
      var newWorker;
      if (workersPool.length > 0) {
        return workersPool.shift();
      } else if (workersPool.length < 8) {
        newWorker = new Worker(workerUrl);
        newWorker.sourceUrl = workerUrl;
        return newWorker;
      } else {
        return null;
      }
    };

    WorkerManager.prototype.releaseWorker = function(worker) {
      worker.removeEventListener('message');
      workersPool.push(worker);
      return this.checkPending();
    };

    WorkerManager.prototype.requestJob = function(workerUrl, onmessage) {
      var worker;
      worker = this.getWorker(workerUrl);
      if (worker) {
        return this.startWorker(worker, onmessage);
      } else {
        return pendingJobs.push({
          "workerUrl": workerUrl,
          "onmessage": onmessage
        });
      }
    };

    WorkerManager.prototype.checkPending = function() {
      var job, shouldCheck, worker, _results;
      shouldCheck = true;
      _results = [];
      while (pendingJobs.length > 0 && shouldCheck) {
        job = pendingJobs[0];
        worker = this.getWorker(job.workerUrl);
        if (worker) {
          this.startWorker(worker, job.onmessage);
          pendingJobs.shift();
          _results.push(shouldCheck = true);
        } else {
          _results.push(shouldCheck = false);
        }
      }
      return _results;
    };

    return WorkerManager;

  })();

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Managers.UiTooltipManager = (function() {
    function UiTooltipManager($root) {
      this.resgisterContent = __bind(this.resgisterContent, this);
      this.createTip = __bind(this.createTip, this);
      this.handleTooltipOver = __bind(this.handleTooltipOver, this);
      $root.on("mouseover", ".ui-tip-target,.leaflet-zoom-animated", this.handleTooltipOver);
    }

    UiTooltipManager.prototype.handleTooltipOver = function(e) {
      if ($(e.currentTarget).attr("data-hasqtip") == null) {
        return this.createTip(e.currentTarget);
      }
    };

    UiTooltipManager.prototype.createTip = function(target) {
      if (($(target).attr("data-ui-tip-id") != null) && (this.uiTooltipDictionary[$(target).attr("data-ui-tip-id")] != null)) {
        return $(target).qtip({
          style: {
            classes: "ui-tip",
            tip: {
              corner: true,
              offset: 5
            }
          },
          content: {
            text: this.uiTooltipDictionary[$(target).attr("data-ui-tip-id")]
          },
          show: {
            delay: 1000,
            ready: true
          },
          hide: {
            event: 'wheel mouseleave mousedown',
            fixed: true
          },
          position: {
            target: "mouse",
            my: "bottom left",
            at: "top center",
            viewport: $("body"),
            adjust: {
              mouse: false,
              method: 'flip flip',
              resize: true
            }
          },
          events: {
            hide: function(e, api) {
              return quadrigram.tracker.sendEvent({
                event_type: 306,
                client_data: {
                  uiTipId: $(target).attr("data-ui-tip-id")
                }
              });
            },
            hidden: function(event, api) {
              return $(this).detach();
            },
            show: function(event, api) {
              return $(this).appendTo(api.get('position.container'));
            }
          }
        });
      }
    };

    UiTooltipManager.prototype.resgisterContent = function(id, content) {
      return this.uiTooltipDictionary[id] = content;
    };

    UiTooltipManager.prototype.uiTooltipDictionary = {
      "export-button": "Share the project by hosting it at quadrigram.com or downloading the HTML5 source code.",
      "undo-button": "Undo",
      "redo-button": "Redo",
      "help-button": "Lessons and tutorials at quadrigram.com",
      "preview-button": "See how the exported project will look like",
      "data-manager": "Load and operate with files",
      "layout-settings": "Configure project global settings such as width, height, layout and colors",
      "block-group-rename": "Double-click to rename",
      "viz-LinkControl": "Creates a text anchor element for navigating to a given url when clicked.",
      "viz-ListChart": "Display a selectable list of items. Useful to make interactive filters.",
      "viz-ScatterPlot": "Compare up to three (X-axis, Y-axis and point radius) numeric variables using a scatter plot.",
      "viz-BarChart": "Group data with rectangular bars with lengths proportional to the values that they represent using a bar chart",
      "viz-StackedBarChart": "Stack series of data on top of each other with a stacked bar chart.",
      "viz-GroupedBarChart": "Groups series of data as rectangular bars next to each other with a bar chart.",
      "viz-LineChart": "Plot multiple time series with a line chart",
      "viz-StackedAreaChart": "Stack multiple time series to represent accumulated totals over time using percentages ",
      "viz-PointsInAMap": "Draw geolocalized data points over a dynamic map.",
      "viz-TreeMap": "Display hierarchical (tree structured) data a a set of nested rectangles",
      "viz-Network": "Visualize a set of nodes and relations as a graph",
      "viz-RadarChart": "Display multivariate data in the form of a two-dimensional chart",
      "data-block": "Double-click to preview the content of this data block",
      "edit-external": "Edit how the file is interpreted",
      "edit-custom": "Edit the contents of this formula",
      "operator-Identity": "Set manually the value of the block",
      "operator-Filter": "Filter a data block with conditions on the rows and/or columns.",
      "operator-Transpose": "Swap the columns and rows of a table",
      "operator-Join": "Join two blocks with a common identifier into one.",
      "operator-GetNames": "Extract the ids of a block.",
      "operator-SwapIds": "Swap the values and names of a column block.",
      "operator-Sort": "Sort the values of a block according to its ids or values.",
      "operator-Aggregate": "Set the ids of a block to the values of one of its columns, aggregating the other columns.",
      "pages-shortcut": "Click to manage the pages of your project",
      "delete-viz-button": "Delete visualizer",
      "output-viz-button": "View the outputs of this visualizer in the Data Manager",
      "family-data": "Change the data",
      "family-style": "Change styling properties of the visualizer like colors and sizes of elements displayed in the chart",
      "family-select": "Change selection behaviour",
      "family-axis": "Change axis settings",
      "family-tooltip": "Change styling of tooltip inside this visualizer",
      "format-selector": "Select the input format that best suits your needs",
      "copy-ids": "Copy these ids to the clipboard",
      "Load file": "Load this file from your Google Drive into the current project",
      "delete-file": "The file will be deleted from your Google Drive Quadrigram folder",
      "dropzone": "Upload files to your Google Drive to be able to load them into the project",
      "file-too-large": "Files must be smaller than 20MB",
      "view-on-drive": "Click to view the original file on Google Drive",
      "refresh-file": "Reload the file from the source",
      "view-mode-toggle": "Choose how to view the data in this block. Note that the data won't change, only how you see it in this preview.",
      "toggle-header": "The header must be empty before you can disable it",
      "page-remove": "The page must be empty before you can delete it",
      "zoom-cover": "Click to enable scroll zoom"
    };

    return UiTooltipManager;

  })();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    __slice = [].slice;

  quadrigram.Models.QModel = (function(_super) {
    __extends(QModel, _super);

    function QModel() {
      this.duplicate = __bind(this.duplicate, this);
      this.destroyR = __bind(this.destroyR, this);
      this.removeFromProject = __bind(this.removeFromProject, this);
      this.bubbleEvent = __bind(this.bubbleEvent, this);
      this.postModelSetup = __bind(this.postModelSetup, this);
      this.postCreate = __bind(this.postCreate, this);
      this.create = __bind(this.create, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.labelChanged = __bind(this.labelChanged, this);
      _ref = QModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    /*
    toString:()=>
      return "{"+@.get("id")+","+@.get("value")+"}"
    */


    QModel.prototype.initialize = function(attributes, options) {
      var id;
      if (!attributes || !attributes.id) {
        id = quadrigram.idManager.getId(this.constructor.name.replace("Model", "") + "_");
        this.set("id", id);
        this.create(options);
        _.defer(this.postCreate);
      }
      quadrigram.idManager.addToList(this.get("id"));
      if (this.get("label")) {
        quadrigram.labelManager.addToList(this.get("label"));
      }
      this.on("change:label", this.labelChanged);
      this.modelSetup(options);
      _.defer(this.postModelSetup);
      return this.on("all", this.bubbleEvent);
    };

    QModel.prototype.labelChanged = function() {
      quadrigram.labelManager.removeFromList(this._previousAttributes["label"]);
      return quadrigram.labelManager.addToList(this.get("label"));
    };

    QModel.prototype.modelSetup = function(options) {};

    QModel.prototype.create = function() {};

    QModel.prototype.postCreate = function() {};

    QModel.prototype.postModelSetup = function() {};

    QModel.prototype.bubbleEvent = function() {
      var collection, eventName, eventType, keyContents, model, models, options, relation, _i, _j, _len, _ref1, _results,
        _this = this;
      eventName = arguments[0], model = arguments[1], collection = 4 <= arguments.length ? __slice.call(arguments, 2, _i = arguments.length - 1) : (_i = 2, []), options = arguments[_i++];
      eventType = eventName.indexOf(":") >= 0 ? eventName.substring(0, eventName.indexOf(":")) : eventName;
      if (this.undoableEvents && this.undoableEvents.indexOf(eventName) >= 0) {
        if (quadrigram.router.dataModels.currentProject != null) {
          quadrigram.router.dataModels.currentProject.trigger(eventType, model, collection[0], options);
        }
      }
      /*
      if model
        log "++++++++ skipping event?",model.get("id")," event: ",eventName,
        "_attributeChangeFired",model._attributeChangeFired,
        "isNew",model.isNew(),
        "hasChanged",model.hasChanged(),
        "_isInitialized",model._isInitialized,
        "changed",model.changed
      if model && !model._attributeChangeFired && !eventName=="childModified"
        log "++++++++ skipping event!",eventName,model._attributeChangeFired
        return
      */

      if (eventName === "childModified" || (this.bubblingEvents && this.bubblingEvents.indexOf(eventName) >= 0)) {
        _ref1 = this.getRelations();
        _results = [];
        for (_j = 0, _len = _ref1.length; _j < _len; _j++) {
          relation = _ref1[_j];
          if (relation.options.bubbleUp) {
            keyContents = this.get(relation.key);
            models = keyContents ? (keyContents instanceof Backbone.Collection ? keyContents.models : [keyContents]) : [];
            _results.push(_.each(models || [], function(related) {
              if (related) {
                return related.trigger("childModified", _this);
              }
            }));
          } else {
            _results.push(void 0);
          }
        }
        return _results;
      }
    };

    QModel.prototype.removeFromProject = function() {
      var i, keyContents, models, relation, rmodel, _i, _j, _len, _ref1, _ref2;
      if (this.beingRemoved) {
        return;
      } else {
        this.beingRemoved = true;
      }
      if (this.get("project")) {
        this.set("project", null);
      }
      _ref1 = this.getRelations();
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        relation = _ref1[_i];
        if (relation.options.type === Backbone.HasMany || relation.reverseRelation.bubbleUp) {
          keyContents = this.get(relation.key);
          models = keyContents ? (keyContents instanceof Backbone.Collection ? keyContents.models : [keyContents]) : [];
          if (models.length > 0) {
            for (i = _j = _ref2 = models.length - 1; _j >= 0; i = _j += -1) {
              rmodel = models[i];
              if (rmodel != null) {
                rmodel.removeFromProject();
              }
            }
          }
        }
      }
      return this.beingRemoved = false;
    };

    QModel.prototype.destroyR = function() {
      var i, keyContents, models, relation, rmodel, _i, _j, _len, _ref1, _ref2;
      if (this.beingDestroyed != null) {
        return;
      } else {
        this.beingDestroyed = true;
      }
      this.off();
      _ref1 = this.getRelations();
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        relation = _ref1[_i];
        if (relation.options.type === Backbone.HasMany || relation.reverseRelation.bubbleUp) {
          keyContents = this.get(relation.key);
          models = keyContents ? (keyContents instanceof Backbone.Collection ? keyContents.models : [keyContents]) : [];
          if (models.length > 0) {
            for (i = _j = _ref2 = models.length - 1; _j >= 0; i = _j += -1) {
              rmodel = models[i];
              if (rmodel != null) {
                rmodel.destroyR();
              }
            }
          }
        }
      }
      return Backbone.Relational.store.unregister(this);
    };

    QModel.prototype.duplicate = function() {
      var cloneModel, i, keyContents, models, relation, rmodel, _i, _j, _len, _ref1, _ref2;
      if (this.beingDuplicated != null) {
        return;
      } else {
        this.beingDuplicated = true;
      }
      cloneModel = this.clone();
      _ref1 = this.getRelations();
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        relation = _ref1[_i];
        if (relation.options.type === Backbone.HasMany || relation.reverseRelation.bubbleUp) {
          keyContents = this.get(relation.key);
          models = keyContents ? (keyContents instanceof Backbone.Collection ? keyContents.models : [keyContents]) : [];
          if (models.length > 0) {
            for (i = _j = _ref2 = models.length - 1; _j >= 0; i = _j += -1) {
              rmodel = models[i];
              if (rmodel != null) {
                cloneModel.set(relation.key, rmodel.duplicate());
              }
            }
          }
        }
      }
      this.beingDuplicated = null;
      return cloneModel;
    };

    return QModel;

  })(Backbone.RelationalModel);

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Models.QValue = (function() {
    function QValue(value, id) {
      this.value = value;
      this.id = id;
      this.toString = __bind(this.toString, this);
    }

    QValue.prototype.toString = function() {
      return "{" + this.id + "," + this.value + "}";
    };

    return QValue;

  })();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.DataBlockModel = (function(_super) {
    __extends(DataBlockModel, _super);

    function DataBlockModel() {
      this.detachAndDestroy = __bind(this.detachAndDestroy, this);
      this.removeFromProject = __bind(this.removeFromProject, this);
      this.summary = __bind(this.summary, this);
      this.toJSON = __bind(this.toJSON, this);
      this.toTemplateData = __bind(this.toTemplateData, this);
      this.getValue = __bind(this.getValue, this);
      this.setData = __bind(this.setData, this);
      this.setDataManual = __bind(this.setDataManual, this);
      this.addValue = __bind(this.addValue, this);
      this.clearData = __bind(this.clearData, this);
      this.setSelected = __bind(this.setSelected, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = DataBlockModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockModel.prototype.undoableEvents = ["change:data:manual", "change:label"];

    DataBlockModel.prototype.bubblingEvents = ["change:data", "change:label", "change:fetchState", "dependency-change"];

    DataBlockModel.prototype.subModelTypes = {
      "Function": "quadrigram.Models.FunctionBlockModel",
      "Editable": "quadrigram.Models.EditableBlockModel",
      "External": "quadrigram.Models.ExternalBlockModel"
    };

    DataBlockModel.prototype.create = function() {};

    DataBlockModel.prototype.modelSetup = function(options) {
      if (!this.get("data")) {
        this.set("data", [], {
          silent: true
        });
      }
      return this.set("fetchState", "ready", {
        silent: true
      });
    };

    DataBlockModel.prototype.setSelected = function(value) {
      this.selected = value;
      return this.trigger("set-selected");
    };

    DataBlockModel.prototype.clearData = function() {
      return this.set("data", []);
    };

    DataBlockModel.prototype.addValue = function(id, value) {
      var values;
      values = this.get("data");
      values.push(new quadrigram.Models.QValue(value, id));
      return this.set("data", values);
    };

    DataBlockModel.prototype.setDataManual = function(value) {
      this.setData(value);
      this.trigger("change:data:manual", this);
      if ((this.get("internalOfSlot").get("ownerSlotGroup").get("ownerViz") != null) && !(this.get("internalOfSlot").get("ownerSlotGroup").get("ownerViz").get("type") === "TextArea" && this.get("internalOfSlot").get("ownerSlotGroup").get("propId") === "value")) {
        quadrigram.tracker.sendEvent({
          event_type: 202,
          event_subtype: 2,
          client_data: {
            owner: this.get("internalOfSlot").get("ownerSlotGroup").get("ownerViz").get("id"),
            action: "manualEdit",
            value: value,
            id: this.get("internalOfSlot").get("ownerSlotGroup").get("propId")
          }
        });
      } else if (this.get("internalOfSlot").get("ownerSlotGroup").get("currentOperation") != null) {
        quadrigram.tracker.sendEvent({
          event_type: 202,
          event_subtype: 2,
          client_data: {
            owner: this.get("internalOfSlot").get("ownerSlotGroup").get("currentOperation"),
            action: "manualEdit",
            value: value,
            id: this.get("internalOfSlot").get("slotId")
          }
        });
      }
      return quadrigram.achievementTracker.checkBlockInSlot(this, this.get("internalOfSlot"));
    };

    DataBlockModel.prototype.setData = function(value, options) {
      var v, _i, _j, _k, _len, _len1, _len2, _values;
      if (_.isArray(value)) {
        if (value[0] == null) {
          _values = value;
        } else if (value[0].constructor.name === "QValue") {
          _values = value;
        } else if (value[0].value) {
          _values = [];
          for (_i = 0, _len = value.length; _i < _len; _i++) {
            v = value[_i];
            _values.push(new quadrigram.Models.QValue(v.value, v.id));
          }
        } else if (value[0].children) {
          _values = [];
          for (_j = 0, _len1 = value.length; _j < _len1; _j++) {
            v = value[_j];
            _values.push(new quadrigram.Models.QValue(v.children, v.id));
          }
        } else {
          _values = [];
          for (_k = 0, _len2 = value.length; _k < _len2; _k++) {
            v = value[_k];
            _values.push(new quadrigram.Models.QValue(v));
          }
        }
      } else {
        if (value == null) {
          _values = [new quadrigram.Models.QValue("")];
        } else if (value.constructor.name === "QValue") {
          _values = [value];
        } else {
          _values = [new quadrigram.Models.QValue(value)];
        }
      }
      return this.set("data", _values, options);
    };

    DataBlockModel.prototype.getValue = function() {
      if (this.get("data").length > 1) {
        return this.get("data");
      } else if (this.get("data").length === 1) {
        return this.get("data")[0].value;
      } else {
        return "";
      }
    };

    DataBlockModel.prototype.toTemplateData = function(options) {
      return Backbone.Model.prototype.toJSON.call(this);
    };

    DataBlockModel.prototype.toJSON = function(options) {
      var result;
      result = DataBlockModel.__super__.toJSON.apply(this, arguments);
      if ((options != null) && options.ommitData) {
        if (this.constructor.name === "FunctionBlockModel" || this.constructor.name === "ExternalBlockModel" || this.get("role") === "output") {
          return _.omit(result, ["data", "fetchState"]);
        }
      }
      return result;
    };

    DataBlockModel.prototype.summary = function() {
      var e, result;
      result = "[DataBlock - label: '" + this.get("label") + "'";
      try {
        if (this.get("data") != null) {
          result += " - length: " + this.get("data").length;
          if (this.get("metaData") != null) {
            result += " - idLabel: '" + this.get("metaData").idLabel + "' - valueLabel: '" + this.get("metaData").valueLabel + "'";
          }
          if (this.get("data").length > 0) {
            result += " - sample: [{" + this.get("data")[0].id + "," + this.get("data")[0].value + "}";
            if (this.get("data").length > 1) {
              result += ", {" + this.get("data")[1].id + "," + this.get("data")[1].value + "},...]";
            }
          }
          result += "]";
        }
      } catch (_error) {
        e = _error;
        result += "ERROR ENCODING...]";
      }
      return result;
    };

    DataBlockModel.prototype.removeFromProject = function() {
      var slot, _i, _len, _ref1;
      _ref1 = this.get("insideSlot").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        if (slot != null) {
          slot.popBlock();
        }
      }
      return DataBlockModel.__super__.removeFromProject.call(this);
    };

    DataBlockModel.prototype.detachAndDestroy = function() {
      return this.removeFromProject();
    };

    return DataBlockModel;

  })(quadrigram.Models.QModel);

  quadrigram.Models.DataBlockModel.setup();

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Models.DataBlockData = (function() {
    function DataBlockData(source) {
      this.summary = __bind(this.summary, this);
      this.toString = __bind(this.toString, this);
      this.getBackboneModel = __bind(this.getBackboneModel, this);
      this.set = __bind(this.set, this);
      this.get = __bind(this.get, this);
      if (source instanceof quadrigram.Models.DataBlockModel) {
        this.set("data", source.get("data"));
        this.set("metaData", source.get("metaData"));
      } else if (_.isArray(source)) {
        this.set("data", source);
      } else if (source != null) {
        this.set("data", [source]);
      } else {
        this.set("data", []);
      }
    }

    DataBlockData.prototype.get = function(attrName) {
      /*
      if attrName == "data"
        return @data
      if attrName == "metaData"
        return @metaData
      */

      return this[attrName];
    };

    DataBlockData.prototype.set = function(attrName, value) {
      /*
      if attrName == "data"
        @data = value
      if attrName == "metaData"
        @metaData = value
      */

      return this[attrName] = value;
    };

    DataBlockData.prototype.getBackboneModel = function() {
      return new Backbone.Model(this);
    };

    DataBlockData.prototype.toString = function() {
      var result;
      return result = "[DataBlockData length:" + this.get("data").length + "]";
    };

    DataBlockData.prototype.summary = function() {
      var result;
      return result = "[DataBlockData length:" + this.get("data").length + "]";
    };

    return DataBlockData;

  })();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.DataBlockCollection = (function(_super) {
    __extends(DataBlockCollection, _super);

    function DataBlockCollection() {
      this.toJSON = __bind(this.toJSON, this);
      this.comparator = __bind(this.comparator, this);
      _ref = DataBlockCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockCollection.prototype.model = quadrigram.Models.DataBlockModel;

    DataBlockCollection.prototype.comparator = function(model) {
      var date;
      date = model.get("creation_date");
      if (date) {
        return date;
      }
    };

    DataBlockCollection.prototype.toJSON = function(options) {
      var result,
        _this = this;
      result = DataBlockCollection.__super__.toJSON.apply(this, arguments);
      if ((options != null) && options.ommitData) {
        result = result.filter(function(block) {
          var originalBlock;
          if (block.internalOfSlot != null) {
            return true;
          }
          if (block.insideSlot.length > 0) {
            return true;
          }
          originalBlock = _this.find({
            "id": block.id
          });
          if (originalBlock.get("blockGroup") && originalBlock.get("blockGroup").get("type") === "custom" && originalBlock.get("blockGroup").get("mainBlock") === originalBlock) {
            return true;
          }
          return false;
        });
      }
      return result;
    };

    return DataBlockCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SlotModel = (function(_super) {
    __extends(SlotModel, _super);

    function SlotModel() {
      this.removeFromProject = __bind(this.removeFromProject, this);
      this.getOwnerBlockGroup = __bind(this.getOwnerBlockGroup, this);
      this.getState = __bind(this.getState, this);
      this.getBlock = __bind(this.getBlock, this);
      this.getValue = __bind(this.getValue, this);
      this.setValue = __bind(this.setValue, this);
      this.setExternalBlock = __bind(this.setExternalBlock, this);
      this.animatedPop = __bind(this.animatedPop, this);
      this.popBlock = __bind(this.popBlock, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = SlotModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SlotModel.prototype.relations = [
      {
        type: Backbone.HasOne,
        key: 'internalBlock',
        relatedModel: "quadrigram.Models.DataBlockModel",
        includeInJSON: Backbone.Model.prototype.idAttribute,
        reverseRelation: {
          type: Backbone.HasOne,
          key: 'internalOfSlot',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }, {
        type: Backbone.HasOne,
        key: 'externalBlock',
        relatedModel: "quadrigram.Models.DataBlockModel",
        includeInJSON: Backbone.Model.prototype.idAttribute,
        reverseRelation: {
          key: 'insideSlot',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }
    ];

    SlotModel.prototype.undoableEvents = ["change:externalBlock"];

    SlotModel.prototype.bubblingEvents = ["change:externalBlock"];

    SlotModel.prototype.create = function() {
      var block;
      block = new quadrigram.Models.EditableBlockModel({
        "internalOfSlot": this
      });
      return block.set({
        "blockGroup": this.getOwnerBlockGroup(),
        "label": "List of " + pluralize(this.get("slotId")),
        "origin": "internal"
      }, {
        silent: true
      });
    };

    SlotModel.prototype.modelSetup = function(options) {};

    /*
    it creates an internal block function.
    createAndInsertFunctionBlock:()=>
      ##TODO: Are names still too long?
      fb = new quadrigram.Models.FunctionBlockModel blockGroup:quadrigram.router.dataModels.currentProject.getCustomGroup() ,label:@.get("ownerSlotGroup").get("ownerViz").get("id")+ " - " +@.get("ownerSlotGroup").get("propLabel")
      log "created function block",fb
    */


    SlotModel.prototype.popBlock = function() {
      var block, defaultData;
      if (this.get("internalBlock") == null) {
        block = new quadrigram.Models.EditableBlockModel({
          "internalOfSlot": this
        });
        defaultData = this.get("ownerSlotGroup").getDefaultAt(this.get("slotId"));
        block.set({
          "blockGroup": this.getOwnerBlockGroup(),
          "label": "List of " + pluralize(this.get("slotId")),
          "origin": "internal"
        }, {
          silent: true
        });
        block.setData(defaultData, {
          silent: true
        });
      }
      return this.set("externalBlock", null);
    };

    SlotModel.prototype.animatedPop = function() {
      var _this = this;
      this.trigger("wrongData");
      return _.delay(function() {
        return _this.popBlock();
      }, 2000);
    };

    SlotModel.prototype.setExternalBlock = function(block) {
      var blockValue;
      if (this.get("ownerSlotGroup").get("ownerViz") != null) {
        this.get("ownerSlotGroup").get("ownerViz").newExternal = block;
      }
      this.set("externalBlock", block);
      blockValue = block.summary();
      if (this.get("ownerSlotGroup").get("ownerViz") != null) {
        return quadrigram.tracker.sendEvent({
          event_type: 202,
          event_subtype: 2,
          client_data: {
            owner: this.get("ownerSlotGroup").get("ownerViz").get("id"),
            action: "dropped",
            value: blockValue,
            id: this.get("ownerSlotGroup").get("propId")
          }
        });
      } else if (this.get("ownerSlotGroup").get("currentOperation") != null) {
        return quadrigram.tracker.sendEvent({
          event_type: 202,
          event_subtype: 2,
          client_data: {
            owner: this.get("ownerSlotGroup").get("currentOperation"),
            action: "dropped",
            value: blockValue,
            id: this.get("slotId")
          }
        });
      }
    };

    SlotModel.prototype.setValue = function(value, options) {
      return this.get("internalBlock").setData(value, options);
    };

    SlotModel.prototype.getValue = function() {
      var data;
      if (this.get("externalBlock") != null) {
        data = this.get("externalBlock").getValue();
      } else if (this.get("internalBlock") != null) {
        data = this.get("internalBlock").getValue();
      } else {
        data = null;
      }
      return data;
    };

    SlotModel.prototype.getBlock = function() {
      var block;
      if (this.get("externalBlock") != null) {
        block = this.get("externalBlock");
      } else {
        block = this.get("internalBlock");
      }
      return block;
    };

    SlotModel.prototype.getState = function() {
      var result;
      result = "ready";
      if (this.get("externalBlock") != null) {
        result = this.get("externalBlock").get("fetchState");
      } else if (this.get("internalBlock") != null) {
        result = this.get("internalBlock").get("fetchState");
      }
      return result;
    };

    SlotModel.prototype.getOwnerBlockGroup = function() {
      return this.get("ownerSlotGroup").getBlockGroup();
    };

    SlotModel.prototype.removeFromProject = function() {
      if (this.get("externalBlock") != null) {
        this.popBlock();
      }
      return SlotModel.__super__.removeFromProject.call(this);
    };

    return SlotModel;

  })(quadrigram.Models.QModel);

  quadrigram.Models.SlotModel.setup();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.SlotCollection = (function(_super) {
    __extends(SlotCollection, _super);

    function SlotCollection() {
      _ref = SlotCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SlotCollection.prototype.model = quadrigram.Models.SlotModel;

    return SlotCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.VisualizerModel = (function(_super) {
    __extends(VisualizerModel, _super);

    function VisualizerModel() {
      this.createFromJSON = __bind(this.createFromJSON, this);
      this.duplicate = __bind(this.duplicate, this);
      this.info = __bind(this.info, this);
      this.toJSON = __bind(this.toJSON, this);
      this.handleWrongData = __bind(this.handleWrongData, this);
      this.updateOutput = __bind(this.updateOutput, this);
      this._flattenModel = __bind(this._flattenModel, this);
      this.getFlatModel = __bind(this.getFlatModel, this);
      this.getValues = __bind(this.getValues, this);
      this.getIds = __bind(this.getIds, this);
      this.getPropertiesCollection = __bind(this.getPropertiesCollection, this);
      this.getProperty = __bind(this.getProperty, this);
      this.setProperty = __bind(this.setProperty, this);
      this.insertToDataSlot = __bind(this.insertToDataSlot, this);
      this.activateProperty = __bind(this.activateProperty, this);
      this.createOutputs = __bind(this.createOutputs, this);
      this.createProperties = __bind(this.createProperties, this);
      this.setFrame = __bind(this.setFrame, this);
      this.handleChildModified = __bind(this.handleChildModified, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      this.initialize = __bind(this.initialize, this);
      _ref = VisualizerModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VisualizerModel.DEACTIVATED = "@QDeactivatedWord";

    VisualizerModel.prototype.behaviors = [];

    VisualizerModel.prototype.relations = [
      {
        type: Backbone.HasMany,
        key: 'propertiesCollection',
        relatedModel: "quadrigram.Models.PropertyModel",
        includeInJSON: true,
        collectionType: "quadrigram.Collections.PropertyCollection",
        reverseRelation: {
          key: 'ownerViz',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }, {
        type: Backbone.HasMany,
        key: 'outputBlocksCollection',
        relatedModel: "quadrigram.Models.DataBlockModel",
        includeInJSON: false,
        collectionType: "quadrigram.Collections.DataBlockCollection",
        reverseRelation: {
          key: 'outputOwnerViz',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }
    ];

    VisualizerModel.prototype.subModelTypes = {
      "BarChart": "quadrigram.Models.BarChartModel",
      "DonutChart": "quadrigram.Models.DonutChartModel",
      "Histogram": "quadrigram.Models.HistogramModel",
      "LineChart": "quadrigram.Models.LineChartModel",
      "LineAndBarChart": "quadrigram.Models.LineAndBarChartModel",
      "TextArea": "quadrigram.Models.TextAreaModel",
      "RectangleArea": "quadrigram.Models.RectangleAreaModel",
      "StackedAreaChart": "quadrigram.Models.StackedAreaChartModel",
      "ScatterPlot": "quadrigram.Models.ScatterPlotModel",
      "StackedBarChart": "quadrigram.Models.StackedBarChartModel",
      "GroupedBarChart": "quadrigram.Models.GroupedBarChartModel",
      "PointsInAMap": "quadrigram.Models.PointsInAMapModel",
      "HeatMap": "quadrigram.Models.HeatMapModel",
      "TreeMap": "quadrigram.Models.TreeMapModel",
      "PieChart": "quadrigram.Models.PieChartModel",
      "NetworkVisualizer": "quadrigram.Models.NetworkVisualizerModel",
      "RadialNetworkVisualizer": "quadrigram.Models.RadialNetworkVisualizerModel",
      "ListChart": "quadrigram.Models.ListChartModel",
      "LinkControl": "quadrigram.Models.LinkControlModel",
      "PictoGram": "quadrigram.Models.PictoGramModel",
      "MatrixChart": "quadrigram.Models.MatrixChartModel",
      "RadarChart": "quadrigram.Models.RadarChartModel",
      "ParalelCoords": "quadrigram.Models.ParalelCoordsModel",
      "Choropleth": "quadrigram.Models.ChoroplethModel",
      "SliderControl": "quadrigram.Models.SliderControlModel",
      "RangeControl": "quadrigram.Models.RangeControlModel",
      "DropDown": "quadrigram.Models.DropDownModel",
      "DynamicTextControl": "quadrigram.Models.DynamicTextControlModel",
      "TableControl": "quadrigram.Models.TableControlModel",
      "PlayPauseControl": "quadrigram.Models.PlayPauseControlModel",
      "LegendControl": "quadrigram.Models.LegendControlModel",
      "ImageControl": "quadrigram.Models.ImageControlModel",
      "IFrameControl": "quadrigram.Models.IFrameControlModel",
      "YoutubeControl": "quadrigram.Models.YoutubeControlModel",
      "ShareButtonsControl": "quadrigram.Models.ShareButtonsControlModel",
      "PageNavControl": "quadrigram.Models.PageNavControlModel",
      "ButtonControl": "quadrigram.Models.ButtonControlModel"
    };

    VisualizerModel.mergeInfo = function(meta, behaviors) {
      var behaviorInfo, behaviorPath, behaviorProperties, mergeProperties, metaProperties, output, _i, _len;
      mergeProperties = function(baseProperties, newProperties) {
        return _.deepObjectExtend(baseProperties, newProperties);
        /*for propertyKeyOnNew of newProperties
          currentProperty = baseProperties[propertyKeyOnNew]
          propertyOnNew = newProperties[propertyKeyOnNew]
          if currentProperty?
            for fieldKeyOnProperty of propertyOnNew
              currentProperty[fieldKeyOnProperty] = propertyOnNew[fieldKeyOnProperty]
          else
            baseProperties[propertyKeyOnNew] = propertyOnNew
        baseProperties
        */

      };
      output = JSON.parse(JSON.stringify(meta));
      metaProperties = output.properties;
      output.properties || (output.properties = {});
      behaviorProperties = {};
      for (_i = 0, _len = behaviors.length; _i < _len; _i++) {
        behaviorPath = behaviors[_i];
        behaviorInfo = eval(behaviorPath).info();
        behaviorProperties = mergeProperties(behaviorProperties, JSON.parse(JSON.stringify(behaviorInfo.properties)));
      }
      output.properties = mergeProperties(output.properties, behaviorProperties);
      return output;
    };

    VisualizerModel.prototype.initialize = function(attributes, options) {
      if (attributes.type === "TextArea") {
        /*
        flatModel = new Backbone.Model(attributes,options)
        vizDef = @info(@get("config"))
        preProps = []
        for propId of vizDef.properties
          savedObject = @.get("propertiesCollection").findWhere({"propId":propId})
          if !savedObject?
            p = new quadrigram.Models.ExportedPreProperty {"ownerViz":this,"propId":propId}
            preProps.push(p)
          else
            propertyDef = savedObject.attributes
            p = new quadrigram.Models.ExportedPreProperty {"ownerViz":this,"propId":propId}, {propDef:propertyDef}
            preProps.push(p)
            @.get("propertiesCollection").remove(savedObject,{silent:true})
        
        this.prePropertiesCollection = new Backbone.Collection preProps
        */

        /*BASURA
        
        this.getProperty = (propId)=>
          fakeProp = {}
          fakeProp.getValues = ()=>
            return attributes[propId] || 0
          return fakeProp
        this.setProperty = (propId,value)=>
          return
        this._flattenModel = ()=>
          this.flatModel = new Backbone.Model(attributes)
        return
        */

      }
      if (options != null) {
        if (options.addMode != null) {
          this.addMode = options.addMode;
        }
        if (options.options != null) {
          this.options || (this.options = {});
          _.extend(this.options, options.options);
        }
      }
      return VisualizerModel.__super__.initialize.call(this, attributes, options);
    };

    VisualizerModel.prototype.create = function(options) {
      var blockGroup;
      blockGroup = new quadrigram.Models.VizBlockGroupModel({
        "ownerViz": this,
        "project": quadrigram.router.dataModels.currentProject,
        "label": quadrigram.labelManager.getPropperName(this.get("type"))
      });
      this.createProperties();
      return this.createOutputs();
    };

    VisualizerModel.prototype.modelSetup = function(options) {
      /*WARNIGN: Esto no esta funcionando bien con muchas llamadas seguidas!!!!!*/

      var _this = this;
      this.userInteractive = false;
      this.flattenModel = _.debounce(this._flattenModel, 10);
      this.createProperties();
      this.createOutputs();
      this.on("wrongData", this.handleWrongData);
      return this.get("blockGroup").on("change:label", function() {
        return _this.trigger("changeGroupLabel");
      });
    };

    VisualizerModel.prototype.handleChildModified = function(model) {
      if (!model.get || model.get("role") !== "output") {
        return this.flattenModel();
      }
    };

    VisualizerModel.prototype.setFrame = function(frame) {
      this.getProperty("col").updateValues({
        "value": frame.col
      });
      this.getProperty("row").updateValues({
        "value": frame.row
      });
      this.getProperty("size_x").updateValues({
        "value": frame.size_x
      });
      this.getProperty("size_y").updateValues({
        "value": frame.size_y
      });
      return this.getProperty("page").updateValues({
        "value": frame.page
      });
    };

    VisualizerModel.prototype.createProperties = function() {
      var index, p, preProps, propId, propertyDef, savedObject, vizDef;
      vizDef = this.info(this.get("config"));
      preProps = [];
      index = 0;
      for (propId in vizDef.properties) {
        savedObject = this.get("propertiesCollection").findWhere({
          "propId": propId
        });
        if (savedObject == null) {
          propertyDef = vizDef.properties[propId];
          if (propertyDef.deprecated !== true) {
            p = new quadrigram.Models.PreProperty({
              "ownerViz": this,
              "propId": propId,
              "index": index,
              "sortingWeight": propertyDef.sortingWeight
            });
            p.on("activate-property", this.activateProperty, p);
            preProps.push(p);
          }
        } else {
          if (savedObject.get("type") === "propDef") {
            propertyDef = savedObject.attributes;
            p = new quadrigram.Models.PreProperty({
              "ownerViz": this,
              "propId": propId,
              "index": index,
              "sortingWeight": propertyDef.sortingWeight
            }, {
              propDef: propertyDef
            });
            p.on("activate-property", this.activateProperty, p);
            preProps.push(p);
            this.get("propertiesCollection").remove(savedObject, {
              silent: true
            });
          }
        }
        index += 1;
      }
      return this.prePropertiesCollection = new Backbone.Collection(preProps);
    };

    VisualizerModel.prototype.createOutputs = function() {
      var behaviorInfo, blockGroup, currentBlock, outputBlock, outputBlocks, outputId, outputInfo, outputLabel, outputType, _results;
      blockGroup = this.get("blockGroup");
      outputBlocks = [];
      behaviorInfo = this.info();
      _results = [];
      for (outputId in behaviorInfo.outputs) {
        outputInfo = behaviorInfo.outputs[outputId];
        currentBlock = blockGroup.get("blocksCollection").find(function(candidate) {
          return candidate.get("outputId") === outputId;
        });
        outputLabel = outputInfo.label ? outputInfo.label : outputId;
        outputType = outputInfo.outputType ? outputInfo.outputType : "default";
        if (!currentBlock && !outputInfo.deprecated) {
          outputBlock = new quadrigram.Models.DataBlockModel;
          outputBlock.set({
            "blockGroup": blockGroup,
            "outputOwnerViz": this,
            "role": "output",
            "outputId": outputId,
            "outputType": outputType,
            "label": outputLabel,
            "origin": "visualizer"
          }, {
            "silent": true
          });
          _results.push(outputBlock.setData(outputInfo["default"]));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    VisualizerModel.prototype.activateProperty = function(preProp) {
      var i, p, preBlock, preSlot, slot, _i, _j, _len, _len1, _ref1, _ref2, _results;
      this.prePropertiesCollection.remove(preProp);
      p = new quadrigram.Models.PropertyModel({
        "ownerViz": preProp.get("ownerViz"),
        "propId": preProp.get("propId"),
        "index": preProp.get("index"),
        "sortingWeight": preProp.get("sortingWeight")
      }, {
        preProp: preProp
      });
      preProp.trigger("replace-model", p);
      _ref1 = preProp.getSlots();
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        preSlot = _ref1[i];
        slot = p.getSlots()[i];
        preSlot.trigger("replace-model", slot);
        if (preSlot.get("externalBlock") != null) {
          slot.set("externalBlock", preSlot.get("externalBlock"));
        }
      }
      _ref2 = preProp.getBlocks();
      _results = [];
      for (i = _j = 0, _len1 = _ref2.length; _j < _len1; i = ++_j) {
        preBlock = _ref2[i];
        _results.push(preBlock.trigger("replace-model", p.getBlocks()[i]));
      }
      return _results;
    };

    VisualizerModel.prototype.insertToDataSlot = function(block) {
      var prop;
      prop = this.get("propertiesCollection").where({
        "propId": "data"
      })[0];
      if (!prop) {
        prop = this.prePropertiesCollection.where({
          "propId": "data"
        })[0];
      }
      if (!prop) {
        throw "VisualizerModel:setProperty-Property not found: data";
        return;
      }
      return prop.getSlots()[0].setExternalBlock(block);
    };

    VisualizerModel.prototype.setProperty = function(propId, newValues) {
      var prop;
      prop = this.get("propertiesCollection").where({
        "propId": propId
      })[0];
      if (!prop) {
        prop = this.prePropertiesCollection.where({
          "propId": propId
        })[0];
      }
      if (!prop) {
        throw "VisualizerModel:setProperty-Property not found: " + propId;
        return;
      }
      return prop.updateValues(newValues);
    };

    VisualizerModel.prototype.getProperty = function(propId) {
      var prop;
      prop = this.get("propertiesCollection").where({
        "propId": propId
      })[0];
      if (!prop) {
        prop = this.prePropertiesCollection.where({
          "propId": propId
        })[0];
      }
      if (!prop) {
        throw "VisualizerModel:getProperty-Property not found: " + propId;
        return;
      }
      return prop;
    };

    VisualizerModel.prototype.getPropertiesCollection = function() {
      var result;
      if (!this.get("propertiesCollection")) {
        result = this.prePropertiesCollection;
      } else if (!this.prePropertiesCollection) {
        result = this.get("propertiesCollection");
      } else {
        result = new Backbone.Collection([].concat(this.prePropertiesCollection.models, this.get("propertiesCollection").models));
      }
      result.comparator = function(prop) {
        return prop.get("index");
      };
      result.sort();
      return result;
    };

    VisualizerModel.prototype.getIds = function() {
      return this._ids;
    };

    VisualizerModel.prototype.getValues = function() {
      return this._values;
    };

    VisualizerModel.prototype.getFlatModel = function() {
      this._flattenModel();
      return this.flatModel;
    };

    VisualizerModel.prototype._flattenModel = function() {
      var b, changedProperties, globalState, isNew, prop, propState, requireMeta, value, _i, _j, _len, _len1, _ref1, _ref2;
      isNew = false;
      if (this.flatModel == null) {
        this.flatModel = new Backbone.Model();
      }
      if (!this._events["childModified"]) {
        this.on("childModified", this.handleChildModified);
      }
      changedProperties = {};
      globalState = "ready";
      _ref1 = this.getPropertiesCollection().models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        prop = _ref1[_i];
        if (prop.get("family") !== "layout") {
          if ((prop.getBlocks == null) || (prop.propDef == null)) {
            continue;
          }
          requireMeta = prop.propDef.requireMeta === true;
          if (prop.getBlocks().length === 0) {
            value = quadrigram.Models.VisualizerModel.DEACTIVATED;
          } else if (prop.getBlocks().length === 1) {
            if (prop.getBlocks()[0] != null) {
              value = BlockUtils.adaptFlattenBlockToVisualizers(prop.getBlocks()[0].toJSON(), requireMeta);
            }
          } else {
            value = [];
            _ref2 = prop.getBlocks();
            for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
              b = _ref2[_j];
              if (b != null) {
                value.push(BlockUtils.adaptFlattenBlockToVisualizers(b.toJSON(), requireMeta));
              } else {
                elog("undefined block inside prop");
              }
            }
          }
          if (_.isArray(value)) {
            value["currentFormat"] = prop.get("currentFormat");
          }
          if (!BlockUtils.isEqual(this.flatModel.get(prop.get("propId")), value, ["metadata", "metaData", "label", "operator", "insideSlot"])) {
            changedProperties[prop.get("propId")] = value;
          }
          propState = prop.getState();
          if (propState !== "ready") {
            globalState = propState;
          }
        }
      }
      changedProperties["fetchState"] = globalState;
      this.flatModel.set(changedProperties);
      this.flatModel.behaviors = this.constructor.behaviors;
      this.flatModel.original = this;
      return this.newExternal = null;
    };

    VisualizerModel.prototype.updateOutput = function(outputId, newValue, newMeta) {
      var candidates, outputBlock;
      candidates = this.get("outputBlocksCollection").where({
        "role": "output",
        "outputId": outputId
      });
      if (candidates.length > 0) {
        outputBlock = candidates[0];
        if (newMeta != null) {
          outputBlock.set("metaData", newMeta, {
            silent: true
          });
        }
        return outputBlock.setData(newValue);
      } else {

      }
    };

    VisualizerModel.prototype.handleWrongData = function(changed) {
      var key, prop, s, _i, _len, _ref1, _results;
      key = Object.keys(changed)[0];
      prop = this.getPropertiesCollection().findWhere({
        propId: key
      });
      log("last data was wrong", prop);
      if (this.newExternal != null) {
        _ref1 = prop.getSlots();
        _results = [];
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          s = _ref1[_i];
          _results.push(s.animatedPop());
        }
        return _results;
      }
    };

    VisualizerModel.prototype.toJSON = function(options) {
      var p, result, _i, _len, _ref1;
      result = VisualizerModel.__super__.toJSON.call(this, options);
      _ref1 = this.prePropertiesCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.defaultsModified) {
          result.propertiesCollection.push(p.toJSON());
        }
      }
      return result;
    };

    VisualizerModel.prototype.info = function() {
      if (this.output == null) {
        this.output = quadrigram.Models.VisualizerModel.mergeInfo(this.constructor.meta, this.constructor.behaviors);
      }
      return this.output;
    };

    VisualizerModel.prototype.duplicate = function() {
      var candidate, getNewId, groupjson, layoutData, newGroup, newViz, pj, pp, prop, propsjson, slot, vizModelClass, vizjson, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _ref2,
        _this = this;
      getNewId = function(oldid) {
        var idBase;
        idBase = oldid.substring(0, oldid.indexOf("_"));
        return quadrigram.idManager.getId(idBase + "_");
      };
      groupjson = this.get("blockGroup").toJSON({
        ommitData: true
      });
      groupjson.id = getNewId(groupjson.id);
      groupjson.label = quadrigram.labelManager.getPropperName(groupjson.label);
      groupjson.ownerViz = null;
      groupjson.blocksCollection = [];
      vizjson = this.toJSON({
        ommitData: true
      });
      vizjson.id = getNewId(vizjson.id);
      vizjson.blockGroup = groupjson.id;
      propsjson = vizjson.propertiesCollection;
      for (_i = 0, _len = propsjson.length; _i < _len; _i++) {
        prop = propsjson[_i];
        if (prop.id != null) {
          prop.id = getNewId(prop.id);
        }
        if (prop.ownerViz != null) {
          prop.ownerViz = null;
        }
      }
      for (_j = 0, _len1 = propsjson.length; _j < _len1; _j++) {
        prop = propsjson[_j];
        if (prop.type !== "propDef") {
          prop.ownerViz = vizjson.id;
        }
        if (prop.slotsCollection != null) {
          prop.slotsCollection.ownerSlotGroup = null;
          _ref1 = prop.slotsCollection;
          for (_k = 0, _len2 = _ref1.length; _k < _len2; _k++) {
            slot = _ref1[_k];
            slot.id = getNewId(slot.id);
            slot.ownerSlotGroup = null;
          }
        }
        /*OLD
        if prop.family=="layout"
          layoutData = quadrigram.router.dataModels.currentProject.get("layoutData")
          candidate = _.find(layoutData,(ld)=>
            return ld.vizID == this.get("id")
          )
          prop.formats.Number.defaults.value = candidate[prop.propId]
        */

      }
      layoutData = quadrigram.router.dataModels.currentProject.get("layoutData");
      candidate = _.find(layoutData, function(ld) {
        return ld.vizID === _this.get("id");
      });
      _ref2 = this.prePropertiesCollection.where({
        "family": "layout"
      });
      for (_l = 0, _len3 = _ref2.length; _l < _len3; _l++) {
        pp = _ref2[_l];
        if (_.findWhere(propsjson, {
          "propId": pp.get("propId")
        }) == null) {
          pj = pp.toJSON();
          pj.formats.Number.defaults.value = candidate[pj.propId];
          propsjson.push(pj);
        }
      }
      vizjson.outputBlocksCollection = [];
      /*
      vizjson.blockGroup= groupjson
      @createFromJSON(vizjson)
      */

      newGroup = new quadrigram.Models.VizBlockGroupModel(groupjson);
      vizModelClass = eval("quadrigram.Models." + vizjson.type + "Model");
      newViz = new vizModelClass(vizjson, {
        addMode: "float",
        options: {
          initialPos: {
            x: 1,
            y: 1
          }
        }
      });
      return quadrigram.router.appViews.projectView.changeVisualizerFrame(false);
    };

    VisualizerModel.prototype.createFromJSON = function(vizjson) {
      var newGroup, newViz, vizModelClass;
      newGroup = new quadrigram.Models.VizBlockGroupModel(vizjson.blockGroup);
      vizModelClass = eval("quadrigram.Models." + vizjson.type + "Model");
      newViz = new vizModelClass(vizjson, {
        addMode: "float",
        options: {
          initialPos: {
            x: 1,
            y: 1
          }
        }
      });
      return quadrigram.router.appViews.projectView.changeVisualizerFrame(false);
    };

    return VisualizerModel;

  }).call(this, quadrigram.Models.QModel);

  quadrigram.Models.VisualizerModel.setup();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.VisualizerCollection = (function(_super) {
    __extends(VisualizerCollection, _super);

    function VisualizerCollection() {
      _ref = VisualizerCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VisualizerCollection.prototype.model = quadrigram.Models.VisualizerModel;

    return VisualizerCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.BarChartModel = (function(_super) {
    __extends(BarChartModel, _super);

    function BarChartModel() {
      _ref = BarChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BarChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.OneDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.XAndYAxisBehavior", "quadrigram.Models.TooltipBehavior"];

    BarChartModel.meta = {
      "name": "BarChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a list of numbers to represent as bars",
          "label": "Height of each bar",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "requireMeta": true,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Item 1",
                    "value": 20
                  }, {
                    "id": "Item 2",
                    "value": 30
                  }, {
                    "id": "Item 3",
                    "value": 40
                  }, {
                    "id": "Item 4",
                    "value": 50
                  }, {
                    "id": "Item 5",
                    "value": 60
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each bar",
          "hidden": false,
          "uiTipContent": "Defines the color of each bar",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": "0",
                    "value": "#989FCC"
                  }
                ]
              }
            }
          }
        },
        "fillOpacities": {
          "label": "Fill opacity of each bar",
          "hidden": true,
          "formats": {
            "Percentage": {
              "defaults": {
                "value": 100
              },
              "multiValues": {
                "value": true
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each bar",
          "hidden": true,
          "multiValues": {
            "value": true
          },
          "formats": {
            "Color": {
              "defaults": {
                "value": "#434c88"
              }
            }
          }
        },
        "lineThickness": {
          "label": "Outline thickness of each bar"
        },
        "lineOpacities": {
          "label": "Outline opacity of each bar",
          "formats": {
            Percentage: {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 0
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "IdsOnAxis": {
          "label": "Direction of the bars",
          "family": "axis",
          "sortingWeight": "0",
          "hidden": false,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Vertical"
              },
              "options": {
                "value": ["Vertical", "Horizontal"]
              }
            }
          }
        },
        "gapBetweenBars": {
          "label": "Gap between bars",
          "family": "style",
          "sortingWeight": "29",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "10"
              }
            }
          }
        },
        axisXRange: {
          internal: true
        }
      }
    };

    BarChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(BarChartModel.meta, BarChartModel.behaviors);
      return output;
    };

    return BarChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.DonutChartModel = (function(_super) {
    __extends(DonutChartModel, _super);

    function DonutChartModel() {
      _ref = DonutChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DonutChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.OneDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.SvgBehavior", "quadrigram.Models.TooltipBehavior", "quadrigram.Models.TextStyleBehavior"];

    DonutChartModel.meta = {
      "name": "DonutChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a list of numbers to represent as sectors",
          "label": "Angle of each sector",
          "family": "data",
          "sortingWeight": "1",
          "requireMeta": true,
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Sector 1",
                    "value": 20
                  }, {
                    "id": "Sector 2",
                    "value": 30
                  }, {
                    "id": "Sector 3",
                    "value": 40
                  }, {
                    "id": "Sector 4",
                    "value": 50
                  }, {
                    "id": "Sector 5",
                    "value": 60
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each sector",
          "hidden": false,
          "uiTipContent": "Defines the color of each sector"
        },
        "fillOpacities": {
          "label": "Fill opacity of each sector",
          "hidden": true,
          "formats": {
            "Percentage": {
              "defaults": {
                "value": 100
              },
              "multiValues": {
                "value": true
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each sector",
          "hidden": true,
          "multiValues": {
            "value": true
          },
          "defaults": {
            "value": "#FFFFFF"
          }
        },
        "lineThickness": {
          "label": "Outline thickness of each sector"
        },
        "lineOpacities": {
          "label": "Outline opacity of each sector",
          "formats": {
            Percentage: {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 0
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "innerRadius": {
          "label": "Inner Radius",
          "uiTipContent": "Percentage of the sector radius assigned to the inner hole",
          "family": "style",
          "sortingWeight": "30",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "60"
              }
            }
          }
        },
        "labelsOption": {
          "label": "Display labels",
          "uiTipContent": "Display sector labels or not. The auto mode will hide the labels if more than twenty sectors were drawn",
          "family": "style",
          "sortingWeight": "30",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "auto"
              },
              "options": {
                "value": ["hide", "auto", "show"]
              }
            }
          }
        }
      }
    };

    DonutChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(DonutChartModel.meta, DonutChartModel.behaviors);
      return output;
    };

    return DonutChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.HistogramModel = (function(_super) {
    __extends(HistogramModel, _super);

    function HistogramModel() {
      _ref = HistogramModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    HistogramModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.OneDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.XAndYAxisBehavior", "quadrigram.Models.TooltipBehavior"];

    HistogramModel.meta = {
      "name": "BarChart",
      "outputs": {
        "selectedIndexes": {
          "outputType": "selection",
          "default": [],
          "label": "Selected Items"
        },
        "selectedValues": {
          internal: true,
          deprecated: true
        },
        "mouseOverItem": {
          "outputType": "OnOver",
          "default": [],
          "label": "Hovered item"
        },
        "selectedColor": {
          "outputType": "styles",
          "default": [],
          "label": "Colors of selection"
        },
        "selectedItemsInBin": {
          "outputType": "selection",
          "default": [],
          "label": "Items in the selected bin"
        },
        "selectedValuesInBin": {
          "outputType": "selection",
          "default": [],
          "label": "Values in the selected bin"
        },
        "minimumBinValue": {
          "outputType": "selection",
          "default": [],
          "label": "The minimum value of the selected bin(s)"
        },
        "maximumBinValue": {
          "outputType": "selection",
          "default": [],
          "label": "The maximum value of the selected bin(s)"
        }
      },
      "properties": {
        "data": {
          "uiTipContent": "Insert a list of numbers to represent as bars",
          "label": "Height of each bar",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Random values"
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": 1
                  }, {
                    "id": "2",
                    "value": 30
                  }, {
                    "id": "3",
                    "value": 40
                  }, {
                    "id": "4",
                    "value": 50
                  }, {
                    "id": "5",
                    "value": 0
                  }, {
                    "id": "6",
                    "value": 12
                  }, {
                    "id": "7",
                    "value": 34
                  }, {
                    "id": "8",
                    "value": 82
                  }, {
                    "id": "9",
                    "value": 43
                  }, {
                    "id": "10",
                    "value": 33
                  }, {
                    "id": "11",
                    "value": 62
                  }, {
                    "id": "12",
                    "value": 7
                  }, {
                    "id": "13",
                    "value": 12
                  }, {
                    "id": "14",
                    "value": 24
                  }, {
                    "id": "15",
                    "value": 30
                  }, {
                    "id": "16",
                    "value": 43
                  }, {
                    "id": "17",
                    "value": 31
                  }, {
                    "id": "18",
                    "value": 12
                  }, {
                    "id": "19",
                    "value": 83
                  }, {
                    "id": "20",
                    "value": 100
                  }
                ]
              }
            }
          }
        },
        "bins": {
          "uiTipContent": "Specifies how to bin values in the histogram. If the property is set as deactivated, the visualizer will calculate the number of bins to set.",
          "label": "Bins",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Bins"
              },
              "defaults": {
                "value": 5
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each item",
          "uiTipContent": "Defines the color of each item",
          "family": "style",
          "sortingWeight": "21",
          "hidden": false,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#293990"
              }
            },
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            }
          }
        },
        "fillOpacities": {
          "label": "Fill opacity of each bar",
          "hidden": true,
          "formats": {
            "Percentage": {
              "defaults": {
                "value": 100
              },
              "multiValues": {
                "value": true
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each bar",
          "hidden": true,
          "multiValues": {
            "value": true
          },
          "defaults": {
            "value": "#FFFFFF"
          }
        },
        "lineThickness": {
          "label": "Outline thickness of each bar"
        },
        "lineOpacities": {
          "label": "Outline opacity of each bar",
          "formats": {
            Percentage: {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 0
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "IdsOnAxis": {
          "label": "Direction of the bars",
          "family": "axis",
          "sortingWeight": "0",
          "hidden": false,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Vertical"
              },
              "options": {
                "value": ["Vertical", "Horizontal"]
              }
            }
          }
        },
        "gapBetweenBars": {
          "label": "Gap between bars",
          "family": "style",
          "sortingWeight": "29",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "10"
              }
            }
          }
        },
        axisXRange: {
          internal: true
        }
      }
    };

    HistogramModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(HistogramModel.meta, HistogramModel.behaviors);
      return output;
    };

    return HistogramModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.LineChartModel = (function(_super) {
    __extends(LineChartModel, _super);

    function LineChartModel() {
      _ref = LineChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LineChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TwoDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SVGShapesBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.ZoomableXAndYAxisBehavior", "quadrigram.Models.TwoDimTooltipBehavior"];

    LineChartModel.meta = {
      "name": "LineChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a block with columns of numbers. Each column (or row) will be represented as a line",
          "label": "Data to plot in line",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "requireMeta": true,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example Data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Line 1",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 20
                      }, {
                        "id": "Day 2",
                        "value": 12
                      }, {
                        "id": "Day 3",
                        "value": 20
                      }, {
                        "id": "Day 4",
                        "value": 40
                      }, {
                        "id": "Day 5",
                        "value": 30
                      }, {
                        "id": "Day 6",
                        "value": 25
                      }, {
                        "id": "Day 7",
                        "value": 12
                      }, {
                        "id": "Day 8",
                        "value": 22
                      }
                    ]
                  }, {
                    "id": "Line 2",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 20
                      }, {
                        "id": "Day 2",
                        "value": 10
                      }, {
                        "id": "Day 3",
                        "value": 15
                      }, {
                        "id": "Day 4",
                        "value": 30
                      }, {
                        "id": "Day 5",
                        "value": 20
                      }, {
                        "id": "Day 6",
                        "value": 50
                      }, {
                        "id": "Day 7",
                        "value": 50
                      }, {
                        "id": "Day 8",
                        "value": 50
                      }
                    ]
                  }, {
                    "id": "Line 3",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 10
                      }, {
                        "id": "Day 2",
                        "value": 25
                      }, {
                        "id": "Day 3",
                        "value": 20
                      }, {
                        "id": "Day 4",
                        "value": 30
                      }, {
                        "id": "Day 5",
                        "value": 30
                      }, {
                        "id": "Day 6",
                        "value": 45
                      }, {
                        "id": "Day 7",
                        "value": 52
                      }, {
                        "id": "Day 8",
                        "value": 32
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "hidden": true,
          "internal": true
        },
        "fillOpacities": {
          "hidden": true,
          "internal": true
        },
        "lineColors": {
          "hidden": false,
          "label": "Color of each line",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(255,82,82),   rgb(128,137,124) 16.67%, rgb(0,191,165) 33.33%,  rgb(127,204,109) 50%,   rgb(253,216,53) 66.67%,  rgb(127,181,144) 83.33%, rgb(0,145,234) 100%)"
              }
            }
          }
        },
        "lineThickness": {
          "label": "Thickness of each line",
          "formats": {
            "Px": {
              "defaults": {
                "value": "2px"
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Opacity of each line"
        },
        "interpolation": {
          "label": "Line interpolation",
          "uiTipContent": "Defines how to interpolate the lines between the control points",
          "sortingWeight": "8",
          "family": "style",
          "hidden": true,
          "internal": false,
          "formats": {
            "Options": {
              "defaults": {
                "value": "Linear"
              },
              "multiValues": {
                "value": false
              },
              "options": {
                "value": ["Linear", "Smooth", "Steps"]
              }
            }
          }
        },
        "displayBreakpoints": {
          "label": "Display control points",
          "sortingWeight": "9",
          "family": "style",
          "hidden": true,
          "internal": false,
          "formats": {
            "Boolean": {
              "defaults": {
                "value": true
              },
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionLineThickness": {
          "label": "Thickness of selected lines",
          "formats": {
            "Px": {
              "defaults": {
                "value": "4px"
              },
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionLineOpacities": {
          "label": "Opacity of selected lines"
        },
        "selectionLineColors": {
          "label": "Color of selected lines"
        },
        "selectionFillColors": {
          "hidden": true,
          "internal": true
        },
        "selectionFillOpacities": {
          "hidden": true,
          "internal": true
        },
        "zoom": {
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "None"
              },
              "options": {
                "value": ["X and Y", "Only X", "Only Y", "None"]
              }
            }
          }
        },
        "shapeType": {
          "label": "Shape of each control point",
          "sortingWeight": "91"
        },
        "shapeSize": {
          "label": "Size of the control points",
          "sortingWeight": "92"
        }
      }
    };

    LineChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(LineChartModel.meta, LineChartModel.behaviors);
      return output;
    };

    return LineChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.LineAndBarChartModel = (function(_super) {
    __extends(LineAndBarChartModel, _super);

    function LineAndBarChartModel() {
      _ref = LineAndBarChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LineAndBarChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TwoPlusOneDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.SecondSelectionSVGBehavior", "quadrigram.Models.DoubleAxisBehavior", "quadrigram.Models.TooltipBehavior", "quadrigram.Models.SecondTwoDimTooltipBehavior"];

    LineAndBarChartModel.meta = {
      "name": "BarsAndLineChart",
      "properties": {
        "data1": {
          "uiTipContent": "Insert a list of numbers to represent as bars",
          "label": "Height of each bar",
          "family": "data",
          "sortingWeight": "1",
          "requireMeta": true,
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example Bar data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": 20
                  }, {
                    "id": "2",
                    "value": 50
                  }, {
                    "id": "3",
                    "value": 70
                  }, {
                    "id": "4",
                    "value": 30
                  }, {
                    "id": "5",
                    "value": 90
                  }
                ]
              }
            }
          }
        },
        "data2": {
          "uiTipContent": "Insert a list of numbers to represent as bars",
          "label": "Line data...",
          "family": "data",
          "sortingWeight": "2",
          "requireMeta": true,
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example line data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Line 1",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "1",
                        "value": 10
                      }, {
                        "id": "2",
                        "value": 40
                      }, {
                        "id": "3",
                        "value": 30
                      }, {
                        "id": "4",
                        "value": 60
                      }, {
                        "id": "5",
                        "value": 25
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "sortingWeight": "0",
          "label": "Fill color of each bar",
          "hidden": false,
          "uiTipContent": "Defines the color of each bar"
        },
        "lineColors2": {
          "sortingWeight": "1",
          "label": "Color of each line",
          "hidden": false,
          "multiValues": {
            "value": true
          },
          "defaults": {
            "value": "#FFFFFF"
          }
        },
        "fillColors2": {
          "internal": true
        },
        "fillOpacities": {
          "sortingWeight": "3",
          "label": "Fill opacity of each bar",
          "hidden": true,
          "formats": {
            "Percentage": {
              "defaults": {
                "value": 100
              },
              "multiValues": {
                "value": true
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "fillOpacities2": {
          "internal": true
        },
        "lineColors": {
          "internal": true,
          "label": "Outline color of each bar",
          "hidden": true,
          "multiValues": {
            "value": true
          },
          "defaults": {
            "value": "#FFFFFF"
          }
        },
        "lineThickness": {
          "label": "Outline thickness of each bar",
          "internal": true
        },
        "lineThickness2": {
          "sortingWeight": "2",
          "label": "Thickness of each line"
        },
        "lineOpacities": {
          "internal": true,
          "label": "Outline opacity of each bar",
          "formats": {
            Percentage: {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 0
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "lineOpacities2": {
          "sortingWeight": "4",
          "label": "Opacity of each line"
        },
        "IdsOnAxis": {
          "internal": true,
          "label": "Direction of the bars",
          "family": "axis",
          "sortingWeight": "10",
          "hidden": false,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Vertical"
              },
              "options": {
                "value": ["Vertical", "Horizontal"]
              }
            }
          }
        },
        "gapBetweenBars": {
          "label": "Gap between bars",
          "family": "style",
          "sortingWeight": "29",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "50"
              }
            }
          }
        },
        axisLabels: {
          idSource: {
            value: "visualizer.ids"
          }
        },
        axisRange2: {
          "uiTipContent": "Defines the visible range of values on Axis",
          label: "Visible range of right Y Axis (lines)",
          sortingWeight: "3",
          family: "axis",
          hidden: true,
          deprecated: true,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            SimpleRange: {
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            }
          }
        },
        axisY2Range: {
          "uiTipContent": "Defines the visible range of values on the lines Y Axis (left)",
          label: "Visible range of lines Axis (left)",
          sortingWeight: "31"
        },
        axisYRange: {
          "uiTipContent": "Defines the visible range of values on the bars Y Axis (right)",
          label: "Visible range of bars Axis (right)",
          sortingWeight: "32"
        },
        axisYTitle: {
          "uiTipContent": "Defines the title of the lines Y Axis (left)",
          label: "Lines Axis title (left)",
          sortingWeight: "22"
        },
        axisY2Title: {
          "uiTipContent": "Defines the title of the bars Y Axis (right)",
          label: "Bars Axis title (right)",
          sortingWeight: "23"
        },
        selectedItems: {
          label: "Ids of the selected bars"
        },
        selectedItems2: {
          label: "Ids of the selected lines"
        },
        forceSelection: {
          label: "Always one bar selected",
          hidden: true,
          formats: {
            Boolean: {
              defaults: {
                value: false
              }
            }
          }
        },
        forceSelection2: {
          label: "Always one line selected",
          hidden: true,
          formats: {
            Boolean: {
              defaults: {
                value: false
              }
            }
          }
        },
        selectionMode: {
          label: "Type of selection for bars"
        },
        selectionMode2: {
          label: "Type of selection for lines"
        },
        selectionFillColors: {
          label: "Color of selected bars"
        },
        selectionFillColors2: {
          internal: true
        },
        selectionFillOpacities: {
          label: "Opacity of selected bars"
        },
        selectionFillOpacities2: {
          internal: true
        },
        selectionLineColors: {
          label: "Outline color of selected bars"
        },
        selectionLineColors2: {
          label: "Color of selected lines"
        },
        selectionLineThickness: {
          label: "Outline thickness of selected bars"
        },
        selectionLineThickness2: {
          label: "Thickness of selected lines"
        },
        selectionLineOpacities: {
          label: "Outline opacity of selected bars"
        },
        selectionLineOpacities2: {
          label: "Opacity of selected lines"
        },
        tooltipActive: {
          label: "Use tooltips for bars",
          sortingWeight: "0"
        },
        tooltipActive2: {
          label: "Use tooltips for lines",
          sortingWeight: "1"
        },
        tooltipTitle: {
          label: "Tooltip titles for bars",
          sortingWeight: "2"
        },
        tooltipTitle2: {
          label: "Tooltip titles for lines",
          sortingWeight: "3"
        },
        tooltipValue: {
          label: "Tooltip values for bars",
          sortingWeight: "4"
        },
        tooltipValue2: {
          label: "Tooltip values for lines",
          sortingWeight: "5"
        },
        tooltipDescription: {
          label: "Tooltip descriptions for bars",
          sortingWeight: "6"
        },
        tooltipDescription2: {
          label: "Tooltip descriptions for lines",
          sortingWeight: "7"
        },
        tooltipImage: {
          label: "Tooltip Image urls for bars",
          sortingWeight: "8"
        },
        tooltipImage2: {
          label: "Tooltip Image urls for lines",
          sortingWeight: "9"
        },
        tooltipStyle: {
          label: "Tooltip styles for bars",
          sortingWeight: "10"
        },
        tooltipStyle2: {
          label: "Tooltip styles for lines",
          sortingWeight: "11"
        },
        uniformAxes: {
          internal: false
        }
      }
    };

    LineAndBarChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(LineAndBarChartModel.meta, LineAndBarChartModel.behaviors);
      return output;
    };

    return LineAndBarChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RadarChartModel = (function(_super) {
    __extends(RadarChartModel, _super);

    function RadarChartModel() {
      _ref = RadarChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RadarChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TwoDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.RadialAxisBehavior", "quadrigram.Models.RadarTooltipBehavior"];

    RadarChartModel.meta = {
      "name": "RadarChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a block with columns of numbers. Each column (or row) will be represented as a polygon",
          "label": "Data to plot in line",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example Data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Item 1",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Axis 1",
                        "value": 20
                      }, {
                        "id": "Axis 2",
                        "value": 20
                      }, {
                        "id": "Axis 3",
                        "value": 25
                      }, {
                        "id": "Axis 4",
                        "value": 30
                      }, {
                        "id": "Axis 5",
                        "value": 30
                      }
                    ]
                  }, {
                    "id": "Item 2",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Axis 1",
                        "value": 15
                      }, {
                        "id": "Axis 2",
                        "value": 40
                      }, {
                        "id": "Axis 3",
                        "value": 20
                      }, {
                        "id": "Axis 4",
                        "value": 32
                      }, {
                        "id": "Axis 5",
                        "value": 15
                      }
                    ]
                  }, {
                    "id": "Item 3",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Axis 1",
                        "value": 29
                      }, {
                        "id": "Axis 2",
                        "value": 10
                      }, {
                        "id": "Axis 3",
                        "value": 15
                      }, {
                        "id": "Axis 4",
                        "value": 14
                      }, {
                        "id": "Axis 5",
                        "value": 20
                      }
                    ]
                  }, {
                    "id": "Item 4",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Axis 1",
                        "value": 19
                      }, {
                        "id": "Axis 2",
                        "value": 46
                      }, {
                        "id": "Axis 3",
                        "value": 29
                      }, {
                        "id": "Axis 4",
                        "value": 38
                      }, {
                        "id": "Axis 5",
                        "value": 20
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(255,82,82),   rgb(128,137,124) 16.67%, rgb(0,191,165) 33.33%,  rgb(127,204,109) 50%,   rgb(253,216,53) 66.67%,  rgb(127,181,144) 83.33%, rgb(0,145,234) 100%)"
              }
            }
          }
        },
        "fillOpacities": {
          "label": "Fill opacity",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 30
              }
            }
          }
        },
        "lineColors": {
          "hidden": false,
          "label": "Line color",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(255,82,82),   rgb(128,137,124) 16.67%, rgb(0,191,165) 33.33%,  rgb(127,204,109) 50%,   rgb(253,216,53) 66.67%,  rgb(127,181,144) 83.33%, rgb(0,145,234) 100%)"
              }
            }
          }
        },
        "lineThickness": {
          "label": "Line thickness",
          "formats": {
            "Px": {
              "defaults": {
                "value": "2px"
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Line opacity"
        },
        "axisColor": {
          "uiTipContent": "Defines the color of the axes",
          "label": "Axes color",
          "family": "axis",
          "sortingWeight": "26",
          "hidden": true,
          "deprecated": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#888888"
              }
            }
          }
        },
        "axisThickness": {
          "uiTipContent": "Defines the thickness of the axes",
          "label": "Axes thickness",
          "family": "axis",
          "sortingWeight": "27",
          "hidden": true,
          "deprecated": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "1px"
              }
            }
          }
        },
        "axisOpacity": {
          "uiTipContent": "Defines the opacity of the axes",
          "label": "Axes opacity",
          "family": "axis",
          "sortingWeight": "28",
          "hidden": true,
          "deprecated": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "70"
              }
            }
          }
        },
        "labelColor": {
          "label": "Labels color",
          "uiTipContent": "Defines the color of labels",
          "family": "axis",
          "hidden": true,
          "deprecated": true,
          "formats": {
            "Color": {
              "defaults": {
                "value": "#444444"
              },
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "labelfontSize": {
          "label": "Label size",
          "uiTipContent": "Defines the font size of labels",
          "family": "axis",
          "hidden": true,
          "internal": true,
          "deprecated": true,
          "formats": {
            "Px": {
              "defaults": {
                "value": "12px"
              },
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "dimensionAsItems": {
          "uiTipContent": "Determines if each item (polygon) is a row or a column of the input table"
        },
        "interpolation": {
          "label": "Line interpolation",
          "uiTipContent": "Defines how to interpolate the lines between the control points",
          "family": "style",
          "hidden": true,
          "internal": false,
          "sortingWeight": "0",
          "formats": {
            "Options": {
              "defaults": {
                "value": "Segments"
              },
              "multiValues": {
                "value": false
              },
              "options": {
                "value": ["Segments", "Curves"]
              }
            }
          }
        },
        uniformAxes: {
          internal: false,
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        axisXRange: {
          internal: true
        }
      }
    };

    RadarChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(RadarChartModel.meta, RadarChartModel.behaviors);
      return output;
    };

    return RadarChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.StackedAreaChartModel = (function(_super) {
    __extends(StackedAreaChartModel, _super);

    function StackedAreaChartModel() {
      _ref = StackedAreaChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    StackedAreaChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TwoDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.ZoomableXAndYAxisBehavior", "quadrigram.Models.TwoDimTooltipBehavior"];

    StackedAreaChartModel.meta = {
      "name": "StackedAreaChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a block with columns of numbers. Each column (or row) will be represented as a line separating and the area below",
          "label": "Data to plot in line",
          "family": "data",
          "sortingWeight": "0",
          "hidden": false,
          "requireMeta": true,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example Data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Area 1",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 20
                      }, {
                        "id": "Day 2",
                        "value": 12
                      }, {
                        "id": "Day 3",
                        "value": 20
                      }, {
                        "id": "Day 4",
                        "value": 40
                      }, {
                        "id": "Day 5",
                        "value": 30
                      }, {
                        "id": "Day 6",
                        "value": 25
                      }, {
                        "id": "Day 7",
                        "value": 12
                      }, {
                        "id": "Day 8",
                        "value": 22
                      }
                    ]
                  }, {
                    "id": "Area 2",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 20
                      }, {
                        "id": "Day 2",
                        "value": 10
                      }, {
                        "id": "Day 3",
                        "value": 15
                      }, {
                        "id": "Day 4",
                        "value": 30
                      }, {
                        "id": "Day 5",
                        "value": 20
                      }, {
                        "id": "Day 6",
                        "value": 50
                      }, {
                        "id": "Day 7",
                        "value": 50
                      }, {
                        "id": "Day 8",
                        "value": 60
                      }
                    ]
                  }, {
                    "id": "Area 3",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 10
                      }, {
                        "id": "Day 2",
                        "value": 20
                      }, {
                        "id": "Day 3",
                        "value": 25
                      }, {
                        "id": "Day 4",
                        "value": 30
                      }, {
                        "id": "Day 5",
                        "value": 30
                      }, {
                        "id": "Day 6",
                        "value": 45
                      }, {
                        "id": "Day 7",
                        "value": 52
                      }, {
                        "id": "Day 8",
                        "value": 32
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each area",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(255,82,82),   rgb(128,137,124) 16.67%, rgb(0,191,165) 33.33%,  rgb(127,204,109) 50%,   rgb(253,216,53) 66.67%,  rgb(127,181,144) 83.33%, rgb(0,145,234) 100%)"
              }
            },
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    id: "example data 1",
                    value: "#AEB5DE"
                  }, {
                    id: "example data 2",
                    value: "#989FCC"
                  }, {
                    id: "example data 3",
                    value: "#8D91BC"
                  }
                ]
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Line opacity of each line",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 0
              }
            }
          }
        },
        "selectionLineThickness": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "2px"
              }
            }
          }
        },
        "dataGaps": {
          "internal": true,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "true"
              }
            }
          }
        }
      }
    };

    StackedAreaChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(StackedAreaChartModel.meta, StackedAreaChartModel.behaviors);
      return output;
    };

    return StackedAreaChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PictoGramModel = (function(_super) {
    __extends(PictoGramModel, _super);

    function PictoGramModel() {
      _ref = PictoGramModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PictoGramModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.OneDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.SvgBehavior", "quadrigram.Models.TooltipBehavior"];

    PictoGramModel.meta = {
      "name": "BarChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a list of numbers to represent as bars",
          "label": "Height of each bar",
          "family": "data",
          "sortingWeight": "1",
          "requireMeta": true,
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": 20
                  }, {
                    "id": "2",
                    "value": 30
                  }, {
                    "id": "3",
                    "value": 40
                  }, {
                    "id": "4",
                    "value": 50
                  }, {
                    "id": "5",
                    "value": 60
                  }
                ]
              }
            }
          }
        },
        "icon_url": {
          "uiTipContent": "Icon fdsfasd fadsf asd ",
          "label": "Icon",
          "family": "style",
          "sortingWeight": "0",
          "hidden": false,
          "formats": {
            "Options": {
              "label": "Build in icons",
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "person"
              },
              "options": {
                "value": ["person", "car", "house", "shopping_car", "flight", "walk", "bus", "boat", "train", "star", "bar", "coin", "document", "heart"]
              }
            },
            "ImageUrl": {
              "label": "External image",
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              },
              "options": {
                "scale": ["contain", "cover", "stretch", "preserve"]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each icon",
          "hidden": false,
          "uiTipContent": "Defines the color of each bar"
        },
        "fillOpacities": {
          "label": "Fill opacity of each icon",
          "hidden": true,
          "formats": {
            "Percentage": {
              "defaults": {
                "value": 100
              },
              "multiValues": {
                "value": true
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "lineColors": {
          "label": "line color of each icon",
          "hidden": true,
          "multiValues": {
            "value": true
          },
          "defaults": {
            "value": "#FFFFFF"
          }
        },
        "lineThickness": {
          "label": "line thickness of each icon"
        },
        "lineOpacities": {
          "label": "line opacity of each icon",
          "formats": {
            Percentage: {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 0
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "numIcons": {
          "label": "Total number of icons",
          "family": "data",
          "formats": {
            Number: {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": 100
              }
            }
          }
        },
        "iconPadding": {
          "label": "Separation between icons",
          "family": "style",
          "formats": {
            Percentage: {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": 20
              }
            }
          }
        },
        "selectionLineColors": {
          "uiTipContent": "Defines the color of the outline for the selected items",
          "label": "Outline color of selected items",
          "family": "select",
          "sortingWeight": "86",
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "transparent"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionLineThickness": {
          "uiTipContent": "Defines the thickness of the outline for the selected items",
          "label": "Line thickness of selected items",
          "family": "select",
          "sortingWeight": "87",
          "hidden": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "2px"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionFillColors": {
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#2861ff"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        }
      }
    };

    PictoGramModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(PictoGramModel.meta, PictoGramModel.behaviors);
      return output;
    };

    return PictoGramModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.MatrixChartModel = (function(_super) {
    __extends(MatrixChartModel, _super);

    function MatrixChartModel() {
      _ref = MatrixChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    MatrixChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.MatrixDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.SvgBehavior", "quadrigram.Models.TooltipBehavior", "quadrigram.Models.TextStyleSVGBehavior"];

    MatrixChartModel.meta = {
      "name": "LineChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a block with columns of numbers. Each column (or row) will be represented as a line",
          "label": "Data to plot in line",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "requireMeta": true,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example Data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Row 1",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 10
                      }, {
                        "id": "Col 2",
                        "value": 12
                      }, {
                        "id": "Col 3",
                        "value": 15
                      }, {
                        "id": "Col 4",
                        "value": 24
                      }, {
                        "id": "Col 5",
                        "value": 30
                      }, {
                        "id": "Col 6",
                        "value": 20
                      }, {
                        "id": "Col 7",
                        "value": 45
                      }, {
                        "id": "Col 8",
                        "value": 33
                      }, {
                        "id": "Col 9",
                        "value": 44
                      }, {
                        "id": "Col 10",
                        "value": 42
                      }
                    ]
                  }, {
                    "id": "Row 2",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 10
                      }, {
                        "id": "Col 2",
                        "value": 22
                      }, {
                        "id": "Col 3",
                        "value": 15
                      }, {
                        "id": "Col 4",
                        "value": 21
                      }, {
                        "id": "Col 5",
                        "value": 30
                      }, {
                        "id": "Col 6",
                        "value": 30
                      }, {
                        "id": "Col 7",
                        "value": 42
                      }, {
                        "id": "Col 8",
                        "value": 40
                      }, {
                        "id": "Col 9",
                        "value": 45
                      }, {
                        "id": "Col 10",
                        "value": 50
                      }
                    ]
                  }, {
                    "id": "Row 3",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 21
                      }, {
                        "id": "Col 2",
                        "value": 24
                      }, {
                        "id": "Col 3",
                        "value": 21
                      }, {
                        "id": "Col 4",
                        "value": 32
                      }, {
                        "id": "Col 5",
                        "value": 26
                      }, {
                        "id": "Col 6",
                        "value": 34
                      }, {
                        "id": "Col 7",
                        "value": 52
                      }, {
                        "id": "Col 8",
                        "value": 40
                      }, {
                        "id": "Col 9",
                        "value": 47
                      }, {
                        "id": "Col 10",
                        "value": 40
                      }
                    ]
                  }, {
                    "id": "Row 4",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 10
                      }, {
                        "id": "Col 2",
                        "value": 22
                      }, {
                        "id": "Col 3",
                        "value": 30
                      }, {
                        "id": "Col 4",
                        "value": 30
                      }, {
                        "id": "Col 5",
                        "value": 42
                      }, {
                        "id": "Col 6",
                        "value": 40
                      }, {
                        "id": "Col 7",
                        "value": 48
                      }, {
                        "id": "Col 8",
                        "value": 42
                      }, {
                        "id": "Col 9",
                        "value": 45
                      }, {
                        "id": "Col 10",
                        "value": 42
                      }
                    ]
                  }, {
                    "id": "Row 5",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 20
                      }, {
                        "id": "Col 2",
                        "value": 17
                      }, {
                        "id": "Col 3",
                        "value": 14
                      }, {
                        "id": "Col 4",
                        "value": 12
                      }, {
                        "id": "Col 5",
                        "value": 25
                      }, {
                        "id": "Col 6",
                        "value": 35
                      }, {
                        "id": "Col 7",
                        "value": 33
                      }, {
                        "id": "Col 8",
                        "value": 33
                      }, {
                        "id": "Col 9",
                        "value": 45
                      }, {
                        "id": "Col 10",
                        "value": 43
                      }
                    ]
                  }, {
                    "id": "Row 6",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 20
                      }, {
                        "id": "Col 2",
                        "value": 22
                      }, {
                        "id": "Col 3",
                        "value": 20
                      }, {
                        "id": "Col 4",
                        "value": 30
                      }, {
                        "id": "Col 5",
                        "value": 34
                      }, {
                        "id": "Col 6",
                        "value": 32
                      }, {
                        "id": "Col 7",
                        "value": 43
                      }, {
                        "id": "Col 8",
                        "value": 46
                      }, {
                        "id": "Col 9",
                        "value": 48
                      }, {
                        "id": "Col 10",
                        "value": 50
                      }
                    ]
                  }, {
                    "id": "Row 7",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 20
                      }, {
                        "id": "Col 2",
                        "value": 25
                      }, {
                        "id": "Col 3",
                        "value": 23
                      }, {
                        "id": "Col 4",
                        "value": 32
                      }, {
                        "id": "Col 5",
                        "value": 37
                      }, {
                        "id": "Col 6",
                        "value": 45
                      }, {
                        "id": "Col 7",
                        "value": 43
                      }, {
                        "id": "Col 8",
                        "value": 40
                      }, {
                        "id": "Col 9",
                        "value": 44
                      }, {
                        "id": "Col 10",
                        "value": 47
                      }
                    ]
                  }, {
                    "id": "Row 8",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 20
                      }, {
                        "id": "Col 2",
                        "value": 22
                      }, {
                        "id": "Col 3",
                        "value": 21
                      }, {
                        "id": "Col 4",
                        "value": 25
                      }, {
                        "id": "Col 5",
                        "value": 29
                      }, {
                        "id": "Col 6",
                        "value": 45
                      }, {
                        "id": "Col 7",
                        "value": 34
                      }, {
                        "id": "Col 8",
                        "value": 50
                      }, {
                        "id": "Col 9",
                        "value": 48
                      }, {
                        "id": "Col 10",
                        "value": 47
                      }
                    ]
                  }, {
                    "id": "Row 9",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 10
                      }, {
                        "id": "Col 2",
                        "value": 22
                      }, {
                        "id": "Col 3",
                        "value": 25
                      }, {
                        "id": "Col 4",
                        "value": 30
                      }, {
                        "id": "Col 5",
                        "value": 40
                      }, {
                        "id": "Col 6",
                        "value": 33
                      }, {
                        "id": "Col 7",
                        "value": 42
                      }, {
                        "id": "Col 8",
                        "value": 30
                      }, {
                        "id": "Col 9",
                        "value": 50
                      }, {
                        "id": "Col 10",
                        "value": 44
                      }
                    ]
                  }, {
                    "id": "Row 10",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Col 1",
                        "value": 30
                      }, {
                        "id": "Col 2",
                        "value": 22
                      }, {
                        "id": "Col 3",
                        "value": 40
                      }, {
                        "id": "Col 4",
                        "value": 50
                      }, {
                        "id": "Col 5",
                        "value": 45
                      }, {
                        "id": "Col 6",
                        "value": 39
                      }, {
                        "id": "Col 7",
                        "value": 47
                      }, {
                        "id": "Col 8",
                        "value": 44
                      }, {
                        "id": "Col 9",
                        "value": 43
                      }, {
                        "id": "Col 10",
                        "value": 42
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "valueFills": {
          "label": "Fill color of each cell",
          "uiTipContent": "Defines the color of each cell according to its value",
          "family": "style",
          "sortingWeight": "21",
          "hidden": false,
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(84,36,148) 12.5%,    rgb(142,36,170) 25%,    rgb(199,59,126) 37.5%,  rgb(288,82,82) 50%,      rgb(254,149,68) 62.5%,   rgb(253,216,53) 75%,    rgb(252,233,152) 87.5%,  rgb(250,250,250) 100%)"
              }
            },
            "Color": {
              "label": "Same color",
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#989FCC"
              }
            }
          }
        },
        "cellShape": {
          "label": "Shape of each cell",
          "uiTipContent": "Defines the shape of each item",
          "family": "style",
          "sortingWeight": "22",
          "hidden": true,
          "formats": {
            "Options": {
              "label": "Shape",
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "square"
              },
              "options": {
                "value": ["square", "circle"]
              }
            }
          }
        },
        "cellSize": {
          "label": "Size of each cell",
          "uiTipContent": "Defines the size of each item",
          "family": "style",
          "sortingWeight": "23",
          "hidden": true,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "PxRange": {
              "multiValues": {
                "min": false,
                "max": false
              },
              "defaults": {
                "min": "",
                "max": ""
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each item",
          "uiTipContent": "Defines the color of each item",
          "family": "style",
          "sortingWeight": "21",
          "hidden": true,
          "internal": true,
          "formats": {
            "ColorsByValues": {
              "multiValues": {
                "values": true,
                "colorscale": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": "1"
                  }, {
                    "id": "2",
                    "value": "2"
                  }, {
                    "id": "3",
                    "value": "3"
                  }, {
                    "id": "4",
                    "value": "4"
                  }, {
                    "id": "5",
                    "value": "5"
                  }
                ],
                "colorscale": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            }
          }
        },
        "fillOpacities": {
          "hidden": true,
          "internal": true
        },
        "lineColors": {
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#000"
              }
            }
          }
        },
        "lineThickness": {
          "hidden": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "0px"
              }
            }
          }
        },
        "lineOpacities": {
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "showLabels": {
          "family": "axis",
          "label": "Show labels",
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "true"
              }
            }
          }
        },
        "forceSelection": {
          "internal": true
        },
        "selectionMode": {
          "internal": true
        },
        "selectedItems": {
          "internal": true
        }
      }
    };

    MatrixChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(MatrixChartModel.meta, MatrixChartModel.behaviors);
      return output;
    };

    return MatrixChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ParalelCoordsModel = (function(_super) {
    __extends(ParalelCoordsModel, _super);

    function ParalelCoordsModel() {
      _ref = ParalelCoordsModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ParalelCoordsModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TwoDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.ParalelAxisBehavior", "quadrigram.Models.TwoDimTooltipBehavior"];

    ParalelCoordsModel.meta = {
      "name": "ParallelCoordinates",
      outputs: {
        "filteredIds": {
          "outputType": "selection",
          "sortingWeight": "50",
          "default": [],
          "label": "Filtered ids"
        },
        "filteredValues": {
          "outputType": "selection",
          "sortingWeight": "51",
          "default": [],
          "label": "Filtered values"
        }
      },
      "properties": {
        "data": {
          "uiTipContent": "Insert a block with columns of numbers. Each column (or row) will be represented as a polygon",
          "label": "Data to plot in line",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example Data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Item 1",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Axis 1",
                        "value": 1
                      }, {
                        "id": "Axis 2",
                        "value": 20
                      }, {
                        "id": "Axis 3",
                        "value": 0.2
                      }, {
                        "id": "Axis 4",
                        "value": 30
                      }, {
                        "id": "Axis 5",
                        "value": 30
                      }
                    ]
                  }, {
                    "id": "Item 2",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Axis 1",
                        "value": 5
                      }, {
                        "id": "Axis 2",
                        "value": 40
                      }, {
                        "id": "Axis 3",
                        "value": 0.6
                      }, {
                        "id": "Axis 4",
                        "value": 32
                      }, {
                        "id": "Axis 5",
                        "value": 15
                      }
                    ]
                  }, {
                    "id": "Item 3",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Axis 1",
                        "value": 10
                      }, {
                        "id": "Axis 2",
                        "value": 10
                      }, {
                        "id": "Axis 3",
                        "value": 0.4
                      }, {
                        "id": "Axis 4",
                        "value": 14
                      }, {
                        "id": "Axis 5",
                        "value": 20
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "lineThickness": {
          "label": "Line thickness",
          "formats": {
            "Px": {
              "defaults": {
                "value": "2px"
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Line opacity"
        },
        "axisColor": {
          "uiTipContent": "Defines the color of the axes",
          "label": "Axes color",
          "family": "axis",
          "sortingWeight": "26",
          "hidden": true,
          "deprectated": true,
          "internal": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#888888"
              }
            }
          }
        },
        "axisThickness": {
          "uiTipContent": "Defines the thickness of the axes",
          "label": "Axes thickness",
          "family": "axis",
          "sortingWeight": "27",
          "hidden": true,
          "deprectated": true,
          "internal": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "1px"
              }
            }
          }
        },
        "axisOpacity": {
          "uiTipContent": "Defines the opacity of the axes",
          "label": "Axes opacity",
          "family": "axis",
          "sortingWeight": "28",
          "hidden": true,
          "deprectated": true,
          "internal": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "70"
              }
            }
          }
        },
        "dimensionAsItems": {
          "uiTipContent": "Determines if each item (polygon) is a row or a column of the input table"
        },
        uniformAxes: {
          internal: false
        },
        xAxisGrid: {
          internal: true
        },
        axisXRange: {
          internal: true
        },
        axisLabels: {
          "uiTipContent": "Defines the text to display on the X axes",
          label: "Axes labels",
          sortingWeight: "5",
          family: "axis",
          multivalue: false,
          hidden: true,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Text: {
              multiValues: {
                value: true
              },
              defaults: {
                value: "Axis Label"
              },
              idSource: {
                value: "visualizer.dimensions"
              }
            }
          }
        },
        "fillColors": {
          "hidden": true,
          "internal": true
        },
        "fillOpacities": {
          "hidden": true,
          "internal": true
        },
        "lineColors": {
          "hidden": false,
          "label": "Color of each line",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(255,82,82),   rgb(128,137,124) 16.67%, rgb(0,191,165) 33.33%,  rgb(127,204,109) 50%,   rgb(253,216,53) 66.67%,  rgb(127,181,144) 83.33%, rgb(0,145,234) 100%)"
              }
            }
          }
        }
      }
    };

    ParalelCoordsModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ParalelCoordsModel.meta, ParalelCoordsModel.behaviors);
      return output;
    };

    return ParalelCoordsModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ChoroplethModel = (function(_super) {
    __extends(ChoroplethModel, _super);

    function ChoroplethModel() {
      _ref = ChoroplethModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ChoroplethModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.RegionsDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.SvgBehavior", "quadrigram.Models.TooltipBehavior"];

    ChoroplethModel.meta = {
      "name": "Choropleth",
      "properties": {
        "data": {
          "uiTipContent": "Insert a list of numbers to represent as bars",
          "label": "Regions to draw",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "requireMeta": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "World Countries (ISO2)"
              },
              "options": {
                "value": ["World Countries (ISO2)", "World Countries (ISO3)", "US States", "European Union", "Continents", "Barcelona"],
                "filename": ["world_iso2.svg", "world_iso3.svg", "Blank_US_Map.svg", "EU.svg", "Continents.svg", "BCN_LITE.svg"]
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "auto"
              },
              "options": {
                "value": ""
              }
            },
            "ImageUrl": {
              "label": "Image",
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "",
                "scale": "cover",
                "repeat": "false"
              },
              "options": {
                "scale": ["contain", "cover", "stretch", "preserve"]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each region",
          "uiTipContent": "Defines the color of each region",
          "family": "data",
          "proxyFamily": "style",
          "sortingWeight": "21",
          "requireMeta": true,
          "hidden": false,
          "formats": {
            "ColorsByValues": {
              "idSource": {
                "values": "visualizer.svgIds"
              },
              "multiValues": {
                "values": true,
                "colorscale": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": "1"
                  }, {
                    "id": "2",
                    "value": "2"
                  }, {
                    "id": "3",
                    "value": "3"
                  }, {
                    "id": "4",
                    "value": "4"
                  }, {
                    "id": "5",
                    "value": "5"
                  }
                ],
                "colorscale": "linear-gradient(90deg, rgb(207, 212, 236),rgb(141, 145, 188) 100%)",
                "defaultColor": "#9e9e9e"
              }
            },
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165) 25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            },
            "Color": {
              "multiValues": {
                "value": true
              },
              "idSource": {
                "value": "visualizer.svgIds"
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": "#989FCC"
                  }, {
                    "id": "2",
                    "value": "#8D91BC"
                  }, {
                    "id": "3",
                    "value": "#CFD4EC"
                  }, {
                    "id": "4",
                    "value": "#AEB5DE"
                  }, {
                    "id": "5",
                    "value": "#989FCC"
                  }
                ]
              }
            },
            "ColorsByCategories": {
              "multiValues": {
                "colors": true,
                "categories": true,
                "defaultColor": false
              },
              "idSource": {
                "colors": "categories"
              },
              "defaults": {
                "defaultColor": "#eee"
              }
            }
          }
        },
        "lineColors": {
          "uiTipContent": "Defines the color of the outline for each item",
          "label": "Outline color of each item",
          "family": "style",
          "sortingWeight": "23",
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#FFF"
              }
            }
          }
        },
        "lineOpacities": {
          "label": "line opacity of each icon",
          "formats": {
            Percentage: {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 20
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "lineThickness": {
          "formats": {
            "Px": {
              "defaults": {
                "value": "1px"
              }
            }
          }
        },
        "selectionLineThickness": {
          "formats": {
            "Px": {
              "defaults": {
                "value": "2px"
              }
            }
          }
        }
      }
    };

    ChoroplethModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ChoroplethModel.meta, ChoroplethModel.behaviors);
      return output;
    };

    return ChoroplethModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SlotGroupModel = (function(_super) {
    __extends(SlotGroupModel, _super);

    function SlotGroupModel() {
      this.getBlockGroup = __bind(this.getBlockGroup, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = SlotGroupModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SlotGroupModel.prototype.relations = [
      {
        type: Backbone.HasMany,
        key: 'slotsCollection',
        relatedModel: "quadrigram.Models.SlotModel",
        includeInJSON: true,
        collectionType: "quadrigram.Collections.SlotCollection",
        reverseRelation: {
          key: 'ownerSlotGroup',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }
    ];

    SlotGroupModel.prototype.subModelTypes = {
      "operator": "quadrigram.Models.OperatorModel",
      "property": "quadrigram.Models.PropertyModel",
      "propDef": "quadrigram.Models.PropDef"
    };

    SlotGroupModel.prototype.create = function() {};

    SlotGroupModel.prototype.modelSetup = function() {};

    SlotGroupModel.prototype.getBlockGroup = function() {};

    return SlotGroupModel;

  })(quadrigram.Models.QModel);

  quadrigram.Models.SlotGroupModel.setup();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.SlotGroupCollection = (function(_super) {
    __extends(SlotGroupCollection, _super);

    function SlotGroupCollection() {
      _ref = SlotGroupCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SlotGroupCollection.prototype.model = quadrigram.Models.SlotGroupModel;

    return SlotGroupCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PropertyModel = (function(_super) {
    __extends(PropertyModel, _super);

    function PropertyModel() {
      this.unregister = __bind(this.unregister, this);
      this.toJSON = __bind(this.toJSON, this);
      this.getDefaultAt = __bind(this.getDefaultAt, this);
      this.getSlots = __bind(this.getSlots, this);
      this.getBlocks = __bind(this.getBlocks, this);
      this.getBlockGroup = __bind(this.getBlockGroup, this);
      this.getSlotValue = __bind(this.getSlotValue, this);
      this.getState = __bind(this.getState, this);
      this.getValues = __bind(this.getValues, this);
      this.getSourceIds = __bind(this.getSourceIds, this);
      this.updateIds = __bind(this.updateIds, this);
      this.updateStaticData = __bind(this.updateStaticData, this);
      this.updateValues = __bind(this.updateValues, this);
      this.createSlots = __bind(this.createSlots, this);
      this.slotsFromManualValues = __bind(this.slotsFromManualValues, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = PropertyModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PropertyModel.prototype.undoableEvents = ["change:currentFormat:preSots"];

    PropertyModel.prototype.bubblingEvents = ["change:currentFormat"];

    PropertyModel.prototype.create = function(options) {
      var defaultFormat, propDef, vizDef;
      if ((options != null) && options.preProp) {
        propDef = options.preProp.propDef;
      } else {
        vizDef = this.get("ownerViz").info(this.get("ownerViz").get("config"));
        propDef = vizDef.properties[this.get("propId")];
      }
      this.propDef = propDef;
      if (_.isArray(this.propDef.formats)) {
        defaultFormat = this.propDef.formats[0];
      } else {
        if (this.propDef.currentFormat != null) {
          defaultFormat = this.propDef.currentFormat;
        } else {
          defaultFormat = Object.keys(this.propDef.formats)[0];
        }
      }
      this.set("label", propDef.label, {
        silent: true
      });
      this.set("family", propDef.family, {
        silent: true
      });
      this.set("hidden", propDef.hidden, {
        silent: true
      });
      this.set("internal", propDef.internal, {
        silent: true
      });
      this.set("currentFormat", defaultFormat, {
        silent: true
      });
      this.createSlots();
      if (_.isArray(this.propDef.formats)) {
        if (this.propDef.defaults) {
          return this.updateValues(this.propDef.defaults);
        } else {
          return this.updateValues({
            "value": ""
          });
        }
      } else {
        return this.updateValues(this.propDef.formats[this.get("currentFormat")].defaults);
      }
    };

    PropertyModel.prototype.modelSetup = function(options) {
      var vizDef,
        _this = this;
      vizDef = this.get("ownerViz").info(this.get("ownerViz").get("config"));
      this.propDef = vizDef.properties[this.get("propId")];
      /*
        This ignores the property that comes from the persistence data
        maybe because it's not part of the view anymore
      */

      if (this.propDef == null) {
        return;
      }
      if (this.propDef.family !== this.get('family')) {
        this.set('family', this.propDef.family);
      }
      if (this.propDef.formats[this.get('currentFormat')] == null) {
        this.set('currentFormat', Object.keys(this.propDef.formats)[0]);
      }
      this.slotsFromManualValues();
      this.updateStaticData();
      return this.on("change:currentFormat", function(changedModel) {
        if (changedModel.changed.currentFormat) {
          _this.trigger("change:currentFormat:preSots", _this);
          _this.createSlots();
          _this.updateValues(_this.propDef.formats[_this.get("currentFormat")].defaults);
          return _this.updateStaticData();
        }
      });
    };

    PropertyModel.prototype.slotsFromManualValues = function() {
      var newBlock, slot, _i, _len, _ref1, _results;
      _ref1 = this.get("slotsCollection").models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        if (slot.get("manualValue") != null) {
          newBlock = new quadrigram.Models.EditableBlockModel({
            "internalOfSlot": slot
          });
          newBlock.set({
            "blockGroup": this.get("ownerViz").get("blockGroup"),
            "label": "List of " + pluralize(slot.get("slotId")),
            "origin": "internal"
          }, {
            silent: true
          });
          slot.set("internalBlock", newBlock);
          newBlock.set("data", slot.get("manualValue"), {
            silent: true
          });
          _results.push(slot.unset("manualValue"));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    PropertyModel.prototype.createSlots = function() {
      var cached, format, newSlots, slot, slotdef, wasEmpty, _i, _j, _len, _len1, _ref1, _ref2;
      format = quadrigram.router.managers.formatManager.formatDefinitions[this.get("currentFormat")];
      if (!format) {
        elog("Format is undefined!");
      }
      if (!this.cachedSlots) {
        this.cachedSlots = new Backbone.Collection;
      }
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        if (slot.get("internalBlock") != null) {
          slot.get("internalBlock").set("blockGroup", null);
        }
      }
      this.cachedSlots.add(this.get("slotsCollection").models);
      if (this.get("slotsCollection").models.length === 0 && this.cachedSlots.length === 0) {
        wasEmpty = true;
      }
      newSlots = [];
      if (format !== void 0) {
        _ref2 = format.slots;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          slotdef = _ref2[_j];
          cached = this.cachedSlots.where({
            "formatId": this.get("currentFormat"),
            "slotId": slotdef.id
          });
          if (cached.length > 0) {
            cached[0].get("internalBlock").set("blockGroup", this.get("ownerViz").get("blockGroup"), {
              "silent": true
            });
            newSlots.push(cached[0]);
          } else {
            newSlots.push(new quadrigram.Models.SlotModel({
              "ownerSlotGroup": this,
              "dataType": slotdef.type,
              "formatId": this.get("currentFormat"),
              "slotId": slotdef.id,
              "slotLabel": slotdef.label
            }));
          }
        }
      }
      this.set("slotsCollection", newSlots, {
        "remove": true
      }, {
        silent: true
      });
      if (wasEmpty) {
        return this.trigger("change:slotsCollection");
      }
    };

    PropertyModel.prototype.updateValues = function(newValues) {
      var slot, slotName, _results;
      _results = [];
      for (slotName in newValues) {
        slot = this.get("slotsCollection").where({
          "slotId": slotName
        })[0];
        if (slot) {
          _results.push(slot.setValue(newValues[slotName]));
        } else {
          _results.push(elog("PropertyModel:updateValues -- slot not found: " + slotName));
        }
      }
      return _results;
    };

    PropertyModel.prototype.updateStaticData = function() {
      var slot, slotName, _i, _len, _ref1, _results;
      _ref1 = this.get("slotsCollection").models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        slotName = slot.get("slotId");
        if (slot) {
          if (slot.get("dataType") === "options" && (this.propDef.formats[this.get("currentFormat")].options != null)) {
            slot.options = this.propDef.formats[this.get("currentFormat")].options[slotName];
          }
          if (this.propDef.formats[this.get("currentFormat")].multiValues && this.propDef.formats[this.get("currentFormat")].multiValues[slotName]) {
            _results.push(slot.set("multiValue", true));
          } else {
            _results.push(slot.set("multiValue", false));
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    PropertyModel.prototype.updateIds = function() {
      var idSourceBlock, idSourceName, idSourceSlot, slot, slotName, _i, _len, _ref1, _results;
      _ref1 = this.get("slotsCollection").models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        slotName = slot.get("slotId");
        if (this.propDef.formats[this.get("currentFormat")].idSource) {
          idSourceName = this.propDef.formats[this.get("currentFormat")].idSource[slotName];
          if (idSourceName) {
            idSourceSlot = this.get("slotsCollection").findWhere({
              "slotId": idSourceName
            });
            if (idSourceSlot) {
              idSourceBlock = idSourceSlot.getBlock();
              _results.push(log("should fill ids with", idSourceBlock));
            } else {
              _results.push(void 0);
            }
          } else {
            _results.push(void 0);
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    PropertyModel.prototype.getSourceIds = function(slotId) {
      var idSourceBlock, idSourceName, idSourceProperty, idSourceSlot, qv, result, _i, _len, _ref1;
      result = [];
      if (this.propDef.formats[this.get("currentFormat")].idSource && this.propDef.formats[this.get("currentFormat")].idSource[slotId]) {
        idSourceName = this.propDef.formats[this.get("currentFormat")].idSource[slotId];
        if (idSourceName.indexOf("visualizer.") !== -1) {
          idSourceProperty = idSourceName.replace("visualizer.", "");
          result = this.get("ownerViz")[idSourceProperty];
        } else {
          idSourceSlot = this.get("slotsCollection").findWhere({
            "slotId": idSourceName
          });
          if (idSourceSlot) {
            idSourceBlock = idSourceSlot.getBlock();
            if (idSourceBlock) {
              _ref1 = idSourceBlock.getValue();
              for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
                qv = _ref1[_i];
                result.push(qv.value);
              }
            }
          }
        }
      } else {
        result = this.get("ownerViz").getIds();
      }
      return result;
    };

    PropertyModel.prototype.getValues = function() {
      var result, slot, _i, _len, _ref1;
      if (this.get("slotsCollection").models.length === 1) {
        result = this.get("slotsCollection").models[0].getValue();
      } else {
        result = {};
        _ref1 = this.get("slotsCollection").models;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          slot = _ref1[_i];
          result[slot.get("slotId")] = slot.getValue();
        }
      }
      return result;
    };

    PropertyModel.prototype.getState = function() {
      var result, slot, _i, _len, _ref1;
      result = "ready";
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        if (slot.getState() !== "ready") {
          result = slot.getState();
        }
      }
      return result;
    };

    PropertyModel.prototype.getSlotValue = function(slotName) {
      var slot;
      slot = this.get("slotsCollection").where({
        "slotId": slotName
      })[0];
      if (!slot) {
        elog("slot not found!" + slotName);
        return;
      }
      return slot.getValue();
    };

    PropertyModel.prototype.getBlockGroup = function() {
      return this.get("ownerViz").get("blockGroup");
    };

    PropertyModel.prototype.getBlocks = function() {
      var result, slot, _i, _len, _ref1;
      result = [];
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        result.push(slot.getBlock());
      }
      return result;
    };

    PropertyModel.prototype.getSlots = function() {
      return this.get("slotsCollection").models;
    };

    PropertyModel.prototype.getDefaultAt = function(id) {
      if (this.propDef.formats[this.get("currentFormat")].defaults) {
        return this.propDef.formats[this.get("currentFormat")].defaults[id];
      } else {
        return "";
      }
    };

    PropertyModel.prototype.toJSON = function(options) {
      var defaultsObject, needsFullSave, result, s, slotObject, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _ref3;
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        s = _ref1[_i];
        if (s.get("externalBlock") != null) {
          needsFullSave = true;
        }
      }
      if ((needsFullSave != null) || (this.propDef == null)) {
        result = PropertyModel.__super__.toJSON.call(this, options);
        _ref2 = this.get("slotsCollection").models;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          s = _ref2[_j];
          slotObject = _.findWhere(result.slotsCollection, {
            slotId: s.get("slotId")
          });
          if ((slotObject.externalBlock == null) && (slotObject.internalBlock != null)) {
            slotObject.manualValue = s.get("internalBlock").get("data");
            slotObject.internalBlock = null;
          }
        }
      } else {
        result = this.propDef;
        defaultsObject = result.formats[this.get("currentFormat")].defaults;
        _ref3 = this.get("slotsCollection").models;
        for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
          s = _ref3[_k];
          defaultsObject[s.get("slotId")] = s.getValue();
        }
        result.type = "propDef";
        result.propId = this.get("propId");
        result.currentFormat = this.get("currentFormat");
        delete result.relations;
      }
      return result;
    };

    PropertyModel.prototype.unregister = function() {
      /*
      for s in this.get("slotsCollection").models
        Backbone.Relational.store.unregister(s)
      for part in @get("currentExpression").models
        Backbone.Relational.store.unregister(part)
      */

      /*
      @off()
      Backbone.Relational.store.unregister(this.get("slotsCollection"))
      Backbone.Relational.store.unregister(@)
      */

    };

    return PropertyModel;

  })(quadrigram.Models.SlotGroupModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.PropertyCollection = (function(_super) {
    __extends(PropertyCollection, _super);

    function PropertyCollection() {
      _ref = PropertyCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PropertyCollection.prototype.model = function(attrs, options) {
      switch (attrs.type) {
        case 'property':
          return new quadrigram.Models.PropertyModel(attrs, options);
        case 'preProp':
          return new quadrigram.Models.PropDef(attrs, options);
      }
    };

    return PropertyCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PreProperty = (function(_super) {
    __extends(PreProperty, _super);

    function PreProperty() {
      this.toJSON = __bind(this.toJSON, this);
      this.activate = __bind(this.activate, this);
      this.getState = __bind(this.getState, this);
      this.getSlots = __bind(this.getSlots, this);
      this.getBlocks = __bind(this.getBlocks, this);
      this.getValues = __bind(this.getValues, this);
      this.updateStaticData = __bind(this.updateStaticData, this);
      this.updateValues = __bind(this.updateValues, this);
      this.createSlots = __bind(this.createSlots, this);
      this.initialize = __bind(this.initialize, this);
      _ref = PreProperty.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PreProperty.prototype.initialize = function(attrs, options) {
      var defaultFormat, propDef, vizDef;
      vizDef = this.get("ownerViz").info(this.get("ownerViz").get("config"));
      if ((options != null) && (options.propDef != null)) {
        this.defaultsModified = true;
        propDef = options.propDef;
      } else {
        propDef = vizDef.properties[this.get("propId")];
      }
      this.propDef = propDef;
      if (_.isArray(this.propDef.formats)) {
        defaultFormat = this.propDef.formats[0];
      } else {
        if (this.propDef.currentFormat != null) {
          defaultFormat = this.propDef.currentFormat;
        } else {
          defaultFormat = Object.keys(this.propDef.formats)[0];
        }
      }
      this.set("label", propDef.label, {
        silent: true
      });
      this.set("family", propDef.family, {
        silent: true
      });
      this.set("hidden", propDef.hidden, {
        silent: true
      });
      this.set("internal", propDef.internal, {
        silent: true
      });
      this.set("currentFormat", defaultFormat, {
        silent: true
      });
      this.createSlots();
      if (_.isArray(this.propDef.formats)) {
        if (this.propDef.defaults) {
          this.updateValues(this.propDef.defaults);
        } else {
          this.updateValues({
            "value": ""
          });
        }
      } else {
        this.updateValues(this.propDef.formats[this.get("currentFormat")].defaults, this.propDef.formats[this.get("currentFormat")].defaultsNames);
      }
      return this.updateStaticData();
      /*
      
      if !options? || !options.defaults?
        if !options? then options = {}
        options.defaults = {"value":""}
      
      @updateStaticData()
      
      if options && options.defaults
        @updateValues(options.defaults)
      */

    };

    PreProperty.prototype.createSlots = function() {
      var format, newSlots, slot, slotdef, _i, _len, _ref1;
      format = quadrigram.router.managers.formatManager.formatDefinitions[this.get("currentFormat")];
      if (!format) {
        elog("Format is undefined!");
      }
      newSlots = [];
      if (format !== void 0) {
        _ref1 = format.slots;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          slotdef = _ref1[_i];
          slot = new quadrigram.Models.PreSlot({
            "ownerSlotGroup": this,
            "dataType": slotdef.type,
            "formatId": this.get("currentFormat"),
            "slotId": slotdef.id,
            "slotLabel": slotdef.label
          });
          slot.on("activate-property", this.activate);
          newSlots.push(slot);
        }
      }
      return this.set("slotsCollection", new Backbone.Collection(newSlots));
    };

    PreProperty.prototype.updateValues = function(newValues, names) {
      var candidateName, slot, slotName, _results;
      _results = [];
      for (slotName in newValues) {
        if (names) {
          candidateName = names[slotName];
        }
        slot = this.get("slotsCollection").where({
          "slotId": slotName
        })[0];
        if (slot) {
          slot.setValue(newValues[slotName]);
          if (candidateName) {
            _results.push(slot.getBlock().set("label", candidateName));
          } else {
            _results.push(void 0);
          }
        } else {
          _results.push(elog("PropertyModel:updateValues -- slot not found: " + slotName));
        }
      }
      return _results;
    };

    PreProperty.prototype.updateStaticData = function() {
      var slot, slotName, _i, _len, _ref1, _results;
      _ref1 = this.get("slotsCollection").models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        slotName = slot.get("slotId");
        if (slot) {
          if (slot.get("dataType") === "options") {
            slot.options = this.propDef.formats[this.get("currentFormat")].options[slotName];
          }
          if (this.propDef.formats[this.get("currentFormat")].multiValues && this.propDef.formats[this.get("currentFormat")].multiValues[slotName]) {
            _results.push(slot.set("multiValue", true));
          } else {
            _results.push(slot.set("multiValue", false));
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    PreProperty.prototype.getValues = function() {
      var result, slot, _i, _len, _ref1;
      if (this.get("slotsCollection").models.length === 1) {
        result = this.get("slotsCollection").models[0].getValue();
      } else {
        result = {};
        _ref1 = this.get("slotsCollection").models;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          slot = _ref1[_i];
          result[slot.get("slotId")] = slot.getValue();
        }
      }
      return result;
    };

    PreProperty.prototype.getBlocks = function() {
      var result, slot, _i, _len, _ref1;
      result = [];
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        result.push(slot.getBlock());
      }
      return result;
    };

    PreProperty.prototype.getSlots = function() {
      return this.get("slotsCollection").models;
    };

    PreProperty.prototype.getState = function() {
      return "ready";
    };

    PreProperty.prototype.activate = function() {
      return this.trigger("activate-property", this);
    };

    PreProperty.prototype.toJSON = function(options) {
      var result;
      result = this.propDef;
      result.type = "propDef";
      result.propId = this.get("propId");
      result.label = this.get("label");
      return result;
    };

    return PreProperty;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ExportedPreProperty = (function(_super) {
    __extends(ExportedPreProperty, _super);

    function ExportedPreProperty() {
      this.toJSON = __bind(this.toJSON, this);
      this.activate = __bind(this.activate, this);
      this.getState = __bind(this.getState, this);
      this.getSlots = __bind(this.getSlots, this);
      this.getBlocks = __bind(this.getBlocks, this);
      this.getValues = __bind(this.getValues, this);
      this.updateStaticData = __bind(this.updateStaticData, this);
      this.updateValues = __bind(this.updateValues, this);
      this.createSlots = __bind(this.createSlots, this);
      this.initialize = __bind(this.initialize, this);
      _ref = ExportedPreProperty.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExportedPreProperty.prototype.initialize = function(attrs, options) {
      var defaultFormat, propDef, vizDef;
      vizDef = this.get("ownerViz").info(this.get("ownerViz").get("config"));
      if ((options != null) && (options.propDef != null)) {
        this.defaultsModified = true;
        propDef = options.propDef;
      } else {
        propDef = vizDef.properties[this.get("propId")];
      }
      this.propDef = propDef;
      if (_.isArray(this.propDef.formats)) {
        defaultFormat = this.propDef.formats[0];
      } else {
        if (this.propDef.currentFormat != null) {
          defaultFormat = this.propDef.currentFormat;
        } else {
          defaultFormat = Object.keys(this.propDef.formats)[0];
        }
      }
      this.set("label", propDef.label, {
        silent: true
      });
      this.set("family", propDef.family, {
        silent: true
      });
      this.set("hidden", propDef.hidden, {
        silent: true
      });
      this.set("internal", propDef.internal, {
        silent: true
      });
      this.set("currentFormat", defaultFormat, {
        silent: true
      });
      this.createSlots();
      if (_.isArray(this.propDef.formats)) {
        if (this.propDef.defaults) {
          this.updateValues(this.propDef.defaults);
        } else {
          this.updateValues({
            "value": ""
          });
        }
      } else {
        this.updateValues(this.propDef.formats[this.get("currentFormat")].defaults, this.propDef.formats[this.get("currentFormat")].defaultsNames);
      }
      return this.updateStaticData();
      /*
      
      if !options? || !options.defaults?
        if !options? then options = {}
        options.defaults = {"value":""}
      
      @updateStaticData()
      
      if options && options.defaults
        @updateValues(options.defaults)
      */

    };

    ExportedPreProperty.prototype.createSlots = function() {
      var format, newSlots, slot, slotdef, _i, _len, _ref1;
      format = quadrigram.router.managers.formatManager.formatDefinitions[this.get("currentFormat")];
      if (!format) {
        elog("Format is undefined!");
      }
      newSlots = [];
      if (format !== void 0) {
        _ref1 = format.slots;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          slotdef = _ref1[_i];
          slot = new quadrigram.Models.PreSlot({
            "ownerSlotGroup": this,
            "dataType": slotdef.type,
            "formatId": this.get("currentFormat"),
            "slotId": slotdef.id,
            "slotLabel": slotdef.label
          });
          slot.on("activate-property", this.activate);
          newSlots.push(slot);
        }
      }
      return this.set("slotsCollection", new Backbone.Collection(newSlots));
    };

    ExportedPreProperty.prototype.updateValues = function(newValues, names) {
      var candidateName, slot, slotName, _results;
      _results = [];
      for (slotName in newValues) {
        if (names) {
          candidateName = names[slotName];
        }
        slot = this.get("slotsCollection").where({
          "slotId": slotName
        })[0];
        if (slot) {
          slot.setValue(newValues[slotName]);
          if (candidateName) {
            _results.push(slot.getBlock().set("label", candidateName));
          } else {
            _results.push(void 0);
          }
        } else {
          _results.push(elog("PropertyModel:updateValues -- slot not found: " + slotName));
        }
      }
      return _results;
    };

    ExportedPreProperty.prototype.updateStaticData = function() {
      var slot, slotName, _i, _len, _ref1, _results;
      _ref1 = this.get("slotsCollection").models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        slotName = slot.get("slotId");
        if (slot) {
          if (slot.get("dataType") === "options") {
            slot.options = this.propDef.formats[this.get("currentFormat")].options[slotName];
          }
          if (this.propDef.formats[this.get("currentFormat")].multiValues && this.propDef.formats[this.get("currentFormat")].multiValues[slotName]) {
            _results.push(slot.set("multiValue", true));
          } else {
            _results.push(slot.set("multiValue", false));
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    ExportedPreProperty.prototype.getValues = function() {
      var result, slot, _i, _len, _ref1;
      if (this.get("slotsCollection").models.length === 1) {
        result = this.get("slotsCollection").models[0].getValue();
      } else {
        result = {};
        _ref1 = this.get("slotsCollection").models;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          slot = _ref1[_i];
          result[slot.get("slotId")] = slot.getValue();
        }
      }
      return result;
    };

    ExportedPreProperty.prototype.getBlocks = function() {
      var result, slot, _i, _len, _ref1;
      result = [];
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        result.push(slot.getBlock());
      }
      return result;
    };

    ExportedPreProperty.prototype.getSlots = function() {
      return this.get("slotsCollection").models;
    };

    ExportedPreProperty.prototype.getState = function() {
      return "ready";
    };

    ExportedPreProperty.prototype.activate = function() {
      return this.trigger("activate-property", this);
    };

    ExportedPreProperty.prototype.toJSON = function(options) {
      var result;
      result = this.propDef;
      result.type = "propDef";
      result.propId = this.get("propId");
      result.label = this.get("label");
      return result;
    };

    return ExportedPreProperty;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PreSlot = (function(_super) {
    __extends(PreSlot, _super);

    function PreSlot() {
      this.setExternalBlock = __bind(this.setExternalBlock, this);
      this.activate = __bind(this.activate, this);
      this.getBlock = __bind(this.getBlock, this);
      this.getValue = __bind(this.getValue, this);
      this.setValue = __bind(this.setValue, this);
      this.initialize = __bind(this.initialize, this);
      _ref = PreSlot.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PreSlot.prototype.initialize = function(attrs, options) {
      var block;
      block = new quadrigram.Models.PreEditableBlockModel({
        "internalOfSlot": this
      });
      block.set({
        "label": "List of " + pluralize(this.get("slotId")),
        "origin": "internal"
      }, {
        silent: true
      });
      block.on("activate-property", this.activate);
      return this.set("internalBlock", block);
    };

    PreSlot.prototype.setValue = function(value, options) {
      return this.get("internalBlock").setData(value, options);
    };

    PreSlot.prototype.getValue = function() {
      return this.get("internalBlock").getValue();
    };

    PreSlot.prototype.getBlock = function() {
      return this.get("internalBlock");
    };

    PreSlot.prototype.activate = function() {
      return this.trigger("activate-property");
    };

    PreSlot.prototype.setExternalBlock = function(block) {
      var blockValue;
      this.set("externalBlock", block);
      blockValue = block.summary();
      if (this.get("ownerSlotGroup").get("ownerViz") != null) {
        quadrigram.tracker.sendEvent({
          event_type: 202,
          event_subtype: 2,
          client_data: {
            owner: this.get("ownerSlotGroup").get("ownerViz").get("id"),
            action: "dropped",
            value: blockValue,
            id: this.get("ownerSlotGroup").get("propId")
          }
        });
      } else if (this.get("ownerSlotGroup").get("currentOperation") != null) {
        quadrigram.tracker.sendEvent({
          event_type: 202,
          event_subtype: 2,
          client_data: {
            owner: this.get("ownerSlotGroup").get("currentOperation"),
            action: "dropped",
            value: blockValue,
            id: this.get("slotId")
          }
        });
      }
      return this.activate();
    };

    return PreSlot;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PreEditableBlockModel = (function(_super) {
    __extends(PreEditableBlockModel, _super);

    function PreEditableBlockModel() {
      this.getData = __bind(this.getData, this);
      this.getValue = __bind(this.getValue, this);
      this.setData = __bind(this.setData, this);
      this.activate = __bind(this.activate, this);
      this.initialize = __bind(this.initialize, this);
      _ref = PreEditableBlockModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PreEditableBlockModel.prototype.initialize = function() {
      this.set("metaData", {
        "valueLabel": "Custom value",
        "idLabel": "Custom id",
        "viewMode": "cell"
      }, {
        silent: true
      });
      return this.set("fetchState", "ready", {
        silent: true
      });
    };

    PreEditableBlockModel.prototype.activate = function() {
      return this.trigger("activate-property");
    };

    /*
    actualActivate:()=>
      log "SHOULD ACTIVATE!"
      
      block = new quadrigram.Models.EditableBlockModel "internalOfSlot":@
      block.set({"blockGroup":@getOwnerBlockGroup(),"label":@.get("ownerSlotGroup").get("propId")},{silent:true})
    
    
      ##DA UN POCO DE MIEDO, pero creo que si que podemos hacer off (para que lo coja el gc...)
      @.off()
      return block
    */


    PreEditableBlockModel.prototype.setData = function(value, options) {
      var v, _i, _j, _k, _len, _len1, _len2, _values;
      if (_.isArray(value)) {
        if (value[0] == null) {
          _values = value;
        } else if (value[0].constructor.name === "QValue") {
          _values = value;
        } else if (value[0].value) {
          _values = [];
          for (_i = 0, _len = value.length; _i < _len; _i++) {
            v = value[_i];
            _values.push(new quadrigram.Models.QValue(v.value, v.id));
          }
        } else if (value[0].children) {
          _values = [];
          for (_j = 0, _len1 = value.length; _j < _len1; _j++) {
            v = value[_j];
            _values.push(new quadrigram.Models.QValue(v.children, v.id));
          }
        } else {
          _values = [];
          for (_k = 0, _len2 = value.length; _k < _len2; _k++) {
            v = value[_k];
            _values.push(new quadrigram.Models.QValue(v));
          }
        }
      } else {
        if (value == null) {
          _values = [new quadrigram.Models.QValue("")];
        } else if (value.constructor.name === "QValue") {
          _values = [value];
        } else {
          _values = [new quadrigram.Models.QValue(value)];
        }
      }
      return this.set("data", _values, options);
    };

    PreEditableBlockModel.prototype.getValue = function() {
      if (this.get("data").length > 1) {
        return this.get("data");
      } else if (this.get("data").length === 1) {
        return this.get("data")[0].value;
      } else {
        return "";
      }
    };

    PreEditableBlockModel.prototype.getData = function() {
      return this.get("data");
    };

    return PreEditableBlockModel;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PropDef = (function(_super) {
    __extends(PropDef, _super);

    function PropDef() {
      _ref = PropDef.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    return PropDef;

  })(Backbone.RelationalModel);

  quadrigram.Models.PropDef.setup();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.OperatorModel = (function(_super) {
    __extends(OperatorModel, _super);

    function OperatorModel() {
      this.unregister = __bind(this.unregister, this);
      this.removeFromProject = __bind(this.removeFromProject, this);
      this.toJSON = __bind(this.toJSON, this);
      this.getDefaultAt = __bind(this.getDefaultAt, this);
      this.getSourceIds = __bind(this.getSourceIds, this);
      this.getOperationResult = __bind(this.getOperationResult, this);
      this.getBlockGroup = __bind(this.getBlockGroup, this);
      this.getOperationClass = __bind(this.getOperationClass, this);
      this.removeLoopGroup = __bind(this.removeLoopGroup, this);
      this.hasLoopGroup = __bind(this.hasLoopGroup, this);
      this.addLoopGroup = __bind(this.addLoopGroup, this);
      this.setExpressionValues = __bind(this.setExpressionValues, this);
      this.updateSelectedOptions = __bind(this.updateSelectedOptions, this);
      this.updateDynamicParts = __bind(this.updateDynamicParts, this);
      this.changeExpressionPart = __bind(this.changeExpressionPart, this);
      this.createSlots = __bind(this.createSlots, this);
      this.createOperation = __bind(this.createOperation, this);
      this.slotsFromManualValues = __bind(this.slotsFromManualValues, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = OperatorModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    /*
    subModelTypes:
      {
        "Identity":"quadrigram.Models.Identity",
        "OpTest":"quadrigram.Models.OpTest"
      }
    */


    OperatorModel.prototype.relations = [
      {
        type: Backbone.HasMany,
        key: 'currentExpression',
        relatedModel: "quadrigram.Models.ExpressionPart",
        includeInJSON: true,
        collectionType: "quadrigram.Collections.ExpressionPartCollection",
        reverseRelation: {
          key: 'ownerOperator',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }
    ];

    OperatorModel.prototype.undoableEvents = ["change:currentOperation:preSots", "add:currentExpression"];

    OperatorModel.prototype.bubblingEvents = ["change:currentOperation"];

    OperatorModel.availableOperations = {
      "Identity": {
        className: "quadrigram.Models.Identity",
        label: " Set value"
      },
      "Filter": {
        className: "quadrigram.Models.Filter",
        label: "Filter"
      },
      "Transpose": {
        className: "quadrigram.Models.Transpose",
        label: "Transpose"
      },
      "Join": {
        className: "quadrigram.Models.Join",
        label: "Join"
      },
      "GetNames": {
        className: "quadrigram.Models.GetNames",
        label: "Get names"
      },
      /*
      "SwapIds":
        className:"quadrigram.Models.SwapIds"
        label:"Swap Ids"
      */

      "Sort": {
        className: "quadrigram.Models.Sort",
        label: "Sort"
      },
      "Group": {
        className: "quadrigram.Models.Group",
        label: "Group"
      },
      "Summarize": {
        className: "quadrigram.Models.Summarize",
        label: "Summarize"
      },
      "Aggregate": {
        className: "quadrigram.Models.Aggregate",
        label: "Aggregate"
      },
      "GoToPage": {
        className: "quadrigram.Models.GoToPage",
        label: "Go to page"
      },
      "GoToViz": {
        className: "quadrigram.Models.GoToViz",
        label: "Go to viz"
      }
    };

    OperatorModel.prototype.create = function() {
      var blockGroup;
      blockGroup = new quadrigram.Models.FunctionBlockGroupModel;
      blockGroup.set({
        "ownerOp": this,
        "project": quadrigram.router.dataModels.currentProject,
        "label": "opBlockGroup"
      }, {
        silent: true
      });
      this.set("currentOperation", "Identity");
      return this.createOperation(true);
    };

    OperatorModel.prototype.modelSetup = function(options) {
      var _this = this;
      this.slotsFromManualValues();
      return this.on("change:currentOperation", function(changedModel) {
        if (changedModel.changed.currentOperation) {
          _this.trigger("change:currentOperation:preSots", _this);
          return _this.createOperation(true);
        }
      });
    };

    OperatorModel.prototype.slotsFromManualValues = function() {
      var newBlock, s, slot, _i, _j, _len, _len1, _ref1, _ref2;
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        if (slot.get("manualValue") != null) {
          newBlock = new quadrigram.Models.EditableBlockModel({
            "internalOfSlot": slot
          });
          newBlock.set({
            "blockGroup": this.get("ownerBlock").get("blockGroup"),
            "label": "List of " + pluralize(slot.get("slotId")),
            "origin": "internal"
          }, {
            silent: true
          });
          slot.set("internalBlock", newBlock);
          newBlock.set("data", slot.get("manualValue"), {
            silent: true
          });
          slot.unset("manualValue");
        }
      }
      _ref2 = this.get("slotsCollection").models;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        s = _ref2[_j];
        s.on("change:externalBlock", this.updateDynamicParts);
      }
      return this.updateSelectedOptions();
    };

    OperatorModel.prototype.createOperation = function(silent) {
      var baseExpCollection, baseExpression, part, _i, _len, _ref1;
      if (!this.cachedExpressionParts) {
        this.cachedExpressionParts = new Backbone.Collection;
      }
      this.cachedExpressionParts.add(this.get("currentExpression").models);
      if (this.cachedExpressionParts.where({
        "operationId": this.get("currentOperation")
      }).length > 0) {
        baseExpCollection = new quadrigram.Collections.ExpressionPartCollection(this.cachedExpressionParts.where({
          "operationId": this.get("currentOperation")
        }));
      } else {
        baseExpression = _.map(this.getOperationClass().baseExpression, _.clone);
        baseExpCollection = new quadrigram.Collections.ExpressionPartCollection(baseExpression);
        _ref1 = baseExpCollection.models;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          part = _ref1[_i];
          part.set("operationId", this.get("currentOperation"));
        }
      }
      this.createSlots(baseExpCollection);
      this.set("currentExpression", baseExpCollection.models, {
        "remove": true,
        "silent": silent
      });
      return this.updateSelectedOptions();
    };

    OperatorModel.prototype.createSlots = function(expression) {
      var cached, newSlots, part, s, slot, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _ref3;
      if (!this.cachedSlots) {
        this.cachedSlots = new Backbone.Collection;
      }
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        if (slot.get("internalBlock") != null) {
          slot.get("internalBlock").set("blockGroup", null, {
            silent: true
          });
        }
      }
      this.cachedSlots.add(this.get("slotsCollection").models);
      newSlots = [];
      _ref2 = expression.models;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        part = _ref2[_j];
        if (part.get("type") === "slot") {
          cached = this.cachedSlots.where({
            "operationId": this.get("currentOperation"),
            "slotId": part.get("partId")
          });
          if (cached.length > 0) {
            if (cached[0].get("internalBlock") != null) {
              cached[0].get("internalBlock").set("blockGroup", this.get("blockGroup"), {
                "silent": true
              });
            }
            newSlots.push(cached[0]);
          } else {
            slot = new quadrigram.Models.SlotModel({
              "ownerSlotGroup": this,
              "slotId": part.get("partId")
            });
            slot.set({
              "dataType": part.get("slotType"),
              "operationId": this.get("currentOperation"),
              "multiValue": part.get("multiValue")
            }, {
              silent: true
            });
            slot.options = part.get("options");
            if (part.get("default") != null) {
              slot.setValue(part.get("default"));
            }
            newSlots.push(slot);
          }
        }
      }
      this.set("slotsCollection", newSlots, {
        "remove": true
      }, {
        silent: true
      });
      _ref3 = this.get("slotsCollection").models;
      for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
        s = _ref3[_k];
        s.on("change:externalBlock", this.updateDynamicParts);
      }
      return this.updateSelectedOptions();
    };

    OperatorModel.prototype.changeExpressionPart = function(partId, newSelection) {
      var part;
      part = this.get("currentExpression").where({
        "partId": partId
      })[0];
      if (!part) {
        elog("part not found!");
      } else {
        part.set("selected", newSelection);
      }
      this.get("currentExpression").trigger("change", part);
      return this.updateDynamicParts();
    };

    OperatorModel.prototype.updateDynamicParts = function() {
      var opClass;
      opClass = this.getOperationClass();
      if (opClass.updateDynamicParts) {
        opClass.updateDynamicParts(this.get("currentExpression"), this.get("slotsCollection"));
        return this.updateSelectedOptions();
      }
    };

    OperatorModel.prototype.updateSelectedOptions = function() {
      var opClass, p, slot, _i, _len, _ref1;
      _ref1 = this.get("currentExpression").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.get("type") === "dynamic") {
          this.updatePartSelectedOption(p);
        }
        if (p.get("type") === "slot") {
          if (p.get("options") != null) {
            slot = this.get("slotsCollection").findWhere({
              "slotId": p.get("partId")
            });
            if ((slot != null) && (slot.options == null)) {
              slot.options = p.get("options");
            }
          }
        }
      }
      opClass = this.getOperationClass();
      if (opClass.updateSelectedOptions) {
        return opClass.updateSelectedOptions(this.get("currentExpression"), this.get("slotsCollection"));
      }
    };

    OperatorModel.prototype.updatePartSelectedOption = function(part) {
      var lastOption;
      lastOption = part.get("selected");
      if (lastOption == null) {
        part.set("selected", part.get("options")[0], {
          "silent": true
        });
      } else if (part.get("options").length > 0 && $.grep(part.get("options"), function(e) {
        return e.value === lastOption.value;
      }).length === 0) {
        part.set("selected", part.get("options")[0], {
          "silent": true
        });
      }
      return null;
    };

    OperatorModel.prototype.setExpressionValues = function(filledExpression) {
      var filledPart, opClass, part, partId, slot, _i, _len, _ref1, _results;
      opClass = this.getOperationClass();
      this.createSlots(this.get("currentExpression"));
      for (partId in filledExpression) {
        if (partId.indexOf("loopBlock") >= 0) {
          this.addLoopGroup(true);
        }
      }
      _ref1 = this.get("currentExpression").models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        part = _ref1[_i];
        if (filledExpression[part.get("partId")] != null) {
          filledPart = filledExpression[part.get("partId")];
          if (part.get("type") === "slot") {
            slot = this.get("slotsCollection").where({
              "operationId": this.get("currentOperation"),
              "slotId": part.get("partId")
            })[0];
            if (BlockUtils.isBlockOrData(filledPart)) {
              _results.push(slot.set("externalBlock", filledPart, {
                "silent": true
              }));
            } else {
              _results.push(slot.setValue(filledPart, {
                "silent": true
              }));
            }
          } else if (part.get("type") === "dynamic") {
            /*
            currentOption = _.find(part.get("options"),(e)->
              e.optId == filledPart
            )
            */

            _results.push(part.set("selected", filledPart, {
              "silent": true
            }));
          } else {
            _results.push(void 0);
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    OperatorModel.prototype.addLoopGroup = function(silent) {
      var cached, loopCloneDef, newLoopGroup, newSlots, part, slot, totalSlots, _i, _j, _len, _len1, _ref1;
      newSlots = [];
      totalSlots = this.get("currentExpression").models.length;
      /*
      operatorContainer = $(".operation-container")
      operatorWidth = totalSlots*120
      if (operatorWidth > $('.mega-slot-container').width())
        $('.mega-slot-container').append($('<div class="view-more"><span class="scroll-left"></span></div>'))
      operatorContainer.css('width':operatorWidth+'px')
      */

      loopCloneDef = _.map(this.getOperationClass().loopGroup, _.clone);
      for (_i = 0, _len = loopCloneDef.length; _i < _len; _i++) {
        part = loopCloneDef[_i];
        part.partId = part.partId + totalSlots;
        part.operationId = this.get("currentOperation");
      }
      newLoopGroup = new quadrigram.Collections.ExpressionPartCollection(loopCloneDef);
      _ref1 = newLoopGroup.models;
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        part = _ref1[_j];
        if (part.get("type") === "slot") {
          cached = !this.cachedSlots ? [] : this.cachedSlots.where({
            "operationId": this.get("currentOperation"),
            "slotId": part.get("partId")
          });
          if (cached.length > 0) {
            cached[0].get("internalBlock").set("blockGroup", this.get("blockGroup"), {
              "silent": true
            });
            newSlots.push(cached[0]);
            part.set({
              "slot": cached[0]
            });
          } else {
            slot = new quadrigram.Models.SlotModel({
              "ownerSlotGroup": this,
              "dataType": part.get("slotType"),
              "slotId": part.get("partId"),
              "operationId": this.get("currentOperation"),
              "multiValue": part.get("multiValue"),
              "sourceId": part.get("sourceId")
            });
            slot.options = part.get("options");
            if (part.get("default") != null) {
              slot.setValue(part.get("default"), {
                "silent": true
              });
            }
            newSlots.push(slot);
          }
        }
      }
      this.set("slotsCollection", newSlots, {
        "remove": false,
        "silent": silent
      });
      this.set("currentExpression", newLoopGroup.models, {
        "remove": false,
        "silent": silent
      });
      this.updateDynamicParts();
      return this.trigger("childModified");
    };

    OperatorModel.prototype.hasLoopGroup = function() {
      var part, _i, _len, _ref1;
      _ref1 = this.get("currentExpression").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        part = _ref1[_i];
        if (part.get("partId").indexOf("loopBlock") >= 0) {
          return true;
        }
      }
      return false;
    };

    OperatorModel.prototype.removeLoopGroup = function(silent) {
      var lastPart, lastPartId, loopId, part, slot, toBeRemoved, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _ref2;
      lastPart = this.get("currentExpression").models[this.get("currentExpression").models.length - 1];
      lastPartId = lastPart.get("partId");
      if (lastPartId.indexOf("loopBlock") >= 0) {
        loopId = lastPartId.substring(lastPartId.indexOf("loopBlock"), lastPartId.length);
        log("last id", loopId);
        toBeRemoved = [];
        _ref1 = this.get("currentExpression").models;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          part = _ref1[_i];
          if (part.get("partId").indexOf(loopId) >= 0) {
            toBeRemoved.push(part);
          }
        }
        for (_j = 0, _len1 = toBeRemoved.length; _j < _len1; _j++) {
          part = toBeRemoved[_j];
          this.get("currentExpression").remove(part, {
            "silent": silent
          });
        }
        _ref2 = this.get("slotsCollection").models;
        for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
          slot = _ref2[_k];
          if (slot.get("slotId").indexOf(loopId) >= 0) {
            toBeRemoved.push(slot);
          }
        }
        for (_l = 0, _len3 = toBeRemoved.length; _l < _len3; _l++) {
          slot = toBeRemoved[_l];
          this.get("slotsCollection").remove(slot, {
            "silent": silent
          });
        }
        this.updateDynamicParts();
        return this.trigger("childModified");
      }
    };

    OperatorModel.prototype.getOperationClass = function() {
      return eval("quadrigram.Models." + this.get("currentOperation"));
    };

    OperatorModel.prototype.getBlockGroup = function() {
      return this.get("blockGroup");
    };

    OperatorModel.prototype.getOperationResult = function(context) {
      var opClass;
      opClass = this.getOperationClass();
      return opClass.operate(this.get("slotsCollection"), this.get("currentExpression"), context);
    };

    OperatorModel.prototype.getSourceIds = function(slotId) {
      var baseExpCollection, idSourceBlock, idSourceSlot, opClass, part, qv, result, sourceSlotId, _i, _j, _len, _len1, _ref1;
      result = [];
      baseExpCollection = this.get("currentExpression").models;
      for (_i = 0, _len = baseExpCollection.length; _i < _len; _i++) {
        part = baseExpCollection[_i];
        if (part.get("partId") === slotId) {
          if (part.get("idSource") != null) {
            sourceSlotId = part.get("idSource");
          }
          break;
        }
      }
      if (sourceSlotId != null) {
        idSourceSlot = this.get("slotsCollection").findWhere({
          slotId: sourceSlotId
        });
        if (idSourceSlot != null) {
          idSourceBlock = idSourceSlot.getBlock();
          if (idSourceBlock) {
            _ref1 = idSourceBlock.getValue();
            for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
              qv = _ref1[_j];
              result.push(qv.id);
            }
          }
        }
      }
      opClass = this.getOperationClass();
      if (opClass.getSourceIdsPostProcessing != null) {
        result = opClass.getSourceIdsPostProcessing(this.get("slotsCollection"), this.get("currentExpression"), slotId, result);
      }
      return result;
    };

    OperatorModel.prototype.getDefaultAt = function(id) {
      return "";
    };

    OperatorModel.prototype.toJSON = function(options) {
      var result, s, slotObject, _i, _len, _ref1;
      result = OperatorModel.__super__.toJSON.call(this, options);
      _ref1 = this.get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        s = _ref1[_i];
        slotObject = _.findWhere(result.slotsCollection, {
          slotId: s.get("slotId")
        });
        if ((slotObject.externalBlock == null) && (slotObject.internalBlock != null)) {
          if (s.get("internalBlock") != null) {
            slotObject.manualValue = s.get("internalBlock").get("data");
            slotObject.internalBlock = null;
          }
        }
      }
      return result;
    };

    OperatorModel.prototype.removeFromProject = function() {
      if (this.get("blockGroup") != null) {
        this.get("blockGroup").removeFromProject();
      }
      return OperatorModel.__super__.removeFromProject.call(this);
    };

    OperatorModel.prototype.unregister = function() {
      /*
      for s in this.get("slotsCollection").models
        Backbone.Relational.store.unregister(s)
      for part in @get("currentExpression").models
        Backbone.Relational.store.unregister(part)
      */

      /*
      @off()
      Backbone.Relational.store.unregister(this.get("slotsCollection"))
      Backbone.Relational.store.unregister(@get("currentExpression"))
      Backbone.Relational.store.unregister(@)
      */

    };

    return OperatorModel;

  })(quadrigram.Models.SlotGroupModel);

  quadrigram.Models.OperatorModel.setup();

}).call(this);

(function() {
  'use strict';
  quadrigram.Models.Operation = (function() {
    function Operation() {}

    Operation.buildInput = function(slotsCollection, partsCollection) {
      elog("buildInput MUST be overriden!");
      return null;
    };

    Operation.operate = function(slotsCollection, partsCollection, context) {
      var args;
      args = this.buildInput(slotsCollection, partsCollection);
      if (context._events["operation-finished"] == null) {
        context.on("operation-finished", function(data) {
          var blockData;
          blockData = BlockUtils.unflattenBlock(data);
          return context.trigger("operation-end", blockData);
        });
      }
      return this.doOperation.apply(context, args);
    };

    return Operation;

  })();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Identity = (function(_super) {
    __extends(Identity, _super);

    function Identity() {
      _ref = Identity.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Identity.baseExpression = [
      {
        "type": "label",
        "partId": "label",
        "label": "Set value"
      }, {
        "type": "slot",
        "partId": "value",
        "slotType": "any",
        "multiValue": true
      }
    ];

    Identity.buildInput = function(slotsCollection, partsCollection) {
      return [
        slotsCollection.where({
          "slotId": "value"
        })[0].getBlock()
      ];
    };

    Identity.doOperation = function() {
      var block;
      block = arguments[0];
      return this.trigger("operation-finished", {
        "data": block.get("data"),
        "metaData": block.get("metaData")
      });
    };

    return Identity;

  })(quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Filter = (function(_super) {
    __extends(Filter, _super);

    function Filter() {
      _ref = Filter.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Filter.baseExpression = [
      {
        "type": "label",
        "partId": "filterLabel",
        "label": "Filter"
      }, {
        "type": "slot",
        "partId": "originalBlock",
        "slotType": "noinput",
        "updateDynamic": "keySelector"
      }, {
        "type": "dynamic",
        "partId": "keySelector",
        "label": "where",
        "options": [],
        "selected": null
      }, {
        "type": "dynamic",
        "partId": "relationSelector",
        "label": "is",
        "options": [
          {
            "optId": "eq",
            "label": "equal to",
            "value": "=="
          }, {
            "optId": "g",
            "label": "greater than",
            "value": ">"
          }, {
            "optId": "geq",
            "label": "greater or equal",
            "value": ">="
          }, {
            "optId": "l",
            "label": "smaller than",
            "value": "<"
          }, {
            "optId": "leq",
            "label": "smaller or equal",
            "value": "<="
          }, {
            "optId": "neq",
            "label": "different from",
            "value": "!="
          }, {
            "optId": "cont",
            "label": "contains",
            "value": "C"
          }, {
            "optId": "ncont",
            "label": "doesn't contain",
            "value": "!C"
          }
        ]
      }, {
        "type": "slot",
        "partId": "comparingValue",
        "slotType": "text"
      }
    ];

    Filter.loopGroup = [
      {
        "type": "dynamic",
        "partId": "conjunctionSelector_loopBlock_",
        "label": "",
        "options": [
          {
            "optId": "and",
            "label": "and",
            "value": "&&"
          }, {
            "optId": "or",
            "label": "or",
            "value": "||"
          }
        ]
      }, {
        "type": "dynamic",
        "partId": "keySelector_loopBlock_",
        "label": "where",
        "options": [],
        "selected": null
      }, {
        "type": "dynamic",
        "partId": "relationSelector_loopBlock_",
        "label": "is",
        "options": [
          {
            "optId": "eq",
            "label": "equal to",
            "value": "=="
          }, {
            "optId": "g",
            "label": "greater than",
            "value": ">"
          }, {
            "optId": "geq",
            "label": "greater or equal",
            "value": ">="
          }, {
            "optId": "l",
            "label": "smaller than",
            "value": "<"
          }, {
            "optId": "leq",
            "label": "smaller or equal",
            "value": "<="
          }, {
            "optId": "neq",
            "label": "different from",
            "value": "!="
          }, {
            "optId": "cont",
            "label": "contains",
            "value": "C"
          }, {
            "optId": "ncont",
            "label": "doesn't contain",
            "value": "!C"
          }
        ]
      }, {
        "type": "slot",
        "partId": "comparingValue_loopBlock_",
        "slotType": "text"
      }
    ];

    Filter.updateDynamicParts = function(partsCollection, slotsCollection) {
      var options, optionsObject, originalBlock, p, startingLevel, totalDepth, _i, _len, _ref1, _results;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      if ((originalBlock != null) && originalBlock.get("fetchState") !== "ready") {
        return;
      }
      if ((originalBlock != null) && (originalBlock.get("data") != null)) {
        if (originalBlock.get("data").length === 0) {
          return;
        }
        startingLevel = BlockUtils.getBlockDepth(originalBlock);
        totalDepth = startingLevel;
        optionsObject = this.getRecursiveOptions(originalBlock, startingLevel, totalDepth);
        options = optionsObject.idOptions;
        options = options.concat(optionsObject.valueOptions);
      } else {
        options = [];
      }
      _ref1 = partsCollection.models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          _results.push(p.set("options", options));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    Filter.getRecursiveOptions = function(qvvalue, level, totalDepth, previousOptions) {
      var levelIdLabel, optId, option, options, retroValue, value, _i, _len, _ref1;
      if (!previousOptions) {
        options = {
          "idOptions": [],
          "valueOptions": []
        };
      } else {
        options = previousOptions;
      }
      if (totalDepth === 1) {
        levelIdLabel = "Name";
        levelIdLabel += " (" + qvvalue.get("metaData").idLabel + ")";
        optId = "col";
      } else if (totalDepth - level === 0) {
        levelIdLabel = "Column name";
        if ((qvvalue.get("metaData") != null) && qvvalue.get("metaData").idLabel !== "Column") {
          levelIdLabel += " (" + qvvalue.get("metaData").idLabel + ")";
        }
        optId = "col";
      } else if (totalDepth - level === 1) {
        levelIdLabel = "Row name";
        if ((qvvalue.get("metaData") != null) && qvvalue.get("metaData").idLabel !== "Row") {
          levelIdLabel += " (" + qvvalue.get("metaData").idLabel + ")";
        }
        optId = "row";
      } else {
        if ((qvvalue.get != null) && (qvvalue.get("metaData") != null)) {
          levelIdLabel = qvvalue.get("metaData").idLabel;
          if (qvvalue.get("metaData").idLabel !== "index") {
            levelIdLabel += " name";
          }
        } else {
          levelIdLabel = "Unknown";
        }
        optId = "dim_" + (totalDepth - level);
      }
      if (quadrigram.router.compareVersions(quadrigram.router.dataModels.currentProject.get("pversion"), "0.9.3") < 0) {
        retroValue = level;
      } else {
        retroValue = totalDepth - level;
      }
      option = {
        "optId": optId,
        "label": levelIdLabel,
        "type": "id",
        "level": retroValue
      };
      options.idOptions.push(option);
      if (totalDepth === 1) {
        option = {
          "optId": "col-value",
          "label": "Value (" + qvvalue.get("metaData").valueLabel + ")",
          "value": "__value__",
          "type": "value",
          "level": totalDepth - level
        };
        options.valueOptions.push(option);
      } else if (totalDepth > 1 && totalDepth - level === 0) {
        if (qvvalue instanceof quadrigram.Models.DataBlockModel) {
          if ((qvvalue.get("data")[0] != null) && qvvalue.get("data")[0].value) {
            _ref1 = qvvalue.get("data");
            for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
              value = _ref1[_i];
              option = {
                "optId": value.id,
                "label": value.id,
                "value": value.id,
                "type": "value",
                "level": retroValue
              };
              options.valueOptions.push(option);
            }
          }
        }
      }
      /*
      if totalDepth==1 && level == 1 
        option = {"optId":"col-value","label":"Cell value","value":"__value__","type":"value" ,"level":totalDepth-level}
        options.valueOptions.push(option)
      */

      if (level > 1) {
        Filter.getRecursiveOptions(qvvalue.get("data")[0].value, level - 1, totalDepth, options);
      }
      return options;
    };

    Filter.buildInput = function(slotsCollection, partsCollection) {
      var args, c, conditionBlock, conditions, err, i, loopId, originalBlock, qv, s, slotId, totalDepth, _i, _j, _len, _len1, _ref1, _ref2;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      conditions = [];
      _ref1 = slotsCollection.models;
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        s = _ref1[i];
        slotId = s.get("slotId");
        try {
          if (slotId.indexOf("comparingValue") >= 0) {
            loopId = slotId.replace("comparingValue", "");
            c = {};
            c.key = _.clone(partsCollection.where({
              "partId": "keySelector" + loopId
            })[0].get("selected"));
            if (quadrigram.router.compareVersions(quadrigram.router.dataModels.currentProject.get("pversion"), "0.9.3") < 0) {
              totalDepth = BlockUtils.getBlockDepth(originalBlock);
              c.key.level = totalDepth - c.key.level;
            }
            if (originalBlock.get("metaData").viewMode === "table" && BlockUtils.getBlockDepth(originalBlock) === 1 && c.key.level === 1) {
              c.key.level = 0;
            }
            c.comparator = partsCollection.where({
              "partId": "relationSelector" + loopId
            })[0].get("selected").value;
            c.conditionals = [];
            conditionBlock = slotsCollection.where({
              "slotId": "comparingValue" + loopId
            })[0].getBlock();
            _ref2 = conditionBlock.get("data");
            for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
              qv = _ref2[_j];
              if (qv.value !== "") {
                c.conditionals.push(qv.value);
              }
            }
            if (c.conditionals.length === 0) {
              throw new Error("empty conditionals");
            }
            if (partsCollection.where({
              "partId": "conjunctionSelector" + loopId
            })[0] != null) {
              c.conjunction = partsCollection.where({
                "partId": "conjunctionSelector" + loopId
              })[0].get("selected").value;
            }
            conditions.push(c);
          }
        } catch (_error) {
          err = _error;
        }
      }
      args = [originalBlock, conditions];
      return args;
    };

    /**
     * perform the FILTER operation
     * @param  {[type]} originalBlock  [description]
     * @param  {[type]} key            [description]
     * @param  {[type]} comparator     [description]
     * @param  {[type]} conditionBlock [description]
     * @return {[type]}                [description]
    */


    Filter.doOperation = function() {
      var conditions, config, newOrder, originalBlock,
        _this = this;
      originalBlock = arguments[0];
      conditions = arguments[1];
      if ((originalBlock != null) && (conditions != null) && conditions.length > 0 && BlockUtils.getBlockDepth(originalBlock) > 0) {
        newOrder = null;
        if (this.worker != null) {
          this.worker.terminate();
          this.worker = null;
        }
        this.worker = new Worker('scripts/managers/operationworker.js');
        this.worker.onmessage = function(e) {
          switch (e.data.t) {
            case 'e':
              elog(e.data.d);
              return quadrigram.tracker.sendEvent({
                event_type: 101,
                event_subtype: 1,
                error_code: "filter_error",
                error_data: {
                  stack: e.data.d
                }
              });
            case 'log':
              return log("Worker message: ", e.data.message);
            case 'ready':
              return _this.worker.postMessage({
                t: "operate",
                operation: "filter",
                originalBlock: JSON.stringify(originalBlock),
                newOrder: newOrder,
                conditions: conditions
              });
            case 'operation-finished':
              _this.trigger("operation-finished", e.data.d);
              return _this.worker.terminate();
          }
        };
        config = {};
        config.timeFormatArray = quadrigram.router.dataModels.currentProject.timeFormat.momentFormatter;
        return this.worker.postMessage({
          t: "isReady",
          d: config
        });
      } else {
        return this.trigger("operation-finished", {
          "data": []
        });
      }
    };

    return Filter;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Transpose = (function(_super) {
    __extends(Transpose, _super);

    function Transpose() {
      _ref = Transpose.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Transpose.baseExpression = [
      {
        "type": "label",
        "partId": "transpose",
        "label": "Transpose"
      }, {
        "type": "slot",
        "partId": "originalBlock",
        "slotType": "noinput"
      }
    ];

    Transpose.buildInput = function(slotsCollection, partsCollection) {
      var args, originalBlock;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      args = [originalBlock];
      return args;
    };

    /**
     * perform the TRANSPOSE operation
     * @param  {[type]} originalBlock [description]
     * @return {[type]}               [description]
    */


    Transpose.doOperation = function() {
      var conditions, config, newOrder, originalBlock, _i, _ref1, _results,
        _this = this;
      originalBlock = arguments[0];
      conditions = [];
      if ((originalBlock != null) && (conditions != null) && BlockUtils.getBlockDepth(originalBlock) > 0) {
        newOrder = (function() {
          _results = [];
          for (var _i = _ref1 = BlockUtils.getBlockDepth(originalBlock) - 1; _ref1 <= 0 ? _i <= 0 : _i >= 0; _ref1 <= 0 ? _i++ : _i--){ _results.push(_i); }
          return _results;
        }).apply(this);
        if (this.worker != null) {
          this.worker.terminate();
          this.worker = null;
        }
        this.worker = new Worker('scripts/managers/operationworker.js');
        this.worker.onmessage = function(e) {
          switch (e.data.t) {
            case 'e':
              elog(e.data.d);
              return quadrigram.tracker.sendEvent({
                event_type: 101,
                event_subtype: 1,
                error_code: "transpose_error",
                error_data: {
                  stack: e.data.d
                }
              });
            case 'log':
              return log("Worker message: ", e.data.message);
            case 'ready':
              return _this.worker.postMessage({
                t: "operate",
                operation: "transpose",
                originalBlock: JSON.stringify(originalBlock),
                newOrder: newOrder,
                conditions: conditions
              });
            case 'operation-finished':
              _this.trigger("operation-finished", e.data.d);
              _this.worker.terminate();
              return _this.worker = null;
          }
        };
        config = {};
        config.timeFormatArray = quadrigram.router.dataModels.currentProject.timeFormat.momentFormatter;
        return this.worker.postMessage({
          t: "isReady",
          d: config
        });
      } else {
        return this.trigger("operation-finished", {
          "data": []
        });
      }
    };

    return Transpose;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Join = (function(_super) {
    __extends(Join, _super);

    function Join() {
      _ref = Join.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Join.baseExpression = [
      {
        "type": "label",
        "partId": "combine",
        "label": "Join"
      }, {
        "type": "dynamic",
        "partId": "structureSelector",
        "label": "",
        "options": [
          {
            "optId": "cols",
            "label": "columns",
            "value": 1
          }, {
            "optId": "rows",
            "label": "rows",
            "value": 0
          }, {
            "optId": "tables",
            "label": "tables",
            "value": 2
          }
        ]
      }, {
        "type": "label",
        "partId": "combine",
        "label": "from"
      }, {
        "type": "slot",
        "partId": "first_joinblock",
        "slotType": "noinput"
      }, {
        "type": "label",
        "partId": "and",
        "label": "and"
      }, {
        "type": "slot",
        "partId": "second_joinblock",
        "slotType": "noinput"
      }
    ];

    Join.loopGroup = [
      {
        "type": "label",
        "partId": "and",
        "label": "and"
      }, {
        "type": "slot",
        "partId": "second_joinblock_loopblock_",
        "slotType": "noinput"
      }
    ];

    Join.buildInput = function(slotsCollection, partsCollection) {
      var allBlocks, args, b, s, structureLevel, _i, _len, _ref1;
      allBlocks = [];
      _ref1 = slotsCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        s = _ref1[_i];
        if (s.get("slotId").indexOf("joinblock") >= 0) {
          b = s.getBlock();
          if ((b != null) && b.getValue() !== "") {
            allBlocks.push(b);
          }
        }
      }
      structureLevel = partsCollection.where({
        "partId": "structureSelector"
      })[0].get("selected").value;
      args = [allBlocks, structureLevel];
      return args;
    };

    /**
     * perform the COMBINE operation
     * @param  {[type]} allBlocks [description]
     * @return {[type]}           [description]
    */


    Join.doOperation = function() {
      var blocksArray, config, structureLevel,
        _this = this;
      blocksArray = arguments[0];
      structureLevel = arguments[1];
      if ((blocksArray != null) && blocksArray.length > 0 && (structureLevel != null)) {
        if (this.worker != null) {
          this.worker.terminate();
          this.worker = null;
        }
        this.worker = new Worker('scripts/managers/operationworker.js');
        this.worker.onmessage = function(e) {
          var b, objectsArray, _i, _len;
          switch (e.data.t) {
            case 'e':
              elog(e.data.d);
              return quadrigram.tracker.sendEvent({
                event_type: 101,
                event_subtype: 1,
                error_code: "join_error",
                error_data: {
                  stack: e.data.d
                }
              });
            case 'log':
              return log("Worker message: ", e.data.message);
            case 'ready':
              objectsArray = [];
              for (_i = 0, _len = blocksArray.length; _i < _len; _i++) {
                b = blocksArray[_i];
                objectsArray.push(JSON.stringify(b));
              }
              return _this.worker.postMessage({
                t: "operate",
                operation: "concat",
                array: objectsArray,
                level: structureLevel
              });
            case 'operation-finished':
              _this.trigger("operation-finished", e.data.d);
              _this.worker.terminate();
              return _this.worker = null;
          }
        };
        config = {};
        config.timeFormatArray = quadrigram.router.dataModels.currentProject.timeFormat.momentFormatter;
        return this.worker.postMessage({
          t: "isReady",
          d: config
        });
      } else {
        return this.trigger("operation-finished", {
          "data": []
        });
      }
    };

    return Join;

  })(quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.GetNames = (function(_super) {
    __extends(GetNames, _super);

    function GetNames() {
      _ref = GetNames.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    GetNames.baseExpression = [
      {
        "type": "label",
        "partId": "getNames",
        "label": "Get names"
      }, {
        "type": "dynamic",
        "partId": "levelSelector",
        "label": "of",
        "options": [],
        "selected": null
      }, {
        "type": "label",
        "partId": "from",
        "label": "from"
      }, {
        "type": "slot",
        "partId": "originalBlock",
        "slotType": "noinput"
      }
    ];

    GetNames.updateDynamicParts = function(partsCollection, slotsCollection) {
      var depth, options, originalBlock, viewDirection, viewMode;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      if ((originalBlock != null) && originalBlock.get("fetchState") !== "ready") {
        return;
      }
      depth = BlockUtils.getBlockDepth(originalBlock);
      viewMode = originalBlock.get("metaData").viewMode;
      viewDirection = originalBlock.get("metaData").viewDirection;
      options = [];
      if (depth === 1) {
        if (viewDirection === "col" || (viewMode == null) || viewMode === "list") {
          options.push({
            "optId": "col",
            "label": "rows",
            "value": 1
          });
        } else {
          options.push({
            "optId": "col",
            "label": "columns",
            "value": 1
          });
        }
      }
      if (depth === 2) {
        options.push({
          "optId": "row",
          "label": "rows",
          "value": 2
        });
        options.push({
          "optId": "col",
          "label": "columns",
          "value": 1
        });
      }
      if (depth === 3) {
        options.push({
          "optId": "row",
          "label": "rows",
          "value": 3
        });
        options.push({
          "optId": "col",
          "label": "columns",
          "value": 2
        });
        options.push({
          "optId": "table",
          "label": "tables",
          "value": 1
        });
      }
      return partsCollection.where({
        "partId": "levelSelector"
      })[0].set("options", options);
    };

    GetNames.buildInput = function(slotsCollection, partsCollection) {
      var args, error, originalBlock, structureLevel;
      originalBlock = null;
      structureLevel = 0;
      try {
        originalBlock = slotsCollection.where({
          "slotId": "originalBlock"
        })[0].getBlock();
        structureLevel = partsCollection.where({
          "partId": "levelSelector"
        })[0].get("selected").value;
      } catch (_error) {
        error = _error;
        log("error", error);
      }
      args = [originalBlock, structureLevel];
      return args;
    };

    GetNames.doOperation = function() {
      var originalBlock, structureLevel, trueResult;
      originalBlock = arguments[0];
      structureLevel = arguments[1];
      if ((originalBlock != null) && (structureLevel != null)) {
        trueResult = BlockUtils.getIdsAtLevel(originalBlock, structureLevel);
      } else {
        trueResult = {
          "data": []
        };
      }
      return this.trigger("operation-finished", trueResult);
    };

    return GetNames;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SwapIds = (function(_super) {
    __extends(SwapIds, _super);

    function SwapIds() {
      _ref = SwapIds.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SwapIds.baseExpression = [
      {
        "type": "label",
        "partId": "swapIds",
        "label": "Swap Ids of"
      }, {
        "type": "slot",
        "partId": "originalBlock",
        "slotType": "noinput"
      }
    ];

    SwapIds.buildInput = function(slotsCollection, partsCollection) {
      var args, error, originalBlock, structureLevel;
      originalBlock = null;
      structureLevel = 0;
      try {
        originalBlock = slotsCollection.where({
          "slotId": "originalBlock"
        })[0].getBlock();
      } catch (_error) {
        error = _error;
        log("error", error);
      }
      args = [originalBlock, structureLevel];
      return args;
    };

    SwapIds.doOperation = function() {
      var originalBlock, trueResult;
      originalBlock = arguments[0];
      if ((originalBlock != null) && BlockUtils.getBlockDepth(originalBlock) === 1) {
        trueResult = BlockUtils.swapIds(originalBlock);
      } else {
        trueResult = {
          "data": []
        };
      }
      return this.trigger("operation-finished", trueResult);
    };

    return SwapIds;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Sort = (function(_super) {
    __extends(Sort, _super);

    function Sort() {
      _ref = Sort.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Sort.baseExpression = [
      {
        "type": "label",
        "partId": "combine",
        "label": "Sort rows of"
      }, {
        "type": "slot",
        "partId": "originalBlock",
        "slotType": "noinput",
        "multiValue": false,
        "updateDynamic": "sortingId"
      }, {
        "type": "dynamic",
        "partId": "sortingId",
        "label": "on column",
        "options": [],
        "selected": null
      }, {
        "type": "label",
        "partId": "inlabel",
        "label": "in"
      }, {
        "type": "dynamic",
        "partId": "direction",
        "label": "",
        "options": [
          {
            "optId": "desc",
            "label": "descending order",
            "value": "desc"
          }, {
            "optId": "asc",
            "label": "ascending order",
            "value": "asc"
          }
        ]
      }
    ];

    Sort.updateDynamicParts = function(partsCollection, slotsCollection) {
      var onlyOption, options, originalBlock, p, qv, _i, _j, _len, _len1, _ref1, _ref2, _results;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      options = [];
      if ((originalBlock != null) && (originalBlock.get("data") != null) && originalBlock.get("data").length > 0) {
        if ((originalBlock.get("data")[0].value.get != null) && (originalBlock.get("data")[0].value.get("data") != null)) {
          _ref1 = originalBlock.get("data");
          for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
            qv = _ref1[_i];
            options.push({
              "optId": qv.id,
              "label": qv.id,
              "value": qv.id
            });
          }
        } else {
          onlyOption = originalBlock.get("metaData").valueLabel;
          options.push({
            "optId": onlyOption,
            "label": onlyOption,
            "value": onlyOption
          });
        }
        if ((originalBlock.get("data")[0].value.get != null) && (originalBlock.get("data")[0].value.get("data") != null)) {
          options.push({
            "optId": "__id__",
            "label": originalBlock.get("data")[0].value.get("metaData").idLabel,
            "value": "__id__"
          });
        } else {
          options.push({
            "optId": "__id__",
            "label": originalBlock.get("metaData").idLabel,
            "value": "__id__"
          });
        }
      }
      _ref2 = partsCollection.models;
      _results = [];
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        p = _ref2[_j];
        if (p.get("partId").indexOf("sortingId") >= 0) {
          p.set("options", options);
          if (options.length < 2) {
            _results.push(p.set("hidden", true));
          } else {
            _results.push(p.unset("hidden"));
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    Sort.buildInput = function(slotsCollection, partsCollection) {
      var args, direction, originalBlock, sortingId, structureLevel;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      structureLevel = 0;
      direction = partsCollection.where({
        "partId": "direction"
      })[0].get("selected").value;
      try {
        sortingId = partsCollection.where({
          "partId": "sortingId"
        })[0].get("selected").value;
      } catch (_error) {}
      args = [originalBlock, structureLevel, sortingId, direction];
      return args;
    };

    /**
     * perform the COMBINE operation
     * @param  {[type]} allBlocks [description]
     * @return {[type]}           [description]
    */


    Sort.doOperation = function() {
      var config, direction, originalBlock, sortingId, structureLevel,
        _this = this;
      originalBlock = arguments[0];
      structureLevel = arguments[1];
      sortingId = arguments[2];
      direction = arguments[3];
      if ((originalBlock != null) && (sortingId != null)) {
        if (this.worker != null) {
          this.worker.terminate();
          this.worker = null;
        }
        this.worker = new Worker('scripts/managers/operationworker.js');
        this.worker.onmessage = function(e) {
          switch (e.data.t) {
            case 'e':
              elog(e.data.d);
              return quadrigram.tracker.sendEvent({
                event_type: 101,
                event_subtype: 1,
                error_code: "sort_error",
                error_data: {
                  stack: e.data.d
                }
              });
            case 'log':
              return log("Worker message: ", e.data.message);
            case 'ready':
              return _this.worker.postMessage({
                t: "operate",
                operation: "sort",
                originalBlock: JSON.stringify(originalBlock),
                structureLevel: structureLevel,
                sortingId: sortingId,
                direction: direction
              });
            case 'operation-finished':
              _this.trigger("operation-finished", e.data.d);
              _this.worker.terminate();
              return _this.worker = null;
          }
        };
        config = {};
        config.timeFormatArray = quadrigram.router.dataModels.currentProject.timeFormat.momentFormatter;
        return this.worker.postMessage({
          t: "isReady",
          d: config
        });
      } else {
        return this.trigger("operation-finished", {
          "data": []
        });
      }
    };

    return Sort;

  })(quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Aggregate = (function(_super) {
    __extends(Aggregate, _super);

    function Aggregate() {
      _ref = Aggregate.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Aggregate.baseExpression = [
      {
        "type": "label",
        "partId": "aggName",
        "label": "Aggregate"
      }, {
        "type": "slot",
        "partId": "originalBlock",
        "slotType": "noinput",
        "updateDynamic": "keySelector"
      }, {
        "type": "dynamic",
        "partId": "keySelector",
        "label": "using column",
        "options": [],
        "selected": null
      }, {
        "type": "label",
        "partId": "andaslabel",
        "label": "as id and aggregating each column"
      }, {
        "type": "slot",
        "partId": "modesSelector",
        "label": "",
        "slotType": "options",
        "multiValue": true,
        "idSource": "originalBlock",
        "options": [
          {
            "value": "add",
            "label": "by adding"
          }, {
            "value": "mean",
            "label": "as the mean"
          }, {
            "value": "count",
            "label": "by counting"
          }, {
            "value": "asblock",
            "label": "as a list"
          }, {
            "value": "min",
            "label": "minimum value"
          }, {
            "value": "max",
            "label": "maximum value"
          }, {
            "value": "first",
            "label": "first value"
          }, {
            "value": "last",
            "label": "last value"
          }, {
            "value": "ignore",
            "label": "ignore"
          }
        ],
        "default": "add"
      }
    ];

    Aggregate.loopGroup = [
      {
        "type": "label",
        "partId": "andthenlabel_loopBlock_",
        "label": "and then (for each row) aggregate"
      }, {
        "type": "dynamic",
        "partId": "keySelector_loopBlock_",
        "label": "using column",
        "options": [],
        "selected": null
      }, {
        "type": "label",
        "partId": "andaslabel_loopBlock_",
        "label": "as id and aggregating each column"
      }, {
        "type": "slot",
        "partId": "modesSelector_loopBlock_",
        "label": "",
        "slotType": "options",
        "multiValue": true,
        "idSource": "originalBlock",
        "options": [
          {
            "value": "add",
            "label": "by adding"
          }, {
            "value": "mean",
            "label": "as the mean"
          }, {
            "value": "count",
            "label": "by counting"
          }, {
            "value": "asblock",
            "label": "as a list"
          }, {
            "value": "min",
            "label": "minimum value"
          }, {
            "value": "max",
            "label": "maximum value"
          }, {
            "value": "first",
            "label": "first value"
          }, {
            "value": "last",
            "label": "last value"
          }, {
            "value": "ignore",
            "label": "ignore"
          }
        ],
        "default": "asblock"
      }
    ];

    Aggregate.updateDynamicParts = function(partsCollection, slotsCollection) {
      var options, originalBlock, p, qv, _i, _j, _len, _len1, _ref1, _ref2, _results;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      if ((originalBlock != null) && originalBlock.get("fetchState") !== "ready") {
        return;
      }
      if ((originalBlock != null) && (originalBlock.get("data") != null)) {
        options = [];
        _ref1 = originalBlock.get("data");
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          qv = _ref1[_i];
          options.push({
            "optId": qv.id,
            "label": qv.id,
            "value": qv.id
          });
        }
      } else {
        options = [];
      }
      _ref2 = partsCollection.models;
      _results = [];
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        p = _ref2[_j];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          _results.push(p.set("options", options));
        } else {
          _results.push(void 0);
        }
        /*
        FALTA HACER QUE SE "actualizen" los defaults del slot de mode (slot.options) pero no creo que deba ser aqui
        DEBERIA SER EL SLOT ON "modelSetup" o algo asi...
        
        if p.get("partId").indexOf("modesSelector")>=0
          p.set("options",options)
        */

      }
      return _results;
    };

    Aggregate.updateSelectedOptions = function(partsCollection, slotsCollection) {
      var allOptions, forbiddenOptionValues, myOptions, o, p, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _ref2, _results;
      forbiddenOptionValues = {};
      _ref1 = partsCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          allOptions = p.get("options");
          if (p.get("selected") != null) {
            if (!forbiddenOptionValues[p.get("selected").value]) {
              forbiddenOptionValues[p.get("selected").value] = true;
            } else {
              for (_j = 0, _len1 = allOptions.length; _j < _len1; _j++) {
                o = allOptions[_j];
                if (!forbiddenOptionValues[o.value]) {
                  p.set("selected", o, {
                    silent: true
                  });
                  forbiddenOptionValues[o.value] = true;
                  break;
                }
              }
            }
          }
        }
      }
      _ref2 = partsCollection.models;
      _results = [];
      for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
        p = _ref2[_k];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          myOptions = JSON.parse(JSON.stringify(allOptions));
          for (_l = 0, _len3 = myOptions.length; _l < _len3; _l++) {
            o = myOptions[_l];
            if (forbiddenOptionValues[o.value] && o.value !== p.get("selected").value) {
              o.hidden = true;
            } else {
              delete o.hidden;
            }
          }
          _results.push(p.set("options", myOptions));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    Aggregate.getSourceIdsPostProcessing = function(slotsCollection, partsCollection, slotId, ids) {
      var forbiddenOptionValues, id, part, result, _i, _j, _len, _len1, _ref1;
      forbiddenOptionValues = {};
      _ref1 = partsCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        part = _ref1[_i];
        if (part.get("partId") === slotId) {
          break;
        }
        if (part.get("partId").indexOf("keySelector") >= 0) {
          forbiddenOptionValues[part.get("selected").value] = true;
        }
      }
      result = [];
      result.push(slotsCollection.models[0].getBlock().get("metaData").idKey);
      for (_j = 0, _len1 = ids.length; _j < _len1; _j++) {
        id = ids[_j];
        if (forbiddenOptionValues[id] == null) {
          result.push(id);
        }
      }
      return result;
    };

    Aggregate.buildInput = function(slotsCollection, partsCollection) {
      var aggBy, aggByOriginal, aggRules, args, e, i, key, loopId, originalBlock, qv, s, slotId, _i, _j, _len, _len1, _ref1, _ref2;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      aggRules = [];
      _ref1 = slotsCollection.models;
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        s = _ref1[i];
        slotId = s.get("slotId");
        try {
          if (slotId.indexOf("modesSelector") >= 0) {
            loopId = slotId.replace("modesSelector", "");
            key = partsCollection.where({
              "partId": "keySelector" + loopId
            })[0].get("selected").value;
            aggByOriginal = slotsCollection.where({
              "slotId": "modesSelector" + loopId
            })[0].getBlock().get("data");
            if (aggByOriginal.length === 1) {
              aggBy = [];
              _ref2 = originalBlock.get("data");
              for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
                qv = _ref2[_j];
                aggBy.push({
                  id: qv.id,
                  value: aggByOriginal[0].value
                });
              }
              aggBy.push({
                id: originalBlock.get("metaData").idKey,
                value: aggByOriginal[0].value
              });
            } else {
              aggBy = aggByOriginal;
            }
            aggRules.push({
              key: key,
              aggBy: aggBy
            });
          }
        } catch (_error) {
          e = _error;
        }
      }
      args = [originalBlock, aggRules];
      return args;
    };

    /**
     * perform the TRANSPOSE operation
     * @param  {[type]} originalBlock [description]
     * @return {[type]}               [description]
    */


    Aggregate.doOperation = function() {
      var aggRules, config, originalBlock,
        _this = this;
      originalBlock = arguments[0];
      aggRules = arguments[1];
      /*
      if aggRules.length == 0
        return
      key = aggRules[0].key
      aggBy = aggRules[0].aggBy
      */

      if ((originalBlock != null) && BlockUtils.getBlockDepth(originalBlock) > 0 && aggRules.length > 0) {
        if (this.worker != null) {
          this.worker.terminate();
          this.worker = null;
        }
        this.worker = new Worker('scripts/managers/operationworker.js');
        this.worker.onmessage = function(e) {
          switch (e.data.t) {
            case 'e':
              elog(e.data.d);
              return quadrigram.tracker.sendEvent({
                event_type: 101,
                event_subtype: 1,
                error_code: "aggregate_error",
                error_data: {
                  stack: e.data.d
                }
              });
            case 'log':
              return log("Worker message: ", e.data.message);
            case 'ready':
              return _this.worker.postMessage({
                t: "operate",
                operation: "aggregate",
                originalBlock: JSON.stringify(originalBlock),
                aggRules: JSON.stringify(aggRules)
              });
            case 'operation-finished':
              _this.trigger("operation-finished", e.data.d);
              _this.worker.terminate();
              return _this.worker = null;
          }
        };
        config = {};
        config.timeFormatArray = quadrigram.router.dataModels.currentProject.timeFormat.momentFormatter;
        return this.worker.postMessage({
          t: "isReady",
          d: config
        });
      } else {
        return this.trigger("operation-finished", {
          "data": []
        });
      }
    };

    return Aggregate;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Group = (function(_super) {
    __extends(Group, _super);

    function Group() {
      _ref = Group.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Group.baseExpression = [
      {
        "type": "label",
        "partId": "aggName",
        "label": "Group rows of"
      }, {
        "type": "slot",
        "partId": "originalBlock",
        "slotType": "noinput",
        "updateDynamic": "keySelector"
      }, {
        "type": "dynamic",
        "partId": "keySelector",
        "label": "by repetitions in column",
        "options": [],
        "selected": null
      }
    ];

    Group.loopGroup = [
      {
        "type": "label",
        "partId": "andthenlabel_loopBlock_",
        "label": "and then"
      }, {
        "type": "dynamic",
        "partId": "keySelector_loopBlock_",
        "label": "by repetitions in column",
        "options": [],
        "selected": null
      }
    ];

    Group.updateDynamicParts = function(partsCollection, slotsCollection) {
      var options, originalBlock, p, qv, _i, _j, _len, _len1, _ref1, _ref2, _results;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      if ((originalBlock != null) && (originalBlock.get("data") != null)) {
        options = [];
        _ref1 = originalBlock.get("data");
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          qv = _ref1[_i];
          options.push({
            "optId": qv.id,
            "label": qv.id,
            "value": qv.id
          });
        }
      } else {
        options = [];
      }
      _ref2 = partsCollection.models;
      _results = [];
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        p = _ref2[_j];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          _results.push(p.set("options", options));
        } else {
          _results.push(void 0);
        }
        /*
        FALTA HACER QUE SE "actualizen" los defaults del slot de mode (slot.options) pero no creo que deba ser aqui
        DEBERIA SER EL SLOT ON "modelSetup" o algo asi...
        
        if p.get("partId").indexOf("modesSelector")>=0
          p.set("options",options)
        */

      }
      return _results;
    };

    Group.updateSelectedOptions = function(partsCollection, slotsCollection) {
      var allOptions, forbiddenOptionValues, myOptions, o, p, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _ref2, _results;
      forbiddenOptionValues = {};
      _ref1 = partsCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          allOptions = p.get("options");
          if (p.get("selected") != null) {
            if (!forbiddenOptionValues[p.get("selected").value]) {
              forbiddenOptionValues[p.get("selected").value] = true;
            } else {
              for (_j = 0, _len1 = allOptions.length; _j < _len1; _j++) {
                o = allOptions[_j];
                if (!forbiddenOptionValues[o.value]) {
                  p.set("selected", o, {
                    silent: true
                  });
                  forbiddenOptionValues[o.value] = true;
                  break;
                }
              }
            }
          }
        }
      }
      _ref2 = partsCollection.models;
      _results = [];
      for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
        p = _ref2[_k];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          myOptions = JSON.parse(JSON.stringify(allOptions));
          for (_l = 0, _len3 = myOptions.length; _l < _len3; _l++) {
            o = myOptions[_l];
            if (forbiddenOptionValues[o.value] && o.value !== p.get("selected").value) {
              o.hidden = true;
            } else {
              delete o.hidden;
            }
          }
          _results.push(p.set("options", myOptions));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    Group.getSourceIdsPostProcessing = function(slotsCollection, partsCollection, slotId, ids) {
      var forbiddenOptionValues, id, part, result, _i, _j, _len, _len1, _ref1;
      forbiddenOptionValues = {};
      _ref1 = partsCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        part = _ref1[_i];
        if (part.get("partId") === slotId) {
          break;
        }
        if (part.get("partId").indexOf("keySelector") >= 0) {
          forbiddenOptionValues[part.get("selected").value] = true;
        }
      }
      result = [];
      for (_j = 0, _len1 = ids.length; _j < _len1; _j++) {
        id = ids[_j];
        if (forbiddenOptionValues[id] == null) {
          result.push(id);
        }
      }
      return result;
    };

    Group.buildInput = function(slotsCollection, partsCollection) {
      var aggRules, args, e, key, originalBlock, part, partId, _i, _len, _ref1;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      /*
      aggRules = []
      for s,i in slotsCollection.models
        slotId = s.get("slotId")
        try
          if slotId.indexOf("modesSelector")>=0
            loopId = slotId.replace("modesSelector","")
      
            key = partsCollection.where({"partId":"keySelector"+loopId})[0].get("selected").value
            aggByOriginal = slotsCollection.where({"slotId":"modesSelector"+loopId})[0].getBlock().get("data")
            if aggByOriginal.length==1
              aggBy = []
              for qv in originalBlock.get("data")
                aggBy.push({id:qv.id,value:aggByOriginal[0].value})
              aggBy.push({id:originalBlock.get("metaData").idKey,value:aggByOriginal[0].value})
            else
              aggBy = aggByOriginal
      
            aggRules.push({key:key,aggBy:aggBy})
      
        catch e
      */

      aggRules = [];
      _ref1 = partsCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        part = _ref1[_i];
        partId = part.get("partId");
        try {
          if (partId.indexOf("keySelector") >= 0) {
            key = part.get("selected").value;
            aggRules.push({
              key: key,
              aggBy: "asblock"
            });
          }
        } catch (_error) {
          e = _error;
        }
      }
      args = [originalBlock, aggRules];
      return args;
    };

    /**
     * perform the TRANSPOSE operation
     * @param  {[type]} originalBlock [description]
     * @return {[type]}               [description]
    */


    Group.doOperation = function() {
      var aggRules, config, originalBlock,
        _this = this;
      originalBlock = arguments[0];
      aggRules = arguments[1];
      /*
      if aggRules.length == 0
        return
      key = aggRules[0].key
      aggBy = aggRules[0].aggBy
      */

      if ((originalBlock != null) && BlockUtils.getBlockDepth(originalBlock) > 0 && aggRules.length > 0) {
        if (this.worker != null) {
          this.worker.terminate();
          this.worker = null;
        }
        this.worker = new Worker('scripts/managers/operationworker.js');
        this.worker.onmessage = function(e) {
          switch (e.data.t) {
            case 'e':
              elog(e.data.d);
              return quadrigram.tracker.sendEvent({
                event_type: 101,
                event_subtype: 1,
                error_code: "aggregate_error",
                error_data: {
                  stack: e.data.d
                }
              });
            case 'log':
              return log("Worker message: ", e.data.message);
            case 'ready':
              return _this.worker.postMessage({
                t: "operate",
                operation: "aggregate",
                originalBlock: JSON.stringify(originalBlock),
                aggRules: JSON.stringify(aggRules)
              });
            case 'operation-finished':
              _this.trigger("operation-finished", e.data.d);
              _this.worker.terminate();
              return _this.worker = null;
          }
        };
        config = {};
        config.timeFormatArray = quadrigram.router.dataModels.currentProject.timeFormat.momentFormatter;
        return this.worker.postMessage({
          t: "isReady",
          d: config
        });
      } else {
        return this.trigger("operation-finished", {
          "data": []
        });
      }
    };

    return Group;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Summarize = (function(_super) {
    __extends(Summarize, _super);

    function Summarize() {
      _ref = Summarize.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Summarize.baseExpression = [
      {
        "type": "label",
        "partId": "aggName",
        "label": "Summarize each column of"
      }, {
        "type": "slot",
        "partId": "originalBlock",
        "slotType": "noinput",
        "updateDynamic": "keySelector"
      }, {
        "type": "dynamic",
        "partId": "keySelector",
        "label": "aggregating repetitions of",
        "options": [],
        "selected": null
      }, {
        "type": "label",
        "partId": "andaslabel",
        "label": "by"
      }, {
        "type": "slot",
        "partId": "modesSelector",
        "label": "",
        "slotType": "options",
        "multiValue": true,
        "idSource": "originalBlock",
        "options": [
          {
            "value": "add",
            "label": "by adding"
          }, {
            "value": "mean",
            "label": "as the mean"
          }, {
            "value": "count",
            "label": "by counting"
          }, {
            "value": "min",
            "label": "minimum value"
          }, {
            "value": "max",
            "label": "maximum value"
          }, {
            "value": "first",
            "label": "first value"
          }, {
            "value": "last",
            "label": "last value"
          }, {
            "value": "ignore",
            "label": "ignore"
          }
        ],
        "default": "add"
      }
    ];

    /*
    @loopGroup:[
      {
        "type": "label"
        "partId": "andthenlabel_loopBlock_"
        "label": "and then (for each row) aggregate"
      },
      {
        "type": "dynamic"
        "partId": "keySelector_loopBlock_"
        "label": "using column"
        "options":[]
        "selected": null
      },
      {
        "type": "label"
        "partId": "andaslabel_loopBlock_"
        "label": "as id and aggregating each column"
      },
      {
        "type": "slot"
        "partId": "modesSelector_loopBlock_"
        "label": ""
        "slotType": "options"
        "multiValue": true
        "idSource": "originalBlock"
        "options":[
          {
            "value":"add"
            "label":"by adding"
          },
          {
            "value":"mean"
            "label":"as the mean"
          },
          {
            "value":"count"
            "label":"by counting"
          },
          {
            "value":"min"
            "label":"minimum value"
          },
          {
            "value":"max"
            "label":"maximum value"
          },
          {
            "value":"first"
            "label":"first value"
          },
          {
            "value":"last"
            "label":"last value"
          }
        ]
        "default":"asblock"
      }
    ]
    */


    Summarize.updateDynamicParts = function(partsCollection, slotsCollection) {
      var options, originalBlock, p, qv, _i, _j, _len, _len1, _ref1, _ref2, _results;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      if ((originalBlock != null) && (originalBlock.get("data") != null)) {
        options = [];
        _ref1 = originalBlock.get("data");
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          qv = _ref1[_i];
          options.push({
            "optId": qv.id,
            "label": qv.id,
            "value": qv.id
          });
        }
      } else {
        options = [];
      }
      _ref2 = partsCollection.models;
      _results = [];
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        p = _ref2[_j];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          _results.push(p.set("options", options));
        } else {
          _results.push(void 0);
        }
        /*
        FALTA HACER QUE SE "actualizen" los defaults del slot de mode (slot.options) pero no creo que deba ser aqui
        DEBERIA SER EL SLOT ON "modelSetup" o algo asi...
        
        if p.get("partId").indexOf("modesSelector")>=0
          p.set("options",options)
        */

      }
      return _results;
    };

    Summarize.updateSelectedOptions = function(partsCollection, slotsCollection) {
      var allOptions, forbiddenOptionValues, myOptions, o, p, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _ref2, _results;
      forbiddenOptionValues = {};
      _ref1 = partsCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          allOptions = p.get("options");
          if (p.get("selected") != null) {
            if (!forbiddenOptionValues[p.get("selected").value]) {
              forbiddenOptionValues[p.get("selected").value] = true;
            } else {
              for (_j = 0, _len1 = allOptions.length; _j < _len1; _j++) {
                o = allOptions[_j];
                if (!forbiddenOptionValues[o.value]) {
                  p.set("selected", o, {
                    silent: true
                  });
                  forbiddenOptionValues[o.value] = true;
                  break;
                }
              }
            }
          }
        }
      }
      _ref2 = partsCollection.models;
      _results = [];
      for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
        p = _ref2[_k];
        if (p.get("partId").indexOf("keySelector") >= 0) {
          myOptions = JSON.parse(JSON.stringify(allOptions));
          for (_l = 0, _len3 = myOptions.length; _l < _len3; _l++) {
            o = myOptions[_l];
            if (forbiddenOptionValues[o.value] && o.value !== p.get("selected").value) {
              o.hidden = true;
            } else {
              delete o.hidden;
            }
          }
          _results.push(p.set("options", myOptions));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    Summarize.getSourceIdsPostProcessing = function(slotsCollection, partsCollection, slotId, ids) {
      var forbiddenOptionValues, id, part, result, _i, _j, _len, _len1, _ref1;
      forbiddenOptionValues = {};
      _ref1 = partsCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        part = _ref1[_i];
        if (part.get("partId") === slotId) {
          break;
        }
        if (part.get("partId").indexOf("keySelector") >= 0) {
          forbiddenOptionValues[part.get("selected").value] = true;
        }
      }
      result = [];
      for (_j = 0, _len1 = ids.length; _j < _len1; _j++) {
        id = ids[_j];
        if (forbiddenOptionValues[id] == null) {
          result.push(id);
        }
      }
      return result;
    };

    Summarize.buildInput = function(slotsCollection, partsCollection) {
      var aggBy, aggByOriginal, aggRules, args, e, i, key, loopId, originalBlock, qv, s, slotId, _i, _j, _len, _len1, _ref1, _ref2;
      originalBlock = slotsCollection.where({
        "slotId": "originalBlock"
      })[0].getBlock();
      aggRules = [];
      _ref1 = slotsCollection.models;
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        s = _ref1[i];
        slotId = s.get("slotId");
        try {
          if (slotId.indexOf("modesSelector") >= 0) {
            loopId = slotId.replace("modesSelector", "");
            key = partsCollection.where({
              "partId": "keySelector" + loopId
            })[0].get("selected").value;
            aggByOriginal = slotsCollection.where({
              "slotId": "modesSelector" + loopId
            })[0].getBlock().get("data");
            if (aggByOriginal.length === 1) {
              aggBy = [];
              _ref2 = originalBlock.get("data");
              for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
                qv = _ref2[_j];
                aggBy.push({
                  id: qv.id,
                  value: aggByOriginal[0].value
                });
              }
              aggBy.push({
                id: originalBlock.get("metaData").idKey,
                value: aggByOriginal[0].value
              });
            } else {
              aggBy = aggByOriginal;
            }
            aggRules.push({
              key: key,
              aggBy: aggBy
            });
          }
        } catch (_error) {
          e = _error;
        }
      }
      args = [originalBlock, aggRules];
      return args;
    };

    /**
     * perform the TRANSPOSE operation
     * @param  {[type]} originalBlock [description]
     * @return {[type]}               [description]
    */


    Summarize.doOperation = function() {
      var aggRules, config, originalBlock,
        _this = this;
      originalBlock = arguments[0];
      aggRules = arguments[1];
      /*
      if aggRules.length == 0
        return
      key = aggRules[0].key
      aggBy = aggRules[0].aggBy
      */

      if ((originalBlock != null) && BlockUtils.getBlockDepth(originalBlock) > 0 && aggRules.length > 0) {
        if (this.worker != null) {
          this.worker.terminate();
          this.worker = null;
        }
        this.worker = new Worker('scripts/managers/operationworker.js');
        this.worker.onmessage = function(e) {
          switch (e.data.t) {
            case 'e':
              elog(e.data.d);
              return quadrigram.tracker.sendEvent({
                event_type: 101,
                event_subtype: 1,
                error_code: "aggregate_error",
                error_data: {
                  stack: e.data.d
                }
              });
            case 'log':
              return log("Worker message: ", e.data.message);
            case 'ready':
              return _this.worker.postMessage({
                t: "operate",
                operation: "aggregate",
                originalBlock: JSON.stringify(originalBlock),
                aggRules: JSON.stringify(aggRules)
              });
            case 'operation-finished':
              _this.trigger("operation-finished", e.data.d);
              _this.worker.terminate();
              return _this.worker = null;
          }
        };
        config = {};
        config.timeFormatArray = quadrigram.router.dataModels.currentProject.timeFormat.momentFormatter;
        return this.worker.postMessage({
          t: "isReady",
          d: config
        });
      } else {
        return this.trigger("operation-finished", {
          "data": []
        });
      }
    };

    return Summarize;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.GoToPage = (function(_super) {
    __extends(GoToPage, _super);

    function GoToPage() {
      _ref = GoToPage.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    GoToPage.baseExpression = [
      {
        "type": "label",
        "partId": "whenLabel",
        "label": "When user changes"
      }, {
        "type": "slot",
        "partId": "triggerblock",
        "slotType": "noinput"
      }, {
        "type": "label",
        "partId": "gotoLabel",
        "label": "go to page"
      }, {
        "type": "slot",
        "partId": "pageId",
        "label": "fdsfsa",
        "slotType": "options",
        "multiValue": false,
        "idSource": "originalBlock",
        "options": [],
        "default": "Page"
      }
    ];

    GoToPage.addSpecialListener = function(handler) {
      return quadrigram.router.dataModels.currentProject.get("pagesCollection").on("add remove change", handler);
    };

    GoToPage.removeSpecialListener = function(handler) {
      return quadrigram.router.dataModels.currentProject.get("pagesCollection").off("add remove change", handler);
    };

    GoToPage.updateExternalOptions = function(partsCollection, slotsCollection) {
      var options, p, pages, slot, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _results;
      pages = quadrigram.router.appViews.projectView.layoutManager.getRealPagesArray();
      options = [];
      for (_i = 0, _len = pages.length; _i < _len; _i++) {
        p = pages[_i];
        options.push({
          "optId": p.get("id"),
          "label": p.get("label"),
          "value": p.get("label")
        });
      }
      _ref1 = partsCollection.models;
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        p = _ref1[_j];
        if (p.get("partId").indexOf("pageId") >= 0) {
          p.set("options", options);
        }
      }
      _ref2 = slotsCollection.models;
      _results = [];
      for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
        slot = _ref2[_k];
        if (slot.get("slotId") === "pageId") {
          _results.push(slot.options = options);
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    GoToPage.buildInput = function(slotsCollection, partsCollection) {
      var args, error, pageId, triggerblock;
      triggerblock = null;
      pageId = 0;
      try {
        triggerblock = slotsCollection.where({
          "slotId": "triggerblock"
        })[0].getBlock();
        pageId = slotsCollection.where({
          "slotId": "pageId"
        })[0].getBlock().getValue();
      } catch (_error) {
        error = _error;
        log("error", error);
      }
      args = [triggerblock, pageId];
      return args;
    };

    GoToPage.doOperation = function() {
      var originalBlock, pageId, trueResult;
      originalBlock = arguments[0];
      pageId = arguments[1];
      if ((originalBlock != null) && (pageId != null) && (originalBlock.get("outputOwnerViz") != null) && pageId !== "") {
        if (originalBlock.get("outputOwnerViz").userInteractive && originalBlock.get("outputOwnerViz").triggering) {
          Backbone.history.fragment = null;
          quadrigram.router.navigate("#p/" + pageId, {
            trigger: true
          });
        }
        trueResult = {
          "data": []
        };
      } else {
        trueResult = {
          "data": []
        };
      }
      return this.trigger("operation-finished", trueResult);
    };

    return GoToPage;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.GoToViz = (function(_super) {
    __extends(GoToViz, _super);

    function GoToViz() {
      _ref = GoToViz.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    GoToViz.baseExpression = [
      {
        "type": "label",
        "partId": "whenLabel",
        "label": "When user changes"
      }, {
        "type": "slot",
        "partId": "triggerblock",
        "slotType": "noinput"
      }, {
        "type": "label",
        "partId": "gotoLabel",
        "label": "go to viz"
      }, {
        "type": "slot",
        "partId": "vizId",
        "label": "fdsfsa",
        "slotType": "options",
        "multiValue": false,
        "idSource": "originalBlock",
        "options": [],
        "default": "Page"
      }
    ];

    GoToViz.addSpecialListener = function(handler) {
      return quadrigram.router.dataModels.currentProject.get("visualizersCollection").on("add remove changeGroupLabel", handler);
    };

    GoToViz.removeSpecialListener = function(handler) {
      return quadrigram.router.dataModels.currentProject.get("visualizersCollection").off("add remove changeGroupLabel", handler);
    };

    GoToViz.updateExternalOptions = function(partsCollection, slotsCollection) {
      var options, p, slot, v, vizs, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _results;
      vizs = quadrigram.router.dataModels.currentProject.get("visualizersCollection").models;
      options = [];
      for (_i = 0, _len = vizs.length; _i < _len; _i++) {
        v = vizs[_i];
        options.push({
          "optId": v.get("id"),
          "label": v.get("blockGroup").get("label"),
          "value": v.get("blockGroup").get("label")
        });
      }
      _ref1 = partsCollection.models;
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        p = _ref1[_j];
        if (p.get("partId").indexOf("vizId") >= 0) {
          p.set("options", options);
        }
      }
      _ref2 = slotsCollection.models;
      _results = [];
      for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
        slot = _ref2[_k];
        if (slot.get("slotId") === "vizId") {
          _results.push(slot.options = options);
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    GoToViz.buildInput = function(slotsCollection, partsCollection) {
      var args, error, triggerblock, vizId;
      triggerblock = null;
      vizId = 0;
      try {
        triggerblock = slotsCollection.where({
          "slotId": "triggerblock"
        })[0].getBlock();
        vizId = slotsCollection.where({
          "slotId": "vizId"
        })[0].getBlock().getValue();
      } catch (_error) {
        error = _error;
        log("error", error);
      }
      args = [triggerblock, vizId];
      return args;
    };

    GoToViz.doOperation = function() {
      var originalBlock, trueResult, vizId;
      originalBlock = arguments[0];
      vizId = arguments[1];
      if ((originalBlock != null) && (vizId != null) && (originalBlock.get("outputOwnerViz") != null) && vizId !== "") {
        if (originalBlock.get("outputOwnerViz").triggering && originalBlock.get("outputOwnerViz").userInteractive) {
          Backbone.history.fragment = null;
          quadrigram.router.navigate("#v/" + vizId, {
            trigger: true
          });
        }
        trueResult = {
          "data": ["?"]
        };
      } else {
        trueResult = {
          "data": ["?"]
        };
      }
      return this.trigger("operation-finished", trueResult);
    };

    return GoToViz;

  }).call(this, quadrigram.Models.Operation);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.BlockGroupModel = (function(_super) {
    __extends(BlockGroupModel, _super);

    function BlockGroupModel() {
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = BlockGroupModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BlockGroupModel.prototype.relations = [
      {
        type: Backbone.HasMany,
        key: 'blocksCollection',
        relatedModel: "quadrigram.Models.DataBlockModel",
        includeInJSON: true,
        collectionType: "quadrigram.Collections.DataBlockCollection",
        reverseRelation: {
          key: 'blockGroup',
          bubbleUp: true,
          includeInJSON: "id"
        }
      }, {
        type: Backbone.HasOne,
        key: 'ownerViz',
        relatedModel: "quadrigram.Models.VisualizerModel",
        includeInJSON: Backbone.Model.prototype.idAttribute,
        reverseRelation: {
          type: Backbone.HasOne,
          key: 'blockGroup',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }, {
        type: Backbone.HasOne,
        key: 'ownerOp',
        relatedModel: "quadrigram.Models.OperatorModel",
        includeInJSON: Backbone.Model.prototype.idAttribute,
        reverseRelation: {
          type: Backbone.HasOne,
          key: 'blockGroup',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }, {
        type: Backbone.HasOne,
        key: 'mainBlock',
        relatedModel: "quadrigram.Models.FunctionBlockModel",
        includeInJSON: Backbone.Model.prototype.idAttribute,
        reverseRelation: {
          type: Backbone.HasOne,
          key: 'ownerCustomBlockGroup',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }
    ];

    BlockGroupModel.prototype.undoableEvents = ["add:blocksCollection", "remove:blocksCollection", "change:buildData"];

    BlockGroupModel.prototype.subModelTypes = {
      "external": "quadrigram.Models.ExternalBlockGroupModel",
      "custom": "quadrigram.Models.CustomBlockGroupModel",
      "viz": "quadrigram.Models.VizBlockGroupModel",
      "function": "quadrigram.Models.FunctionBlockGroupModel"
    };

    BlockGroupModel.prototype.create = function() {};

    BlockGroupModel.prototype.modelSetup = function(options) {};

    /*
    destroy:()=>
      for b in @.get("blocksCollection").models
        ##No se como pero peta...
        if b?
          b.detachAndDestroy()
    */


    return BlockGroupModel;

  })(quadrigram.Models.QModel);

  quadrigram.Models.BlockGroupModel.setup();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ExternalBlockGroupModel = (function(_super) {
    __extends(ExternalBlockGroupModel, _super);

    function ExternalBlockGroupModel() {
      this.updateBlocks = __bind(this.updateBlocks, this);
      this.toOptimizedResource = __bind(this.toOptimizedResource, this);
      this.createSubBlocks = __bind(this.createSubBlocks, this);
      this.createNetworkSubBlocks = __bind(this.createNetworkSubBlocks, this);
      this.updateAggregatedBlock = __bind(this.updateAggregatedBlock, this);
      this.updateNetworkBlocks = __bind(this.updateNetworkBlocks, this);
      this.updateTypedBlock = __bind(this.updateTypedBlock, this);
      this.handleNewBuildData = __bind(this.handleNewBuildData, this);
      this.updateBuildData = __bind(this.updateBuildData, this);
      this.updateAggregators = __bind(this.updateAggregators, this);
      this.resetBuildData = __bind(this.resetBuildData, this);
      this.createMainBlock = __bind(this.createMainBlock, this);
      this.buildFromRawData = __bind(this.buildFromRawData, this);
      this.buildFromProcessedData = __bind(this.buildFromProcessedData, this);
      this.onJsonParsed = __bind(this.onJsonParsed, this);
      this.csvToJson = __bind(this.csvToJson, this);
      this.jsonToJson = __bind(this.jsonToJson, this);
      this.getXLSSheet = __bind(this.getXLSSheet, this);
      this.xlsworker = __bind(this.xlsworker, this);
      this.xlsToJson = __bind(this.xlsToJson, this);
      this.convertToJSON = __bind(this.convertToJSON, this);
      this.parseFile = __bind(this.parseFile, this);
      this.onResponse = __bind(this.onResponse, this);
      this.requestData = __bind(this.requestData, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = ExternalBlockGroupModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExternalBlockGroupModel.prototype.create = function() {
      return this.set("type", "external", {
        silent: true
      });
    };

    ExternalBlockGroupModel.prototype.modelSetup = function(options) {
      return this.requestData();
    };

    ExternalBlockGroupModel.prototype.requestData = function(options) {
      this.set("fetchState", "loading");
      quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
        message: "Getting " + this.get("label") + " from Google Drive ",
        type: 0,
        priority: 0,
        timeout: 0,
        mode: 0,
        "class": "getting",
        id: this.get("rid")
      });
      return quadrigram.router.managers.serverManager.fetchFile(this.get("rid"), this.get("id"), this.onResponse);
    };

    ExternalBlockGroupModel.prototype.onResponse = function(fetchResponse) {
      quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
        mode: 1,
        "class": "getting",
        id: fetchResponse.rid
      });
      if (fetchResponse.status !== 200 && fetchResponse.status !== "success") {
        this.invalidData = true;
        quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
          message: 1,
          type: 1,
          priority: 1,
          "class": "driveError",
          id: fetchResponse.rid,
          timeout: 3000,
          mode: 0
        });
        return;
      }
      if (fetchResponse.providerName !== "local") {
        return this.parseFile(fetchResponse.rid, fetchResponse.mimeType, fetchResponse.data, fetchResponse.satus);
      } else {
        return this.buildFromProcessedData(fetchResponse.data);
      }
    };

    ExternalBlockGroupModel.prototype.parseFile = function(rid, mimeType, rawData, status) {
      if (rawData != null) {
        quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
          message: "Parsing the file " + this.get("label"),
          type: 0,
          priority: 0,
          timeout: 0,
          mode: 0,
          "class": "parsing",
          id: this.get("rid")
        });
        return this.convertToJSON(mimeType, rawData, this.onJsonParsed);
      } else {
        elog("Error: file not found");
        return this.onJsonParsed({});
      }
    };

    ExternalBlockGroupModel.prototype.convertToJSON = function(mimeType, content, callback) {
      var pattern;
      pattern = /(.+?)(;.+?)?$/;
      mimeType = mimeType.match(pattern)[1];
      switch (mimeType) {
        case "application/vnd.ms-excel":
          return this.xlsToJson(content, callback, "xls");
        case "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":
          return this.xlsToJson(content, callback, "xlsx");
        case "application/json":
          return this.jsonToJson(content, callback);
        case "text/csv":
          return this.csvToJson(content, callback);
      }
    };

    ExternalBlockGroupModel.prototype.xlsToJson = function(content, callback, xlsType) {
      var arr, bstr, data, i, _i, _ref1;
      data = new Uint8Array(content);
      arr = new Array();
      for (i = _i = 0, _ref1 = data.length + 1; 0 <= _ref1 ? _i <= _ref1 : _i >= _ref1; i = 0 <= _ref1 ? ++_i : --_i) {
        arr[i] = String.fromCharCode(data[i]);
      }
      bstr = arr.join("");
      return this.xlsworker(bstr, callback, xlsType);
    };

    ExternalBlockGroupModel.prototype.xlsworker = function(sourceData, cb, xlsType) {
      var worker,
        _this = this;
      worker = new Worker('scripts/managers/xlsworker.js');
      worker.externalBlockGroup = this;
      worker.onmessage = function(e) {
        switch (e.data.t) {
          case 'e':
            elog(e.data.d);
            return quadrigram.tracker.sendEvent({
              event_type: 101,
              event_subtype: 2,
              error_code: "xls_error",
              error_data: {
                stack: e.data.d
              }
            });
          case 'readyToParse':
            return worker.postMessage({
              t: "parse",
              d: sourceData,
              xlsType: xlsType,
              sheet: 0
            });
          case 'parsed':
            cb(e.data.d);
            return worker.terminate();
        }
      };
      return worker.postMessage({
        t: "isReadyToParse",
        d: sourceData,
        xlsType: xlsType
      });
    };

    ExternalBlockGroupModel.prototype.getXLSSheet = function(rawData, sheetName) {};

    ExternalBlockGroupModel.prototype.jsonToJson = function(content, cb) {};

    ExternalBlockGroupModel.prototype.csvToJson = function(content, cb) {
      var csvString, lastObject, result;
      csvString = (new TextDecoder("utf-8")).decode(content);
      result = Papa.parse(csvString, {
        header: true
      });
      lastObject = result.data[result.data.length - 1];
      while (Object.keys(lastObject).length === 1 && lastObject[Object.keys(lastObject)[0]] === "") {
        result.data.pop();
        lastObject = result.data[result.data.length - 1];
      }
      return cb(result.data);
    };

    ExternalBlockGroupModel.prototype.onJsonParsed = function(jsonData) {
      var _this = this;
      quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
        mode: 1,
        "class": "parsing",
        id: this.get("rid")
      });
      this.rawData = jsonData;
      if (!this.get("buildData")) {
        quadrigram.router.appViews.uiView.showBlockBuilder(this);
      }
      this.on("change:buildData", this.handleNewBuildData);
      this.on("change:currentSheet", function() {
        return _this.buildFromRawData({
          resetBuildData: true
        });
      });
      return this.buildFromRawData();
    };

    ExternalBlockGroupModel.prototype.buildFromProcessedData = function(data) {
      var bdata, block, _i, _j, _len, _len1, _ref1, _ref2;
      log("building from", data);
      _ref1 = data.blocks;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        bdata = _ref1[_i];
        block = this.get("blocksCollection").findWhere({
          "id": bdata.id
        });
        block.staticData = true;
        block.set("data", bdata.data);
        block.set("metaData", bdata.metaData);
      }
      _ref2 = data.blocks;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        bdata = _ref2[_j];
        block = this.get("blocksCollection").findWhere({
          "id": bdata.id
        });
        block.set("fetchState", "ready");
      }
      return null;
    };

    ExternalBlockGroupModel.prototype.buildFromRawData = function(options) {
      var bd, colNames, jsonData, key, keyCandidates, row, sheet, _i, _len;
      if (this.rawData.multiSheet) {
        this.sheetOptions = Object.keys(this.rawData.sheets);
        if (this.get("currentSheet") == null) {
          this.set("currentSheet", Object.keys(this.rawData.sheets)[0], {
            silent: true
          });
        }
        if (Object.keys(this.rawData.sheets).length > 1) {
          this.set("blockLabel", this.get("label") + " (" + this.get("currentSheet") + ")");
        }
        sheet = this.rawData.sheets[this.get("currentSheet")];
        jsonData = sheet.data;
        this.consistency = sheet.consistency;
        if (this.consistency === "invalid") {
          this.invalidData = true;
        } else {
          this.invalidData = false;
        }
        colNames = sheet.colNames;
      } else {
        jsonData = this.rawData;
      }
      if ((colNames != null) && colNames.length > 0) {
        this.keys = colNames;
      } else {
        keyCandidates = {};
        for (_i = 0, _len = jsonData.length; _i < _len; _i++) {
          row = jsonData[_i];
          for (key in row) {
            keyCandidates[key] = true;
          }
        }
        this.keys = Object.keys(keyCandidates);
        colNames = this.keys;
      }
      this.jsonData = jsonData;
      if (!this.invalidData) {
        this.createMainBlock(jsonData);
        this.dataTypeOptions = {};
        this.dataTypeOptions.network = NetworkUtils.checkIfNetwork(this.mainBlock);
        if (!this.get("buildData") || (options && options.resetBuildData)) {
          if (this.dataTypeOptions.network != null) {
            bd = {};
            bd.dataType = "network";
            bd.networkFormat = Object.keys(this.dataTypeOptions.network)[0];
            return this.set("buildData", bd);
          } else {
            return this.updateBuildData(this.resetBuildData(jsonData, colNames));
          }
        } else {
          return this.updateTypedBlock();
        }
      } else {
        this.get("blocksCollection").reset({
          silent: true
        });
        this.mainBlock = new quadrigram.Models.ExternalBlockModel({
          "blockGroup": this,
          "label": "ERROR",
          "role": "empty",
          "origin": "file"
        });
        this.dataTypeOptions = {};
        this.set({
          "fetchState": "ready"
        }, {
          silent: true
        });
        return this.trigger("change-block-structure");
      }
    };

    ExternalBlockGroupModel.prototype.createMainBlock = function(dataObject) {
      var currentId, idsDict, index, key, keyBlockData, keyData, mainBlock, mainData, nameOfTableBlock, object, qvalue, _i, _j, _len, _len1, _ref1;
      this.preBlocks = [];
      this.set("consistency", this.consistency, {
        "silent": true
      });
      if (this.get("blocksCollection").where({
        "role": "hidden"
      }).length <= 0) {
        nameOfTableBlock = this.get("label").split(".")[0];
        if (nameOfTableBlock.length > 25) {
          nameOfTableBlock = nameOfTableBlock.substring(0, 22) + "...";
        }
        mainBlock = new quadrigram.Models.ExternalBlockModel({
          "blockGroup": this,
          "label": nameOfTableBlock,
          "role": "hidden",
          "origin": "file"
        });
        mainBlock.set("metaData", {
          "idLabel": "Column",
          "valueLabel": nameOfTableBlock,
          "viewMode": "table"
        });
      } else {
        mainBlock = this.get("blocksCollection").where({
          "role": "hidden"
        })[0];
      }
      mainData = [];
      this.hasIdRepetition = {};
      _ref1 = this.keys;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        key = _ref1[_i];
        if (true) {
          keyData = [];
          idsDict = {};
          for (index = _j = 0, _len1 = dataObject.length; _j < _len1; index = ++_j) {
            object = dataObject[index];
            currentId = String(index);
            keyData.push({
              id: currentId,
              value: object[key]
            });
            if (idsDict[object[key]]) {
              this.hasIdRepetition[key] = true;
            }
            idsDict[object[key]] = true;
            keyBlockData = new quadrigram.Models.DataBlockData(keyData);
            keyBlockData.set("label", key);
            keyBlockData.set("metaData", {
              "idLabel": "Index",
              "valueLabel": key,
              "viewMode": "list",
              "viewDirection": "col"
            });
          }
          qvalue = new quadrigram.Models.QValue(keyBlockData, key);
          mainData.push(qvalue);
        }
      }
      if (mainData.length === 1) {
        mainBlock.get("metaData").viewMode = "list";
        mainBlock.get("metaData").valueLabel = mainData[0].value.get("metaData").valueLabel;
        mainBlock.get("metaData").idLabel = mainData[0].value.get("metaData").idLabel;
        mainData = mainData[0].value.get("data");
      } else {
        mainBlock.get("metaData").viewMode = "table";
      }
      mainBlock.get("metaData").idKey = "__Index__";
      mainBlock.set({
        "data": mainData,
        "fetchState": "ready"
      }, {
        "silent": true
      });
      return this.mainBlock = mainBlock;
    };

    ExternalBlockGroupModel.prototype.resetBuildData = function(jsonData, colNames) {
      var firstColKey, result;
      result = {};
      if (colNames != null) {
        firstColKey = colNames[0];
      } else {
        firstColKey = Object.keys(jsonData[0])[0];
      }
      if (!QValueUtils.needsAggregation(jsonData, firstColKey)) {
        result.idKey = firstColKey;
      } else {
        result.idKey = "__Index__";
      }
      result.blocks = [];
      this.updateAggregators(result, jsonData);
      result.dataType = "dataTable";
      return result;
    };

    ExternalBlockGroupModel.prototype.updateAggregators = function(buildData, jsonData) {
      var key, _i, _len, _ref1, _results;
      buildData.blocks = [];
      _ref1 = this.keys;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        key = _ref1[_i];
        if (buildData.idKey !== "__Index__" && this.hasIdRepetition[buildData.idKey]) {
          _results.push(buildData.blocks.push({
            "id": key,
            value: QValueUtils.chooseBestAggregation(jsonData, key)
          }));
        } else {
          _results.push(buildData.blocks.push({
            "id": key,
            value: "none"
          }));
        }
      }
      return _results;
    };

    ExternalBlockGroupModel.prototype.updateBuildData = function(newData) {
      return this.set("buildData", newData);
    };

    ExternalBlockGroupModel.prototype.handleNewBuildData = function() {
      /*VERY IMPORTANT*/

      var _this = this;
      if ((this.lastIdKey == null) || this.lastIdKey !== this.get("buildData").idKey || this.get("buildData").blocks.length === 0) {
        this.updateAggregators(this.get("buildData"), this.jsonData);
      }
      this.lastIdKey = this.get("buildData").idKey;
      return this.updateTypedBlock(function() {
        return _this.trigger("change-block-structure");
      });
    };

    ExternalBlockGroupModel.prototype.updateTypedBlock = function(callback) {
      if (this.get("buildData").dataType == null) {
        this.get("buildData").dataType = "dataTable";
      }
      if (this.get("buildData").dataType === "network") {
        return this.updateNetworkBlocks(callback);
      } else {
        return this.updateAggregatedBlock(callback);
      }
    };

    ExternalBlockGroupModel.prototype.updateNetworkBlocks = function(callback) {
      var aggregatedMainBlock, aggregatedMainPreBlock, nodesBlock, relsBlock,
        _this = this;
      if (this.get("blocksCollection").where({
        "role": "all-network"
      }).length <= 0) {
        aggregatedMainPreBlock = new quadrigram.Models.PreFunctionBlockModel({
          "label": this.mainBlock.get("label"),
          "blockGroup": this,
          "role": "all-network",
          "order": 0,
          "operation": "Summarize",
          "origin": "file",
          "options": {
            "keySelector": {
              value: this.keys[0]
            },
            "originalBlock": this.mainBlock,
            "modesSelector": [
              {
                value: "first"
              }
            ]
          }
        });
        aggregatedMainPreBlock.on("replace-model", function(aggregatedMainBlock) {
          aggregatedMainPreBlock.off("replace-model");
          return aggregatedMainBlock.on("change:fetchState", function() {
            aggregatedMainBlock.off("change:fetchState");
            NetworkUtils.fillBlocks(_this.mainBlock, nodesBlock, relsBlock, _this.get("buildData").networkFormat, aggregatedMainBlock);
            _this.createNetworkSubBlocks(nodesBlock, relsBlock);
            if (callback) {
              callback(nodesBlock, relsBlock);
            }
            _this.set("fetchState", "ready");
            return _this.trigger("change-block-structure");
          });
        });
        aggregatedMainBlock = aggregatedMainPreBlock.activate();
      } else {
        aggregatedMainBlock = this.get("blocksCollection").findWhere({
          "role": "all-network"
        });
        aggregatedMainBlock.get("operator").setExpressionValues({
          "keySelector": {
            value: this.keys[0]
          },
          "originalBlock": this.mainBlock,
          "modesSelector": [
            {
              value: "first"
            }
          ]
        });
        aggregatedMainBlock.on("change:fetchState", function() {
          if (aggregatedMainBlock.get("fetchState") === "ready") {
            aggregatedMainBlock.off("change:fetchState");
            NetworkUtils.fillBlocks(_this.mainBlock, nodesBlock, relsBlock, _this.get("buildData").networkFormat, aggregatedMainBlock);
            _this.createNetworkSubBlocks(nodesBlock, relsBlock);
            if (callback) {
              callback(nodesBlock, relsBlock);
            }
            _this.set("fetchState", "ready");
            return _this.trigger("change-block-structure");
          }
        });
        aggregatedMainBlock.runOperator();
      }
      if (this.get("blocksCollection").where({
        "role": "nodes"
      }).length <= 0) {
        nodesBlock = new quadrigram.Models.ExternalBlockModel({
          "label": "Nodes of " + this.mainBlock.get("label"),
          "blockGroup": this,
          "role": "nodes",
          "order": 0,
          "origin": "file",
          "metaData": {
            "viewMode": "table",
            "idLabel": "Node id"
          }
        });
      } else {
        nodesBlock = this.get("blocksCollection").findWhere({
          "role": "nodes"
        });
      }
      if (this.get("blocksCollection").where({
        "role": "rels"
      }).length <= 0) {
        return relsBlock = new quadrigram.Models.ExternalBlockModel({
          "label": "Relations of " + this.mainBlock.get("label"),
          "blockGroup": this,
          "role": "rels",
          "order": 1,
          "origin": "file",
          "metaData": {
            "viewMode": "table",
            "idLabel": "Relation id"
          }
        });
      } else {
        return relsBlock = this.get("blocksCollection").findWhere({
          "role": "rels"
        });
      }
    };

    ExternalBlockGroupModel.prototype.updateAggregatedBlock = function(callback) {
      var aggregatedMainBlock, aggregatedMainPreBlock,
        _this = this;
      if (quadrigram.router.compareVersions(quadrigram.router.dataModels.currentProject.get("pversion"), "0.9") < 0) {
        this.updateBlocks();
        this.set("fetchState", "ready");
        this.trigger("change-block-structure");
        return;
      }
      if (this.get("blocksCollection").where({
        "role": "all"
      }).length <= 0) {
        aggregatedMainPreBlock = new quadrigram.Models.PreFunctionBlockModel({
          "label": this.mainBlock.get("label"),
          "blockGroup": this,
          "role": "all",
          "order": 0,
          "operation": "Summarize",
          "origin": "file",
          "options": {
            "keySelector": {
              value: this.get("buildData").idKey
            },
            "originalBlock": this.mainBlock,
            "modesSelector": this.get("buildData").blocks
          }
        });
        this.preBlocks.push(aggregatedMainPreBlock);
        aggregatedMainPreBlock.on("replace-model", function(aggregatedMainBlock) {
          aggregatedMainPreBlock.off("replace-model");
          aggregatedMainBlock.on("change:fetchState", function() {
            var indexCol;
            aggregatedMainBlock.off("change:fetchState");
            if (_this.get("buildData").idKey !== "__Index__") {
              indexCol = _.find(aggregatedMainBlock.get("data"), function(col) {
                return col.id === "__Index__";
              });
              if (indexCol != null) {
                aggregatedMainBlock.get("data").splice(aggregatedMainBlock.get("data").indexOf(indexCol), 1);
              }
            }
            _this.createSubBlocks(aggregatedMainBlock);
            if (callback) {
              callback(aggregatedMainBlock);
            }
            _this.set("fetchState", "ready");
            return _this.trigger("change-block-structure");
          });
          return aggregatedMainBlock.runOperator();
        });
        aggregatedMainBlock = aggregatedMainPreBlock.activate();
      } else {
        aggregatedMainBlock = this.get("blocksCollection").findWhere({
          "role": "all"
        });
        aggregatedMainBlock.get("operator").setExpressionValues({
          "keySelector": {
            value: this.get("buildData").idKey
          },
          "originalBlock": this.mainBlock,
          "modesSelector": this.get("buildData").blocks
        });
        aggregatedMainBlock.on("change:fetchState", function() {
          var indexCol;
          if (aggregatedMainBlock.get("fetchState") === "ready") {
            aggregatedMainBlock.off("change:fetchState");
            if (_this.get("buildData").idKey !== "__Index__") {
              indexCol = _.find(aggregatedMainBlock.get("data"), function(col) {
                return col.id === "__Index__";
              });
              if (indexCol != null) {
                aggregatedMainBlock.get("data").splice(aggregatedMainBlock.get("data").indexOf(indexCol), 1);
              }
            }
            _this.createSubBlocks(aggregatedMainBlock);
            if (callback) {
              callback(aggregatedMainBlock);
            }
            _this.set("fetchState", "ready");
            return _this.trigger("change-block-structure");
          }
        });
        aggregatedMainBlock.runOperator();
      }
      return aggregatedMainBlock;
    };

    ExternalBlockGroupModel.prototype.createNetworkSubBlocks = function(nodesBlock, relsBlock) {
      var block, blocksToRemove, i, mainDepth, newBlockJsonKeys, preBlock, qv, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _ref3;
      mainDepth = 2;
      /*
      @preBlocks = []
      blocksToRemove = []
      for block,i in @get("blocksCollection").models
        if block.get("role")!="nodes" && block.get("role")!="rels" && block.get("role")!="all-network" && block.get("role")!="hidden" 
          block.detachAndDestroy()
          blocksToRemove.push(block)
      @get("blocksCollection").remove(blocksToRemove)
      */

      newBlockJsonKeys = {};
      _ref1 = nodesBlock.get("data");
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        qv = _ref1[i];
        if (this.get("blocksCollection").where({
          "jsonKey": "node_" + qv.id
        }).length <= 0) {
          preBlock = new quadrigram.Models.PreFunctionBlockModel({
            "jsonKey": "node_" + qv.id,
            "label": "Node " + qv.id,
            "blockGroup": this,
            "role": "node-prop",
            "order": i,
            "operation": "Filter",
            "origin": "file",
            "options": {
              "originalBlock": nodesBlock,
              "keySelector": {
                "optId": "col",
                "type": "id",
                "level": 0
              },
              "relationSelector": {
                "optId": "eq",
                "label": "equal to",
                "value": "=="
              },
              "comparingValue": qv.id
            }
          });
          this.preBlocks.push(preBlock);
        } else {
          newBlockJsonKeys["node_" + qv.id] = true;
        }
      }
      _ref2 = relsBlock.get("data");
      for (i = _j = 0, _len1 = _ref2.length; _j < _len1; i = ++_j) {
        qv = _ref2[i];
        if (this.get("blocksCollection").where({
          "jsonKey": "rel_" + qv.id
        }).length <= 0) {
          preBlock = new quadrigram.Models.PreFunctionBlockModel({
            "jsonKey": "rel_" + qv.id,
            "label": "Relation " + qv.id,
            "blockGroup": this,
            "role": "rel-prop",
            "order": i,
            "operation": "Filter",
            "origin": "file",
            "options": {
              "originalBlock": relsBlock,
              "keySelector": {
                "optId": "col",
                "type": "id",
                "level": 0
              },
              "relationSelector": {
                "optId": "eq",
                "label": "equal to",
                "value": "=="
              },
              "comparingValue": qv.id
            }
          });
          this.preBlocks.push(preBlock);
        } else {
          newBlockJsonKeys["rel_" + qv.id] = true;
        }
      }
      blocksToRemove = [];
      _ref3 = this.get("blocksCollection").models;
      for (i = _k = 0, _len2 = _ref3.length; _k < _len2; i = ++_k) {
        block = _ref3[i];
        if ((newBlockJsonKeys[block.get("jsonKey")] == null) && block.get("role") !== "nodes" && block.get("role") !== "rels" && block.get("role") !== "all-network" && block.get("role") !== "hidden") {
          block.detachAndDestroy();
          blocksToRemove.push(block);
        }
      }
      return this.get("blocksCollection").remove(blocksToRemove);
    };

    ExternalBlockGroupModel.prototype.createSubBlocks = function(sourceBlock) {
      var block, blocksToRemove, i, mainDepth, newBlockJsonKeys, preBlock, qv, retroValue, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _ref3;
      mainDepth = BlockUtils.getBlockDepth(sourceBlock);
      this.preBlocks = [];
      /*
      Borrado antiguo, se cargaba los rows... lo ponemos al final
      #chapuzilla para no tener que hacer wheres
      tmpArray = sourceBlock.get("data")
      newBlockIds = {}
      for qv in tmpArray
        newBlockIds[qv.id]=true
      
      blocksToRemove = []
      for block,i in @get("blocksCollection").models
        if block.get("role")!="all" && block.get("role")!="hidden" && !newBlockIds[block.get("jsonKey")]? && block.get("role")!="level0names" && block.get("role")!="level1names"
          block.detachAndDestroy()
          blocksToRemove.push(block)
      
      @get("blocksCollection").remove(blocksToRemove)
      */

      newBlockJsonKeys = {};
      if (quadrigram.router.compareVersions(quadrigram.router.dataModels.currentProject.get("pversion"), "0.9.3") < 0) {
        retroValue = 1;
      } else {
        retroValue = 1;
      }
      if (this.get("blocksCollection").where({
        "jsonKey": "id-col"
      }).length <= 0) {
        preBlock = new quadrigram.Models.PreFunctionBlockModel({
          "jsonKey": "id-col",
          "label": "Column names",
          "blockGroup": this,
          "role": "level0names",
          "order": 0,
          "operation": "GetNames",
          "origin": "file",
          "options": {
            "levelSelector": {
              "optId": "col",
              "value": retroValue
            },
            "originalBlock": sourceBlock
          }
        });
        this.preBlocks.push(preBlock);
      }
      if (quadrigram.router.compareVersions(quadrigram.router.dataModels.currentProject.get("pversion"), "0.9.3") < 0) {
        retroValue = mainDepth;
      } else {
        retroValue = 0;
      }
      _ref1 = sourceBlock.get("data");
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        qv = _ref1[i];
        if (this.get("blocksCollection").where({
          "jsonKey": qv.id
        }).length <= 0 || this.get("blocksCollection").where({
          "jsonKey": qv.id
        })[0].get("operator").get("blockGroup") === null) {
          preBlock = new quadrigram.Models.PreFunctionBlockModel({
            "jsonKey": qv.id,
            "label": qv.id,
            "blockGroup": this,
            "role": "level0",
            "order": i,
            "operation": "Filter",
            "origin": "file",
            "options": {
              "originalBlock": sourceBlock,
              "keySelector": {
                "optId": "col",
                "type": "id",
                "level": retroValue
              },
              "relationSelector": {
                "optId": "eq",
                "label": "equal to",
                "value": "=="
              },
              "comparingValue": qv.id
            }
          });
          this.preBlocks.push(preBlock);
        } else {
          newBlockJsonKeys[qv.id] = true;
        }
      }
      if (mainDepth > 1) {
        if (quadrigram.router.compareVersions(quadrigram.router.dataModels.currentProject.get("pversion"), "0.9.3") < 0) {
          retroValue = 2;
        } else {
          retroValue = 2;
        }
        if (this.get("blocksCollection").where({
          "jsonKey": "id-row"
        }).length <= 0) {
          preBlock = new quadrigram.Models.PreFunctionBlockModel({
            "jsonKey": "id-row",
            "label": "Row names",
            "blockGroup": this,
            "role": "level1names",
            "order": 0,
            "operation": "GetNames",
            "origin": "file",
            "options": {
              "levelSelector": {
                "optId": "row",
                "value": retroValue
              },
              "originalBlock": sourceBlock
            }
          });
          this.preBlocks.push(preBlock);
        }
        if (quadrigram.router.compareVersions(quadrigram.router.dataModels.currentProject.get("pversion"), "0.9.3") < 0) {
          retroValue = mainDepth - 1;
        } else {
          retroValue = 1;
        }
        _ref2 = sourceBlock.get("data")[0].value.get("data");
        for (i = _j = 0, _len1 = _ref2.length; _j < _len1; i = ++_j) {
          qv = _ref2[i];
          if (this.get("blocksCollection").where({
            "jsonKey": qv.id
          }).length <= 0) {
            preBlock = new quadrigram.Models.PreFunctionBlockModel({
              "jsonKey": qv.id,
              "label": qv.id,
              "blockGroup": this,
              "role": "level1",
              "order": i,
              "operation": "Filter",
              "origin": "file",
              "options": {
                "originalBlock": sourceBlock,
                "keySelector": {
                  "optId": "row",
                  "type": "id",
                  "level": retroValue
                },
                "relationSelector": {
                  "optId": "eq",
                  "label": "equal to",
                  "value": "=="
                },
                "comparingValue": qv.id
              }
            });
            this.preBlocks.push(preBlock);
          } else {
            newBlockJsonKeys[qv.id] = true;
          }
        }
      }
      blocksToRemove = [];
      _ref3 = this.get("blocksCollection").models;
      for (i = _k = 0, _len2 = _ref3.length; _k < _len2; i = ++_k) {
        block = _ref3[i];
        if (block.get("role") !== "all" && block.get("role") !== "hidden" && (newBlockJsonKeys[block.get("jsonKey")] == null) && block.get("role") !== "level0names" && block.get("role") !== "level1names") {
          block.detachAndDestroy();
          blocksToRemove.push(block);
        }
      }
      return this.get("blocksCollection").remove(blocksToRemove);
    };

    ExternalBlockGroupModel.prototype.toOptimizedResource = function() {
      var b, result, _i, _len, _ref1;
      result = {};
      result.id = this.get("id");
      result.rid = this.get("rid");
      _ref1 = this.get("blocksCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        b = _ref1[_i];
        result.blocks || (result.blocks = []);
        if (b.get("role") !== "hidden" && b.get("insideSlot").models.length > 0) {
          result.blocks.push(b.toJSON());
        }
      }
      return result;
    };

    ExternalBlockGroupModel.prototype.updateBlocks = function() {
      var b, currentAggr, currentId, dataObject, i, idsDict, index, key, keyBlockData, keyData, kqvalue, mainBlock, mainData, mainDepth, nameOfTableBlock, object, preBlock, qv, qvalue, shouldRemove, _i, _j, _k, _l, _len, _len1, _len2, _len3, _len4, _len5, _m, _n, _ref1, _ref2, _ref3, _ref4,
        _this = this;
      dataObject = this.jsonData;
      this.set("consistency", this.consistency, {
        "silent": true
      });
      if (this.get("blocksCollection").where({
        "role": "all"
      }).length <= 0) {
        nameOfTableBlock = this.get("label").split(".")[0];
        if (nameOfTableBlock.length > 25) {
          nameOfTableBlock = nameOfTableBlock.substring(0, 22) + "...";
        }
        mainBlock = new quadrigram.Models.ExternalBlockModel({
          "blockGroup": this,
          "label": nameOfTableBlock,
          "role": "all",
          "origin": "file"
        });
        mainBlock.set("metaData", {
          "idLabel": "Column",
          "valueLabel": nameOfTableBlock,
          "viewMode": "table"
        });
      } else {
        mainBlock = this.get("blocksCollection").where({
          "role": "all"
        })[0];
      }
      mainBlock.on("change-block-structure", function() {
        return _this.trigger("change-block-structure");
      });
      mainData = [];
      this.hasIdRepetition = false;
      _ref1 = this.keys;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        key = _ref1[_i];
        if (key !== this.get("buildData").idKey || this.keys.length === 1) {
          keyData = [];
          idsDict = {};
          for (index = _j = 0, _len1 = dataObject.length; _j < _len1; index = ++_j) {
            object = dataObject[index];
            if (this.get("buildData").idKey === "__Index__") {
              currentId = String(index);
            } else {
              currentId = object[this.get("buildData").idKey];
            }
            if (currentId == null) {
              continue;
            }
            if (idsDict[currentId] == null) {
              idsDict[currentId] = QValueUtils.aggregateInit(currentId);
            } else {
              this.hasIdRepetition = true;
            }
            if ((key !== this.get("buildData").idKey && object[key]) || this.keys.length === 1) {
              if (this.get("buildData").blocks[key]) {
                currentAggr = this.get("buildData").blocks[key].aggregateBy;
              } else {
                currentAggr = _.findWhere(this.get("buildData").blocks, {
                  "id": key
                }).value;
              }
              idsDict[currentId] = QValueUtils.aggregateStep(idsDict[currentId], object[key], currentAggr);
            }
          }
          for (index = _k = 0, _len2 = dataObject.length; _k < _len2; index = ++_k) {
            object = dataObject[index];
            if (this.get("buildData").idKey === "__Index__") {
              currentId = String(index);
            } else {
              currentId = object[this.get("buildData").idKey];
            }
            if (currentId == null) {
              continue;
            }
            if (idsDict[currentId] !== null) {
              if (this.get("buildData").blocks[key]) {
                currentAggr = this.get("buildData").blocks[key].aggregateBy;
              } else {
                currentAggr = _.findWhere(this.get("buildData").blocks, {
                  "id": key
                }).value;
              }
              kqvalue = QValueUtils.aggregateEnd(idsDict[currentId], currentAggr, key + "s of " + currentId);
              keyData.push(kqvalue);
              idsDict[currentId] = null;
            }
          }
          keyBlockData = new quadrigram.Models.DataBlockData(keyData);
          keyBlockData.set("label", key);
          keyBlockData.set("metaData", {
            "idLabel": this.get("buildData").idKey,
            "valueLabel": key,
            "viewMode": "list"
          });
          qvalue = new quadrigram.Models.QValue(keyBlockData, key);
          mainData.push(qvalue);
        }
      }
      if (mainData.length === 1) {
        mainBlock.get("metaData").viewMode = "list";
        mainBlock.get("metaData").valueLabel = mainData[0].value.get("metaData").valueLabel;
        mainBlock.get("metaData").idLabel = mainData[0].value.get("metaData").idLabel;
        mainData = mainData[0].value.get("data");
      } else {
        mainBlock.get("metaData").viewMode = "table";
      }
      mainBlock.get("metaData").idKey = this.get("buildData").idKey;
      mainBlock.set({
        "data": mainData,
        "fetchState": "ready"
      }, {
        "silent": true
      });
      mainBlock.trigger("dependency-change");
      shouldRemove = [];
      _ref2 = this.get("blocksCollection").models;
      for (_l = 0, _len3 = _ref2.length; _l < _len3; _l++) {
        b = _ref2[_l];
        if (b.get("role") === "all") {
          continue;
        }
        if (b.get("role") === "level0names") {
          continue;
        }
        if (b.get("role") === "level1names") {
          continue;
        }
        if (_.find(mainBlock.get("data"), function(qv) {
          return qv.id === b.get("jsonKey");
        })) {
          continue;
        }
        if (mainDepth === 2 && _.find(mainBlock.get("data")[0].value.get("data"), function(qv) {
          return qv.id === b.get("jsonKey");
        })) {
          continue;
        }
        shouldRemove.push(b);
      }
      this.get("blocksCollection").remove(shouldRemove);
      mainDepth = BlockUtils.getBlockDepth(mainBlock);
      this.preBlocks = [];
      if (this.get("blocksCollection").where({
        "jsonKey": "id-col"
      }).length <= 0) {
        preBlock = new quadrigram.Models.PreFunctionBlockModel({
          "jsonKey": "id-col",
          "label": "Column names",
          "blockGroup": this,
          "role": "level0names",
          "order": 0,
          "operation": "GetNames",
          "origin": "file",
          "options": {
            "levelSelector": {
              "optId": "col",
              "value": mainDepth - 1
            },
            "originalBlock": mainBlock
          }
        });
        this.preBlocks.push(preBlock);
      }
      _ref3 = mainBlock.get("data");
      for (i = _m = 0, _len4 = _ref3.length; _m < _len4; i = ++_m) {
        qv = _ref3[i];
        if (this.get("blocksCollection").where({
          "jsonKey": qv.id
        }).length <= 0) {
          preBlock = new quadrigram.Models.PreFunctionBlockModel({
            "jsonKey": qv.id,
            "label": qv.id,
            "blockGroup": this,
            "role": "level0",
            "order": i,
            "operation": "Filter",
            "origin": "file",
            "options": {
              "originalBlock": mainBlock,
              "keySelector": {
                "optId": "col",
                "type": "id",
                "level": mainDepth
              },
              "relationSelector": {
                "optId": "eq",
                "label": "equal to",
                "value": "=="
              },
              "comparingValue": qv.id
            }
          });
          this.preBlocks.push(preBlock);
        }
      }
      if (mainDepth > 1) {
        if (this.get("blocksCollection").where({
          "jsonKey": "id-row"
        }).length <= 0) {
          preBlock = new quadrigram.Models.PreFunctionBlockModel({
            "jsonKey": "id-row",
            "label": "Row names",
            "blockGroup": this,
            "role": "level1names",
            "order": 0,
            "operation": "GetNames",
            "origin": "file",
            "options": {
              "levelSelector": {
                "optId": "row",
                "value": mainDepth - 2
              },
              "originalBlock": mainBlock
            }
          });
          this.preBlocks.push(preBlock);
        }
        _ref4 = mainBlock.get("data")[0].value.get("data");
        for (i = _n = 0, _len5 = _ref4.length; _n < _len5; i = ++_n) {
          qv = _ref4[i];
          if (this.get("blocksCollection").where({
            "jsonKey": qv.id
          }).length <= 0) {
            preBlock = new quadrigram.Models.PreFunctionBlockModel({
              "jsonKey": qv.id,
              "label": qv.id,
              "blockGroup": this,
              "role": "level1",
              "order": i,
              "operation": "Filter",
              "origin": "file",
              "options": {
                "originalBlock": mainBlock,
                "keySelector": {
                  "optId": "row",
                  "type": "id",
                  "level": mainDepth - 1
                },
                "relationSelector": {
                  "optId": "eq",
                  "label": "equal to",
                  "value": "=="
                },
                "comparingValue": qv.id
              }
            });
            this.preBlocks.push(preBlock);
          }
        }
      }
      return this.set("fetchState", "ready");
    };

    return ExternalBlockGroupModel;

  })(quadrigram.Models.BlockGroupModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.CustomBlockGroupModel = (function(_super) {
    __extends(CustomBlockGroupModel, _super);

    function CustomBlockGroupModel() {
      this.updateAndCreateSubBlocks = __bind(this.updateAndCreateSubBlocks, this);
      this.clearAllBlocks = __bind(this.clearAllBlocks, this);
      this.create = __bind(this.create, this);
      this.deleteBlock = __bind(this.deleteBlock, this);
      this.changeMainBlockLabel = __bind(this.changeMainBlockLabel, this);
      this.handleMainBlockLabelChange = __bind(this.handleMainBlockLabelChange, this);
      this.handleMainBlockFetchState = __bind(this.handleMainBlockFetchState, this);
      this.handleMainBlockSet = __bind(this.handleMainBlockSet, this);
      this.postModelSetup = __bind(this.postModelSetup, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = CustomBlockGroupModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    CustomBlockGroupModel.prototype.create = function() {
      return this.set("type", "custom", {
        silent: true
      });
    };

    CustomBlockGroupModel.prototype.modelSetup = function(options) {
      this.loaded = true;
      if (this.get("mainBlock")) {
        this.handleMainBlockSet();
      }
      this.on("change:mainBlock", this.handleMainBlockSet);
      return this.on("change:label", this.changeMainBlockLabel);
    };

    CustomBlockGroupModel.prototype.postModelSetup = function() {
      if (this.get("mainBlock")) {
        this.get("mainBlock").on("change:fetchState", this.handleMainBlockFetchState);
        return this.latestOperation = this.get("mainBlock").get("operator").get("currentOperation");
      }
    };

    CustomBlockGroupModel.prototype.handleMainBlockSet = function() {
      if (this.get("mainBlock").get("defaultLabel") != null) {
        this.set("defaultLabel", this.get("mainBlock").get("defaultLabel"));
      }
      return this.get("mainBlock").on("change:label", this.handleMainBlockLabelChange);
    };

    CustomBlockGroupModel.prototype.handleMainBlockFetchState = function() {
      if (this.get("mainBlock").get("fetchState") === "ready") {
        if (this.latestOperation !== this.get("mainBlock").get("operator").get("currentOperation")) {
          this.latestOperation = this.get("mainBlock").get("operator").get("currentOperation");
          this.clearAllBlocks();
          return this.updateAndCreateSubBlocks(this.get("mainBlock"));
          /*
          _.defer(()=>
            @trigger("change-block-structure")
          )
          */

        } else {
          return this.updateAndCreateSubBlocks(this.get("mainBlock"));
          /*
          _.defer(()=>
            @trigger("change-block-content")
          )
          */

        }
      }
    };

    CustomBlockGroupModel.prototype.handleMainBlockLabelChange = function() {
      return this.set("label", this.get("mainBlock").get("label"));
    };

    CustomBlockGroupModel.prototype.changeMainBlockLabel = function() {
      if (this.get("mainBlock") != null) {
        return this.get("mainBlock").set("label", this.get("label"));
      }
    };

    CustomBlockGroupModel.prototype.deleteBlock = function(blockId) {
      var candidates;
      candidates = this.get("blocksCollection").where({
        "id": blockId
      });
      return this.get("blocksCollection").remove(candidates);
    };

    CustomBlockGroupModel.prototype.create = function() {
      var id;
      id = quadrigram.idManager.getId("customBlockGroup_");
      this.set("id", id);
      return this.set("type", "custom", {
        silent: true
      });
    };

    CustomBlockGroupModel.prototype.clearAllBlocks = function() {
      var block, blocksToRemove, i, _i, _len, _ref1;
      blocksToRemove = [];
      _ref1 = this.get("blocksCollection").models;
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        block = _ref1[i];
        if (block !== this.get("mainBlock")) {
          block.detachAndDestroy();
          blocksToRemove.push(block);
        }
      }
      this.get("blocksCollection").remove(blocksToRemove);
      return this.preBlocks = [];
    };

    CustomBlockGroupModel.prototype.updateAndCreateSubBlocks = function(sourceBlock) {
      /*
      if !sourceBlock.get("metaData") || sourceBlock.get("metaData").viewMode == "cell"
        mainDepth = 0
      else if sourceBlock.get("metaData").viewMode == "list" 
        mainDepth = 1
      #else if sourceBlock.get("metaData").viewMode == "table" 
      #  mainDepth = 2
      else
        mainDepth = BlockUtils.getBlockDepth(sourceBlock)
      */

      var b, currentPreBlocks, i, j, keyId, label, lvl, mainDepth, maxLevel, newPreBlocks, origin, pb, pblvl, preBlock, qv, retroValue, role, sourceData, _i, _j, _k, _l, _len, _len1, _len2, _ref1, _ref2;
      mainDepth = BlockUtils.getBlockDepth(sourceBlock);
      origin = "formula";
      if (this.preBlocks == null) {
        this.preBlocks = [];
      }
      currentPreBlocks = {};
      _ref1 = this.preBlocks;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        pb = _ref1[_i];
        if (pb.get("operation") === "GetNames") {
          if (!currentPreBlocks[pb.get("options").levelSelector.value - 1]) {
            currentPreBlocks[pb.get("options").levelSelector.value - 1] = {};
          }
          currentPreBlocks[pb.get("options").levelSelector.value - 1]["__getNames__"] = pb;
        } else {
          if (!currentPreBlocks[pb.get("options").keySelector.level]) {
            currentPreBlocks[pb.get("options").keySelector.level] = {};
          }
          currentPreBlocks[pb.get("options").keySelector.level][pb.get("options").comparingValue] = pb;
        }
      }
      newPreBlocks = [];
      maxLevel = Math.min(Math.max(mainDepth - 1, Object.keys(currentPreBlocks).length - 1), 1);
      for (lvl = _j = 0; 0 <= maxLevel ? _j <= maxLevel : _j >= maxLevel; lvl = 0 <= maxLevel ? ++_j : --_j) {
        if (lvl === 0) {
          sourceData = sourceBlock.get("data");
          /*
          if maxLevel == 0
            sourceData = sourceBlock.get("data")
          else if sourceBlock.get("data").length>0 && sourceBlock.get("data")[0].value.get
            sourceData = sourceBlock.get("data")
          else
            sourceData = [{id:"CACA",value:sourceBlock.get("data")}]
          */

          keyId = "col";
          label = "Column";
          role = "level0";
        } else if (lvl === 1) {
          if (sourceBlock.get("data").length > 0 && (sourceBlock.get("data")[0].value != null) && sourceBlock.get("data")[0].value.get) {
            sourceData = sourceBlock.get("data")[0].value.get("data");
          } else {
            sourceData = [];
          }
          keyId = "row";
          label = "Row";
          role = "level1";
        }
        if (!BlockUtils.isEmpty(sourceBlock)) {
          if (this.get("blocksCollection").where({
            "jsonKey": "id-" + keyId
          }).length <= 0 && (!currentPreBlocks[lvl] || !currentPreBlocks[lvl]["__getNames__"])) {
            preBlock = new quadrigram.Models.PreFunctionBlockModel({
              "jsonKey": "id-" + keyId,
              "label": label + " names",
              "blockGroup": this,
              "role": "level" + lvl + "names",
              "order": 0,
              "operation": "GetNames",
              "origin": origin,
              "options": {
                "levelSelector": {
                  "optId": keyId,
                  "value": lvl + 1
                },
                "originalBlock": sourceBlock
              }
            });
            newPreBlocks.push(preBlock);
          } else if ((currentPreBlocks[lvl] != null) && currentPreBlocks[lvl]["__getNames__"]) {
            currentPreBlocks[lvl]["__getNames__"].state = "ready";
            newPreBlocks.push(currentPreBlocks[lvl]["__getNames__"]);
            currentPreBlocks[lvl]["__getNames__"] = null;
          }
        }
        if (quadrigram.router.compareVersions(quadrigram.router.dataModels.currentProject.get("pversion"), "0.9.3") < 0) {
          retroValue = mainDepth - lvl;
        } else {
          retroValue = lvl;
        }
        _ref2 = this.get("blocksCollection").models;
        for (_k = 0, _len1 = _ref2.length; _k < _len1; _k++) {
          b = _ref2[_k];
          if (b.get("role") === role) {
            b.set("state", "dead");
          }
        }
        for (i = _l = 0, _len2 = sourceData.length; _l < _len2; i = ++_l) {
          qv = sourceData[i];
          if (this.get("blocksCollection").where({
            "jsonKey": qv.id
          }).length <= 0 && (!currentPreBlocks[lvl] || !currentPreBlocks[lvl][qv.id])) {
            preBlock = new quadrigram.Models.PreFunctionBlockModel({
              "jsonKey": qv.id,
              "label": qv.id,
              "blockGroup": this,
              "role": role,
              "order": i,
              "operation": "Filter",
              "origin": origin,
              "options": {
                "originalBlock": sourceBlock,
                "keySelector": {
                  "optId": keyId,
                  "type": "id",
                  "level": retroValue
                },
                "relationSelector": {
                  "optId": "eq",
                  "label": "equal to",
                  "value": "=="
                },
                "comparingValue": qv.id
              }
            });
            newPreBlocks.push(preBlock);
          } else if ((currentPreBlocks[lvl] != null) && currentPreBlocks[lvl][qv.id]) {
            currentPreBlocks[lvl][qv.id].state = "ready";
            newPreBlocks.push(currentPreBlocks[lvl][qv.id]);
            currentPreBlocks[lvl][qv.id] = null;
          } else {
            this.get("blocksCollection").where({
              "jsonKey": qv.id
            })[0].set("state", "ready");
          }
        }
      }
      for (i in currentPreBlocks) {
        pblvl = currentPreBlocks[i];
        for (j in pblvl) {
          pb = pblvl[j];
          if (pb != null) {
            pb.state = "dead";
            newPreBlocks.push(pb);
          }
        }
      }
      return this.preBlocks = newPreBlocks;
    };

    /*
    updateSubBlocks:(sourceBlock)=>
      if !sourceBlock.get("data")? ||sourceBlock.get("data").length == 0
        for pb in @preBlocks
          pb.disabled = true
          pb.trigger("change:data")
      else
        for pb in @preBlocks
          if pb.get("jsonKey") == "id-col" || pb.get("jsonKey") == "id-row" 
            pb.disabled = false
          else if _.findWhere(sourceBlock.get("data")[0].value.get("data"),{id:pb.get("options").comparingValue})?
            pb.disabled = false
          else if _.findWhere(sourceBlock.get("data"),{id:pb.get("options").comparingValue})?
            pb.disabled = false
          else   
            pb.disabled = true
          pb.trigger("change:data")
        
    
        ##FALTA  ALGO COMO ESTO pero "entagled" con lo de antes para no repetir!!!
        #DEBERIA UNIFICARSE CON CREATE BLOCKS!!!!
        origin = "formula"
        mainDepth = BlockUtils.getBlockDepth(sourceBlock)
        for qv,i in sourceBlock.get("data")[0].value.get("data")
          if @get("blocksCollection").where({"jsonKey":qv.id}).length<=0
            preBlock = new quadrigram.Models.PreFunctionBlockModel "jsonKey":qv.id, "label":qv.id,"blockGroup":@,"role":"level1","order":i,"operation":"Filter", "origin":origin,"options":{
              "originalBlock":sourceBlock,
              "keySelector":{"optId":"row","type":"id" ,"level":mainDepth-1},
              "relationSelector":{"optId":"eq","label":"equal to","value":"=="},
              "comparingValue":qv.id,
            }
            @preBlocks.push(preBlock)
    
        @trigger("change-block-structure")
    */


    /*
    createSubBlocks:(sourceBlock)=>
      ##PREBLOCKS
      
      mainDepth = BlockUtils.getBlockDepth(sourceBlock)
      @preBlocks = []
    
      ##Remove disapeared blocks
      
      #chapuzilla para no tener que hacer wheres
      tmpArray = sourceBlock.get("data")
      newBlockIds = {}
      for qv in tmpArray
        newBlockIds[qv.id]=true
    
      blocksToRemove = []
      for block,i in @get("blocksCollection").models
        if block != @get("mainBlock")
          block.detachAndDestroy()
          blocksToRemove.push(block)
    
      @get("blocksCollection").remove(blocksToRemove)
      
      origin = "formula"
     
      if @get("blocksCollection").where({"jsonKey":"id-col"}).length<=0
        preBlock = new quadrigram.Models.PreFunctionBlockModel "jsonKey":"id-col", "label":"Column names","blockGroup":@,"role":"level0names","order":0, "operation":"GetNames", "origin":origin, "options":{
              "levelSelector": {"optId":"col","value":mainDepth-1}
              "originalBlock":sourceBlock
            }
        @preBlocks.push(preBlock)
    
      ##CREATE COLS AND ROWS preFunctions if they are not in the blocksCOllection
      ##FIRST LEVEL (COLS or ROWS depending on mainDetph)
      for qv,i in sourceBlock.get("data")
        if @get("blocksCollection").where({"jsonKey":qv.id}).length<=0
          preBlock = new quadrigram.Models.PreFunctionBlockModel "jsonKey":qv.id, "label":qv.id,"blockGroup":@,"role":"level0","order":i, "operation":"Filter", "origin":origin,"options":{
            "originalBlock":sourceBlock,
            "keySelector":{"optId":"col","type":"id" ,"level":mainDepth}
            "relationSelector":{"optId":"eq","label":"equal to","value":"=="},
            "comparingValue":qv.id
          }
          @preBlocks.push(preBlock)
    
    
      ##SECOND LEVEL (ROWS or Nothing depending on mainDetph) 
    
      if mainDepth > 1
        if @get("blocksCollection").where({"jsonKey":"id-row"}).length<=0
          preBlock = new quadrigram.Models.PreFunctionBlockModel "jsonKey":"id-row", "label":"Row names","blockGroup":@,"role":"level1names","order":0, "operation":"GetNames", "origin":origin,"options":{
              "levelSelector": {"optId":"row","value":mainDepth-2}
              "originalBlock":sourceBlock
            }
          @preBlocks.push(preBlock)
    
        for qv,i in sourceBlock.get("data")[0].value.get("data")
          if @get("blocksCollection").where({"jsonKey":qv.id}).length<=0
            preBlock = new quadrigram.Models.PreFunctionBlockModel "jsonKey":qv.id, "label":qv.id,"blockGroup":@,"role":"level1","order":i,"operation":"Filter", "origin":origin,"options":{
              "originalBlock":sourceBlock,
              "keySelector":{"optId":"row","type":"id" ,"level":mainDepth-1},
              "relationSelector":{"optId":"eq","label":"equal to","value":"=="},
              "comparingValue":qv.id,
            }
            @preBlocks.push(preBlock)
    */


    return CustomBlockGroupModel;

  })(quadrigram.Models.BlockGroupModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.VizBlockGroupModel = (function(_super) {
    __extends(VizBlockGroupModel, _super);

    function VizBlockGroupModel() {
      this.toJSON = __bind(this.toJSON, this);
      this.hasOutputs = __bind(this.hasOutputs, this);
      this.create = __bind(this.create, this);
      _ref = VizBlockGroupModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VizBlockGroupModel.prototype.create = function() {
      return this.set("type", "viz", {
        silent: true
      });
    };

    VizBlockGroupModel.prototype.hasOutputs = function() {
      if (this.get("ownerViz") instanceof quadrigram.Models.RectangleAreaModel || this.get("ownerViz") instanceof quadrigram.Models.TextAreaModel || this.get("ownerViz") instanceof quadrigram.Models.LinkControlModel || this.get("ownerViz") instanceof quadrigram.Models.DynamicTextControlModel || this.get("ownerViz") instanceof quadrigram.Models.IFrameControlModel || this.get("ownerViz") instanceof quadrigram.Models.ImageControlModel || this.get("ownerViz") instanceof quadrigram.Models.YoutubeControlModel || this.get("ownerViz") instanceof quadrigram.Models.ShareButtonsControlModel) {
        return false;
      } else {
        return true;
      }
    };

    VizBlockGroupModel.prototype.toJSON = function(options) {
      var result,
        _this = this;
      result = VizBlockGroupModel.__super__.toJSON.apply(this, arguments);
      if ((options != null) && options.ommitData) {
        result.blocksCollection = result.blocksCollection.filter(function(block) {
          if (block.type === "Editable") {
            return false;
          }
          if (block.role === "output" && block.insideSlot.length === 0) {
            return false;
          }
          return true;
        });
        if (result.blocksCollection.lenght === 0) {
          result = null;
        }
      }
      return result;
    };

    return VizBlockGroupModel;

  })(quadrigram.Models.BlockGroupModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.FunctionBlockGroupModel = (function(_super) {
    __extends(FunctionBlockGroupModel, _super);

    function FunctionBlockGroupModel() {
      this.create = __bind(this.create, this);
      _ref = FunctionBlockGroupModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    FunctionBlockGroupModel.prototype.create = function() {
      return this.set("type", "function", {
        silent: true
      });
    };

    return FunctionBlockGroupModel;

  })(quadrigram.Models.BlockGroupModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.BlockGroupCollection = (function(_super) {
    __extends(BlockGroupCollection, _super);

    function BlockGroupCollection() {
      this.toJSON = __bind(this.toJSON, this);
      this.filterByType = __bind(this.filterByType, this);
      _ref = BlockGroupCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BlockGroupCollection.prototype.model = quadrigram.Models.BlockGroupModel;

    BlockGroupCollection.prototype.filterByType = function(type) {
      var output;
      output = new quadrigram.Collections.BlockGroupCollection(this.where({
        type: type
      }));
      return output;
    };

    BlockGroupCollection.prototype.toJSON = function(options) {
      var result,
        _this = this;
      result = BlockGroupCollection.__super__.toJSON.apply(this, arguments);
      if ((options != null) && options.ommitData) {
        result = result.filter(function(blockGroup) {
          var originalBG;
          if (blockGroup.type === "function") {
            originalBG = _this.find({
              "id": blockGroup.id
            });
            try {
              if (originalBG && originalBG.get("ownerOp") && originalBG.get("ownerOp").get("ownerBlock") && (originalBG.get("ownerOp").get("ownerBlock").get("ownerCustomBlockGroup") != null)) {
                return true;
              }
              if (!originalBG || !originalBG.get("ownerOp") || !originalBG.get("ownerOp").get("ownerBlock") || originalBG.get("ownerOp").get("ownerBlock").get("insideSlot").models.length === 0) {
                return false;
              }
            } catch (_error) {
              elog("error checking where to save or not a blockgroup");
            }
          }
          return true;
        });
      }
      return result;
    };

    return BlockGroupCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ProjectModel = (function(_super) {
    __extends(ProjectModel, _super);

    function ProjectModel() {
      this.getExternalBlockGroupsReportFromProject = __bind(this.getExternalBlockGroupsReportFromProject, this);
      this.toggleGuidelines = __bind(this.toggleGuidelines, this);
      this.togglePreview = __bind(this.togglePreview, this);
      this.deleteCustomBlock = __bind(this.deleteCustomBlock, this);
      this.createCustomBlock = __bind(this.createCustomBlock, this);
      this.deleteBlockGroup = __bind(this.deleteBlockGroup, this);
      this.getCustomBlocks = __bind(this.getCustomBlocks, this);
      this.createExternalGroup = __bind(this.createExternalGroup, this);
      this.updateVisualizerModelFrame = __bind(this.updateVisualizerModelFrame, this);
      this.updateModelFrames = __bind(this.updateModelFrames, this);
      this.removeVisualizer = __bind(this.removeVisualizer, this);
      this.createVisualizer = __bind(this.createVisualizer, this);
      this.errorWhileProjectWasSaving = __bind(this.errorWhileProjectWasSaving, this);
      this.projectWasSaved = __bind(this.projectWasSaved, this);
      this.checkIntegrity = __bind(this.checkIntegrity, this);
      this.getInitialData = __bind(this.getInitialData, this);
      this.checkIsStatic = __bind(this.checkIsStatic, this);
      this.parse = __bind(this.parse, this);
      this.save = __bind(this.save, this);
      this.startTracking = __bind(this.startTracking, this);
      this.redo = __bind(this.redo, this);
      this.undo = __bind(this.undo, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.updateRelations = __bind(this.updateRelations, this);
      this.postModelSetup = __bind(this.postModelSetup, this);
      this.postCreate = __bind(this.postCreate, this);
      this.hasPendingResources = __bind(this.hasPendingResources, this);
      this.create = __bind(this.create, this);
      this.requestSave = __bind(this.requestSave, this);
      this.requestShare = __bind(this.requestShare, this);
      this.setSaveState = __bind(this.setSaveState, this);
      this.autoSave = __bind(this.autoSave, this);
      this.checkSave = __bind(this.checkSave, this);
      this.handleDestruction = __bind(this.handleDestruction, this);
      this.startAutosave = __bind(this.startAutosave, this);
      this.initialize = __bind(this.initialize, this);
      this.urlRoot = __bind(this.urlRoot, this);
      _ref = ProjectModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ProjectModel.prototype.urlRoot = function() {
      return this.instanceUrl;
    };

    ProjectModel.prototype.relations = [
      {
        type: Backbone.HasMany,
        key: 'blockGroupsCollection',
        relatedModel: "quadrigram.Models.BlockGroupModel",
        includeInJSON: true,
        collectionType: "quadrigram.Collections.BlockGroupCollection",
        reverseRelation: {
          key: 'project',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }, {
        type: Backbone.HasMany,
        key: 'visualizersCollection',
        relatedModel: "quadrigram.Models.VisualizerModel",
        includeInJSON: true,
        collectionType: "quadrigram.Collections.VisualizerCollection",
        reverseRelation: {
          key: 'project',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }, {
        type: Backbone.HasMany,
        key: 'pagesCollection',
        relatedModel: "quadrigram.Models.Page",
        includeInJSON: true,
        collectionType: "quadrigram.Collections.PageCollection",
        reverseRelation: {
          key: 'project',
          bubbleUp: true,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }
    ];

    ProjectModel.prototype.undoableEvents = ["add:blockGroupsCollection", "remove:blockGroupsCollection", "add:visualizersCollection", "remove:visualizersCollection", "add:pagesCollection", "remove:pagesCollection"];

    ProjectModel.prototype.bubblingEvents = ["add:blockGroupsCollection", "remove:blockGroupsCollection", "add:visualizersCollection", "remove:visualizersCollection", "add:pagesCollection", "remove:pagesCollection"];

    ProjectModel.prototype.initialize = function() {
      ProjectModel.__super__.initialize.apply(this, arguments);
      this.undoManager = new Backbone.UndoManager();
      this.undoManager.set("maximumStackLength", 200);
      this.undoManager.register(this);
      this.instanceUrl = quadrigram.baseUrl + "rs/google/project";
      this.on("killProject", this.handleDestruction);
      return this.timeFormat = TimeUtils.getTimeFormat();
    };

    ProjectModel.prototype.startAutosave = function() {
      if (quadrigram.environment === "editor") {
        this.isSaved = "true";
        this.on("all", this.checkSave);
        quadrigram.router.appViews.headerView.setSaveState("success");
        return this.saveInterval || (this.saveInterval = setInterval(this.autoSave, 15000));
      }
    };

    ProjectModel.prototype.handleDestruction = function() {
      log("destroying project");
      return clearInterval(this.saveInterval);
    };

    ProjectModel.prototype.checkSave = function(e, target) {
      if ((this.autoSaveEnabled == null) || !this.autoSaveEnabled) {
        return;
      }
      if (e !== "childModified" && e !== "request" && e !== "sync" && e !== "save" && e !== "saved" && e !== "change:body") {
        if (e === "change" && target === this) {
          return;
        }
        this.isSaved = "false";
        return this.setSaveState();
      }
    };

    ProjectModel.prototype.autoSave = function(e) {
      if (this.isSaved !== "true" && this.autoSaveEnabled) {
        return this.requestSave();
      }
    };

    ProjectModel.prototype.setSaveState = function() {
      if (this.saveState !== "saving") {
        if (this.isSaved === "true") {
          return quadrigram.router.appViews.headerView.setSaveState("success");
        } else {
          return quadrigram.router.appViews.headerView.setSaveState("ready");
        }
      }
    };

    ProjectModel.prototype.requestShare = function(emailList) {
      return quadrigram.router.managers.serverManager.shareProject(emailList, this.get("id"));
    };

    ProjectModel.prototype.requestSave = function() {
      var _this = this;
      if (this.saveState !== "saving") {
        this.on("saved", function(success) {
          _this.off("saved");
          if (success) {
            if (_this.isSaved === "almost") {
              _this.isSaved = "true";
              quadrigram.router.appViews.headerView.setSaveState("success");
              return _this.saveState = "success";
            } else {
              _this.isSaved = "false";
              quadrigram.router.appViews.headerView.setSaveState("ready");
              return _this.saveState = "ready";
            }
          } else {
            _this.isSaved = "false";
            _this.saveState = "success";
            return quadrigram.router.appViews.headerView.setSaveState("error");
          }
        });
        this.saveState = "saving";
        this.isSaved = "almost";
        quadrigram.router.appViews.headerView.setSaveState("saving");
        return this.save();
      }
    };

    ProjectModel.prototype.create = function() {
      var defaultSettings;
      defaultSettings = LayoutUtils.presets["Web"];
      this.set("layout-settings", LayoutUtils.validateLayoutSettings(defaultSettings));
      this.set("pages-settings", {
        "showPageButtons": true,
        "transitionType": "slide"
      });
      this.get("pagesCollection").add(new quadrigram.Models.Page({
        label: "Page1"
      }));
      this.set("pname", "Untitled Project");
      this.set({
        "pversion": quadrigram.version
      });
      return this.unset("id");
    };

    ProjectModel.prototype.hasPendingResources = function() {
      var blockGroup, output, _i, _len, _ref1;
      output = false;
      _ref1 = this.get("blockGroupsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        blockGroup = _ref1[_i];
        if (blockGroup instanceof quadrigram.Models.ExternalBlockGroupModel && blockGroup.fetchState !== "ready") {
          output = true;
        }
      }
      return output;
    };

    ProjectModel.prototype.postCreate = function() {};

    ProjectModel.prototype.postModelSetup = function() {
      this.fetchedAndReady = true;
      if (this.get("pages-settings") == null) {
        this.set("pages-settings", {
          "showPageButtons": true
        });
        return this.get("pagesCollection").add(new quadrigram.Models.Page({
          label: "Page1"
        }));
      }
    };

    ProjectModel.prototype.updateRelations = function(changedAttrs, options) {
      ProjectModel.__super__.updateRelations.call(this, changedAttrs, options);
      if (this.fetchedAndReady) {
        return this.fetchedAndReady = false;
      }
    };

    ProjectModel.prototype.modelSetup = function(options) {
      return this.on("change:layoutData", this.updateModelFrames);
    };

    ProjectModel.prototype.undo = function() {
      /*
      check for @undoManager.stack[@undoManager.pointer] para saber quien era modelo que cambi, i seleccionalro!
      de hecho no solo seleccionar, sino tambien "subseleccionar"
      Entonces hay que disparar un requestFocus des del modelo y la vista lo escucha (?)
      casos: subvistas de los inspectors (ok)
      */

      quadrigram.tracker.sendEvent({
        event_type: 303
      });
      return this.undoManager.undo(true);
    };

    ProjectModel.prototype.redo = function() {
      quadrigram.tracker.sendEvent({
        event_type: 303
      });
      return this.undoManager.redo(true);
    };

    ProjectModel.prototype.startTracking = function() {
      this.undoManager.startTracking();
      return this.autoSaveEnabled = true;
    };

    ProjectModel.prototype.save = function(attrs, options) {
      var _this = this;
      options || (options = {});
      options.beforeSend = function(xhr) {
        return xhr.setRequestHeader("pname", unescape(encodeURIComponent(_this.get("pname"))));
      };
      options.success = this.projectWasSaved;
      options.error = this.errorWhileProjectWasSaving;
      options.data = JSON.stringify(this.toJSON({
        "ommitData": true
      }));
      return Backbone.Model.prototype.save.call(this, attrs, options);
    };

    ProjectModel.prototype.parse = function(response) {
      var nonStaticVs, staticVs,
        _this = this;
      if (quadrigram.environment === "exported") {
        nonStaticVs = [];
        staticVs = _.filter(response.visualizersCollection, function(v) {
          if ((v.type === "TextArea" || v.type === "ImageControl" || v.type === "RectangleArea") && _this.checkIsStatic(v)) {
            return true;
          } else {
            nonStaticVs.push(v);
            return false;
          }
        });
        response.visualizersCollection = nonStaticVs;
        this.staticVisualizers = staticVs;
      }
      return _.omit(response, ["body", "code", "error"]);
    };

    ProjectModel.prototype.checkIsStatic = function(model) {
      var prop, result, _i, _len, _ref1;
      result = true;
      _ref1 = model.propertiesCollection;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        prop = _ref1[_i];
        if ((prop.slotsCollection != null) && prop.slotsCollection.length > 0) {
          result = false;
        }
      }
      return result;
    };

    ProjectModel.prototype.getInitialData = function() {
      var bg, result, _i, _len, _ref1;
      result = [];
      _ref1 = this.get("blockGroupsCollection").where({
        "type": "external"
      });
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        bg = _ref1[_i];
        result.push(bg.toOptimizedResource());
      }
      return result;
    };

    ProjectModel.prototype.checkIntegrity = function() {
      if (this.get("layoutData").length !== this.get("visualizersCollection").models.length) {
        elog("Missing visualizer");
        return false;
      }
      return false;
    };

    ProjectModel.prototype.projectWasSaved = function(model, response) {
      if ((response.code != null) && response.code !== 200) {
        return this.errorWhileProjectWasSaving(model, response);
      } else {
        this.set("id", response.body.id);
        return this.trigger("saved", true);
      }
    };

    ProjectModel.prototype.errorWhileProjectWasSaving = function(model, response) {
      if (!this.get("id")) {
        this.set("pname", "Untitled Project");
      }
      return this.trigger("saved", false);
    };

    ProjectModel.prototype.createVisualizer = function(vizClassID, addMode, options) {
      var vizModel, vizModelClass;
      vizModelClass = eval("quadrigram.Models." + vizClassID + "Model");
      vizModel = new vizModelClass({
        "type": vizClassID,
        "config": options
      });
      vizModel.options = options;
      vizModel.addMode = addMode;
      vizModel.set("project", this);
      this.set("layoutData", quadrigram.router.appViews.projectView.getLayoutData());
      quadrigram.tracker.sendEvent({
        event_type: 201,
        event_subtype: 2,
        client_data: {
          vizType: vizClassID
        }
      });
      quadrigram.achievementTracker.checkUseViz(vizModel);
      return vizModel;
    };

    ProjectModel.prototype.removeVisualizer = function(vizModel) {
      vizModel.unset("project");
      vizModel.get("blockGroup").unset("project");
      this.deleteBlockGroup(vizModel.get("blockGroup"));
      return this.set("layoutData", quadrigram.router.appViews.projectView.getLayoutData(), {
        silent: true
      });
    };

    ProjectModel.prototype.updateModelFrames = function() {
      var consistentLayoutData, i, vizFrame, vizModel, _i, _len, _ref1, _results;
      if (!this.get("visualizersCollection") instanceof quadrigram.Collections.VisualizerCollection) {
        this.trigger("abort");
      }
      if (this.get("layoutData") != null) {
        consistentLayoutData = [];
        _ref1 = this.get("layoutData");
        _results = [];
        for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
          vizFrame = _ref1[i];
          vizModel = this.get("visualizersCollection").where({
            "id": vizFrame.vizID
          })[0];
          if (vizModel != null) {
            this.updateVisualizerModelFrame(vizModel, vizFrame);
            _results.push(consistentLayoutData.push(vizModel));
          } else {
            _results.push(elog("vizModel not found in visualizersCollection"));
          }
        }
        return _results;
      }
    };

    ProjectModel.prototype.updateVisualizerModelFrame = function(vizModel, frame) {
      if (vizModel == null) {
        elog("layoutData did not contain the model?");
        return;
      }
      if (+frame.col !== +vizModel.getProperty("col").getValues()) {
        vizModel.setProperty("col", {
          "value": +frame.col
        });
      }
      if (+frame.row !== +vizModel.getProperty("row").getValues()) {
        vizModel.setProperty("row", {
          "value": +frame.row
        });
      }
      if (+frame.size_x !== +vizModel.getProperty("size_x").getValues()) {
        vizModel.setProperty("size_x", {
          "value": +frame.size_x
        });
      }
      if (+frame.size_y !== +vizModel.getProperty("size_y").getValues()) {
        vizModel.setProperty("size_y", {
          "value": +frame.size_y
        });
      }
      if ((frame.page != null) && frame.page !== vizModel.getProperty("page").getValues()) {
        return vizModel.setProperty("page", {
          "value": frame.page
        });
      }
    };

    ProjectModel.prototype.createExternalGroup = function(metadata) {
      var group;
      group = new quadrigram.Models.ExternalBlockGroupModel({
        "project": this,
        "rid": metadata.get("id"),
        "label": metadata.get("name"),
        "blockLabel": metadata.get("name"),
        "spreadsheet": metadata.get("spreadSheet"),
        "provider": metadata.get("providerName"),
        "exportedProvider": "local",
        "link": metadata.get("link")
      });
      quadrigram.tracker.sendEvent({
        event_type: 201,
        event_subtype: 1,
        client_data: {
          fileName: metadata.get("name")
        }
      });
      return group;
    };

    /*
    refreshExternalGroup:(group)=>
      group = new quadrigram.Models.ExternalBlockGroupModel({"project":@,"rid":metadata.get("rid"),"label":metadata.get("label"), "spreadsheet":metadata.get("spreadSheet"), "provider":metadata.get("provider"), "link":metadata.get("link")})
    */


    /*
    createCustomGroup:()=>
      group = new quadrigram.Models.CustomBlockGroupModel({"project":@})
    
    getCustomGroup:()=>
      @get("blockGroupsCollection").where({"type":"custom"})[0]
    */


    ProjectModel.prototype.getCustomBlocks = function() {
      var customGroups, g, result, _i, _len;
      customGroups = this.get("blockGroupsCollection").where({
        "type": "custom"
      });
      result = new quadrigram.Collections.DataBlockCollection;
      for (_i = 0, _len = customGroups.length; _i < _len; _i++) {
        g = customGroups[_i];
        result.add(g.get("blocksCollection").models[0]);
      }
      return result;
    };

    ProjectModel.prototype.deleteBlockGroup = function(group) {
      quadrigram.labelManager.removeFromList(group.get("label"));
      return group.removeFromProject();
    };

    ProjectModel.prototype.createCustomBlock = function() {
      /*
      if @.get("blockGroupsCollection").where({"type":"custom"}).length==0
        group = new quadrigram.Models.CustomBlockGroupModel({"project":@})
      else
        group = @.get("blockGroupsCollection").where({"type":"custom"})[0]
      */

      var block, group, label;
      label = quadrigram.labelManager.getPropperName("New formula");
      group = new quadrigram.Models.CustomBlockGroupModel({
        "project": this,
        "label": label
      });
      block = new quadrigram.Models.FunctionBlockModel({
        "blockGroup": group,
        "ownerCustomBlockGroup": group,
        "label": label,
        "defaultLabel": true,
        "origin": "formula",
        "role": "all"
      });
      quadrigram.tracker.sendEvent({
        event_type: 201,
        event_subtype: 3
      });
      quadrigram.achievementTracker.trackDirectAction("createFormula");
      return block;
    };

    ProjectModel.prototype.deleteCustomBlock = function(customBlockId) {
      var customGroup, customGroupCandidates;
      customGroupCandidates = this.get("blockGroupsCollection").where({
        "type": "custom"
      });
      if (customGroupCandidates.length === 0) {
        return;
      }
      customGroup = customGroupCandidates[0];
      return customGroup.deleteBlock(customBlockId);
    };

    ProjectModel.prototype.togglePreview = function() {
      if (this.mode === "preview") {
        this.mode = "edit";
      } else {
        this.mode = "preview";
      }
      return this.trigger("changedMode");
    };

    ProjectModel.prototype.toggleGuidelines = function() {
      if (this.showGuidelines === true) {
        this.showGuidelines = false;
      } else {
        this.showGuidelines = true;
      }
      return this.trigger("changedGuidelinesDisplay");
    };

    ProjectModel.prototype.getExternalBlockGroupsReportFromProject = function() {
      var block, blockGroup, blocks, externalBlockGroups, _i, _len, _results;
      externalBlockGroups = this.get("blockGroupsCollection").filterByType("external").models;
      _results = [];
      for (_i = 0, _len = externalBlockGroups.length; _i < _len; _i++) {
        blockGroup = externalBlockGroups[_i];
        log("\t- " + blockGroup.get("label") + " (" + blockGroup.get("fetchState") + ")");
        blocks = blockGroup.get("blocksCollection").models;
        _results.push((function() {
          var _j, _len1, _results1;
          _results1 = [];
          for (_j = 0, _len1 = blocks.length; _j < _len1; _j++) {
            block = blocks[_j];
            _results1.push(log("\t\t* " + block.get("label")));
          }
          return _results1;
        })());
      }
      return _results;
    };

    return ProjectModel;

  })(quadrigram.Models.QModel);

  quadrigram.Models.ProjectModel.setup();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Page = (function(_super) {
    __extends(Page, _super);

    function Page() {
      _ref = Page.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    return Page;

  })(quadrigram.Models.QModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.PageCollection = (function(_super) {
    __extends(PageCollection, _super);

    function PageCollection() {
      _ref = PageCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PageCollection.prototype.model = quadrigram.Models.Page;

    return PageCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.UIView = (function(_super) {
    __extends(UIView, _super);

    function UIView() {
      this.showTOS = __bind(this.showTOS, this);
      this.openAskus = __bind(this.openAskus, this);
      this.openSettings = __bind(this.openSettings, this);
      this.setDevMode = __bind(this.setDevMode, this);
      this.handleModeChange = __bind(this.handleModeChange, this);
      this.showExportOptions = __bind(this.showExportOptions, this);
      this.showProjects = __bind(this.showProjects, this);
      this.showFilePicker = __bind(this.showFilePicker, this);
      this.showImagePicker = __bind(this.showImagePicker, this);
      this.showBlockBuilder = __bind(this.showBlockBuilder, this);
      this.showBlockPreview = __bind(this.showBlockPreview, this);
      this.updateVizInspector = __bind(this.updateVizInspector, this);
      this.removeSubviews = __bind(this.removeSubviews, this);
      this.addSubViewEl = __bind(this.addSubViewEl, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = UIView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    UIView.prototype.template = JST['app/scripts/templates/UI/UI.hbs'];

    UIView.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    UIView.prototype.viewDidRender = function() {
      this.model.on("changedMode", this.handleModeChange);
      this.removeSubviews();
      this.topMenu = new quadrigram.Views.TopMenuView({
        model: this.model
      });
      $(".top-menu-container").append(this.topMenu.$el);
      this.topMenu.render();
      this.toolbar = new quadrigram.Views.Toolbar({
        model: this.model
      });
      $(".toolbar-container").append(this.toolbar.$el);
      this.toolbar.render();
      this.pagesToolbar = new quadrigram.Views.PagesToolbar({
        model: this.model
      });
      $(".left-menu-container").append(this.pagesToolbar.$el);
      this.pagesToolbar.render();
      this.vizInspector = new quadrigram.Views.VizInspectorView({
        el: $(".viz-inspector-container"),
        model: null
      });
      this.vizInspector.render();
      this.blockBuilder = new quadrigram.Views.BlockBuilderView();
      this.helpPopup = new quadrigram.Views.HelpPopupView({
        el: $(".help-popup-container"),
        model: null
      });
      this.helpPopup.render();
      if (quadrigram.router.dataModels.user.get("termsSigned") === 0) {
        return this.showTOS();
      }
    };

    UIView.prototype.addSubViewEl = function(view, selector) {
      this.subViews[selector] = view;
      view.render();
      $(selector).empty();
      return $(selector).append(view.$el);
    };

    UIView.prototype.removeSubviews = function() {
      $(".top-menu-container").html("");
      $(".left-menu-container").html("");
      $(".toolbar-container").html("");
      if (this.topMenu) {
        this.topMenu.remove();
        this.toolbar.remove();
        return this.pagesToolbar.remove();
      }
    };

    UIView.prototype.updateVizInspector = function(vizModel) {
      if (vizModel != null) {
        this.vizInspector.model = vizModel;
        this.vizInspector.update();
        return this.vizInspector.show();
      } else {
        return this.vizInspector.hide();
      }
    };

    /*
    updateBlockInspector:(blockModel)=>
      @blockInspector.setTarget(blockModel)
    
      if blockModel?
        @blockInspector.show()
      else
        @blockInspector.hide()
    */


    UIView.prototype.showBlockPreview = function(blockModel) {
      var blockPreviewer;
      blockPreviewer = new quadrigram.Views.BlockPreviewView();
      blockPreviewer.model = blockModel;
      blockPreviewer.render();
      if (blockModel.get("blockGroup") instanceof quadrigram.Models.ExternalBlockGroupModel) {
        return quadrigram.router.appViews.uiView.toolbar.filesExplorer.selectExternalGroup(blockModel.get("blockGroup").id);
      } else if (blockModel.get("blockGroup") instanceof quadrigram.Models.VizBlockGroupModel) {
        return quadrigram.router.appViews.uiView.toolbar.filesExplorer.selectVisualizerOutput(blockModel.get("blockGroup").id);
      } else if (blockModel.get("blockGroup") instanceof quadrigram.Models.CustomBlockGroupModel) {
        return quadrigram.router.appViews.uiView.toolbar.filesExplorer.selectFormulaGroup(blockModel.get("blockGroup").id);
      }
    };

    /*
    toggleDataFactory:(value)=>
      @dataFactory.setVisible(value)
    */


    UIView.prototype.showBlockBuilder = function(blockGroupModel) {
      this.blockBuilder.model = blockGroupModel;
      return this.blockBuilder.render();
    };

    UIView.prototype.showImagePicker = function(pickerCallback) {
      var filePicker;
      filePicker = new quadrigram.Views.ImagePicker({
        model: this.model
      });
      filePicker.callBack = pickerCallback;
      return filePicker.render();
    };

    UIView.prototype.showFilePicker = function(pickerCallback) {
      var filePicker;
      filePicker = new quadrigram.Views.FilePicker({
        model: this.model
      });
      filePicker.callBack = pickerCallback;
      return filePicker.render();
    };

    UIView.prototype.showProjects = function() {
      var projectsPicker;
      projectsPicker = new quadrigram.Views.ProjectsPicker({
        model: this.model
      });
      projectsPicker.callBack = quadrigram.router.loadProject;
      return projectsPicker.render();
    };

    UIView.prototype.showExportOptions = function() {
      var projectsPicker;
      quadrigram.router.saveCurrentProject();
      quadrigram.router.optimizeCurrentProjectData();
      projectsPicker = new quadrigram.Views.ExportOptions({
        model: this.model
      });
      projectsPicker.callBack = quadrigram.router.exportProject;
      projectsPicker.render();
      return quadrigram.tracker.sendEvent({
        event_type: 307,
        client_data: {
          pname: quadrigram.router.dataModels.currentProject.get("pname")
        }
      });
      /*
      quadrigram.router.managers.serverManager.requestExportWindow()
      quadrigram.tracker.sendEvent({event_type: 307, client_data: {pname: quadrigram.router.dataModels.currentProject.get("pname")}})
      */

    };

    UIView.prototype.handleModeChange = function() {
      if (this.model.mode === "preview") {
        this.topMenu.hide();
        return quadrigram.router.appViews.headerView.$el.addClass("preview-mode");
      } else {
        this.topMenu.show();
        return quadrigram.router.appViews.headerView.$el.removeClass("preview-mode");
      }
    };

    UIView.prototype.setDevMode = function() {
      elog("Dev Mode activated!");
      this.devModeActive = true;
      return quadrigram.router.appViews.headerView.$el.addClass("dev-mode");
    };

    UIView.prototype.openSettings = function(at) {
      var settings;
      settings = new quadrigram.Views.SettingsDialog();
      return settings.render(at);
    };

    UIView.prototype.openAskus = function(at) {
      var askusPopup;
      askusPopup = new quadrigram.Views.AskusDialog();
      return askusPopup.render();
    };

    UIView.prototype.showTOS = function() {
      var tosPopup;
      tosPopup = new quadrigram.Views.TosDialog();
      return tosPopup.render();
    };

    return UIView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.LoadableView = (function(_super) {
    __extends(LoadableView, _super);

    function LoadableView() {
      this.setLoading = __bind(this.setLoading, this);
      this.postRender = __bind(this.postRender, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.init = __bind(this.init, this);
      _ref = LoadableView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LoadableView.prototype.loadingTemplate = JST['app/scripts/templates/UI/loading.hbs'];

    LoadableView.prototype.init = function() {
      var _this = this;
      this.on("render", this.postRender);
      this.model.on("request", function(model) {
        return model.set("fetchState", "loading");
      });
      this.model.on("sync", function(model) {
        return model.set("fetchState", "ready");
      });
      return this.model.on("error", function(model) {
        return model.set("fetchState", "error");
      });
    };

    LoadableView.prototype.viewWillRemove = function() {
      this.off("render");
      this.model.off("request");
      this.model.off("sync");
      return this.model.off("error");
    };

    LoadableView.prototype.postRender = function() {
      return this.setLoading();
    };

    LoadableView.prototype.setLoading = function() {
      if (this.loaderView) {
        this.loaderView.remove();
        this.loaderView = null;
      }
      if (this.model.get("fetchState") === "error") {
        return elog("should display error as loading overlay");
      } else if (this.model.get("fetchState") === "loading") {
        this.loaderView = $(this.loadingTemplate());
        return this.$el.append(this.loaderView);
      }
    };

    return LoadableView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.HeaderView = (function(_super) {
    __extends(HeaderView, _super);

    function HeaderView() {
      this.updateVisibileState = __bind(this.updateVisibileState, this);
      this.setSaveState = __bind(this.setSaveState, this);
      this.userProfileClicked = __bind(this.userProfileClicked, this);
      this.updateNotificationsButton = __bind(this.updateNotificationsButton, this);
      this.firstUpdateNotificationsButton = __bind(this.firstUpdateNotificationsButton, this);
      this.toggleNotifications = __bind(this.toggleNotifications, this);
      this.feedbackHelpClicked = __bind(this.feedbackHelpClicked, this);
      this.externalHelpClicked = __bind(this.externalHelpClicked, this);
      this.tosClicked = __bind(this.tosClicked, this);
      this.askusClicked = __bind(this.askusClicked, this);
      this.helpClicked = __bind(this.helpClicked, this);
      this.redoClicked = __bind(this.redoClicked, this);
      this.undoClicked = __bind(this.undoClicked, this);
      this.togglePreview = __bind(this.togglePreview, this);
      this["export"] = __bind(this["export"], this);
      this.shareClicked = __bind(this.shareClicked, this);
      this.saveClicked = __bind(this.saveClicked, this);
      this.showProjectName = __bind(this.showProjectName, this);
      this.requestProjectLoad = __bind(this.requestProjectLoad, this);
      this.logout = __bind(this.logout, this);
      this.newProject = __bind(this.newProject, this);
      this.renameProject = __bind(this.renameProject, this);
      this.saveAsProject = __bind(this.saveAsProject, this);
      this.openProjects = __bind(this.openProjects, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = HeaderView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    HeaderView.prototype.events = {
      "click .open-button": "openProjects",
      "click .new-button": "newProject",
      "click .save-as-button": "saveAsProject",
      "click .rename-button": "renameProject",
      "click .save-button": "saveClicked",
      "click .share-button": "shareClicked",
      "click .user-profile": "userProfileClicked",
      "click .logout-button": "logout",
      "click .export-button": "export",
      "click .save-btn": "saveClicked",
      "click #project-title": "renameProject",
      "click .toggle-preview-btn": "togglePreview",
      "click .undo": "undoClicked",
      "click .redo": "redoClicked",
      "click .open-help-button": "helpClicked",
      "click .toggle-notif-button": "toggleNotifications",
      "click .external-help-button": "externalHelpClicked",
      "click .feedback-help-button": "feedbackHelpClicked",
      "click .askus-help-button": "askusClicked",
      "click .terms-help-button": "tosClicked"
    };

    HeaderView.prototype.template = JST['app/scripts/templates/UI/header.hbs'];

    HeaderView.prototype.viewWillRender = function() {
      var notis;
      this.templateData.version = quadrigram.version;
      notis = quadrigram.router.dataModels.achievementsModel.get("notificationsEnabeld");
      if (notis == null) {
        notis = true;
      }
      return this.templateData.notifActive = notis;
    };

    HeaderView.prototype.viewDidRender = function() {
      this.$el.removeClass("hidden");
      this.$el.find(".project-loader-btn").on("click", this.requestProjectLoad);
      this.achievementsView = new quadrigram.Views.AchievementsView;
      this.achievementsView.render();
      this.$el.append(this.achievementsView.$el);
      quadrigram.router.dataModels.achievementsModel.on("sync", this.firstUpdateNotificationsButton);
      return this.updateNotificationsButton();
      /*
      @model.on("change:pname",()=>
        @showProjectName(@model.get("pname"))
      )
      */

    };

    HeaderView.prototype.openProjects = function() {
      return quadrigram.router.appViews.uiView.showProjects();
    };

    HeaderView.prototype.saveAsProject = function() {
      return quadrigram.router.saveAsCurrentProject();
    };

    HeaderView.prototype.renameProject = function() {
      return quadrigram.router.renameCurrentProject();
    };

    HeaderView.prototype.newProject = function() {
      return quadrigram.router.loadProject();
    };

    HeaderView.prototype.logout = function() {
      return quadrigram.router.managers.serverManager.logout();
    };

    HeaderView.prototype.requestProjectLoad = function() {
      return quadrigram.router.navigate("project", {
        trigger: true
      });
    };

    HeaderView.prototype.showProjectName = function(name) {
      if (name === "") {
        this.$el.find("#project-title").addClass("hidden");
        this.$el.find(".save-component").addClass("hidden");
        this.$el.find(".header-edit-tools").addClass("hidden");
      } else {
        this.$el.find("#project-title").removeClass("hidden");
        this.$el.find(".save-component").removeClass("hidden");
        this.$el.find(".header-edit-tools").removeClass("hidden");
      }
      return this.$el.find("#project-title").html(name);
    };

    HeaderView.prototype.saveClicked = function(e) {
      return quadrigram.router.saveCurrentProject();
    };

    HeaderView.prototype.shareClicked = function(e) {
      return quadrigram.router.shareCurrentProject();
    };

    HeaderView.prototype["export"] = function() {
      return quadrigram.router.appViews.uiView.showExportOptions();
    };

    HeaderView.prototype.togglePreview = function(e) {
      quadrigram.router.dataModels.currentProject.togglePreview();
      return $(e.currentTarget).find('a').toggleClass('active');
    };

    HeaderView.prototype.undoClicked = function(e) {
      log("undoClidkec");
      return quadrigram.router.dataModels.currentProject.undo();
    };

    HeaderView.prototype.redoClicked = function(e) {
      log("redoClicked");
      return quadrigram.router.dataModels.currentProject.redo();
    };

    HeaderView.prototype.helpClicked = function(e) {
      return quadrigram.router.appViews.uiView.helpPopup.loadLastContent();
    };

    HeaderView.prototype.askusClicked = function(e) {
      return quadrigram.router.appViews.uiView.openAskus();
    };

    HeaderView.prototype.tosClicked = function(e) {
      return quadrigram.router.appViews.uiView.showTOS();
    };

    HeaderView.prototype.externalHelpClicked = function(e) {
      return window.open(quadrigram.webUrl + "/help", "_blank");
    };

    HeaderView.prototype.feedbackHelpClicked = function(e) {
      return window.open("http://goo.gl/forms/G8kSgptyNj", "_blank");
    };

    HeaderView.prototype.toggleNotifications = function(e) {
      quadrigram.achievementTracker.toggleNotifications();
      e.preventDefault();
      return e.stopPropagation();
    };

    HeaderView.prototype.firstUpdateNotificationsButton = function() {
      this.updateNotificationsButton();
      return quadrigram.router.dataModels.achievementsModel.off("sync", this.firstUpdateNotificationsButton);
    };

    HeaderView.prototype.updateNotificationsButton = function() {
      var value;
      value = quadrigram.achievementTracker.getNotificationState();
      if (value) {
        return this.$el.find(".toggle-notif-button").html("Disable notifications");
      } else {
        return this.$el.find(".toggle-notif-button").html("Enable notifications");
      }
    };

    HeaderView.prototype.userProfileClicked = function(e) {
      return window.open(quadrigram.webUserUrl + "#profile", "_blank");
    };

    HeaderView.prototype.setSaveState = function(state, options) {
      return this.updateVisibileState(state);
    };

    HeaderView.prototype.updateVisibileState = function(state) {
      var _this = this;
      this.$el.find(".save-component").removeClass("saving");
      this.$el.find(".save-component").removeClass("ready");
      this.$el.find(".save-component").removeClass("error");
      this.$el.find(".save-component").removeClass("success");
      this.$el.find(".save-component").addClass(state);
      if (this.interval != null) {
        clearInterval(this.interval);
      }
      switch (state) {
        case "saving":
          this.$el.find(".save-component").find(".label").html("Saving");
          return this.interval = setInterval(function() {
            var dots;
            dots = _this.$el.find(".save-component").find(".label").html().replace("Saving", "");
            dots += ".";
            if (dots.length > 3) {
              dots = "";
            }
            return _this.$el.find(".save-component").find(".label").html("Saving" + dots);
          }, 500);
        case "success":
          return this.$el.find(".save-component").find(".label").html("Saved");
        case "ready":
          return this.$el.find(".save-component").find(".label").html("Save");
        case "error":
          return this.$el.find(".save-component").find(".label").html("Error saving!");
      }
    };

    return HeaderView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.AchievementsView = (function(_super) {
    __extends(AchievementsView, _super);

    function AchievementsView() {
      this.turnofClicked = __bind(this.turnofClicked, this);
      this.closeClicked = __bind(this.closeClicked, this);
      this.loadHelp = __bind(this.loadHelp, this);
      this.currentMoreClicked = __bind(this.currentMoreClicked, this);
      this.recomendedClicked = __bind(this.recomendedClicked, this);
      this.hideAchievement = __bind(this.hideAchievement, this);
      this.showAchievement = __bind(this.showAchievement, this);
      this.showLastAchievement = __bind(this.showLastAchievement, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = AchievementsView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    AchievementsView.prototype.template = JST['app/scripts/templates/UI/achievementsView.hbs'];

    AchievementsView.prototype.unlockedTemplate = JST['app/scripts/templates/UI/achievementUnlocked.hbs'];

    AchievementsView.prototype["class"] = "achievements-view";

    AchievementsView.prototype.events = {
      "click li": "recomendedClicked",
      "click .current-more": "currentMoreClicked",
      "click .achievements-unlocked-content": "currentMoreClicked",
      "click .close": "closeClicked",
      "click .turn-off-button": "turnofClicked"
    };

    AchievementsView.prototype.viewDidRender = function() {
      this.$panel = this.$el.find(".achievements-panel");
      return this.$panel.hide();
    };

    AchievementsView.prototype.showLastAchievement = function() {
      this.$panel.show(500);
      return _.delay(this.hideAchievement, 6000);
    };

    AchievementsView.prototype.showAchievement = function(adef) {
      var templateData;
      this.$panel.html("");
      templateData = {};
      templateData.actionLabel = adef.actionLabel;
      /*
      recArray = []
      for recid in adef.recomended
        recObject = _.findWhere(quadrigram.achievementTracker.achievementDefs,{id:recid})
        recArray.push(recObject)
      templateData.recomended = recArray
      */

      this.currentId = adef.id;
      this.$panel.append(this.unlockedTemplate(templateData));
      this.$panel.slideDown(200);
      return quadrigram.router.appViews.uiView.helpPopup.updateContent(this.currentId);
    };

    AchievementsView.prototype.hideAchievement = function() {
      return this.$panel.slideUp(200);
    };

    AchievementsView.prototype.recomendedClicked = function(e) {
      var id;
      id = $(e.target).attr("data-id");
      return this.loadHelp(id);
    };

    AchievementsView.prototype.currentMoreClicked = function(e) {
      var id;
      id = this.currentId;
      if (id === "addedViz") {
        id = "loadData";
      }
      return this.loadHelp(id);
    };

    AchievementsView.prototype.loadHelp = function(id) {
      quadrigram.router.appViews.uiView.helpPopup.loadContentById(id);
      return this.hideAchievement();
    };

    AchievementsView.prototype.closeClicked = function(e) {
      return this.hideAchievement();
    };

    AchievementsView.prototype.turnofClicked = function(e) {
      quadrigram.achievementTracker.toggleNotifications(false);
      return this.hideAchievement();
    };

    return AchievementsView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ProjectView = (function(_super) {
    __extends(ProjectView, _super);

    function ProjectView() {
      this.getRealSize = __bind(this.getRealSize, this);
      this.handleClickWatermark = __bind(this.handleClickWatermark, this);
      this.handleModeChange = __bind(this.handleModeChange, this);
      this.handleGuidelinesDisplay = __bind(this.handleGuidelinesDisplay, this);
      this.getViewByModel = __bind(this.getViewByModel, this);
      this.outputSelect = __bind(this.outputSelect, this);
      this.outputDeselectAll = __bind(this.outputDeselectAll, this);
      this.handleBlockSelection = __bind(this.handleBlockSelection, this);
      this.handleVizSelection = __bind(this.handleVizSelection, this);
      this.deselectBlock = __bind(this.deselectBlock, this);
      this.deselectViz = __bind(this.deselectViz, this);
      this.deselectAll = __bind(this.deselectAll, this);
      this.updateBackgrounds = __bind(this.updateBackgrounds, this);
      this.updatePagesSettings = __bind(this.updatePagesSettings, this);
      this.updateLayoutSettings = __bind(this.updateLayoutSettings, this);
      this.isInIframe = __bind(this.isInIframe, this);
      this.updateLayoutData = __bind(this.updateLayoutData, this);
      this.getLayoutData = __bind(this.getLayoutData, this);
      this.changeVisualizerFrame = __bind(this.changeVisualizerFrame, this);
      this.renderLastInQueue = __bind(this.renderLastInQueue, this);
      this.addToRenderQueue = __bind(this.addToRenderQueue, this);
      this.createVisualizer = __bind(this.createVisualizer, this);
      this.removeVisualizer = __bind(this.removeVisualizer, this);
      this.addVisualizer = __bind(this.addVisualizer, this);
      this.addFlatVisualizer = __bind(this.addFlatVisualizer, this);
      this.mouseOut = __bind(this.mouseOut, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.notifyChangeOfProjectName = __bind(this.notifyChangeOfProjectName, this);
      this.handleKeyDown = __bind(this.handleKeyDown, this);
      this.afterPagesRendered = __bind(this.afterPagesRendered, this);
      this.afterPagesAdded = __bind(this.afterPagesAdded, this);
      this.keyup = __bind(this.keyup, this);
      this.keydown = __bind(this.keydown, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.init = __bind(this.init, this);
      _ref = ProjectView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ProjectView.prototype.template = JST['app/scripts/templates/Project.hbs'];

    ProjectView.prototype.watermarkTemplate = JST['app/scripts/templates/watermarkTemplate.hbs'];

    ProjectView.prototype.navTemplate = JST['app/scripts/templates/navButtonsTemplate.hbs'];

    ProjectView.prototype.className = "project-content";

    ProjectView.prototype.events = {
      "click .watermark": "handleClickWatermark"
    };

    ProjectView.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    ProjectView.prototype.init = function(object) {
      var _this = this;
      object.model.on("change:layout-settings", function() {
        return _.defer(function() {
          return _this.updateLayoutSettings();
        });
      });
      object.model.on("change:pages-settings", function() {
        return _.defer(function() {
          return _this.updatePagesSettings();
        });
      });
      object.model.on("add:pagesCollection remove:pagesCollection", function(model) {
        return _.defer(function() {
          return _this.updatePagesSettings();
        });
      });
      object.model.on("change:layoutData", function() {
        return _this.updateLayoutData();
      });
      object.model.on("remove:visualizersCollection", function(model) {
        return _this.removeVisualizer(model);
      });
      object.model.on("add:visualizersCollection", function(model) {
        return _this.addVisualizer(model);
      });
      object.model.on("changedMode", this.handleModeChange);
      object.model.on("changedGuidelinesDisplay", this.handleGuidelinesDisplay);
      object.model.on("change:pname", this.notifyChangeOfProjectName);
      return this.vizViews = [];
    };

    ProjectView.prototype.viewDidRender = function() {
      var navContainer;
      $(".project-content").addClass("preload");
      this.$el.addClass(this.model.get("layout-settings").layoutFormat);
      this.layoutManager = new quadrigram.Managers.PageCollectionView({
        el: $(".pages-collection-container"),
        model: this.model
      });
      this.layoutManager.render();
      this.toolTipManager = new quadrigram.Managers.ToolTipManager(this.model, this.model.get("tooltip-settings"));
      navContainer = $(this.navTemplate());
      this.$el.closest(".project-super-container").append(navContainer);
      navContainer.find(".page-button.prev").on("click", this.layoutManager.gotoPrevPage);
      navContainer.find(".page-button.next").on("click", this.layoutManager.gotoNextPage);
      if (quadrigram.router.getDevice() !== "Desktop") {
        quadrigram.router.hammer.on("swipeleft", this.layoutManager.gotoNextPage);
        quadrigram.router.hammer.on("swiperight", this.layoutManager.gotoPrevPage);
      }
      if (quadrigram.environment === "exported") {
        this.$el.closest(".project-container").addClass("exported");
        this.$el.closest("body").addClass("exported");
        this.$el.closest("html").addClass("exported");
        this.$el.addClass("exported");
        this.$el.closest("#content").addClass("exported");
      }
      this.$el.closest(".project-container").on("mousedown", this.mouseOut);
      this.$el.append(this.watermarkTemplate());
      this.notifyChangeOfProjectName();
      this.updateLayoutSettings();
      this.updatePagesSettings();
      this.layoutManager.on("pagesAdded", this.afterPagesAdded);
      this.layoutManager.on("pagesRendered", this.afterPagesRendered);
      $(window).on("keydown", this.keydown);
      return $(window).on("keyup", this.keyup);
    };

    ProjectView.prototype.keydown = function(e) {
      if (e.keyCode === 68) {
        return this.D_pressed = true;
      }
      /*
      if e.ctrlKey && e.keyCode == 68
        log "ctrl+d key pressed..."
        if @currentSelection?
          @currentSelection.model.duplicate()
          e.preventDefault()
          e.stopPropagation()
      */

    };

    ProjectView.prototype.keyup = function(e) {
      if (e.keyCode === 68) {
        return this.D_pressed = false;
      }
    };

    ProjectView.prototype.afterPagesAdded = function() {
      var candidate, models, vizModel, _base, _i, _j, _len, _len1, _ref1,
        _this = this;
      models = LayoutUtils.sortArrayOfVizForGridster(this.model.get("visualizersCollection").models, this.model.get("pagesCollection"));
      for (_i = 0, _len = models.length; _i < _len; _i++) {
        vizModel = models[_i];
        this.addVisualizer(vizModel);
      }
      (_base = this.model).staticVisualizers || (_base.staticVisualizers = []);
      _ref1 = this.model.staticVisualizers;
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        vizModel = _ref1[_j];
        candidate = _.find(this.model.get("layoutData"), function(ld) {
          return ld.vizID === vizModel.id;
        });
        vizModel.getProperty = function(id) {
          var prop;
          prop = {};
          prop.getValues = function() {
            return candidate[id];
          };
          return prop;
        };
        this.addFlatVisualizer(vizModel);
      }
      return this.layoutManager.on("change:viz-frame", function(e) {
        return _this.changeVisualizerFrame(e);
      });
    };

    ProjectView.prototype.afterPagesRendered = function() {
      var startId;
      this.layoutManager.disable();
      this.layoutManager.setLoaded();
      setTimeout(this.handleModeChange, 20);
      if (quadrigram.router.appViews.uiView) {
        quadrigram.router.appViews.uiView.pagesToolbar.loadPages();
      }
      if (Backbone.history.fragment.indexOf("p/") === 0) {
        this.layoutManager.gotoPage(Backbone.history.fragment.replace("p/", ""));
      } else {
        startId = this.model.get("pagesCollection").models[0].get("label");
        quadrigram.router.navigate("#p/" + startId, {
          trigger: true,
          replace: true
        });
      }
      quadrigram.router.resizeProject();
      quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
        mode: 1,
        "class": "loadingProject"
      });
      return $("body").on("keydown", this.handleKeyDown);
    };

    ProjectView.prototype.handleKeyDown = function(e) {};

    ProjectView.prototype.notifyChangeOfProjectName = function() {
      if (quadrigram.router.appViews.headerView) {
        return quadrigram.router.appViews.headerView.showProjectName(this.model.get("pname"));
      }
    };

    ProjectView.prototype.viewWillRemove = function() {
      var viz, _i, _len, _ref1;
      this.off();
      this.model.off();
      _ref1 = this.vizViews;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        viz = _ref1[_i];
        viz.remove();
      }
      this.vizViews = [];
      this.$el.closest(".project-container").off("mousedown", this.mouseOut);
      this.layoutManager.off("change:viz-frame", this.changeVisualizerFrame);
      return this.layoutManager.destroy();
    };

    ProjectView.prototype.mouseOut = function(e) {
      if ($(e.target).closest(".viz-container").length === 0) {
        return this.deselectAll();
      }
    };

    ProjectView.prototype.addFlatVisualizer = function(model) {
      var bckgColor, bckgOpacity, bkgEl, bkg_color, bkg_image, bkg_opacity, color, gridElement, html, opacity, scroll_enabled, style, vizContainerEl,
        _this = this;
      vizContainerEl = $("<div class='viz-container'></div>");
      bkgEl = $("<div class='viz-view-background'></div>");
      vizContainerEl.append(bkgEl);
      /*TEXT*/

      if (model.type === "TextArea") {
        html = _.findWhere(model.propertiesCollection, {
          "propId": "value"
        }).formats.Text.defaults.value;
        vizContainerEl.addClass("exported-quill");
        vizContainerEl.append(html);
      }
      /*BACKGROUND*/

      bkg_color = _.findWhere(model.propertiesCollection, {
        "propId": "bkg_color"
      });
      if (bkg_color) {
        bckgColor = bkg_color.formats.Color.defaults.value;
        if ((bckgColor != null) && bckgColor !== "" && bckgColor !== "transparent") {
          color = d3.rgb(bckgColor);
          style = "rgb(" + color.r + "," + color.g + "," + color.b + ")";
          bkgEl.css("background-color", style);
        } else {
          bkgEl.css("background-color", "transparent");
        }
      }
      bkg_opacity = _.findWhere(model.propertiesCollection, {
        "propId": "bkg_opacity"
      });
      if (bkg_opacity) {
        bckgOpacity = bkg_opacity.formats.Percentage.defaults.value;
        opacity = 1;
        if ((bckgOpacity != null) && bckgOpacity !== "") {
          opacity = bckgOpacity / 100;
        }
        bkgEl.css("opacity", opacity);
      }
      bkg_image = _.findWhere(model.propertiesCollection, {
        "propId": "bkg_image"
      });
      if (bkg_image != null) {
        quadrigram.router.managers.serverManager.getImageUrl(bkg_image.formats.ImageUrl.defaults.value, function(resultUrl) {
          return bkgEl.css("background-image", "url('" + resultUrl + "')");
        });
        bkgEl.css(quadrigram.Models.LayoutBehavior.calculateCSS(bkg_image.formats.ImageUrl.defaults.scale, bkg_image.formats.ImageUrl.defaults.repeat));
      }
      /*SCROLL*/

      scroll_enabled = _.findWhere(model.propertiesCollection, {
        "propId": "scroll_enabled"
      });
      if (scroll_enabled != null) {
        if (scroll_enabled.formats.Boolean.defaults.value === "true") {
          vizContainerEl.css("overflow", "hidden");
        } else {
          vizContainerEl.css("overflow-y", "auto");
        }
      } else {
        vizContainerEl.css("overflow", "hidden");
      }
      gridElement = this.layoutManager.addVisualizer(model);
      return gridElement.prepend(vizContainerEl);
    };

    ProjectView.prototype.addVisualizer = function(model) {
      var $image, e, gridElement, vizContainerEl, vizContainerView,
        _this = this;
      vizContainerEl = $("<div class='viz-container'></div>");
      vizContainerView = this.createVisualizer(vizContainerEl, model);
      gridElement = this.layoutManager.addVisualizer(model);
      gridElement.prepend(vizContainerEl);
      if (model.addMode === "float") {
        gridElement.attr("hidden", "true");
        model.hidden = false;
        e = jQuery.Event("mousedown");
        e.target = gridElement[0];
        e.currentTarget = gridElement[0];
        e.clientX = gridElement.position().left + gridElement.offsetParent().offset().left + gridElement.width() / 2;
        e.clientY = gridElement.position().top + gridElement.offsetParent().offset().top + gridElement.height() / 5;
        e.which = 1;
        model.addMode = null;
        if (model.options.iconPath != null) {
          $image = $("<img class='viz-drag-icon' src='" + model.options.iconPath + "'></img>");
          $image.css({
            "top": gridElement.height() / 5 - 77 / 2,
            "left": gridElement.width() / 2 - 77 / 2
          });
          vizContainerEl.append($image);
        }
        return _.delay(function() {
          vizContainerEl.find(".viz-view").css({
            "opacity": 0
          });
          return _this.layoutManager.beginDrag(e);
        }, 10);
      } else if (model.addMode === "scroll") {
        return this.$el.parent().animate({
          scrollTop: gridElement.position().top
        }, 300, 'swing', function() {
          return _this.handleVizSelection(model);
        });
      }
    };

    ProjectView.prototype.removeVisualizer = function(model) {
      var k, vizView, _i, _len, _ref1;
      this.layoutManager.removeVisualizer(model);
      _ref1 = this.vizViews;
      for (k = _i = 0, _len = _ref1.length; _i < _len; k = ++_i) {
        vizView = _ref1[k];
        if (vizView.model === model) {
          vizView.remove();
          this.vizViews.splice(k, 1);
          break;
        }
      }
      return this.deselectAll();
    };

    ProjectView.prototype.createVisualizer = function(el, dataModel) {
      var viz;
      viz = new quadrigram.Views.VisualizerContainerView({
        el: el,
        model: dataModel,
        binding: false
      });
      viz.setMode(this.model.mode);
      if (dataModel.addMode !== "float") {
        this.addToRenderQueue(viz);
      } else {
        viz.render();
      }
      this.listenTo(viz, "selected", this.handleVizSelection);
      this.vizViews.push(viz);
      return viz;
    };

    ProjectView.prototype.addToRenderQueue = function(viz) {
      if (this.renderQueue == null) {
        this.renderQueue = [];
      }
      this.renderQueue.unshift(viz);
      if (this.renderQueue.length === 1) {
        return _.delay(this.renderLastInQueue, 10);
      }
    };

    ProjectView.prototype.renderLastInQueue = function() {
      var currentViz;
      if (this.renderQueue.length > 0) {
        currentViz = this.renderQueue.pop();
        currentViz.once("renderFinished", this.renderLastInQueue);
        return currentViz.render();
      }
    };

    ProjectView.prototype.changeVisualizerFrame = function(hidden) {
      var lastModel, newLayoutData, stackModels;
      newLayoutData = Gridster.sort_by_row_asc(this.layoutManager.serialize());
      this.model.set("layoutData", newLayoutData);
      if (hidden === true) {
        stackModels = quadrigram.router.dataModels.currentProject.undoManager.stack.models;
        lastModel = stackModels[stackModels.length - 1];
        if (lastModel != null) {
          return lastModel.set("magicFusionIndex", lastModel.get("magicFusionIndex") - 1);
        }
      }
    };

    ProjectView.prototype.getLayoutData = function() {
      return Gridster.sort_by_row_asc(this.layoutManager.serialize());
    };

    ProjectView.prototype.updateLayoutData = function() {
      if (this.model.get("layoutData")) {
        return this.layoutManager.redrawFrames(this.model.get("layoutData"));
      }
    };

    ProjectView.prototype.isInIframe = function() {
      var e;
      try {
        return window.self !== window.top;
      } catch (_error) {
        e = _error;
        return true;
      }
    };

    ProjectView.prototype.updateLayoutSettings = function() {
      var layoutClass;
      if (this.isInIframe()) {
        layoutClass = "embed-layout";
      } else {
        layoutClass = "web-layout";
      }
      this.$el.removeClass("web-layout");
      this.$el.removeClass("full-screen-layout");
      this.$el.removeClass("embed-layout");
      this.$el.addClass(layoutClass);
      if (this.layoutManager != null) {
        this.layoutManager.updateLayoutSettings();
      }
      this.updateBackgrounds();
      return quadrigram.router.resizeProject();
    };

    ProjectView.prototype.updatePagesSettings = function() {
      if (this.layoutManager != null) {
        this.layoutManager.updatePagesSettings();
      }
      return this.updateBackgrounds();
    };

    ProjectView.prototype.updateBackgrounds = function() {
      this.$el.closest(".project-container").css("background", this.model.get("layout-settings").backgroundColor);
      $(".header-overlay").css("backgroundColor", this.model.get("layout-settings").backgroundColor);
      $("body").css("background", this.model.get("layout-settings").backgroundColor);
      if (this.layoutManager != null) {
        return this.layoutManager.updateBackgrounds();
      }
    };

    ProjectView.prototype.deselectAll = function() {
      this.deselectViz();
      return this.deselectBlock();
    };

    ProjectView.prototype.deselectViz = function() {
      return this.handleVizSelection();
    };

    ProjectView.prototype.deselectBlock = function() {
      return this.handleBlockSelection();
    };

    ProjectView.prototype.handleVizSelection = function(vizModel) {
      var viz, _i, _len, _ref1;
      this.currentSelection = null;
      _ref1 = this.vizViews;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        viz = _ref1[_i];
        if (viz.setSelected != null) {
          if (viz.model === vizModel) {
            viz.setSelected(true);
            this.currentSelection = viz;
          } else {
            viz.setSelected(false);
          }
        }
      }
      if (quadrigram.router.appViews.uiView) {
        return quadrigram.router.appViews.uiView.updateVizInspector(vizModel);
      }
    };

    ProjectView.prototype.handleBlockSelection = function(blockModel) {
      var b, bg, _i, _len, _ref1, _results;
      _ref1 = this.model.get("blockGroupsCollection").models;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        bg = _ref1[_i];
        _results.push((function() {
          var _j, _len1, _ref2, _results1;
          _ref2 = bg.get("blocksCollection").models;
          _results1 = [];
          for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
            b = _ref2[_j];
            if (b === blockModel) {
              _results1.push(b.setSelected(true));
            } else {
              _results1.push(b.setSelected(false));
            }
          }
          return _results1;
        })());
      }
      return _results;
      /*
      if quadrigram.router.appViews.uiView
        quadrigram.router.appViews.uiView.updateBlockInspector blockModel
      */

    };

    ProjectView.prototype.outputDeselectAll = function() {
      var v, _i, _len, _ref1, _results;
      _ref1 = this.vizViews;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        v = _ref1[_i];
        _results.push(v.setOutputSelected(false));
      }
      return _results;
    };

    ProjectView.prototype.outputSelect = function(model) {
      var vizContainerView;
      this.outputDeselectAll();
      vizContainerView = this.getViewByModel(model);
      if (vizContainerView) {
        return vizContainerView.setOutputSelected(true);
      }
    };

    ProjectView.prototype.getViewByModel = function(model) {
      var v, _i, _len, _ref1;
      _ref1 = this.vizViews;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        v = _ref1[_i];
        if (v.model === model.get("ownerViz")) {
          return v;
        }
      }
    };

    ProjectView.prototype.handleGuidelinesDisplay = function(ev) {
      if (this.model.showGuidelines === true) {
        return this.$('.layout-guides-container').addClass("visible");
      } else {
        return this.$('.layout-guides-container').removeClass("visible");
      }
    };

    ProjectView.prototype.handleModeChange = function(e) {
      var v, _i, _len, _ref1, _results;
      if (this.model.mode === "preview") {
        quadrigram.tracker.sendEvent({
          event_type: 305
        });
        this.deselectAll();
        this.layoutManager.disable();
        if (quadrigram.router.appViews.uiView) {
          quadrigram.router.appViews.uiView.topMenu.hide();
          quadrigram.router.appViews.uiView.pagesToolbar.hide();
        }
      } else {
        this.layoutManager.enable();
        if (quadrigram.router.appViews.uiView) {
          quadrigram.router.appViews.uiView.topMenu.show();
          quadrigram.router.appViews.uiView.pagesToolbar.show();
        }
      }
      _ref1 = this.vizViews;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        v = _ref1[_i];
        if (v.setMode != null) {
          _results.push(v.setMode(this.model.mode));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    ProjectView.prototype.handleClickWatermark = function() {
      return window.open(quadrigram.webUrl, '_blank');
    };

    ProjectView.prototype.getRealSize = function() {
      return this.layoutManager.getRealSize();
    };

    return ProjectView;

  })(quadrigram.Views.LoadableView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PageView = (function(_super) {
    __extends(PageView, _super);

    function PageView() {
      this.drawGuides = __bind(this.drawGuides, this);
      this.resizeGuides = __bind(this.resizeGuides, this);
      this.comparareWgdSizes = __bind(this.comparareWgdSizes, this);
      this.setVizFrame = __bind(this.setVizFrame, this);
      this.redrawFrames = __bind(this.redrawFrames, this);
      this.serialize = __bind(this.serialize, this);
      this.removeToLimbo = __bind(this.removeToLimbo, this);
      this.removeVisualizer = __bind(this.removeVisualizer, this);
      this.addVisualizer = __bind(this.addVisualizer, this);
      this.changing = __bind(this.changing, this);
      this.checkScroll = __bind(this.checkScroll, this);
      this.resizeEnd = __bind(this.resizeEnd, this);
      this.resize = __bind(this.resize, this);
      this.resizeStart = __bind(this.resizeStart, this);
      this.dragEnd = __bind(this.dragEnd, this);
      this.drag = __bind(this.drag, this);
      this.dragStart = __bind(this.dragStart, this);
      this.changeEnd = __bind(this.changeEnd, this);
      this.enable = __bind(this.enable, this);
      this.disable = __bind(this.disable, this);
      this.getLowestPointOfSortedFrameArray = __bind(this.getLowestPointOfSortedFrameArray, this);
      this.updateAfterAllGridsters = __bind(this.updateAfterAllGridsters, this);
      this.updateCanvas = __bind(this.updateCanvas, this);
      this.setGridSizes = __bind(this.setGridSizes, this);
      this._resizeGridster = __bind(this._resizeGridster, this);
      this.getGridsterConfig = __bind(this.getGridsterConfig, this);
      this.updateBackground = __bind(this.updateBackground, this);
      this.updateGridsterSettings = __bind(this.updateGridsterSettings, this);
      this.loadSettings = __bind(this.loadSettings, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = PageView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PageView.prototype.template = JST['app/scripts/templates/pageTemplate.hbs'];

    PageView.prototype.gridTemplate = JST['app/scripts/templates/Grid.hbs'];

    PageView.prototype.className = "page";

    PageView.prototype.viewDidRender = function() {
      var gridsterConfig, self,
        _this = this;
      this.vizViews = [];
      this.$el.attr("data-id", this.model.get("id"));
      this.$el.find(".layout-guides-container").append(this.gridTemplate());
      /*
      window.addEventListener("resize", ()=>
          @_resizeGridster()
      );
      */

      this.loadSettings();
      gridsterConfig = this.getGridsterConfig();
      if (quadrigram.environment === "exported") {
        return;
      }
      this.gridster = this.$el.find(".gridster").gridster({
        namespace: "#gridster-" + this.model.get("id"),
        widget_base_dimensions: [gridsterConfig.x_dimension, gridsterConfig.y_dimension],
        widget_margins: [gridsterConfig.marginx, gridsterConfig.marginy],
        max_cols: gridsterConfig.max_cols,
        min_cols: gridsterConfig.min_cols,
        min_rows: 120,
        autogrow_cols: false,
        limit: false,
        resize: {
          enabled: true,
          start: this.resizeStart,
          stop: this.resizeEnd,
          resize: this.resize
        },
        draggable: {
          limit: false,
          start: this.dragStart,
          stop: this.dragEnd,
          drag: this.drag,
          ignore_dragging: function(e) {
            return $(e.currentTarget).find(".viz-container.selected").length > 0 && !$(e.target).hasClass("context-menu") && !($(e.target).attr("class") === "bkg-svg") && !($(e.target).hasClass("bkg-dom"));
          }
        },
        serialize_params: function($w, wgd) {
          return {
            col: wgd.col,
            row: wgd.row,
            size_x: wgd.size_x,
            size_y: wgd.size_y,
            vizID: $w.attr("viz-id")
          };
        }
      }).data('gridster');
      this.updateCanvas();
      this.gridster.resize_api.options.ignore_dragging = function(e) {
        return $(e.target).closest(".ql-editor").length > 0;
      };
      this.gridster.resize_widget_dimensions = function(options) {
        var serializedGrid;
        if (options.widget_margins) {
          this.options.widget_margins = options.widget_margins;
        }
        if (options.widget_base_dimensions) {
          this.options.widget_base_dimensions = options.widget_base_dimensions;
        }
        if (options.max_cols) {
          this.options.max_cols = options.max_cols;
        }
        if (options.min_cols) {
          this.options.min_cols = options.min_cols;
        }
        this.min_widget_width = (this.options.widget_margins[0] * 2) + this.options.widget_base_dimensions[0];
        this.min_widget_height = (this.options.widget_margins[1] * 2) + this.options.widget_base_dimensions[1];
        serializedGrid = this.serialize();
        /*
        this.$widgets.each($.proxy((i, widget) =>
            $widget = $(widget);
            # log "resizing widget",$widget
            this.resize_widget($widget);
            _.delay(()=>
              $widget.trigger("resizeEnd")
            ,500)
        , this));
        */

        this.generate_grid_and_stylesheet();
        this.get_widgets_from_DOM();
        this.set_dom_grid_height();
        this.set_dom_grid_width();
        this.drag_api.options.container_width = this.cols * this.min_widget_width;
        return this;
      };
      self = this;
      this.gridster.drag_api.scroll_in = function(axis, data) {
        var maxY, minY, mouseY, scrollContainer, scrollOffset, scroll_inc;
        if (axis === "x" || self.model.get("id") === "_headerPage") {
          return;
        }
        scrollContainer = $(".project-container");
        scrollOffset = scrollContainer.scrollTop();
        scroll_inc = 10;
        minY = this.$container.offset().top + scrollOffset;
        maxY = $(".project-container").offset().top + $(".project-container").height();
        mouseY = data.pointer["top"];
        if (mouseY < minY + 50) {
          scrollContainer.scrollTop(scrollOffset - scroll_inc);
          return this['scroll_offset_' + axis] -= scroll_inc;
        } else if (mouseY > maxY - 50) {
          scrollContainer.scrollTop(scrollOffset + scroll_inc);
          return this['scroll_offset_' + axis] += scroll_inc;
        }
      };
      
    this.gridster.drag_api.scroll_inOLD = function(axis, data) {
        var $window = $(self.el).closest(".project-container");
        var dir_map = { x : 'left', y : 'top' };
        var capitalize = function(str) {
          return str.charAt(0).toUpperCase() + str.slice(1);
        };
        var dir_prop = dir_map[axis];

        var area_size = 100;
        var scroll_inc = 5;

        var is_x = axis === 'x';
        //CHAPUZILLA: Queremos o no scroll_x (en principio no, pero si el layout mide mas que nuestra pantalla!!!???)
        //Hay que hacerlo mejor...
        if (is_x == true)
          {
            return;
          }

        var window_size = is_x ? this.window_width : this.window_height;
        var doc_size = is_x ? $(document).width() : $(document).height();
        var player_size = is_x ? this.$player.width() : this.$player.height();

        var next_scroll;
        var scroll_offset = $window['scroll' + capitalize(dir_prop)]();
        var min_window_pos = scroll_offset;
        var max_window_pos = min_window_pos + window_size;

        //CHAPUZA, no se porque el top coge menos que el bottom...
        var mouse_next_zone = max_window_pos - 40;  // down/right
        var mouse_prev_zone = min_window_pos + 120;  // up/left

        var abs_mouse_pos = min_window_pos + data.pointer[dir_prop];

        var max_player_pos = (doc_size - window_size + player_size);

        if (abs_mouse_pos >= mouse_next_zone) {
            next_scroll = scroll_offset + scroll_inc;
            //if (next_scroll < max_player_pos) {
                $window['scroll' + capitalize(dir_prop)](next_scroll);
                this['scroll_offset_' + axis] += scroll_inc;
            //}
        }

        if (abs_mouse_pos <= mouse_prev_zone) {
            next_scroll = scroll_offset - scroll_inc;
            //if (next_scroll > 0) {
                $window['scroll' + capitalize(dir_prop)](next_scroll);
                this['scroll_offset_' + axis] -= scroll_inc;
            //}
        }

        return this;
    };
    ;
      
    this.gridster.drag_api.get_offset = function(e) {

        var $window = $(self.el).closest(".project-container")
        //var $window = $(window)
        e.preventDefault();
        var mouse_actual_pos = this.get_mouse_pos(e);
        var diff_x = Math.round(
            mouse_actual_pos.left - this.mouse_init_pos.left);
        var diff_y = Math.round(mouse_actual_pos.top - this.mouse_init_pos.top);

        var left = Math.round(this.el_init_offset.left +
            diff_x - this.baseX + $window.scrollLeft() - this.win_offset_x);
        var top = Math.round(this.el_init_offset.top +
            diff_y - this.baseY + $window.scrollTop() - this.win_offset_y);

        //THIS should not be performed!!!
        //but then there are some isues when going to the right... :(
        /*
        if (this.options.limit) {
            if (left > this.player_max_left) {
                left = this.player_max_left;
            } else if(left < this.player_min_left) {
                left = this.player_min_left;
            }
        }
        */
        return {
            position: {
                left: left,
                top: top
            },
            pointer: {
                left: mouse_actual_pos.left,
                top: mouse_actual_pos.top,
                diff_left: diff_x + ($window.scrollLeft() - this.win_offset_x),
                diff_top: diff_y + ($window.scrollTop() - this.win_offset_y)
            }
        };
      };
    ;
      
      this.gridster.drag_api.on_dragstart = function(e) {
        e.preventDefault();
        var $window = $(self.el).closest(".project-container")

        if (this.is_dragging) { return this; }

        this.drag_start = this.is_dragging = true;
        var offset = this.$container.offset();
        this.baseX = Math.round(offset.left);
        this.baseY = Math.round(offset.top);
        this.initial_container_width = this.options.container_width || this.$container.width();

        if (this.options.helper === 'clone') {
            this.$helper = this.$player.clone()
                .appendTo(this.$container).addClass('helper');
            this.helper = true;
        } else {
            this.helper = false;
        }

        this.win_offset_y = $window.scrollTop();
        this.win_offset_x = $window.scrollLeft();
        this.scroll_offset_y = 0;
        this.scroll_offset_x = 0;
        this.el_init_offset = this.$player.offset();
        this.player_width = this.$player.width();
        this.player_height = this.$player.height();

        this.set_limits(this.options.container_width);

        if (this.options.start) {
            this.options.start.call(this.$player, e, this.get_drag_data(e));
        }

        return false;
    };

    ;
      
      this.gridster.add_resize_handle = function($w) {
          var append_to = this.options.resize.handle_append_to;
          //un poco chapuzero porque no miramos si $w existe o si teniamos que quitarlo de append_to...
          $w.find("."+this.resize_handle_class).remove()
          $(this.resize_handle_tpl).appendTo( append_to ? $(append_to, $w) : $w);

          return this;
      }
    ;
      
      this.gridster.on_start_drag = function(event, ui) {
        this.$helper.add(this.$player).add(this.$wrapper).addClass('dragging');

        this.highest_col = this.get_highest_occupied_cell().col;

        this.$player.addClass('player');
        this.player_grid_data = this.$player.coords().grid;
        this.placeholder_grid_data = $.extend({}, this.player_grid_data);

            //COMENTED THIS LINES:
            //Could have some ifs to do something in between (showing when something)
            //andother option is to use a "fake canvas" with some alpha...

            //this.set_dom_grid_height(this.$el.height() +
            //    (this.player_grid_data.size_y * this.min_widget_height));

            //this.set_dom_grid_width(this.cols);

        var pgd_sizex = this.player_grid_data.size_x;
        var cols_diff = this.cols - this.highest_col;

        if (this.options.autogrow_cols && cols_diff <= pgd_sizex) {
            this.add_faux_cols(Math.min(pgd_sizex - cols_diff, 1));
        }

        var colliders = this.faux_grid;
        var coords = this.$player.data('coords').coords;

        this.cells_occupied_by_player = this.get_cells_occupied(
            this.player_grid_data);
        this.cells_occupied_by_placeholder = this.get_cells_occupied(
            this.placeholder_grid_data);

        this.last_cols = [];
        this.last_rows = [];

        // see jquery.collision.js
        this.collision_api = this.$helper.collision(
            colliders, this.options.collision);

        this.$preview_holder = $('<' + this.$player.get(0).tagName + ' />', {
              'class': 'preview-holder',
              'data-row': this.$player.attr('data-row'),
              'data-col': this.$player.attr('data-col'),
              css: {
                  width: coords.width,
                  height: coords.height
              }
        }).appendTo(this.$el);

        if (this.options.draggable.start) {
          this.options.draggable.start.call(this, event, ui);
        }
    };
    ;
      
      this.gridster.set_placeholder = function(col, row) {
        var phgd = $.extend({}, this.placeholder_grid_data);
        var $nexts = this.widgets_below({
                col: phgd.col,
                row: phgd.row,
                size_y: phgd.size_y,
                size_x: phgd.size_x
            });

        // Prevents widgets go out of the grid
        var right_col = (col + phgd.size_x - 1);

        if (right_col > this.cols) {
            //ESTABA MAL, ponia (right_col-cols) ...
            col = col - (right_col - this.cols);
        }


        var moved_down = this.placeholder_grid_data.row < row;
        var changed_column = this.placeholder_grid_data.col !== col;

        this.placeholder_grid_data.col = col;
        this.placeholder_grid_data.row = row;

        this.cells_occupied_by_placeholder = this.get_cells_occupied(
            this.placeholder_grid_data);

        this.$preview_holder.attr({
            'data-row' : row,
            'data-col' : col
        });

        if (moved_down || changed_column) {
            $nexts.each($.proxy(function(i, widget) {
                this.move_widget_up(
                 $(widget), this.placeholder_grid_data.col - col + phgd.size_y);
            }, this));
        }

        var $widgets_under_ph = this.get_widgets_under_player(
            this.cells_occupied_by_placeholder);

        if ($widgets_under_ph.length) {
            $widgets_under_ph.each($.proxy(function(i, widget) {
                var $w = $(widget);
                this.move_widget_down(
                 $w, row + phgd.size_y - $w.data('coords').grid.row);
            }, this));
        }

    };
    ;
      
    this.gridster.resize_widget = function($widget, size_x, size_y, callback) {
        var wgd = $widget.coords().grid;
        var col = wgd.col;
        var max_cols = this.options.max_cols;
        var old_size_y = wgd.size_y;
        var old_col = wgd.col;
        var new_col = old_col;

        size_x || (size_x = wgd.size_x);
        size_y || (size_y = wgd.size_y);

        if (max_cols !== Infinity) {
            size_x = Math.min(size_x, max_cols - col + 1);
        }
        //MUY raro que no sirva de nada...
        //pero parece que no, y jodia mucho la performance...
        /*
        if (size_y > old_size_y) {
            this.add_faux_rows(Math.max(size_y - old_size_y, 0));
        }

        var player_rcol = (col + size_x - 1);
        if (player_rcol > this.cols) {
            this.add_faux_cols(player_rcol - this.cols);
        }
        */
       
        //ES por culpa del min_widget_width en on_resize que se redondea mal
        //QUizas ya esta bien comprovarlo aqui.
        size_x = Math.round(size_x);
        size_y = Math.round(size_y);
        
        var new_grid_data = {
            col: new_col,
            row: wgd.row,
            size_x: size_x,
            size_y: size_y
        };

        this.mutate_widget_in_gridmap($widget, wgd, new_grid_data);

        this.set_dom_grid_height();
        this.set_dom_grid_width();

        if (callback) {
            callback.call(this, new_grid_data.size_x, new_grid_data.size_y);
        }

        return $widget;
    };

    ;
      
      this.gridster.add_widget = function(html, size_x, size_y, col, row, max_size, min_size, doAnimation) {
        var pos;
        size_x || (size_x = 1);
        size_y || (size_y = 1);

        if (!col & !row) {
            pos = this.next_position(size_x, size_y);
        } else {
            pos = {
                col: col,
                row: row,
                size_x: size_x,
                size_y: size_y
            };

            this.empty_cells(col, row, size_x, size_y);
        }

        var $w = $(html).attr({
                'data-col': pos.col,
                'data-row': pos.row,
                'data-sizex' : size_x,
                'data-sizey' : size_y
            }).addClass('gs-w').appendTo(this.$el);

        if (doAnimation==true)
        {
          $w.hide();
        }



        this.$widgets = this.$widgets.add($w);

        //Esta llamada, crea un new Coords() que llama widht() y height() del $el, y hace que vaya un poco lento...
        this.register_widget($w);

        this.add_faux_rows(pos.size_y);
        //this.add_faux_cols(pos.size_x);

        if (max_size) {
            this.set_widget_max_size($w, max_size);
        }

        if (min_size) {
            this.set_widget_min_size($w, min_size);
        }

        this.set_dom_grid_width();
        this.set_dom_grid_height();

        this.drag_api.set_limits(this.cols * this.min_widget_width);
        if (doAnimation==true)
        {
          return $w.fadeIn();
        }
        else
        {
          return $w;
        }

    };
    ;
      
      this.gridster.remove_widget_to_limbo = function(el, silent, callback) {
        var $el = el instanceof $ ? el : $(el);
        var wgd = $el.coords().grid;

        // if silent is a function assume it's a callback
        if ($.isFunction(silent)) {
            callback = silent;
            silent = false;
        }

        this.cells_occupied_by_placeholder = {};
        this.$widgets = this.$widgets.not($el);

        var $nexts = this.widgets_below($el);

        this.remove_from_gridmap(wgd);

        //$el.fadeOut($.proxy(function() {
            //$el.remove();

        if (!silent) {
            $nexts.each($.proxy(function(i, widget) {
                this.move_widget_up( $(widget), wgd.size_y );
            }, this));
        }

        this.set_dom_grid_height();
        _.defer(function() {
            if (callback) {
                callback.call(this, el);
            }
        });
        //}, this));

        return this;
    };

    ;
      
    this.gridster.register_widget = function($el) {
        var isDOM = $el instanceof jQuery;
        var wgd = isDOM ? this.dom_to_coords($el) : $el;
        var posChanged = false;
        isDOM || ($el = wgd.el);

        var empty_upper_row = this.can_go_widget_up(wgd);
        if (empty_upper_row) {
            wgd.row = empty_upper_row;
            $el.attr('data-row', empty_upper_row);
            this.$el.trigger('gridster:positionchanged', [wgd]);
            posChanged = true;
        }

        if (this.options.avoid_overlapped_widgets &&
            !this.can_move_to(
             {size_x: wgd.size_x, size_y: wgd.size_y}, wgd.col, wgd.row)
        ) {
            $.extend(wgd, this.next_position(wgd.size_x, wgd.size_y));
            $el.attr({
                'data-col': wgd.col,
                'data-row': wgd.row,
                'data-sizex': wgd.size_x,
                'data-sizey': wgd.size_y
            });
            posChanged = true;
        }

        //En vez de crear el coords, con $el.coords() lo creamos "a mano" para no tener que llamar wdith(), height(), que tardan mucho... (100ms vs 5ms)
        //NO VA BIEN; pero no creo que sea esto... (efetivamente, en versiones antigguas tambien hace cosas raras a veces..)!!!!!


        var coords = new GridsterCoords([{
          left:wgd.col*this.min_widget_width,
          top:wgd.row*this.min_widget_width,
          width:wgd.size_x*this.min_widget_width,
          height:wgd.size_y*this.min_widget_width
        }]);
        coords.el = $el
        coords.coords.el = $el
        $el.data('coords',coords);

        /*
        //attach Coord object to player data-coord attribute
        $el.data('coords', $el.coords());
        */

        // Extend Coord object with grid position info
        $el.data('coords').grid = wgd;

        this.add_to_gridmap(wgd, $el);

        this.options.resize.enabled && this.add_resize_handle($el);

        return posChanged;
    };
    ;
      
    this.gridster.set_dom_grid_height = function(height) {
        if (typeof height === 'undefined') {
            var r = this.get_highest_occupied_cell().row;
            height = r * this.min_widget_height;
        }
        //Aadido esto para que el header se haga pequeo cuando lo dejamos vacio!
        if (height < 0)
        {
            height = 0;
        }
        this.container_height = height;
        this.$el.css('height', this.container_height);
        return this;
    };
    ;
      return this.resizeGridster = _.throttle(this._resizeGridster, 400);
    };

    PageView.prototype.loadSettings = function() {
      this.MARGINS = LayoutUtils.scrapPx(this.layoutSettings.margins);
      this.SIDE_MARGINS = LayoutUtils.scrapPx(this.layoutSettings.sideMargins);
      this.SPACE_WIDTH = LayoutUtils.scrapPx(this.layoutSettings.maxWidth);
      this.SPACE_HEIGHT = LayoutUtils.scrapPx(this.layoutSettings.height);
      this.MAX_WIDTH = LayoutUtils.scrapPx(this.layoutSettings.maxWidth);
      this.MIN_WIDTH = LayoutUtils.scrapPx(this.layoutSettings.minWidth);
      this.MIN_HEIGHT = LayoutUtils.scrapPx(this.layoutSettings.minHeight);
      this.FOREGROUND_COLOR = this.layoutSettings.foregroundColor;
      this.MAX_COLS = this.layoutSettings.numCols;
      this.MAX_ROWS = this.layoutSettings.numRows;
      this.MAX_COLS = Math.floor(this.MAX_COLS);
      this.BASE_DIMENSIONS = ((this.SPACE_WIDTH - 2 * this.SIDE_MARGINS) / this.MAX_COLS) * (1 - 2 * this.MARGINS / 100);
      if (this.model.get("id") === "_headerPage") {
        this.MIN_HEIGHT = this.BASE_DIMENSIONS;
        return this.FOREGROUND_COLOR = this.model.get("foregroundColor");
      }
    };

    PageView.prototype.updateGridsterSettings = function(layoutSettings) {
      var oldSettings;
      if (layoutSettings != null) {
        this.layoutSettings = layoutSettings;
      }
      oldSettings = {
        "old_dimensions_x": this.gridster.options.widget_base_dimensions[0],
        "old_dimensions_y": this.gridster.options.widget_base_dimensions[1],
        "old_cols": this.gridster.options.max_cols
      };
      this.layoutSettings = LayoutUtils.validateLayoutSettings(this.layoutSettings);
      this.loadSettings();
      this._resizeGridster();
      this.updateCanvas();
      return this.setGridSizes(this.layoutSettings, oldSettings);
    };

    PageView.prototype.updateBackground = function() {
      this.loadSettings(this.layoutSettings);
      return this.updateCanvas();
    };

    PageView.prototype.getGridsterConfig = function() {
      var marginx, marginy, newWidth, result, x_dimension, y_dimension;
      newWidth = this.MAX_WIDTH - this.SIDE_MARGINS * 2;
      this.model.set("gridsterSize", {
        width: newWidth,
        height: 0
      });
      x_dimension = (newWidth / this.MAX_COLS) * (1 - 2 * this.MARGINS / 100);
      y_dimension = x_dimension;
      marginx = (newWidth / this.MAX_COLS) * this.MARGINS / 100;
      marginy = marginx;
      result = {
        x_dimension: x_dimension,
        y_dimension: y_dimension,
        marginx: marginx,
        marginy: marginy,
        max_cols: this.MAX_COLS,
        min_cols: this.MAX_COLS
      };
      return result;
    };

    PageView.prototype._resizeGridster = function() {
      var gridsterConfig;
      gridsterConfig = this.getGridsterConfig();
      return this.gridster.resize_widget_dimensions({
        widget_base_dimensions: [gridsterConfig.x_dimension, gridsterConfig.y_dimension],
        widget_margins: [gridsterConfig.marginx, gridsterConfig.marginy],
        max_cols: gridsterConfig.max_cols,
        min_cols: gridsterConfig.min_cols
      });
    };

    PageView.prototype.setGridSizes = function(gridSettings, oldSettings) {
      var old_cols, old_dimensions_x, old_dimensions_y, postLayout, preLayout, wgd, _i, _len, _results;
      old_dimensions_x = oldSettings.old_dimensions_x;
      old_dimensions_y = oldSettings.old_dimensions_y;
      old_cols = oldSettings.old_cols;
      preLayout = this.gridster.serialize();
      postLayout = [];
      _results = [];
      for (_i = 0, _len = preLayout.length; _i < _len; _i++) {
        wgd = preLayout[_i];
        /*
        if old_cols != @MAX_COLS
          wgd.size_x = Math.round( wgd.size_x*old_dimensions_x/@gridster.options.widget_base_dimensions[0] )
          wgd.size_y = Math.round( wgd.size_y*old_dimensions_y/@gridster.options.widget_base_dimensions[1] )
          wgd.col = 1+Math.round( (wgd.col-1)*old_dimensions_x/@gridster.options.widget_base_dimensions[0] )
          wgd.row = 1+Math.round( (wgd.row-1)*old_dimensions_y/@gridster.options.widget_base_dimensions[1] )
        */

        wgd.size_x = Math.min(Math.max(1, wgd.size_x), this.MAX_COLS);
        wgd.size_y = Math.max(1, wgd.size_y);
        wgd.col = Math.min(Math.max(1, wgd.col), this.MAX_COLS + 1 - wgd.size_x);
        wgd.row = Math.max(1, wgd.row);
        _results.push(this.setVizFrame(wgd, {
          forceRedraw: true
        }));
      }
      return _results;
    };

    PageView.prototype.updateCanvas = function(options) {
      var canvasHeight, canvasWidth,
        _this = this;
      options || (options = {});
      /*
      if !@gridster
        return
      */

      if (!this.readyToUpdate) {
        return;
      }
      if (this.model.get("gridsterSize") == null) {
        this.model.set("gridsterSize", {
          height: 0,
          width: this.SPACE_WIDTH
        });
      }
      canvasWidth = this.model.get("gridsterSize").width;
      if (this.gridster == null) {
        canvasHeight = this.model.get("actualSize").height;
      } else {
        canvasHeight = this.gridster.container_height;
      }
      if (canvasHeight === 0) {
        canvasHeight = this.MIN_HEIGHT;
      }
      if (canvasHeight < this.MIN_HEIGHT) {
        canvasHeight = this.MIN_HEIGHT;
      }
      this.model.set("gridsterSize", {
        width: canvasWidth,
        height: canvasHeight
      });
      return _.defer(function() {
        return _this.updateAfterAllGridsters(options);
      });
    };

    PageView.prototype.updateAfterAllGridsters = function(options) {
      var $canvasContainer, canvasHeight, canvasWidth,
        _this = this;
      canvasWidth = this.model.get("gridsterSize").width + this.SIDE_MARGINS * 2;
      canvasHeight = this.model.get("gridsterSize").height;
      quadrigram.router.appViews.projectView.layoutManager.updatePageSizes();
      canvasHeight = Math.max(this.minSize.height, canvasHeight);
      if (this.layoutSettings.heightMode === "Fixed" && this.model.get("id") !== "_headerPage") {
        canvasHeight = String(this.layoutSettings.height).replace("px", "");
      }
      this.model.set("actualSize", {
        width: canvasWidth,
        height: canvasHeight
      });
      this.canvasSize = {
        width: canvasWidth,
        height: canvasHeight
      };
      $canvasContainer = this.$el.find(".canvas-container");
      if (options.silent) {
        $canvasContainer.addClass("notransition");
      }
      $canvasContainer.css({
        "width": canvasWidth,
        "height": canvasHeight,
        "background": this.FOREGROUND_COLOR
      });
      $canvasContainer.find(".layout-guides-container").css({
        "width": canvasWidth - this.SIDE_MARGINS * 2,
        "margin-left": this.SIDE_MARGINS
      });
      this.$el.find(".gridster").css({
        "margin-left": this.SIDE_MARGINS
      });
      _.defer(function() {
        return $canvasContainer.removeClass("notransition");
      });
      this.$el.closest(".pages-collection-container").css("width", canvasWidth);
      if (!this.lastSize || canvasWidth !== this.lastSize.width || canvasHeight !== this.lastSize.height || this.lastSize.maxCols !== this.MAX_COLS || this.lastSize.sideMargins !== this.SIDE_MARGINS) {
        this.lastSize = {
          width: canvasWidth,
          height: canvasHeight,
          maxCols: this.MAX_COLS,
          sideMargins: this.SIDE_MARGINS
        };
        this.resizeGuides();
        if (!options.silent) {
          return this.trigger("canvasUpdated");
        }
      }
    };

    PageView.prototype.getLowestPointOfSortedFrameArray = function(array) {
      var frame, result, _i, _len;
      result = 0;
      for (_i = 0, _len = array.length; _i < _len; _i++) {
        frame = array[_i];
        if (frame.row + frame.size_y - 1 > result) {
          result = frame.row + frame.size_y - 1;
        }
      }
      return result;
    };

    PageView.prototype.disable = function() {
      if (this.gridster != null) {
        this.gridster.disable();
        return this.gridster.disable_resize();
      }
    };

    PageView.prototype.enable = function() {
      if (this.gridster != null) {
        this.gridster.enable();
        return this.gridster.enable_resize();
      }
    };

    PageView.prototype.changeEnd = function(el) {
      if (this.skipChanges === true) {
        return;
      }
      this.trigger("change:viz-frame", el.attr("hidden"));
      if (el.attr("hidden")) {
        return el.removeAttr("hidden");
      }
    };

    PageView.prototype.dragStart = function(e, ui) {
      this.currentDragTarget = ui;
      this.$el.find('.layout-guides-container').addClass("dragging");
      ui.$helper.find(".viz-container").addClass("dragging");
      this.$el.find(".temp-background").css("background-color", this.FOREGROUND_COLOR);
      $(window).trigger("viz:dragging");
      return this.trigger("startdrag", this);
    };

    PageView.prototype.drag = function(e, ui) {
      var el,
        _this = this;
      el = ui.$helper;
      this.changing(el);
      if (this.intervalTrigger) {
        window.clearInterval(this.intervalTrigger);
      }
      this.intervalTrigger = window.setInterval(function() {
        return _this.checkScroll(e, ui);
      }, 100);
      return this.trigger("drag", {
        x: e.clientX,
        y: e.clientY
      });
    };

    PageView.prototype.dragEnd = function(e, ui) {
      var el,
        _this = this;
      if (this.intervalTrigger) {
        window.clearInterval(this.intervalTrigger);
      }
      e.stopImmediatePropagation();
      el = ui.$helper;
      this.$el.find('.layout-guides-container').removeClass("dragging");
      _.defer(function() {
        return ui.$helper.find(".viz-container").removeClass("dragging");
      });
      this.$el.find(".temp-background").css("background-color", "transparent");
      this.changeEnd(el);
      ui.$player.find(".viz-container .viz-view").css({
        "opacity": 1
      });
      ui.$player.find(".viz-container .viz-drag-icon").remove();
      return _.defer(function() {
        _this.trigger("stopdrag", {
          x: e.clientX,
          y: e.clientY
        });
        return _this.currentDragTarget = null;
      });
    };

    PageView.prototype.resizeStart = function(e, ui) {
      this.$el.find('.layout-guides-container').addClass("resizing");
      this.$el.find(".temp-background").css("background-color", this.FOREGROUND_COLOR);
      ui.$helper.closest("li").find(".viz-container").addClass("resizing");
      $(window).trigger("viz:dragging");
      return this.trigger("startdrag", this);
    };

    PageView.prototype.resize = function(e, ui) {
      var el;
      el = $(ui.$helper.closest("li"));
      return el.trigger('qresize');
    };

    PageView.prototype.resizeEnd = function(e, ui) {
      var el;
      el = $(ui.$helper.closest("li"));
      this.$el.find('.layout-guides-container').removeClass("resizing");
      this.$el.find(".temp-background").css("background-color", "transparent");
      /*
      _.delay( () ->
          # log el
          el.trigger('resizeEnd')
        , 500, el)
      */

      el.trigger('qresizeEnd');
      return this.changeEnd(el);
    };

    PageView.prototype.checkScroll = function(e, ui) {
      var data;
      data = this.gridster.drag_api.get_drag_data(e);
      return this.gridster.drag_api.manage_scroll(data);
    };

    PageView.prototype.changing = function(el) {};

    PageView.prototype.addVisualizer = function(model, previousEl) {
      var col, doAnimation, gridsterConfig, h, result, row, size_x, size_y, w, x, y;
      row = model.getProperty("row").getValues();
      col = model.getProperty("col").getValues();
      if (model.getProperty("size_x").getValues() && model.getProperty("size_y").getValues()) {
        size_x = Math.min(this.MAX_COLS, model.getProperty("size_x").getValues());
        size_y = model.getProperty("size_y").getValues();
      } else {
        size_x = Math.floor(this.MAX_COLS / 2);
        if (size_x * this.gridster.min_widget_width < 300) {
          size_x = Math.min(this.MAX_COLS, Math.floor(300 / this.gridster.min_widget_width));
        }
        if (size_x * this.gridster.min_widget_width > 800) {
          size_x = Math.min(this.MAX_COLS, Math.floor(800 / this.gridster.min_widget_width));
        }
        size_y = Math.min(this.MAX_COLS, Math.round(size_x * 0.62));
      }
      if (model.addMode != null) {
        doAnimation = true;
      }
      if (quadrigram.environment === "exported") {
        gridsterConfig = this.getGridsterConfig();
        result = $('<li class="gridster-item" viz-id=' + model.id + '/>');
        result.css("position", "absolute");
        x = gridsterConfig.marginx + (col - 1) * (gridsterConfig.x_dimension + 2 * gridsterConfig.marginx);
        y = gridsterConfig.marginy + (row - 1) * (gridsterConfig.y_dimension + 2 * gridsterConfig.marginy);
        w = size_x * (gridsterConfig.x_dimension + 2 * gridsterConfig.marginx) - 2 * gridsterConfig.marginx;
        h = size_y * (gridsterConfig.y_dimension + 2 * gridsterConfig.marginy) - 2 * gridsterConfig.marginy;
        result.css("width", w);
        result.css("height", h);
        result.css("left", x);
        result.css("top", y);
        this.$el.find(".gridster").append(result);
      } else {
        if (previousEl != null) {
          result = this.gridster.add_widget(previousEl, +size_x, +size_y, +col, +row, null, null, doAnimation);
        } else {
          result = this.gridster.add_widget('<li class="gridster-item" viz-id=' + model.id + '/>', +size_x, +size_y, +col, +row, null, null, doAnimation);
        }
      }
      this.updateCanvas();
      return result;
    };

    PageView.prototype.removeVisualizer = function(model, callback) {
      var $widget;
      $widget = this.gridster.$widgets.filter("[viz-id='" + model.get("id") + "']");
      this.gridster.remove_widget($widget, callback);
      return setTimeout(this.updateCanvas, 500);
    };

    PageView.prototype.removeToLimbo = function(model, callback) {
      var $widget;
      $widget = this.gridster.$widgets.filter("[viz-id='" + model.get("id") + "']");
      this.gridster.remove_widget_to_limbo($widget, callback);
      return setTimeout(this.updateCanvas, 500);
    };

    PageView.prototype.serialize = function(pageIndex) {
      var result, w, _i, _len;
      result = this.gridster.serialize();
      for (_i = 0, _len = result.length; _i < _len; _i++) {
        w = result[_i];
        w.page = this.model.get("id");
      }
      return result;
    };

    PageView.prototype.redrawFrames = function(layoutData) {
      var candidate, vizModel, w, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2,
        _this = this;
      _ref1 = this.gridster.$widgets;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        w = _ref1[_i];
        candidate = _.find(layoutData, function(ld) {
          return ld.vizID === $(w).attr("viz-id");
        });
        if (candidate == null) {
          $(w).stop();
          $(w).css("opacity", "0");
        }
      }
      _ref2 = this.gridster.$widgets;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        w = _ref2[_j];
        this.gridster.remove_from_gridmap(w);
      }
      for (_k = 0, _len2 = layoutData.length; _k < _len2; _k++) {
        vizModel = layoutData[_k];
        if (vizModel.page === this.model.get("id")) {
          this.setVizFrame(vizModel);
        }
      }
      return _.defer(function() {
        return _this.updateCanvas();
      });
    };

    PageView.prototype.setVizFrame = function(wgd, options) {
      var $widget,
        _this = this;
      $widget = this.gridster.$widgets.filter("[viz-id='" + wgd.vizID + "']");
      if ($widget.length > 0) {
        if (((options != null) && options.forceRedraw) || this.comparareWgdSizes(wgd, $widget.coords().grid) === false) {
          $widget.trigger('qresize');
          _.delay(function() {
            return $widget.trigger('qresizeEnd');
          }, 300);
        }
        $widget.trigger('parentChange');
        return this.gridster.mutate_widget_in_gridmap($widget, $widget.coords().grid, wgd);
      } else {

      }
    };

    PageView.prototype.comparareWgdSizes = function(wgdA, wgdB) {
      if (wgdA.size_x !== wgdB.size_x) {
        return false;
      }
      if (wgdA.size_y !== wgdB.size_y) {
        return false;
      }
      return true;
    };

    PageView.prototype.resizeGuides = function() {
      var $guidesContainer,
        _this = this;
      $guidesContainer = this.$el.find(".layout-guides-container");
      /*
      $guidesContainer.css(
        "width":  @model.get("gridsterSize").width
        "height": @model.get("gridsterSize").height
      )
      */

      $guidesContainer.css({
        "width": this.canvasSize.width - this.SIDE_MARGINS * 2,
        "height": this.canvasSize.height
      });
      if (quadrigram.environment === "editor") {
        return setTimeout(function() {
          return _this.drawGuides(_this.canvasSize.width - _this.SIDE_MARGINS * 2, _this.canvasSize.height);
        }, 100);
      }
    };

    PageView.prototype.drawGuides = function(actualWidth, actualHeight) {
      var ROWS, ROW_WIDTH, i, marginX, marginY, newColor, widgetHeight, widgetWidth, _i, _j, _ref1,
        _this = this;
      widgetWidth = this.gridster.min_widget_width;
      widgetHeight = this.gridster.min_widget_height;
      marginX = this.gridster.options.widget_margins[0];
      marginY = this.gridster.options.widget_margins[1];
      ROW_WIDTH = actualWidth;
      this.$el.find('.layout-cols').empty();
      for (i = _i = 0, _ref1 = this.MAX_COLS; _i < _ref1; i = _i += 1) {
        this.$el.find('.layout-cols').append("<div class='layout-col'></div>");
      }
      ROWS = Math.ceil(actualHeight / widgetHeight);
      this.$el.find('.layout-rows').empty();
      for (i = _j = 0; _j < ROWS; i = _j += 1) {
        this.$el.find('.layout-rows').append("<div class='layout-row'></div>");
      }
      this.$el.find('.layout-cols').css("width", actualWidth);
      this.$el.find('.layout-rows').css("width", actualWidth);
      /*
      safeMargin = widgetWidth*@MARGINS/100
      if @MARGINS == 0
        safeMargin = 1
      */

      if (marginX === 0) {
        marginX = 1;
      }
      if (marginY === 0) {
        marginY = 1;
      }
      _.each($('.layout-row'), function(el, k) {
        var topPos;
        topPos = k * (widgetHeight + (2 * marginY));
        return $(el).css({
          "width": actualWidth - 2 * marginX,
          "height": widgetHeight - 2 * marginY,
          "margin": marginX,
          "margin-top": marginY,
          "margin-bottom": marginY * 2,
          "top": topPos
        });
      });
      if (d3.rgb(this.FOREGROUND_COLOR).hsl().l === 0) {
        newColor = "#444";
      } else if (d3.rgb(this.FOREGROUND_COLOR).hsl().l > 0.1) {
        newColor = d3.rgb(this.FOREGROUND_COLOR).darker(1).toString();
      } else {
        newColor = d3.rgb(this.FOREGROUND_COLOR).brighter(0.1).toString();
      }
      this.$el.find(".layout-col").css("background-color", newColor);
      this.$el.find(".layout-row").css("background-color", newColor);
      return this.$el.find('.layout-col').css({
        width: widgetWidth - 2 * marginX,
        margin: marginX
      });
    };

    return PageView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Managers.PageCollectionView = (function(_super) {
    __extends(PageCollectionView, _super);

    function PageCollectionView() {
      this.getRealSize = __bind(this.getRealSize, this);
      this.getCurrentPage = __bind(this.getCurrentPage, this);
      this.updatePageButtons = __bind(this.updatePageButtons, this);
      this.updateWatermark = __bind(this.updateWatermark, this);
      this.resizeHeader = __bind(this.resizeHeader, this);
      this.updatePageSizes = __bind(this.updatePageSizes, this);
      this.canvasDidUpdate = __bind(this.canvasDidUpdate, this);
      this.detachDragged = __bind(this.detachDragged, this);
      this.beginDrag = __bind(this.beginDrag, this);
      this.destroy = __bind(this.destroy, this);
      this.redrawFrames = __bind(this.redrawFrames, this);
      this.serialize = __bind(this.serialize, this);
      this.removeVisualizer = __bind(this.removeVisualizer, this);
      this.addVisualizer = __bind(this.addVisualizer, this);
      this.enable = __bind(this.enable, this);
      this.disable = __bind(this.disable, this);
      this.updateBackgrounds = __bind(this.updateBackgrounds, this);
      this.updatePagesSettings = __bind(this.updatePagesSettings, this);
      this.updateLayoutSettings = __bind(this.updateLayoutSettings, this);
      this.setLoaded = __bind(this.setLoaded, this);
      this.set = __bind(this.set, this);
      this.adjustProjectHeight = __bind(this.adjustProjectHeight, this);
      this.oneSlideTransition = __bind(this.oneSlideTransition, this);
      this.slideTransition = __bind(this.slideTransition, this);
      this.reloadTransition = __bind(this.reloadTransition, this);
      this.startTransition = __bind(this.startTransition, this);
      this.transitionPages = __bind(this.transitionPages, this);
      this.gotoPage = __bind(this.gotoPage, this);
      this.gotoViz = __bind(this.gotoViz, this);
      this.navigateToPage = __bind(this.navigateToPage, this);
      this.gotoNextPage = __bind(this.gotoNextPage, this);
      this.gotoPrevPage = __bind(this.gotoPrevPage, this);
      this.getRealPagesArray = __bind(this.getRealPagesArray, this);
      this.findPage = __bind(this.findPage, this);
      this.isInside = __bind(this.isInside, this);
      this.handleVizDragStop = __bind(this.handleVizDragStop, this);
      this.moveAddIcon = __bind(this.moveAddIcon, this);
      this.toggleAddIcon = __bind(this.toggleAddIcon, this);
      this.handleVizDrag = __bind(this.handleVizDrag, this);
      this.handleVizDragStart = __bind(this.handleVizDragStart, this);
      this.onChangeVizFrame = __bind(this.onChangeVizFrame, this);
      this.removePage = __bind(this.removePage, this);
      this.addPage = __bind(this.addPage, this);
      this.pageRemoved = __bind(this.pageRemoved, this);
      this.pageAdded = __bind(this.pageAdded, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.afterFirstRender = __bind(this.afterFirstRender, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = PageCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PageCollectionView.prototype.template = JST['app/scripts/templates/PageCollection.hbs'];

    PageCollectionView.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    PageCollectionView.prototype.viewWillRender = function() {
      this.pages = [];
      this.layoutSettings = this.model.get("layout-settings");
      this.pagesSettings = this.model.get("pages-settings");
      return this.borderReady = true;
    };

    PageCollectionView.prototype.viewDidRender = function() {
      var p, _i, _len, _ref1,
        _this = this;
      this.pagesToRender = this.model.get("pagesCollection").models.length;
      _ref1 = this.model.get("pagesCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        this.addPage(p);
      }
      if (quadrigram.environment === "exported") {
        $(document).on("keydown", function(e) {
          if (e.keyCode === 37) {
            return _this.gotoPrevPage();
          } else if (e.keyCode === 39) {
            return _this.gotoNextPage();
          }
        });
      }
      this.model.get("pagesCollection").on("add", this.pageAdded);
      this.model.get("pagesCollection").on("remove", this.pageRemoved);
      this.$el.on("mousemove", function(e) {
        _this.lastMouse || (_this.lastMouse = {});
        _this.lastMouse.x = e.clientX;
        return _this.lastMouse.y = e.clientY;
      });
      return _.defer(function() {
        _this.trigger("pagesAdded");
        _this.afterFirstRender();
        return _.defer(function() {
          return _this.trigger("pagesRendered");
        });
      });
    };

    PageCollectionView.prototype.afterFirstRender = function() {
      var p, _i, _len, _ref1, _results;
      this.readyToUpdate = true;
      _ref1 = this.pages;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        p.readyToUpdate = this.readyToUpdate;
        _results.push(p.updateCanvas({
          silent: true
        }));
      }
      return _results;
    };

    PageCollectionView.prototype.viewWillRemove = function() {
      this.$el.off("mousemove");
      this.model.get("pagesCollection").off("add", this.pageAdded);
      return this.model.get("pagesCollection").off("remove", this.pageRemoved);
    };

    PageCollectionView.prototype.pageAdded = function(p) {
      return this.addPage(p);
    };

    PageCollectionView.prototype.pageRemoved = function(p, collection, options) {
      return this.removePage(p, collection, options);
    };

    PageCollectionView.prototype.addPage = function(p) {
      var container, isHeader, pageView;
      if (p.get("id") === "_headerPage") {
        isHeader = true;
      }
      if (isHeader) {
        container = this.$el.find(".header-page-container");
      } else {
        container = this.$el.find(".hidden-pages-container");
      }
      pageView = new quadrigram.Views.PageView({
        model: p
      });
      pageView.layoutSettings = this.layoutSettings;
      container.append(pageView.$el);
      pageView.render();
      pageView.on("change:viz-frame", this.onChangeVizFrame);
      pageView.on("startdrag", this.handleVizDragStart);
      pageView.on("drag", this.handleVizDrag);
      pageView.on("stopdrag", this.handleVizDragStop);
      if (isHeader) {
        pageView.on("canvasUpdated", this.canvasDidUpdate);
        this.headerPage = pageView;
      } else {
        pageView.on("canvasUpdated", this.canvasDidUpdate);
      }
      this.pages.push(pageView);
      return pageView.readyToUpdate = this.readyToUpdate;
    };

    PageCollectionView.prototype.removePage = function(p, collection, options) {
      var isHeader, newIndex, newPageId, pageView, realPages,
        _this = this;
      if (p.get("id") === "_headerPage") {
        isHeader = true;
      }
      pageView = this.findPage(p.get("id"));
      pageView.off("drag", this.handleVizDrag);
      pageView.off("startdrag", this.handleVizDragStart);
      pageView.off("change:viz-frame", this.onChangeVizFrame);
      pageView.off("render");
      pageView.off("stopdrag", this.handleVizDragStop);
      pageView.off("canvasUpdated");
      if (this.activePage === pageView) {
        realPages = this.getRealPagesArray();
        newIndex = Math.max(0, Math.min(realPages.length - 1, options.index));
        newPageId = realPages[newIndex].get("id");
        this.removedLastIndex = options.index;
        this.navigateToPage(newPageId);
      }
      pageView.remove();
      this.pages = $.grep(this.pages, function(value) {
        return value !== pageView;
      });
      if (isHeader) {
        this.headerPage = null;
      }
      this.canvasDidUpdate();
    };

    PageCollectionView.prototype.onChangeVizFrame = function(e) {
      return this.trigger("change:viz-frame", e);
    };

    PageCollectionView.prototype.handleVizDragStart = function(source) {
      return this.focusedPage = source;
    };

    PageCollectionView.prototype.handleVizDrag = function(pos) {
      var dropTarget, p, rect, _i, _len, _ref1;
      _ref1 = this.pages;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        rect = p.$el.find(".canvas-container")[0].getBoundingClientRect();
        if (p.$el.css("visibility") !== "hidden" && this.isInside(pos, rect)) {
          dropTarget = p;
          p.$el.addClass("drag-focus");
          p.$el.removeClass("drag-unfocus");
        } else {
          p.$el.removeClass("drag-focus");
          p.$el.addClass("drag-unfocus");
        }
      }
      if ((dropTarget == null) && (quadrigram.router.appViews.uiView != null) && (quadrigram.router.appViews.uiView.pagesToolbar != null)) {
        quadrigram.router.appViews.uiView.pagesToolbar.checkOver(pos);
      }
      if (this.focusedPage !== dropTarget) {
        this.toggleAddIcon(this.focusedPage.currentDragTarget.$player.find(".viz-container"), true);
        return this.moveAddIcon(pos);
      } else {
        return this.toggleAddIcon(this.focusedPage.currentDragTarget.$player.find(".viz-container"), false);
      }
    };

    PageCollectionView.prototype.toggleAddIcon = function(original, show) {
      if (show) {
        if (this.addIcon == null) {
          this.addIcon = $("<div class='add-to-page-icon'>+</div>");
          this.$el.closest(".mid-container").append(this.addIcon);
          return original.css("display", "none");
        }
      } else {
        if (this.addIcon != null) {
          this.addIcon.remove();
          this.addIcon = null;
          return original.css("display", "block");
        }
      }
    };

    PageCollectionView.prototype.moveAddIcon = function(pos) {
      this.addIcon.css("left", pos.x - 10);
      return this.addIcon.css("top", pos.y - 30 - 10);
    };

    PageCollectionView.prototype.handleVizDragStop = function(pos) {
      var dropModel, dropTarget, p, rect, _i, _len, _ref1;
      this.toggleAddIcon(this.focusedPage.currentDragTarget.$player.find(".viz-container"), false);
      this.focusedPage.currentDragTarget.$player.find(".viz-container").css("opacity", "0");
      _ref1 = this.pages;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        rect = p.$el.find(".canvas-container")[0].getBoundingClientRect();
        p.$el.removeClass("drag-focus");
        if (p.$el.css("visibility") !== "hidden" && this.isInside(pos, rect)) {
          dropTarget = p;
          if (this.focusedPage !== dropTarget) {
            this.focusedPage = dropTarget;
            this.detachDragged();
          }
        }
      }
      if ((quadrigram.router.appViews.uiView != null) && (quadrigram.router.appViews.uiView.pagesToolbar != null)) {
        dropModel = quadrigram.router.appViews.uiView.pagesToolbar.checkOver(pos);
        if (dropModel != null) {
          dropTarget = this.findPage(dropModel.get("id"));
          this.focusedPage = dropTarget;
          this.detachDragged();
        }
      }
      if (this.focusedPage.currentDragTarget != null) {
        return this.focusedPage.currentDragTarget.$player.find(".viz-container").css("opacity", "1");
      }
    };

    PageCollectionView.prototype.isInside = function(p, rect) {
      return p.x > rect.left && p.x < rect.right && p.y > rect.top && p.y < rect.bottom;
    };

    /*
    checkTransit:(pos)=>
      #log "child dragging",pos
      if pos.x>1200
        if !@borderInterval?
          if @borderReady
            @borderInterval = window.setInterval(()=>
              @borderReady=false
              @gotoNextPage()
              window.clearInterval(@borderInterval)
            ,300)
      else if pos.x<80
        if !@borderInterval?
          if @borderReady
            @borderInterval = window.setInterval(()=>
              @borderReady=false
              @gotoPrevPage()
              window.clearInterval(@borderInterval)
            ,300)
      else
        @borderReady = true
        window.clearInterval(@borderInterval)
        @borderInterval = null
    */


    PageCollectionView.prototype.findPage = function(pageId) {
      var p, _i, _j, _len, _len1, _ref1, _ref2;
      _ref1 = this.pages;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.model.get("label") === pageId) {
          return p;
        }
      }
      _ref2 = this.pages;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        p = _ref2[_j];
        if (p.model.get("id") === pageId) {
          return p;
        }
      }
      return null;
    };

    PageCollectionView.prototype.getRealPagesArray = function() {
      var headerPageModel, realPages;
      headerPageModel = _.findWhere(this.model.get("pagesCollection").models, {
        "id": "_headerPage"
      });
      realPages = _.without(this.model.get("pagesCollection").models, headerPageModel);
      return realPages;
    };

    PageCollectionView.prototype.gotoPrevPage = function() {
      var newId, newIndex, realPages;
      realPages = this.getRealPagesArray();
      newIndex = realPages.indexOf(this.activePage.model) - 1;
      if (newIndex < 0) {
        return false;
      }
      newId = realPages[newIndex].get("id");
      if (newId === "_headerPage") {
        return false;
      }
      this.navigateToPage(newId);
      return true;
    };

    PageCollectionView.prototype.gotoNextPage = function() {
      var newId, newIndex, realPages;
      realPages = this.getRealPagesArray();
      newIndex = realPages.indexOf(this.activePage.model) + 1;
      if (newIndex > realPages.length - 1) {
        return false;
      }
      newId = realPages[newIndex].get("id");
      if (newId === "_headerPage") {
        return false;
      }
      this.navigateToPage(newId);
      return true;
    };

    PageCollectionView.prototype.navigateToPage = function(pageId) {
      var newLabel, pageModel;
      pageModel = this.model.get("pagesCollection").findWhere({
        "id": pageId
      });
      if (pageModel) {
        newLabel = pageModel.get("label");
        quadrigram.router.navigate("#p/" + newLabel, {
          trigger: true
        });
        return;
      }
      pageModel = this.model.get("pagesCollection").findWhere({
        "label": pageId
      });
      if (pageModel) {
        newLabel = pageModel.get("label");
        quadrigram.router.navigate("#p/" + newLabel, {
          trigger: true
        });
      }
    };

    PageCollectionView.prototype.gotoViz = function(vizLabel) {
      var scrollTo, vizEl, vizModel,
        _this = this;
      log("should scroll to viz", vizLabel);
      vizModel = _.find(quadrigram.router.dataModels.currentProject.get("visualizersCollection").models, function(viz) {
        return viz.get("blockGroup").get("label") === vizLabel;
      });
      if (vizModel == null) {
        elog("visualizer with label " + vizLabel + " does not exist!");
        return;
      }
      if (vizModel.getProperty("page").getValues() === this.activePage.model.get("id")) {
        vizEl = this.activePage.$el.find("[viz-id=" + vizModel.get("id") + "]");
        scrollTo = -$(".pages-container").offset().top + vizEl.offset().top;
        if (quadrigram.router.getDevice() !== "Desktop") {
          return $("body").animate({
            scrollTop: scrollTo + "px"
          });
        } else {
          return $(".project-container").animate({
            scrollTop: scrollTo + "px"
          });
        }
      } else {
        this.gotoPage(vizModel.getProperty("page").getValues());
        return this.gotoViz(vizLabel);
      }
    };

    PageCollectionView.prototype.gotoPage = function(pageId) {
      var lastPage, newId, newPage,
        _this = this;
      newPage = this.findPage(pageId);
      if (pageId === "_headerPage") {
        elog("can't navigate to header!");
        return false;
      }
      if (newPage == null) {
        newId = this.model.get("pagesCollection").models[0].get("label");
        quadrigram.router.navigate("#p/" + newId, {
          trigger: true
        });
        return false;
      }
      if (!this.activePage) {
        this.activePage = newPage;
      }
      lastPage = this.activePage;
      this.transitionPages(lastPage, newPage, this.pagesSettings.transitionType, this.adjustProjectHeight);
      this.activePage = newPage;
      this.updatePageButtons();
      _.delay(function() {
        return $(".project-content").removeClass("preload");
      }, 500);
      return this.trigger("pageChanged");
    };

    PageCollectionView.prototype.transitionPages = function(lastPage, newPage, type, endCallback) {
      var _this = this;
      $('div.qtip:visible').qtip('hide');
      if (lastPage === newPage) {
        this.$el.find(".pages-container").append(newPage.$el);
        _.defer(function() {
          return endCallback();
        });
        return;
      }
      return this.startTransition(lastPage, newPage, type, endCallback);
    };

    PageCollectionView.prototype.startTransition = function(lastPage, newPage, type, endCallback) {
      var _this = this;
      if (this.transitioning === true) {
        this.queuedTransition = function(newlastpage) {
          return _this.startTransition(newlastpage, newPage, type, endCallback);
        };
        return;
      }
      if (type === "reload") {
        return this.reloadTransition(lastPage, newPage, endCallback);
      } else if (type === "slide") {
        return this.slideTransition(lastPage, newPage, endCallback);
      } else {
        return this.slideTransition(lastPage, newPage, endCallback);
      }
    };

    PageCollectionView.prototype.reloadTransition = function(lastPage, newPage, endCallback) {
      var _this = this;
      this.transitioning = false;
      lastPage.$el.css("left", 0);
      newPage.$el.css("left", 0);
      this.$el.find(".pages-container").append(newPage.$el);
      this.$el.find(".hidden-pages-container").append(lastPage.$el);
      return _.defer(function() {
        return endCallback();
      });
    };

    PageCollectionView.prototype.slideTransition = function(lastPage, newPage, endCallback, firstOrLast) {
      var direction, interPage, lastIndex, newIndex, realPages, steps,
        _this = this;
      realPages = this.getRealPagesArray();
      lastIndex = realPages.indexOf(lastPage.model);
      newIndex = realPages.indexOf(newPage.model);
      if (lastIndex < 0) {
        if (newIndex === realPages.length - 1) {
          lastIndex = newIndex + 1;
        } else {
          lastIndex = newIndex - 1;
        }
      }
      if (lastIndex <= newIndex) {
        direction = 1;
        steps = newIndex - lastIndex;
      } else {
        direction = -1;
        steps = lastIndex - newIndex;
      }
      if (firstOrLast == null) {
        firstOrLast = {
          "first": true,
          "last": false
        };
      }
      if (steps === 1) {
        firstOrLast.last = true;
      }
      if (steps > 0) {
        this.transitioning = true;
        interPage = this.findPage(realPages[lastIndex + direction].get("id"));
        this.$el.find(".pages-container").append(interPage.$el);
        return this.oneSlideTransition(lastPage, interPage, direction, firstOrLast, function() {
          _this.$el.find(".hidden-pages-container").append(lastPage.$el);
          firstOrLast.first = false;
          firstOrLast.last = false;
          _this.transitioning = false;
          if (_this.queuedTransition != null) {
            _this.queuedTransition(interPage);
            return _this.queuedTransition = null;
          } else {
            return _this.slideTransition(interPage, newPage, endCallback, firstOrLast);
          }
        });
      } else {
        return _.defer(function() {
          return endCallback();
        });
      }
    };

    PageCollectionView.prototype.oneSlideTransition = function(lastPage, newPage, direction, firstOrLast, callback) {
      var duration, dx, dy, easing, projectWidth, x1, x2, x3,
        _this = this;
      projectWidth = Math.max($(".project-content").width(), $(".pages-collection-container").width()) + 20;
      if (direction > 0) {
        x1 = projectWidth + "px";
        x2 = "0px";
        x3 = "-" + projectWidth + "px";
        dx = projectWidth;
        dy = 0;
      } else {
        x3 = projectWidth + "px";
        x2 = "0px";
        x1 = "-" + projectWidth + "px";
        dx = -projectWidth;
        dy = 0;
      }
      if (firstOrLast.first && firstOrLast.last) {
        duration = 700;
        easing = "easeInOutQuad";
      } else if (firstOrLast.first) {
        duration = 700;
        easing = "easeInQuad";
      } else if (firstOrLast.last) {
        duration = 700;
        easing = "easeOutQuad";
      } else {
        duration = 400;
        easing = "linear";
      }
      lastPage.$el.css("left", x2);
      newPage.$el.css("left", x1);
      newPage.$el.animate({
        "left": x2
      }, duration, easing);
      return lastPage.$el.animate({
        "left": x3
      }, duration, easing, function() {
        lastPage.$el.css("left", x2);
        return callback();
      });
    };

    PageCollectionView.prototype.adjustProjectHeight = function() {
      var pageHeight;
      if (quadrigram.router.getDevice() !== "Desktop") {
        $(".project-container").css("min-height", window.innerHeight);
        pageHeight = $(".project-container").height();
        $("body").css("height", pageHeight);
        return $("html").css("height", pageHeight);
      } else {
        return quadrigram.router.resizeProject();
      }
    };

    PageCollectionView.prototype.set = function(attr, value) {
      var p, _i, _len, _ref1, _results;
      _ref1 = this.pages;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        _results.push(p[attr] = value);
      }
      return _results;
    };

    PageCollectionView.prototype.setLoaded = function() {
      var p, _i, _len, _ref1, _results;
      _ref1 = this.pages;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        _results.push(p.updateCanvas({
          silent: true
        }));
      }
      return _results;
    };

    PageCollectionView.prototype.updateLayoutSettings = function() {
      var p, _i, _len, _ref1, _results;
      this.layoutSettings = this.model.get("layout-settings");
      _ref1 = this.pages;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        _results.push(p.updateGridsterSettings(this.layoutSettings));
      }
      return _results;
    };

    PageCollectionView.prototype.updatePagesSettings = function() {
      this.pagesSettings = this.model.get("pages-settings");
      this.canvasDidUpdate();
      return this.updatePageButtons();
    };

    PageCollectionView.prototype.updateBackgrounds = function() {
      var p, _i, _len, _ref1, _results;
      _ref1 = this.pages;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        _results.push(p.updateBackground(this.layoutSettings));
      }
      return _results;
    };

    PageCollectionView.prototype.disable = function() {
      var p, _i, _len, _ref1, _results;
      _ref1 = this.pages;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        _results.push(p.disable());
      }
      return _results;
    };

    PageCollectionView.prototype.enable = function() {
      var p, _i, _len, _ref1, _results;
      _ref1 = this.pages;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        _results.push(p.enable());
      }
      return _results;
    };

    PageCollectionView.prototype.addVisualizer = function(model) {
      var pageId, targetPage;
      pageId = model.getProperty("page").getValues();
      targetPage = this.findPage(pageId);
      if (targetPage != null) {
        return targetPage.addVisualizer(model);
      } else {
        if (this.activePage == null) {
          this.activePage = this.pages[0];
        }
        return this.activePage.addVisualizer(model);
      }
    };

    PageCollectionView.prototype.removeVisualizer = function(model) {
      var pageId, targetPage;
      pageId = model.getProperty("page").getValues();
      targetPage = this.findPage(pageId);
      if (targetPage != null) {
        return targetPage.removeVisualizer(model);
      } else {
        return elog("Error, trying to remove a viz from a gridster instance that doesnt exist!!!!");
      }
    };

    PageCollectionView.prototype.serialize = function() {
      var p, result, _i, _len, _ref1;
      result = [];
      _ref1 = this.pages;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        result = result.concat(p.serialize());
      }
      return result;
    };

    PageCollectionView.prototype.redrawFrames = function(layoutData) {
      var newLd, newPage, oldPage, p, vizModel, w, _i, _j, _len, _len1, _ref1, _ref2, _results;
      _ref1 = this.pages;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        p.redrawFrames(layoutData);
      }
      _ref2 = this.pages;
      _results = [];
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        p = _ref2[_j];
        _results.push((function() {
          var _k, _len2, _ref3, _results1,
            _this = this;
          _ref3 = p.gridster.$widgets;
          _results1 = [];
          for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
            w = _ref3[_k];
            newLd = _.find(layoutData, function(ld) {
              return ld.vizID === $(w).attr("viz-id");
            });
            if ((newLd != null) && newLd.page !== p.model.get("id")) {
              newPage = this.findPage(newLd.page);
              oldPage = p;
              vizModel = quadrigram.router.dataModels.currentProject.get("visualizersCollection").findWhere({
                "id": newLd.vizID
              });
              _results1.push(oldPage.removeToLimbo(vizModel, function(el) {
                var newLayoutData;
                newPage.addVisualizer(vizModel, el);
                if ((quadrigram.router.appViews.uiView != null) && (quadrigram.router.appViews.uiView.pagesToolbar != null)) {
                  quadrigram.router.appViews.uiView.pagesToolbar.transportViz(vizModel, oldPage.model, newPage.model);
                }
                $(el).find(".viz-container").css("opacity", "1");
                newLayoutData = Gridster.sort_by_row_asc(_this.serialize());
                _this.model.set("layoutData", newLayoutData, {
                  silent: true
                });
                return _this.model.trigger("change:layoutData");
              }));
            } else {
              _results1.push(void 0);
            }
          }
          return _results1;
        }).call(this));
      }
      return _results;
    };

    PageCollectionView.prototype.destroy = function() {
      var p, _i, _len, _ref1, _results;
      _ref1 = this.pages;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        _results.push(p.gridster.destroy(true));
      }
      return _results;
    };

    PageCollectionView.prototype.beginDrag = function(e) {
      this.activePage.gridster.drag_api.drag_handler(e);
      return this.activePage.gridster.drag_api.on_dragstart(e);
    };

    PageCollectionView.prototype.detachDragged = function() {
      var $player, newLayoutData, newPos, oldLayoutData, p, targetVizData, v, vizID, vizModel, _i, _j, _len, _len1, _ref1;
      _ref1 = this.pages;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.currentDragTarget != null) {
          $player = p.currentDragTarget.$player;
          vizID = p.currentDragTarget.$player.attr("viz-id");
          vizModel = quadrigram.router.dataModels.currentProject.get("visualizersCollection").findWhere({
            "id": vizID
          });
          oldLayoutData = quadrigram.router.dataModels.currentProject.get("layoutData");
          newLayoutData = [];
          for (_j = 0, _len1 = oldLayoutData.length; _j < _len1; _j++) {
            v = oldLayoutData[_j];
            newLayoutData.push(_.clone(v));
          }
          targetVizData = _.findWhere(newLayoutData, {
            "vizID": vizID
          });
          targetVizData.page = this.focusedPage.model.get("id");
          newPos = this.focusedPage.gridster.next_position(targetVizData.size_x, targetVizData.size_y);
          targetVizData.col = newPos.col;
          targetVizData.row = newPos.row;
          quadrigram.router.dataModels.currentProject.set("layoutData", newLayoutData);
        }
      }
    };

    PageCollectionView.prototype.canvasDidUpdate = function() {
      this.resizeHeader();
      return this.updateWatermark();
    };

    PageCollectionView.prototype.updatePageSizes = function() {
      var p, size, _i, _j, _len, _len1, _ref1, _ref2, _results, _results1;
      size = this.getRealSize();
      if (this.layoutSettings.heightMode === "Dynamic") {
        _ref1 = this.pages;
        _results = [];
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          p = _ref1[_i];
          _results.push(p.minSize = {
            width: size.width,
            height: p.model.get("gridsterSize").height
          });
        }
        return _results;
      } else {
        _ref2 = this.pages;
        _results1 = [];
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          p = _ref2[_j];
          if (p.model.get("id") !== "_headerPage") {
            _results1.push(p.minSize = {
              width: size.width,
              height: size.height
            });
          } else {
            _results1.push(p.minSize = {
              width: size.width,
              height: p.model.get("gridsterSize").height
            });
          }
        }
        return _results1;
      }
    };

    PageCollectionView.prototype.resizeHeader = function() {
      var clipPath, containerOffset, contentOffset, headerHeight, overlayHeight, pagesTop;
      if (!this.headerPage) {
        pagesTop = "0px";
        clipPath = "none";
        $(".header-overlay").css("display", "none");
        headerHeight = 0;
      } else {
        containerOffset = $(".project-container").offset().top;
        headerHeight = this.headerPage.model.get("gridsterSize").height * quadrigram.router.dataModels.currentProject.projectScale;
        contentOffset = 50;
        overlayHeight = headerHeight;
        $(".header-overlay").css("display", "block");
        $(".header-overlay").css("width", $(".project-content").width() + "px");
        $(".header-overlay").css("margin-top", -contentOffset + "px");
        $(".header-overlay").css("height", contentOffset + headerHeight + "px");
        $(".header-overlay").css("backgroundColor", this.layoutSettings.backgroundColor);
      }
      return this.$el.find(".pages-container").css("top", headerHeight);
    };

    PageCollectionView.prototype.updateWatermark = function() {
      var _this = this;
      return _.defer(function() {
        var targetHeight;
        if (_this.activePage != null) {
          if (_this.headerPage != null) {
            targetHeight = _this.activePage.model.get("actualSize").height + _this.headerPage.model.get("actualSize").height;
          } else {
            targetHeight = _this.activePage.model.get("actualSize").height;
          }
        }
        return _this.$el.css("height", targetHeight * quadrigram.router.dataModels.currentProject.projectScale + "px");
      });
    };

    PageCollectionView.prototype.updatePageButtons = function() {
      var freeSpace, index, realPages, scale;
      if (!this.readyToUpdate) {
        return;
      }
      if (this.pagesSettings.showPageButtons === false) {
        this.$el.parent().parent().parent().find(".page-buttons-container .page-button").css("display", "none");
        return;
      }
      realPages = this.getRealPagesArray();
      if (this.activePage != null) {
        index = realPages.indexOf(this.activePage.model);
        this.$el.parent().parent().parent().find(".page-buttons-container .page-button").css("display", "block");
        if (index === 0) {
          this.$el.parent().parent().parent().find(".page-buttons-container .page-button.prev").css("display", "none");
        }
        if (index === realPages.length - 1) {
          this.$el.parent().parent().parent().find(".page-buttons-container .page-button.next").css("display", "none");
        }
      }
      freeSpace = (this.$el.parent().parent().width() - this.$el.width()) / 2;
      scale = 1 / quadrigram.router.dataModels.currentProject.viewportScale;
      if (freeSpace > 100) {
        this.$el.parent().parent().parent().removeClass("small-buttons");
      } else {
        this.$el.parent().parent().parent().addClass("small-buttons");
      }
      if (freeSpace > 0) {
        return this.$el.parent().parent().parent().find(".page-buttons-container .fake-project-filler").css("flex", "0 0 " + this.$el.width() / scale + "px");
      } else {
        return this.$el.parent().parent().parent().find(".page-buttons-container .fake-project-filler").css("flex", "none");
      }
    };

    PageCollectionView.prototype.getCurrentPage = function() {
      var index, isFirst, isLast, label, model, realPages;
      if (this.activePage != null) {
        realPages = this.getRealPagesArray();
        index = realPages.indexOf(this.activePage.model);
        isFirst = index === 0;
        isLast = index === realPages.length - 1;
        model = this.activePage.model;
        label = this.activePage.model.get("label");
        return {
          label: label,
          model: model,
          index: index,
          isFirst: isFirst,
          isLast: isLast,
          total: realPages.length
        };
      }
      return null;
    };

    PageCollectionView.prototype.getRealSize = function() {
      var headerHeight, maxHeigth, maxWidth, p, _i, _len, _ref1;
      maxHeigth = 0;
      maxWidth = 0;
      headerHeight = 0;
      _ref1 = this.pages;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (p.model.get("id") === "_headerPage") {
          headerHeight = p.model.get("gridsterSize").height;
        }
        if (maxHeigth < p.model.get("gridsterSize").height) {
          maxHeigth = p.model.get("gridsterSize").height;
        }
        if (maxWidth < p.model.get("gridsterSize").width) {
          maxWidth = p.model.get("gridsterSize").width;
        }
      }
      maxHeigth = maxHeigth + headerHeight;
      if (this.layoutSettings.heightMode === "Fixed") {
        maxHeigth = this.layoutSettings.height;
      }
      return {
        width: maxWidth,
        height: maxHeigth
      };
    };

    return PageCollectionView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ListItemView = (function(_super) {
    __extends(ListItemView, _super);

    function ListItemView() {
      this.refreshIcon = __bind(this.refreshIcon, this);
      this.getIconClassFromModel = __bind(this.getIconClassFromModel, this);
      this.triggerDelete = __bind(this.triggerDelete, this);
      this.triggerEdit = __bind(this.triggerEdit, this);
      this.triggerDoubleClick = __bind(this.triggerDoubleClick, this);
      this.triggerSelected = __bind(this.triggerSelected, this);
      this.labelChanged = __bind(this.labelChanged, this);
      this.refreshLabel = __bind(this.refreshLabel, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ListItemView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ListItemView.prototype.template = JST['app/scripts/templates/UI/listItem.hbs'];

    ListItemView.prototype.className = "list-item";

    ListItemView.prototype.defaultHeight = 30;

    ListItemView.prototype.events = {
      "click": "triggerSelected",
      "dblclick": "triggerDoubleClick",
      "click .delete": "triggerDelete",
      "click .edit": "triggerEdit"
    };

    ListItemView.prototype._serializeData = function() {
      this.templateData = {};
      this.templateData.model = {};
      this.templateData.model.id = this.model.get("id");
      this.templateData.model.label = this.model.get("label");
      return this.templateData;
    };

    ListItemView.prototype.viewWillRender = function() {
      return this.$el.addClass("hidden");
    };

    ListItemView.prototype.viewDidRender = function() {
      var groupDeletable, groupEditable, labelEditable;
      this.refreshLabel();
      labelEditable = true;
      groupDeletable = true;
      groupEditable = true;
      if (this.model instanceof quadrigram.Models.ExternalBlockGroupModel) {
        labelEditable = false;
      }
      if (this.model instanceof quadrigram.Models.VizBlockGroupModel) {
        groupDeletable = false;
        groupEditable = false;
      }
      this.$el.find(".icon").addClass(this.getIconClassFromModel());
      this.$el.find(".item-label").editableSpan();
      this.$el.find(".item-label").on("change", this.labelChanged);
      if (!labelEditable) {
        this.$el.find(".item-label").prop("disabled", true);
      }
      if (!groupDeletable) {
        this.$el.find(".delete").addClass("hidden");
      }
      if (!groupEditable) {
        this.$el.find(".edit").addClass("hidden");
      }
      this.$el.removeClass("hidden");
      if (this.model.get("defaultLabel") != null) {
        this.$el.find(".item-label").editableSpan("startEditing");
        this.model.unset("defaultLabel", {
          "silent": true
        });
        this.model.get("mainBlock").unset("defaultLabel", {
          "silent": true
        });
      }
      this.model.on("change:label change:blockLabel", this.refreshLabel);
      if (this.model.constructor.name === "CustomBlockGroupModel") {
        return this.model.get("mainBlock").get("operator").on("change:currentOperation", this.refreshIcon);
      }
    };

    ListItemView.prototype.viewWillRemove = function() {
      this.model.off("change:label change:blockLabel", this.refreshLabel);
      if (this.model.constructor.name === "CustomBlockGroupModel") {
        if (this.model.get("mainBlock") != null) {
          this.model.get("mainBlock").get("operator").off("change:currentOperation", this.refreshIcon);
        }
      }
      return this.$el.find(".item-label").off("change", this.labelChanged);
    };

    ListItemView.prototype.refreshLabel = function() {
      if (this.model.get("blockLabel") != null) {
        return this.$el.find(".item-label").val(this.model.get("blockLabel"));
      } else {
        return this.$el.find(".item-label").val(this.model.get("label"));
      }
    };

    ListItemView.prototype.labelChanged = function() {
      return this.model.set("label", this.$el.find(".item-label").val());
    };

    ListItemView.prototype.triggerSelected = function() {
      return this.trigger("selected", this);
    };

    ListItemView.prototype.triggerDoubleClick = function() {
      return this.$el.find(".item-label").editableSpan("startEditing");
    };

    ListItemView.prototype.triggerEdit = function() {
      return this.trigger("edit", this);
    };

    ListItemView.prototype.triggerDelete = function(e) {
      e.stopImmediatePropagation();
      return this.trigger("delete", this);
    };

    ListItemView.prototype.getIconClassFromModel = function() {
      switch (this.model.constructor.name) {
        case "CustomBlockGroupModel":
          return (this.model.get("mainBlock").get("operator").get("currentOperation") + "-icon").toLowerCase();
        case "VizBlockGroupModel":
          return (this.model.get("ownerViz").constructor.name.replace("Model", "") + "-icon").toLowerCase();
        case "ExternalBlockGroupModel":
          if (this.model.get("provider") !== void 0) {
            return (this.model.get("provider") + "-icon").toLowerCase();
          }
      }
      return "default-icon";
    };

    ListItemView.prototype.refreshIcon = function() {
      if (this.model.constructor.name === "CustomBlockGroupModel") {
        this.$el.find(".icon").removeClass().addClass("icon").addClass(this.getIconClassFromModel());
        return this.$el.find(".list-item-actions .edit").addClass("editing");
      }
    };

    return ListItemView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.VizInspectorView = (function(_super) {
    __extends(VizInspectorView, _super);

    function VizInspectorView() {
      this.dataSlotPosition = __bind(this.dataSlotPosition, this);
      this.toggleHidden = __bind(this.toggleHidden, this);
      this.inspectorCloseRequest = __bind(this.inspectorCloseRequest, this);
      this.show = __bind(this.show, this);
      this.hide = __bind(this.hide, this);
      this.updatePanelName = __bind(this.updatePanelName, this);
      this.update = __bind(this.update, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = VizInspectorView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VizInspectorView.prototype.events = {
      "click .property-title": "toggleHidden"
    };

    VizInspectorView.prototype.template = JST['app/scripts/templates/UI/vizInspector.hbs'];

    VizInspectorView.prototype.viewWillRender = function() {};

    VizInspectorView.prototype.viewDidRender = function() {
      var _this = this;
      this.hide();
      this.$el.draggable({
        handle: this.$el.find(".header")
      });
      this.$el.find(".close").on("click", this.inspectorCloseRequest);
      this.$el.css({
        'left': ($(window).width() - 245) + "px",
        'top': ($(window).height() - 448) + "px"
      });
      this.$el.find(".viz-label").editableSpan({
        editOnDblClick: true
      });
      return this.$el.find(".viz-label").on("change", function() {
        return _this.model.get("blockGroup").set("label", _this.$el.find(".viz-label").val());
      });
    };

    VizInspectorView.prototype.viewWillRemove = function() {
      return this.$el.find(".close").off("click", this.inspectorCloseRequest);
    };

    VizInspectorView.prototype.update = function() {
      var lastContentView, lastHeight,
        _this = this;
      if (this.model === null) {
        elog("InspectorView:update -> HAS NO MODEL");
        return;
      }
      if (this.model !== this.latestModel) {
        this.latestModel = this.model;
        lastHeight = 0;
        lastContentView = this.contentView;
        this.updatePanelName();
        if (this.vizInspectorNameListener) {
          this.vizInspectorNameListener.off("change:label", this.updatePanelName);
        }
        this.vizInspectorNameListener = this.model.get("blockGroup");
        this.vizInspectorNameListener.on("change:label", this.updatePanelName);
        this.contentView = new quadrigram.Views.VizInspectorContentView({
          model: this.model,
          binding: false
        });
        this.contentView.render();
        return this.contentView.on("rendered", function() {
          var options;
          _this.contentView.off("rendered");
          if (lastContentView) {
            if (_this.contentView.toolbar && lastContentView.toolbar && _this.contentView.toolbar === lastContentView.toolbar) {
              options = {
                "preserveToolbar": true
              };
            } else {
              options = {};
            }
            lastContentView.unbind();
            lastContentView.remove(options);
          }
          return _this.$el.find("#viz-inspector-content").append(_this.contentView.$el);
        });
      }
    };

    VizInspectorView.prototype.updatePanelName = function() {
      return this.$el.find(".viz-label").val(this.model.get("blockGroup").get("label"));
    };

    VizInspectorView.prototype.hide = function() {
      this.latestModel = null;
      if (this.contentView) {
        this.contentView.unbind();
        this.contentView.remove();
      }
      return this.$el.fadeOut(60);
    };

    VizInspectorView.prototype.show = function() {
      return this.$el.fadeIn(60);
    };

    VizInspectorView.prototype.inspectorCloseRequest = function() {
      return quadrigram.router.appViews.projectView.deselectAll();
    };

    VizInspectorView.prototype.toggleHidden = function(event) {
      $(event.currentTarget).parent().find('.propertyBody').slideToggle(300);
      $(event.currentTarget).toggleClass('selected');
      return $(event.currentTarget).parent().toggleClass('collapsed');
    };

    VizInspectorView.prototype.dataSlotPosition = function() {
      return this.contentView.$el.find(".slot").offset();
    };

    return VizInspectorView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.BlockInspectorView = (function(_super) {
    __extends(BlockInspectorView, _super);

    function BlockInspectorView() {
      this.show = __bind(this.show, this);
      this.hide = __bind(this.hide, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.blockNameChanged = __bind(this.blockNameChanged, this);
      this.changeOperator = __bind(this.changeOperator, this);
      this.updateView = __bind(this.updateView, this);
      this.setTarget = __bind(this.setTarget, this);
      this.onResize = __bind(this.onResize, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      this.init = __bind(this.init, this);
      _ref = BlockInspectorView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BlockInspectorView.prototype.template = JST['app/scripts/templates/UI/blockInspector.hbs'];

    BlockInspectorView.prototype.events = {
      "click .operator-selector-item": "changeOperator"
    };

    BlockInspectorView.prototype.init = function() {
      $(window).on("resize", this.onResize);
      return this.onResize();
    };

    BlockInspectorView.prototype._serializeData = function() {
      this.templateData = {};
      this.templateData.functionsLibrary = quadrigram.Models.OperatorModel.availableOperations;
      return this.templateData;
    };

    BlockInspectorView.prototype.viewWillRender = function() {};

    BlockInspectorView.prototype.viewDidRender = function() {
      this.currentMode = "view";
      return this.onResize();
      /*
      if @theBlockGroup
        @collectionView = new quadrigram.Views.CustomBlockCollectionView(collection:@model.getCustomBlocks(),model:@theBlockGroup,binding:true)
        @collectionView.render()
        @$el.find(".block-selector").append(@collectionView.$el)
        @collectionView.on("block-selected",@setTarget)
      
      @$el.find(".new-block-button").on("click",@createNewCustomBlock)
      */

    };

    /*
    createNewCustomBlock:(event)=>
      #NOTE: asume que solo hay un customBlockGroup, no hace falta pasarlo como parametro al creatCustmBlock
      event.preventDefault()
      event.stopPropagation()
      block = quadrigram.router.dataModels.currentProject.createCustomBlock()
    */


    BlockInspectorView.prototype.onResize = function(ev) {
      return this.$('.mega-slot-container').css({
        width: $(window).width() - 184
      });
    };

    BlockInspectorView.prototype.setTarget = function(blockModel) {
      if (this.model !== blockModel) {
        if (this.selectedBlockView != null) {
          this.selectedBlockView.remove();
          this.selectedBlockView = null;
        }
        if (blockModel != null) {
          this.selectedBlockView = new quadrigram.Views.DataBlockSourceView({
            model: blockModel,
            binding: false
          });
          this.selectedBlockView.render();
          this.$el.find(".block-selector .selected-block-container").append(this.selectedBlockView.$el);
        }
        this.model = blockModel;
        return this.updateView();
      }
    };

    BlockInspectorView.prototype.updateView = function() {
      if (this.operatorView) {
        this.operatorView.remove();
      }
      this.$el.find(".function-mega-slot").empty();
      if (this.model && this.model instanceof quadrigram.Models.FunctionBlockModel) {
        this.$el.find(".operator-selector").removeClass("hidden");
        this.$el.find("option[value=" + this.model.get("operator").get("currentOperation") + "]").attr("selected", "selected");
        this.operatorView = new quadrigram.Views.DataBlockFunctionView({
          model: this.model,
          binding: false
        });
        this.$el.find(".mega-slot-container").append(this.operatorView.$el);
        this.operatorView.render();
      } else if (this.model) {
        this.$el.find(".operator-selector").addClass("hidden");
        this.$el.find(".mega-slot-container").append($("<div> Source: " + this.model.get("blockGroup").get("label") + " Content: " + this.model.get("data").length + " values. </div>"));
      } else {
        this.$el.find(".operator-selector").addClass("hidden");
        /*
        @$el.find(".mega-slot-container").append($("<div>CLick to select...</div>"))
        */

      }
      return this.onResize();
    };

    BlockInspectorView.prototype.changeOperator = function(e) {
      var operation;
      operation = $(e.currentTarget).attr("value");
      quadrigram.tracker.sendEvent({
        event_type: 202,
        event_subtype: 3,
        client_data: {
          operation: operation
        }
      });
      return this.model.setOperation(operation);
    };

    /*
    functionContainerClicked:()=>
      @currentMode="edit"
      @updateToCurrentState()
    
    updateToCurrentState:()=>
      if @currentMode == "edit"
        @$el.find(".function-mega-slot").addClass("active")
      else
        @$el.find(".function-mega-slot").removeClass("active")
    */


    BlockInspectorView.prototype.blockNameChanged = function(e, params) {
      return this.model.set("label", params.newValue);
    };

    /*
    handlePreviewClick:()=>
      #log "SHOULD PREVIEW BLOCK!",@model
      if @model
        quadrigram.router.appViews.uiView.showBlockPreview(@model)
    */


    BlockInspectorView.prototype.viewWillRemove = function() {
      this.$el.find(".block-name").off("save", this.blockNameChanged);
      return $(window).off("resize", this.onResize);
    };

    BlockInspectorView.prototype.hide = function() {
      return this.$el.slideUp(160);
    };

    BlockInspectorView.prototype.show = function() {
      return this.$el.slideDown(160);
    };

    return BlockInspectorView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataFactoryView = (function(_super) {
    __extends(DataFactoryView, _super);

    function DataFactoryView() {
      this.renderGroup = __bind(this.renderGroup, this);
      this.hanldeGroupEdited = __bind(this.hanldeGroupEdited, this);
      this.hanldeGroupDeleted = __bind(this.hanldeGroupDeleted, this);
      this.hanldeGroupSelected = __bind(this.hanldeGroupSelected, this);
      this._changeBlockGroupCollection = __bind(this._changeBlockGroupCollection, this);
      this._clickOnDataContainerMenuItem = __bind(this._clickOnDataContainerMenuItem, this);
      this.selectGroup = __bind(this.selectGroup, this);
      this.selectType = __bind(this.selectType, this);
      this.selectFormulaGroup = __bind(this.selectFormulaGroup, this);
      this.selectExternalGroup = __bind(this.selectExternalGroup, this);
      this.selectVisualizerOutput = __bind(this.selectVisualizerOutput, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DataFactoryView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataFactoryView.prototype.template = JST['app/scripts/templates/UI/dataFactory.hbs'];

    DataFactoryView.prototype.selectedMenu = "";

    DataFactoryView.prototype.latestGroupIds = {};

    DataFactoryView.prototype.events = {
      "click .data-container-menu-item": "_clickOnDataContainerMenuItem"
    };

    DataFactoryView.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    DataFactoryView.prototype.viewDidRender = function() {
      this.selectedMenu = "file";
      return this.$el.find(".data-container-menu-item[menu=" + this.selectedMenu + "]").addClass("selected");
    };

    DataFactoryView.prototype.viewWillRemove = function() {
      if (this.blockGroupCollectionView) {
        this.blockGroupCollectionView.off("group:selected", this.hanldeGroupSelected);
        this.blockGroupCollectionView.remove();
      }
      if (this.blockGroupView) {
        return this.blockGroupView.remove();
      }
    };

    DataFactoryView.prototype.selectVisualizerOutput = function(group) {
      if (quadrigram.router.appViews.uiView.toolbar.$el.find(".tools-submenu").hasClass("closed")) {
        quadrigram.router.appViews.uiView.toolbar.openDataManager();
      }
      this.selectType("charts");
      return _.delay(this.selectGroup, 150, group);
    };

    DataFactoryView.prototype.selectExternalGroup = function(group) {
      if (quadrigram.router.appViews.uiView.toolbar.$el.find(".tools-submenu").hasClass("closed")) {
        quadrigram.router.appViews.uiView.toolbar.openDataManager();
      }
      this.selectType("file");
      return _.delay(this.selectGroup, 150, group);
    };

    DataFactoryView.prototype.selectFormulaGroup = function(group) {
      if (quadrigram.router.appViews.uiView.toolbar.$el.find(".tools-submenu").hasClass("closed")) {
        quadrigram.router.appViews.uiView.toolbar.openDataManager();
      }
      this.selectType("custom");
      return _.delay(this.selectGroup, 150, group);
    };

    DataFactoryView.prototype.selectType = function(type) {
      return this.$el.find(".data-container-menu-item[menu=" + type + "]").trigger("click");
    };

    DataFactoryView.prototype.selectGroup = function(group) {
      log("DataFactoryView::selectGroup -> ", group);
      return this.blockGroupCollectionView.selectById(group);
    };

    DataFactoryView.prototype._clickOnDataContainerMenuItem = function(e) {
      var type;
      $(".data-container-menu-item").removeClass("selected");
      $(e.currentTarget).addClass("selected");
      type = $(e.currentTarget).attr("menu");
      if (this.selectedMenu !== type) {
        return this._changeBlockGroupCollection(type);
      }
    };

    DataFactoryView.prototype._changeBlockGroupCollection = function(type) {
      var _this = this;
      this.selectedMenu = type;
      if (this.blockGroupCollectionView) {
        this.blockGroupCollectionView.off("group:selected", this.hanldeGroupSelected);
        this.blockGroupCollectionView.remove();
        this.renderGroup();
      }
      if (this.selectedMenu) {
        this.blockGroupCollectionView = new quadrigram.Views.BlockGroupCollectionView({
          collection: this.model
        });
        this.blockGroupCollectionView.$el.addClass("group-type-" + this.selectedMenu);
        $(this.el).find(".block-group-list-container").append(this.blockGroupCollectionView.$el);
        this.blockGroupCollectionView.on("group:selected", this.hanldeGroupSelected);
        this.blockGroupCollectionView.on("group:edit", this.hanldeGroupEdited);
        this.blockGroupCollectionView.on("group:delete", this.hanldeGroupDeleted);
      }
      this.blockGroupCollectionView.setFilter(this.selectedMenu);
      this.blockGroupCollectionView.render();
      quadrigram.router.appViews.projectView.outputDeselectAll();
      if (this.latestGroupIds[this.selectedMenu]) {
        this.blockGroupCollectionView.selectById(this.latestGroupIds[this.selectedMenu]);
      } else {
        this.blockGroupCollectionView.selectFirst();
      }
      if (quadrigram.router.appViews.uiView.toolbar.functionsExplorer.model != null) {
        return _.defer(function() {
          return _this.blockGroupCollectionView.setEditing(quadrigram.router.appViews.uiView.toolbar.functionsExplorer.model.get("blockGroup"));
        });
      }
    };

    DataFactoryView.prototype.hanldeGroupSelected = function(model) {
      this.renderGroup(model);
      if (model != null) {
        this.selectedGroupModel = model;
        this.latestGroupIds[this.selectedMenu] = model.get("id");
        return quadrigram.router.appViews.projectView.outputSelect(model);
      }
    };

    DataFactoryView.prototype.hanldeGroupDeleted = function(model) {
      quadrigram.router.dataModels.currentProject.deleteBlockGroup(model);
      if (quadrigram.router.appViews.uiView.toolbar.functionsExplorer.model === model.get("mainBlock")) {
        return quadrigram.router.appViews.uiView.toolbar.setFunctionBlockTarget();
      }
    };

    DataFactoryView.prototype.hanldeGroupEdited = function(model) {
      if (this.selectedMenu === "custom") {
        if ((model != null) && (model.get("mainBlock") != null)) {
          return quadrigram.router.appViews.uiView.toolbar.setFunctionBlockTarget(model.get("mainBlock"));
        } else {
          return quadrigram.router.appViews.uiView.toolbar.setFunctionBlockTarget(null);
        }
        /*
        else
          ##FOR RETROCOMP!!
          quadrigram.router.appViews.uiView.toolbar.setFunctionBlockTarget(model.get("blocksCollection").models[0])
        */

      } else {
        return quadrigram.router.appViews.uiView.showBlockBuilder(model);
      }
    };

    DataFactoryView.prototype.renderGroup = function(model) {
      if (this.selectedGroupModel !== model || (this.blockGroupView == null)) {
        if (this.blockGroupView != null) {
          this.blockGroupView.remove();
          this.blockGroupView = null;
        }
        if (model) {
          this.blockGroupView = new quadrigram.Views.BlockGroupView({
            model: model,
            binding: false
          });
          this.$el.find(".block-group-container").append(this.blockGroupView.$el);
          return this.blockGroupView.render();
        }
      }
    };

    return DataFactoryView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.HelpPopupView = (function(_super) {
    __extends(HelpPopupView, _super);

    function HelpPopupView() {
      this.openAskusPanel = __bind(this.openAskusPanel, this);
      this.openVideoPanel = __bind(this.openVideoPanel, this);
      this.closeVideoPanel = __bind(this.closeVideoPanel, this);
      this.videoClosed = __bind(this.videoClosed, this);
      this.videoClicked = __bind(this.videoClicked, this);
      this.show = __bind(this.show, this);
      this.hide = __bind(this.hide, this);
      this.updateHistory = __bind(this.updateHistory, this);
      this.getContentData = __bind(this.getContentData, this);
      this.updateContent = __bind(this.updateContent, this);
      this.loadContentById = __bind(this.loadContentById, this);
      this.loadLastContent = __bind(this.loadLastContent, this);
      this.filterSearch = __bind(this.filterSearch, this);
      this.loadSearch = __bind(this.loadSearch, this);
      this.openSearch = __bind(this.openSearch, this);
      this.toggleSearch = __bind(this.toggleSearch, this);
      this.clickRecomended = __bind(this.clickRecomended, this);
      this.nextItem = __bind(this.nextItem, this);
      this.previousItem = __bind(this.previousItem, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.toggeMinimize = __bind(this.toggeMinimize, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = HelpPopupView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    HelpPopupView.prototype.events = {
      "click .close": "hide",
      "click .minimize": "toggeMinimize",
      "click .askus": "openAskusPanel",
      "click .back": "previousItem",
      "click .forward": "nextItem",
      "click .search-icon": "toggleSearch",
      "click .recomended": "clickRecomended",
      "click .video-thumb": "videoClicked",
      "click .close-video-button": "videoClosed"
    };

    HelpPopupView.prototype.template = JST['app/scripts/templates/UI/helpPopup.hbs'];

    HelpPopupView.prototype.popupContentTemplate = JST['app/scripts/templates/UI/helpPopupContent.hbs'];

    HelpPopupView.prototype.popupSearchTemplate = JST['app/scripts/templates/UI/helpSearchContent.hbs'];

    HelpPopupView.prototype.history = [];

    HelpPopupView.prototype.currentHistoryIndex = -1;

    HelpPopupView.prototype.viewWillRender = function() {};

    HelpPopupView.prototype.viewDidRender = function() {
      this.$el.draggable({
        handle: this.$el.find(".header")
      });
      this.$el.css({
        'left': "2px",
        'top': ($(window).height() - 438) + "px"
      });
      this.loadLastContent();
      this.toggeMinimize();
      return this.$el.fadeIn(0);
    };

    HelpPopupView.prototype.toggeMinimize = function() {
      this.$el.toggleClass("minimized");
      if (this.$el.hasClass("minimized")) {
        return this.$el.draggable('disable');
      } else {
        return this.$el.draggable('enable');
      }
    };

    HelpPopupView.prototype.viewWillRemove = function() {};

    HelpPopupView.prototype.previousItem = function() {
      if (this.currentHistoryIndex > 0) {
        this.currentHistoryIndex--;
        return this.loadContentById(this.history[this.currentHistoryIndex]);
      }
    };

    HelpPopupView.prototype.nextItem = function() {
      if (this.history.length - 1 > this.currentHistoryIndex) {
        this.currentHistoryIndex++;
        return this.loadContentById(this.history[this.currentHistoryIndex]);
      }
    };

    HelpPopupView.prototype.clickRecomended = function(e) {
      var targetId;
      targetId = $(e.currentTarget).attr("data-id");
      return this.loadContentById(targetId);
    };

    HelpPopupView.prototype.toggleSearch = function() {
      if (!this.$el.find(".search-container").hasClass("active")) {
        return this.loadContentById("#search");
      } else if (this.currentHistoryIndex > 0) {
        return this.loadContentById(this.history[this.currentHistoryIndex - 1]);
      }
    };

    HelpPopupView.prototype.openSearch = function() {
      this.$el.find(".search-container").addClass("active");
      return this.loadSearch();
    };

    /*
    closeSearch:()=>
      @$el.find(".search-container").removeClass("active")
      @previousItem()
    */


    HelpPopupView.prototype.loadSearch = function() {
      var fullRecs, rec, self, templateData, _i, _len, _ref1;
      this.updateHistory("#search");
      templateData = {};
      fullRecs = [];
      if (quadrigram.achievementTracker.achievementDefs == null) {
        return;
      }
      _ref1 = quadrigram.achievementTracker.achievementDefs;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        rec = _ref1[_i];
        rec = _.clone(_.findWhere(quadrigram.achievementTracker.achievementDefs, {
          id: rec.id
        }));
        rec.completed = quadrigram.router.dataModels.achievementsModel.checkCompleted(rec.id);
        fullRecs.push(rec);
      }
      templateData.achievements = fullRecs;
      this.$el.find(".help-item-content").html(this.popupSearchTemplate(templateData));
      self = this;
      this.$el.find(".help-item-content").find("li").on("click", function() {
        return self.loadContentById($(this).attr("data-id"));
      });
      this.$el.find(".search-input").on("keyup", this.filterSearch);
      this.$el.find(".search-input").focus();
      return this.filterSearch();
    };

    HelpPopupView.prototype.filterSearch = function() {
      var count, word;
      word = this.$el.find(".search-input").val().toLowerCase();
      count = 0;
      this.$el.find(".results-ul").find("li").each(function() {
        if (word === "" || $(this).attr("data-id").toLowerCase().indexOf(word) >= 0 || $(this).attr("data-search-words").toLowerCase().indexOf(word) >= 0) {
          $(this).css("display", "block");
          return count++;
        } else {
          return $(this).css("display", "none");
        }
      });
      if (word !== "") {
        this.$el.find(".result-count").css("display", "block");
        return this.$el.find(".result-count").html(count + " results");
      } else {
        return this.$el.find(".result-count").css("display", "none");
      }
    };

    HelpPopupView.prototype.loadLastContent = function() {
      if (this.history.length === 0) {
        return this.loadContentById("#search");
      } else {
        return this.loadContentById(this.history[this.currentHistoryIndex]);
      }
    };

    HelpPopupView.prototype.loadContentById = function(id) {
      var templateData,
        _this = this;
      if (id === "#search") {
        this.openSearch();
      } else {
        this.$el.find(".search-container").removeClass("active");
        templateData = this.getContentData(id);
        this.$el.find(".help-item-content").html(this.popupContentTemplate(templateData));
        if (templateData.completed) {
          this.$el.find(".navigation").find(".title").addClass("completed");
        } else {
          this.$el.find(".navigation").find(".title").removeClass("completed");
        }
        this.$el.find(".navigation").find(".title").find("span").html(templateData.goalLabel);
        this.$el.find(".fake-loader").css("display", "block");
        _.delay(function() {
          return _this.$el.find(".fake-loader").css("display", "none");
        }, 500);
      }
      this.updateHistory(id);
      return this.show();
    };

    HelpPopupView.prototype.updateContent = function(id) {
      if (id === this.history[this.currentHistoryIndex]) {
        return this.loadContentById(id);
      }
    };

    HelpPopupView.prototype.getContentData = function(id) {
      var achievementData, fullRecs, rec, recId, templateData, _i, _len, _ref1;
      achievementData = _.findWhere(quadrigram.achievementTracker.achievementDefs, {
        id: id
      });
      achievementData.completed = quadrigram.router.dataModels.achievementsModel.checkCompleted(id);
      templateData = _.clone(achievementData);
      templateData.content || (templateData.content = {});
      /*
      templateData.content.description ||= "This is the description of the achievement that should be something like 3 lines long or so. It could even be longer and wrap around the link to the video tutorial!"
      templateData.content.linkURL ||= "http://quadrigram.com"
      templateData.content.videoID ||= "aEKx4W-2_NU"
      templateData.recomended ||= ["connectLegend","dataMovie","changeColors"]
      */

      fullRecs = [];
      if (templateData.recomended != null) {
        _ref1 = templateData.recomended;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          recId = _ref1[_i];
          rec = _.clone(_.findWhere(quadrigram.achievementTracker.achievementDefs, {
            id: recId
          }));
          rec.completed = quadrigram.router.dataModels.achievementsModel.checkCompleted(recId);
          fullRecs.push(rec);
        }
      }
      templateData.recomended = fullRecs;
      return templateData;
    };

    HelpPopupView.prototype.updateHistory = function(id) {
      if (this.history[this.currentHistoryIndex] !== id) {
        this.history = this.history.splice(0, this.currentHistoryIndex + 1);
        this.history.push(id);
        this.currentHistoryIndex++;
      }
      if (this.currentHistoryIndex === 0) {
        this.$el.find('.navigation .back').addClass("disabled");
      } else {
        this.$el.find('.navigation .back').removeClass("disabled");
      }
      if (this.currentHistoryIndex === this.history.length - 1) {
        return this.$el.find('.navigation .forward').addClass("disabled");
      } else {
        return this.$el.find('.navigation .forward').removeClass("disabled");
      }
    };

    HelpPopupView.prototype.hide = function() {
      this.latestModel = null;
      if (this.contentView) {
        this.contentView.unbind();
        this.contentView.remove();
      }
      return this.$el.fadeOut(60);
    };

    HelpPopupView.prototype.show = function() {
      if (this.$el.hasClass("minimized")) {
        this.toggeMinimize();
      }
      return this.$el.fadeIn(60);
    };

    HelpPopupView.prototype.videoClicked = function(e) {
      var videoURL;
      videoURL = $(e.currentTarget).attr("data-id");
      return this.openVideoPanel(videoURL);
    };

    HelpPopupView.prototype.videoClosed = function(e) {
      return this.closeVideoPanel();
    };

    HelpPopupView.prototype.closeVideoPanel = function() {
      return this.$el.find(".video-container").removeClass("open");
    };

    HelpPopupView.prototype.openVideoPanel = function(youtubeID) {
      if (this.$videoPopup == null) {
        this.$videoPopup = new quadrigram.Views.HelpVideoPopupView(new Backbone.Model());
        this.$videoPopup.render();
        this.$el.parent().append(this.$videoPopup.$el);
      }
      return this.$videoPopup.show(youtubeID);
    };

    HelpPopupView.prototype.openAskusPanel = function() {
      return quadrigram.router.appViews.uiView.openAskus();
    };

    return HelpPopupView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.HelpVideoPopupView = (function(_super) {
    __extends(HelpVideoPopupView, _super);

    function HelpVideoPopupView() {
      this.show = __bind(this.show, this);
      this.hide = __bind(this.hide, this);
      this.closeHandler = __bind(this.closeHandler, this);
      this.loadVideo = __bind(this.loadVideo, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = HelpVideoPopupView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    HelpVideoPopupView.prototype.events = {
      "click .close": "close"
    };

    HelpVideoPopupView.prototype.className = "help-video-popup";

    HelpVideoPopupView.prototype.template = JST['app/scripts/templates/UI/helpVideoPopup.hbs'];

    HelpVideoPopupView.prototype.viewWillRender = function() {};

    HelpVideoPopupView.prototype.viewDidRender = function() {
      return this.$el.find(".close").on("click", this.closeHandler);
      /*
      @$el.position({
        my: "center",
        at: "center"
      })
      */

    };

    HelpVideoPopupView.prototype.loadVideo = function(id) {
      if (this.currentId !== id) {
        this.$el.find("iframe").attr("src", "http://www.youtube.com/embed/" + id + "?autoplay=1&enablejsapi=1&rel=0&modestbranding=1&controls=1&showinfo=0");
        return this.currentId = id;
      }
    };

    HelpVideoPopupView.prototype.closeHandler = function() {
      return this.hide();
    };

    HelpVideoPopupView.prototype.hide = function() {
      this.$el.find("iframe")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
      return this.$el.css("display", "none");
    };

    HelpVideoPopupView.prototype.show = function(youtubeID) {
      this.loadVideo(youtubeID);
      return this.$el.css("display", "block");
    };

    return HelpVideoPopupView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.BlockGroupView = (function(_super) {
    __extends(BlockGroupView, _super);

    function BlockGroupView() {
      this.onOut = __bind(this.onOut, this);
      this.onHover = __bind(this.onHover, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.createCustomBlock = __bind(this.createCustomBlock, this);
      this.roleToClass = __bind(this.roleToClass, this);
      this.compareOrders = __bind(this.compareOrders, this);
      this.renderBlockStack = __bind(this.renderBlockStack, this);
      this.adjustStacksWidth = __bind(this.adjustStacksWidth, this);
      this.updateLevelCount = __bind(this.updateLevelCount, this);
      this.renderVizGroup = __bind(this.renderVizGroup, this);
      this.renderTableBreakDown = __bind(this.renderTableBreakDown, this);
      this.renderNetworkBreakDown = __bind(this.renderNetworkBreakDown, this);
      this.renderInvalidBreakDown = __bind(this.renderInvalidBreakDown, this);
      this.renderNotReadyBreakDown = __bind(this.renderNotReadyBreakDown, this);
      this.renderBreakDownGroup = __bind(this.renderBreakDownGroup, this);
      this.updateBreakDownGroup = __bind(this.updateBreakDownGroup, this);
      this.viewDidRemove = __bind(this.viewDidRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = BlockGroupView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BlockGroupView.prototype.template = JST['app/scripts/templates/blocks/blockGroup.hbs'];

    BlockGroupView.prototype.stackTemplate = JST['app/scripts/templates/blocks/blockGroupBlockStack.hbs'];

    BlockGroupView.prototype.colTemplate = JST['app/scripts/templates/blocks/blockGroupColumn.hbs'];

    BlockGroupView.prototype.className = "block-group-content";

    BlockGroupView.prototype.events = {
      "click .add-block-button": "createCustomBlock"
    };

    BlockGroupView.isMouseOver = false;

    BlockGroupView.prototype.viewDidRender = function() {
      if (this.model instanceof quadrigram.Models.ExternalBlockGroupModel) {
        this.renderBreakDownGroup();
        this.model.on("change:fetchState", this.renderBreakDownGroup);
        return this.model.on("change-block-structure", this.renderBreakDownGroup);
      } else if (this.model instanceof quadrigram.Models.VizBlockGroupModel) {
        return this.renderVizGroup();
      } else if (this.model instanceof quadrigram.Models.CustomBlockGroupModel) {
        this.renderBreakDownGroup();
        this.model.get("mainBlock").on("change:fetchState", this.renderBreakDownGroup);
        return this.model.on("change-block-structure", this.renderBreakDownGroup);
      }
    };

    BlockGroupView.prototype.viewDidRemove = function() {
      this.model.off("change:fetchState", this.renderBreakDownGroup);
      return this.model.off("change-block-structure", this.renderBreakDownGroup);
    };

    BlockGroupView.prototype.updateBreakDownGroup = function() {
      elog("should update stacks instead of rendering the full breakdown again");
      return this.renderBreakDownGroup();
    };

    BlockGroupView.prototype.renderBreakDownGroup = function() {
      if (this.model.invalidData) {
        this.renderInvalidBreakDown();
        return;
      }
      if (this.model instanceof quadrigram.Models.CustomBlockGroupModel && this.model.get("mainBlock").get("fetchState") !== "ready") {
        this.renderNotReadyBreakDown();
        return;
      }
      if (!(this.model instanceof quadrigram.Models.CustomBlockGroupModel) && this.model.get("fetchState") !== "ready") {
        this.renderNotReadyBreakDown();
        return;
      }
      if (this.model.get("buildData") && this.model.get("buildData").dataType === "network") {
        this.renderNetworkBreakDown();
      } else {
        this.renderTableBreakDown();
      }
    };

    BlockGroupView.prototype.renderNotReadyBreakDown = function() {
      this.$el.children().remove();
      return this.$el.append("<div class='block-group-message'> Calculating... </div>");
    };

    BlockGroupView.prototype.renderInvalidBreakDown = function() {
      this.$el.children().remove();
      return this.$el.append("<div class='block-group-message'> The file could not be parsed. </div>");
    };

    BlockGroupView.prototype.renderNetworkBreakDown = function() {
      var collection, firstStack, nodesStack, relsStack;
      this.$el.children().remove();
      collection = this.model.get("blocksCollection").models.concat(this.model.preBlocks);
      this.currentCollection = collection;
      collection.sort(this.compareOrders);
      firstStack = $(this.colTemplate());
      firstStack.append(this.renderBlockStack(collection, {
        "role": "nodes"
      }, "Nodes"));
      firstStack.append(this.renderBlockStack(collection, {
        "role": "rels"
      }, "Relations"));
      this.$el.append(firstStack);
      nodesStack = $(this.colTemplate());
      nodesStack.append(this.renderBlockStack(collection, {
        "role": "node-prop"
      }, "Properties of nodes"));
      this.$el.append(nodesStack);
      relsStack = $(this.colTemplate());
      relsStack.append(this.renderBlockStack(collection, {
        "role": "rel-prop"
      }, "Properties of relations"));
      return this.$el.append(relsStack);
    };

    BlockGroupView.prototype.renderTableBreakDown = function() {
      var collection, depth, firstStack, level0Count, level1Count, mainLabel, namesLabels, namesStack, stack, stackIndex, stacksLabels, viewMode, _i,
        _this = this;
      this.$el.children().remove();
      if (this.model.preBlocks && this.model.preBlocks.length > 0) {
        collection = this.model.get("blocksCollection").models.concat(this.model.preBlocks);
      } else {
        collection = this.model.get("blocksCollection").models;
      }
      this.currentCollection = collection;
      collection.sort(this.compareOrders);
      if (this.model.get("blocksCollection").where({
        "role": "all"
      })[0] && (this.model.get("blocksCollection").where({
        "role": "all"
      })[0].get("metaData") != null)) {
        viewMode = this.model.get("blocksCollection").where({
          "role": "all"
        })[0].get("metaData").viewMode;
      } else {
        viewMode = "cell";
      }
      level0Count = 0;
      level1Count = 0;
      _.each(collection, function(m) {
        if (m.get("role") === "level0") {
          if (m instanceof quadrigram.Models.FunctionBlockModel) {
            if (m.get("state") !== "dead") {
              level0Count += 1;
            }
          } else if (!BlockUtils.isEmpty(m)) {
            level0Count += 1;
          }
        }
        if (m.get("role") === "level1") {
          if (m instanceof quadrigram.Models.FunctionBlockModel) {
            if (m.get("state") !== "dead") {
              return level1Count += 1;
            }
          } else if (!BlockUtils.isEmpty(m)) {
            return level1Count += 1;
          }
        }
      });
      depth = -1;
      if (level0Count > 1) {
        depth = 0;
      }
      if (level1Count > 0) {
        depth = 1;
      }
      if (depth === 1) {
        mainLabel = "Table";
        namesLabels = ["Column Names", "Row Names"];
        stacksLabels = ["Columns (" + level0Count + ")", "Rows (" + level1Count + ")"];
      } else if (depth === 0) {
        mainLabel = "Column";
        namesLabels = ["Row Names"];
        stacksLabels = ["Rows (" + level0Count + ")"];
      } else {
        mainLabel = "Value";
      }
      firstStack = $(this.colTemplate());
      firstStack.append(this.renderBlockStack(collection, {
        "role": "all"
      }, mainLabel));
      this.$el.append(firstStack);
      namesStack = $(this.colTemplate());
      this.$el.append(namesStack);
      if (depth >= 0) {
        for (stackIndex = _i = 0; 0 <= depth ? _i <= depth : _i >= depth; stackIndex = 0 <= depth ? ++_i : --_i) {
          namesStack.append(this.renderBlockStack(collection, {
            "role": "level" + stackIndex + "names"
          }, namesLabels[stackIndex]));
          stack = $(this.colTemplate());
          stack.append(this.renderBlockStack(collection, {
            "role": "level" + stackIndex
          }, stacksLabels[stackIndex]));
          this.$el.append(stack);
        }
      }
      return this.adjustStacksWidth();
    };

    BlockGroupView.prototype.renderVizGroup = function() {
      var col, vizBlock, vizBlockType, vizBlockTypes, vizBlocks, vizTypes, _i, _j, _len, _len1,
        _this = this;
      this.outputsOrder = ["selection", "OnOver", "styles", "geo"];
      vizBlocks = this.model.get("blocksCollection").models;
      vizBlockTypes = {};
      for (_i = 0, _len = vizBlocks.length; _i < _len; _i++) {
        vizBlock = vizBlocks[_i];
        if (vizBlock.get("role") === "output") {
          vizBlockType = vizBlock.get("outputType");
          if (!vizBlockType) {
            vizBlockType = "default";
          }
          if (!vizBlockTypes[vizBlockType]) {
            vizBlockTypes[vizBlockType] = [];
          }
          vizBlockTypes[vizBlockType].push(vizBlock);
        }
      }
      vizTypes = Object.keys(vizBlockTypes);
      vizTypes.sort(function(a, b) {
        return _this.outputsOrder.indexOf(a) > _this.outputsOrder.indexOf(b);
      });
      for (_j = 0, _len1 = vizTypes.length; _j < _len1; _j++) {
        vizBlockType = vizTypes[_j];
        col = $(this.colTemplate());
        col.append(this.renderBlockStack(vizBlocks, {
          "role": "output",
          "outputType": vizBlockType
        }, vizBlockType));
        this.$el.append(col);
      }
      return this.adjustStacksWidth();
    };

    /*
    renderCustomGroup:()=>
      collection = @model.get("blocksCollection").models
      firstCol = $(@colTemplate())
      firstCol.append(@renderBlockStack(collection,{},"Result formula"))
      @$el.append(firstCol)
    
      @adjustStacksWidth()
    */


    BlockGroupView.prototype.updateLevelCount = function() {
      return log("should update levelCount");
    };

    BlockGroupView.prototype.adjustStacksWidth = function() {
      var stackCount;
      stackCount = this.$el.find(".block-group-column").length;
      return this.$el.find(".block-group-column").css("width", 100 / stackCount + "%");
    };

    BlockGroupView.prototype.renderBlockStack = function(collection, filters, label) {
      var $newStack, col, colsCollectionView, self,
        _this = this;
      $newStack = $(this.stackTemplate());
      col = _.filter(collection, function(model) {
        var f, result;
        result = true;
        for (f in filters) {
          if (model.get(f) !== filters[f]) {
            result = false;
          }
        }
        return result;
      });
      self = this;
      colsCollectionView = new quadrigram.Views.DataBlockCollectionView({
        collection: col,
        fullCollection: this.model.get("blocksCollection"),
        filters: filters,
        model: this.model,
        binding: true,
        el: $newStack.find(".block-list")
      });
      colsCollectionView.render();
      $newStack.find(".name").html(label);
      return $newStack;
    };

    /*
    renderSpecialBlock:(collection,role,viewMode)=>
      block = _.filter(collection,(m)=> return m.get("role")==role)[0]
    
      blockClass = @roleToClass(role)
    
      if block? && (role=="all" || BlockUtils.viewModeToLevel(viewMode) >= Number(role.replace("level","").replace("names","")))
        specialBlockView = new quadrigram.Views.DataBlockSourceView(model: block, binding:false)
    
        specialBlockView.render()
        $(@el).find(".block-stack > .data-block-container"+blockClass).append(specialBlockView.$el)
    
      else
        $(@el).find(".block-stack > "+blockClass).addClass("hidden")
    */


    BlockGroupView.prototype.compareOrders = function(a, b) {
      if (a.state === "dead" && b.state !== "dead") {
        return 1;
      }
      if (b.state === "dead" && a.state !== "dead") {
        return -1;
      }
      a = a.get("order");
      b = b.get("order");
      if (a > b || a === void 0) {
        return 1;
      } else if (b > a || b === void 0) {
        return -1;
      } else {
        return 0;
      }
    };

    BlockGroupView.prototype.roleToClass = function(role) {
      var blockClass;
      if (role === "level0names") {
        blockClass = ".level-0-names";
      } else if (role === "level1names") {
        blockClass = ".level-1-names";
      } else if (role === "all") {
        blockClass = ".main-block";
      } else if (role === "level0") {
        blockClass = ".level-0";
      } else if (role === "level1") {
        blockClass = ".level-1";
      }
      return blockClass;
    };

    BlockGroupView.prototype.createCustomBlock = function() {
      return quadrigram.router.dataModels.currentProject.createCustomBlock(this.model);
    };

    BlockGroupView.prototype.viewWillRemove = function() {
      if (this.colsCollectionView) {
        this.colsCollectionView.remove();
      }
      if (this.rowsCollectionView) {
        return this.rowsCollectionView.remove();
      }
    };

    BlockGroupView.prototype.onHover = function(ev) {
      $(ev.currentTarget).children().trigger("mouseoverlist");
    };

    BlockGroupView.prototype.onOut = function(ev) {
      $(ev.currentTarget).children().trigger('mouseoutlist');
    };

    return BlockGroupView;

  })(Backbone.SmoothElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.BlockGroupCollectionView = (function(_super) {
    __extends(BlockGroupCollectionView, _super);

    function BlockGroupCollectionView() {
      this.removeByModel = __bind(this.removeByModel, this);
      this.currentCreationFunction = __bind(this.currentCreationFunction, this);
      this.handleCollectionAdd = __bind(this.handleCollectionAdd, this);
      this.handleCollectionRemove = __bind(this.handleCollectionRemove, this);
      this.updateFormulaSelection = __bind(this.updateFormulaSelection, this);
      this._clickOnEditGroup = __bind(this._clickOnEditGroup, this);
      this._clickOnDeleteGroup = __bind(this._clickOnDeleteGroup, this);
      this._dblClickOnBlockGroup = __bind(this._dblClickOnBlockGroup, this);
      this._clickOnBlockGroup = __bind(this._clickOnBlockGroup, this);
      this.selectById = __bind(this.selectById, this);
      this.selectFirst = __bind(this.selectFirst, this);
      this.setEditing = __bind(this.setEditing, this);
      this.filterVizBlockGroups = __bind(this.filterVizBlockGroups, this);
      this.setFilter = __bind(this.setFilter, this);
      this.renderElement = __bind(this.renderElement, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = BlockGroupCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BlockGroupCollectionView.prototype.template = JST['app/scripts/templates/blocks/blockGroupCollection.hbs'];

    BlockGroupCollectionView.prototype.modelView = quadrigram.Views.ListItemView;

    BlockGroupCollectionView.prototype.className = "block-group-list";

    BlockGroupCollectionView.prototype.bindModelViews = false;

    BlockGroupCollectionView.prototype.groupViews = {};

    BlockGroupCollectionView.prototype.elementEvents = {
      "selected": "_clickOnBlockGroup",
      "dblclick": "_dblClickOnBlockGroup",
      "delete": "_clickOnDeleteGroup",
      "edit": "_clickOnEditGroup"
    };

    BlockGroupCollectionView.prototype.events = {
      "click .add-group-button": "currentCreationFunction"
    };

    BlockGroupCollectionView.prototype.viewWillRender = function() {
      this.templateData.title = this.filterBy;
      if (this.filterBy === "file") {
        this.templateData.newText = "Import new file";
      } else if (this.filterBy === "custom") {
        this.templateData.newText = "Create new formula";
      }
      return this.$el.addClass("hidden");
    };

    BlockGroupCollectionView.prototype.viewDidRender = function() {
      var cid;
      this.$el.removeClass("hidden");
      this.collection.on("remove", this.handleCollectionRemove);
      this.collection.on("add", this.handleCollectionAdd);
      if (this.filterBy === "custom" && (quadrigram.router.appViews.uiView.toolbar.functionsExplorer.selectedBlockView != null)) {
        try {
          cid = quadrigram.router.appViews.uiView.toolbar.functionsExplorer.selectedBlockView.model.get("blockGroup").cid;
          return this.updateFormulaSelection(this.modelViews[cid]);
        } catch (_error) {
          return log("error selecting edited block");
        }
      }
    };

    BlockGroupCollectionView.prototype.renderElement = function(model) {
      var view;
      view = BlockGroupCollectionView.__super__.renderElement.call(this, model);
      switch (model.get("type")) {
        case "external":
          view.$el.find(".edit").addClass("ui-tip-target");
          view.$el.find(".edit").attr("data-ui-tip-id", "edit-external");
          break;
        case "custom":
          view.$el.find(".block-group").addClass("ui-tip-target");
          view.$el.find(".block-group").attr("data-ui-tip-id", "block-group-rename");
          view.$el.find(".edit").addClass("ui-tip-target");
          view.$el.find(".edit").attr("data-ui-tip-id", "edit-custom");
          break;
        case "viz":
          view.$el.find(".block-group").addClass("ui-tip-target");
          view.$el.find(".block-group").attr("data-ui-tip-id", "block-group-rename");
      }
      if (model === this.currentlyEditing) {
        view.$el.find(".edit").addClass("editing");
        view.$el.addClass("editing");
      }
      if (model === this.currentSelection) {
        view.$el.addClass("selected");
      }
      /*
      if @filterBy == "custom" && quadrigram.router.appViews.uiView.toolbar.functionsExplorer.selectedBlockView?
        model.cid = quadrigram.router.appViews.uiView.toolbar.functionsExplorer.selectedBlockView.model.get("blockGroup").cid
        @updateFormulaSelection(view)
      */

      return view;
    };

    BlockGroupCollectionView.prototype.setFilter = function(type) {
      this.filterBy = type;
      switch (type) {
        case "custom":
          return this._filterModels = "CustomBlockGroupModel";
        case "file":
          return this._filterModels = "ExternalBlockGroupModel";
        case "charts":
          return this._filterModels = this.filterVizBlockGroups;
        default:
          return this._filterModels = "BlockGroupModel";
      }
    };

    BlockGroupCollectionView.prototype.filterVizBlockGroups = function(model) {
      if (model.hasOutputs && model.hasOutputs()) {
        return true;
      } else {
        return false;
      }
    };

    BlockGroupCollectionView.prototype.setEditing = function(model) {
      var currentView;
      if (model != null) {
        this.currentlyEditing = model;
        if (this.currentlyEditing != null) {
          currentView = this.modelViews[this.currentlyEditing.cid];
          if (currentView != null) {
            currentView.$el.find(".edit").addClass("editing");
            return currentView.$el.addClass("editing");
          }
        }
      }
    };

    BlockGroupCollectionView.prototype.selectFirst = function() {
      var i, lowestSort, m, _i, _len, _ref1;
      if (this.filteredModels.length > 0) {
        lowestSort = 0;
        _ref1 = this.filteredModels;
        for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
          m = _ref1[i];
          if (this.filteredModels[lowestSort].get("groupSortIndex") > m.get("groupSortIndex")) {
            lowestSort = i;
          }
        }
        this.currentSelection = this.filteredModels[lowestSort].get("id");
        return this.selectById(this.currentSelection);
      }
    };

    BlockGroupCollectionView.prototype.selectById = function(groupId) {
      if (this.collection.where({
        "id": groupId
      }).length > 0) {
        this.currentSelection = this.collection.where({
          "id": groupId
        })[0];
        return this.select(this.currentSelection);
      } else {
        return this.selectFirst();
      }
    };

    BlockGroupCollectionView.prototype._clickOnBlockGroup = function(itemView) {
      var group;
      group = itemView.model;
      this.currentSelection = group;
      $(".list-item").removeClass("selected");
      itemView.$el.addClass("selected");
      return this.trigger("group:selected", group);
    };

    BlockGroupCollectionView.prototype._dblClickOnBlockGroup = function(itemView) {
      var group;
      group = itemView.model;
      return quadrigram.router.appViews.uiView.showBlockBuilder(group);
    };

    BlockGroupCollectionView.prototype._clickOnDeleteGroup = function(itemView) {
      var group;
      group = itemView.model;
      if (group === this.currentSelection) {
        this.trigger("group:selected", null);
      }
      return this.trigger("group:delete", group);
    };

    BlockGroupCollectionView.prototype._clickOnEditGroup = function(itemView) {
      var group;
      group = itemView.model;
      if (this.filterBy === "custom") {
        if (itemView.model !== this.currentlyEditing) {
          this.trigger("group:edit", group);
          return this.updateFormulaSelection(itemView);
        } else {
          this.trigger("group:edit", null);
          return this.updateFormulaSelection(null);
        }
      } else {
        return this.trigger("group:edit", group);
      }
    };

    BlockGroupCollectionView.prototype.updateFormulaSelection = function(selectedView) {
      var item, key, _ref1;
      _ref1 = this.modelViews;
      for (key in _ref1) {
        item = _ref1[key];
        if (item != null) {
          item.$el.find(".edit").removeClass("editing");
          item.$el.removeClass("editing");
        }
      }
      if (selectedView != null) {
        this.currentlyEditing = selectedView.model;
        selectedView.$el.find(".edit").addClass("editing");
        return selectedView.$el.addClass("editing");
      } else {
        return this.currentlyEditing = null;
      }
    };

    BlockGroupCollectionView.prototype.handleCollectionRemove = function(model) {
      if (model === this.currentSelection) {
        return this.trigger("group:selected", null);
      }
    };

    BlockGroupCollectionView.prototype.handleCollectionAdd = function(model) {};

    BlockGroupCollectionView.prototype.currentCreationFunction = function() {
      var newBlock, newBlockGroup;
      if (this.filterBy === "file") {
        return quadrigram.router.managers.serverManager.createPicker();
      } else if (this.filterBy === "custom") {
        newBlock = quadrigram.router.dataModels.currentProject.createCustomBlock();
        newBlockGroup = newBlock.get("blockGroup");
        this.selectById(newBlockGroup.get("id"));
        this.trigger("group:edit", newBlockGroup);
        return this.updateFormulaSelection(this.modelViews[this.currentSelection.cid]);
      }
    };

    BlockGroupCollectionView.prototype.removeByModel = function(model) {
      if (model == null) {
        return;
      }
      return this.collection.remove(model);
    };

    return BlockGroupCollectionView;

  })(Backbone.SortableCollectionView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockView = (function(_super) {
    __extends(DataBlockView, _super);

    function DataBlockView() {
      this.showDataChange = __bind(this.showDataChange, this);
      this.previewBlock = __bind(this.previewBlock, this);
      this.selectBlock = __bind(this.selectBlock, this);
      this.replaceModel = __bind(this.replaceModel, this);
      this.firstClickBlock = __bind(this.firstClickBlock, this);
      this.handleLabelChange = __bind(this.handleLabelChange, this);
      this.loopAnimation = __bind(this.loopAnimation, this);
      this.handleFetchState = __bind(this.handleFetchState, this);
      this.handleDataChange = __bind(this.handleDataChange, this);
      this.render = __bind(this.render, this);
      this.init = __bind(this.init, this);
      _ref = DataBlockView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockView.prototype.events = {
      "mousedown": "firstClickBlock",
      "click": "selectBlock",
      "dblclick": "previewBlock"
    };

    DataBlockView.prototype.init = function() {
      DataBlockView.__super__.init.call(this);
      this.model.on("change:fetchState", this.handleFetchState);
      this.model.on("change:data", this.handleDataChange);
      this.model.on("change:label", this.handleLabelChange);
      return this.model.on("replace-model", this.replaceModel);
    };

    DataBlockView.prototype.render = function() {
      var origin;
      if (!this.isNew) {
        DataBlockView.__super__.render.apply(this, arguments);
      }
      delete this.isNew;
      if (BlockUtils.isEmpty(this.model)) {
        this.$el.addClass("empty");
      } else {
        this.$el.removeClass("empty");
      }
      /*
      if @model instanceof quadrigram.Models.PreFunctionBlockModel
        @$el.css("opacity","0.2")
      else
        @$el.css("opacity","1")
      */

      origin = this.model.get("origin");
      if (origin !== null) {
        if (origin === "formula") {
          this.$el.addClass("formula-block");
        } else if (origin === "visualizer") {
          this.$el.addClass("visualizer-block");
        } else if (origin === "internal") {
          this.$el.addClass("internal-block");
        } else if (origin === "file") {
          this.$el.addClass("file-block");
        } else if (origin === "url") {
          this.$el.addClass("url-block");
        }
      }
      return this.handleFetchState();
    };

    DataBlockView.prototype.handleDataChange = function() {
      if (BlockUtils.isEmpty(this.model)) {
        this.$el.addClass("empty");
      } else {
        this.$el.removeClass("empty");
      }
      this.$el.find(".data-block-processing").stop();
      if (!this.$el.find(".data-block-processing").hasClass("active")) {
        this.$el.find(".data-block-processing").addClass("active");
        return this.loopAnimation();
      }
    };

    DataBlockView.prototype.handleFetchState = function() {
      this.$el.find(".data-block-processing").stop();
      if (this.model.get("fetchState") !== "ready") {
        this.$el.find(".data-block-processing").addClass("active");
        this.loopAnimation();
      } else {
        this.$el.find(".data-block-processing").removeClass("active");
      }
      if (BlockUtils.isEmpty(this.model)) {
        return this.$el.addClass("empty");
      } else {
        return this.$el.removeClass("empty");
      }
    };

    DataBlockView.prototype.loopAnimation = function(duration) {
      var _this = this;
      if (duration == null) {
        duration = 800;
      }
      return this.$el.find(".data-block-processing .processing-bar").animate({
        "margin-left": "100%"
      }, duration, function() {
        _this.$el.find(".data-block-processing .processing-bar").css("margin-left", "-100%");
        if (_this.model.get("fetchState") !== "ready") {
          return _this.loopAnimation(800);
        } else {
          return _this.$el.find(".data-block-processing").removeClass("active");
        }
      });
    };

    DataBlockView.prototype.handleLabelChange = function() {
      return this.$el.find(".data-block-name span").html(this.model.get("label"));
    };

    DataBlockView.prototype.firstClickBlock = function() {
      if (this.model.activate != null) {
        this.isNew = true;
        return this.model.activate();
      }
    };

    DataBlockView.prototype.replaceModel = function(model) {
      var e, oldModel;
      oldModel = this.model;
      this.model = model;
      for (e in oldModel._events) {
        if (!this.model._events[e]) {
          this.model._events[e] = [];
        }
        this.model._events[e] = this.model._events[e].concat(oldModel._events[e]);
      }
      oldModel.off();
      if (this.$el.hasClass("ui-draggable")) {
        this.$el.data("originalModel", this.model);
      }
      return this.handleFetchState();
    };

    DataBlockView.prototype.selectBlock = function(e) {
      return this.trigger("selected", this);
    };

    DataBlockView.prototype.previewBlock = function() {
      return quadrigram.router.appViews.uiView.showBlockPreview(this.model);
    };

    DataBlockView.prototype.showDataChange = function() {
      var oldColor,
        _this = this;
      oldColor = this.$el.find(".data-block-background").css("background");
      this.$el.find(".data-block-background").stop(true, true);
      this.$el.find(".data-block-background").css("background", "#0f0");
      return setTimeout(function() {
        return _this.$el.find(".data-block-background").css("background", "");
      }, 200);
      /*
      @$el.find(".data-block-background").animate({
        "background":"#f00"
      }, 1000)
      */

    };

    return DataBlockView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockSourceView = (function(_super) {
    __extends(DataBlockSourceView, _super);

    function DataBlockSourceView() {
      this.startDrag = __bind(this.startDrag, this);
      this.stopDrag = __bind(this.stopDrag, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      this.displayPill = __bind(this.displayPill, this);
      this.onOut = __bind(this.onOut, this);
      this.onHover = __bind(this.onHover, this);
      _ref = DataBlockSourceView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockSourceView.prototype.template = JST['app/scripts/templates/blocks/dataBlock.hbs'];

    DataBlockSourceView.prototype.className = "data-block";

    DataBlockSourceView.prototype.editMode = false;

    DataBlockSourceView.prototype.events = {
      'mouseover': 'onHover',
      'mouseout': 'onOut',
      "mousedown": "firstClickBlock",
      "click": "selectBlock",
      "dblclick": "previewBlock"
    };

    DataBlockSourceView.prototype.onHover = function(ev) {
      var _this = this;
      ev.stopImmediatePropagation;
      this.hoverState = true;
      this.funcHover || (this.funcHover = _.throttle(function() {
        if (_this.hoverState === true && _this.mouseState !== _this.hoverState) {
          _this.mouseState = _this.hoverState;
          return _this.displayPill(true);
        }
      }, 300, {
        trailing: true,
        leading: false
      }));
      return this.funcHover();
    };

    DataBlockSourceView.prototype.onOut = function(ev) {
      var _this = this;
      ev.stopImmediatePropagation;
      this.hoverState = false;
      this.funcOut || (this.funcOut = _.throttle(function() {
        if (_this.hoverState === false && _this.mouseState !== _this.hoverState) {
          _this.mouseState = _this.hoverState;
          return _this.displayPill(false);
        }
      }, 120, {
        trailing: true,
        leading: false
      }));
      return this.funcOut();
    };

    DataBlockSourceView.prototype.displayPill = function(state) {
      if (state === true) {
        this.$(".data-block-background").addClass("pill-background", 125, "easeOutCirc");
        return this.$(".data-block-name > p").addClass("pill", 125, "easeOutCirc");
      } else {
        this.$(".data-block-background").removeClass("pill-background", 125, "easeInCirc");
        return this.$(".data-block-name > p").removeClass("pill", 125, "easeInCirc");
      }
    };

    DataBlockSourceView.prototype.viewWillRender = function() {};

    DataBlockSourceView.prototype.viewDidRender = function() {
      return this.$el.draggable({
        appendTo: 'body',
        zIndex: 3000,
        start: this.startDrag,
        stop: this.stopDrag,
        helper: "clone",
        revert: "invalid",
        cursorAt: {
          left: 10 + 50,
          top: 10
        },
        revertDuration: 200
      }).data("originalModel", this.model);
    };

    DataBlockSourceView.prototype.checkMustRevert = function(e, ui) {
      return true;
    };

    DataBlockSourceView.prototype.stopDrag = function(e, ui) {
      return $(ui.helper).remove();
    };

    DataBlockSourceView.prototype.startDrag = function(e, ui) {
      ui.helper.css("width", "100px");
      ui.helper.css("height", "20px");
      ui.helper.css({
        'margin-left': 50 - e.offsetX + 'px'
      });
      ui.helper.animate({
        'width': '20px',
        "height": "20px",
        'margin-left': "50px"
      }, 120);
      return ui.helper.html("+");
    };

    return DataBlockSourceView;

  })(quadrigram.Views.DataBlockView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockReferenceView = (function(_super) {
    __extends(DataBlockReferenceView, _super);

    function DataBlockReferenceView() {
      this.stopDrag = __bind(this.stopDrag, this);
      this.startDrag = __bind(this.startDrag, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DataBlockReferenceView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockReferenceView.prototype.template = JST['app/scripts/templates/blocks/dataBlock.hbs'];

    DataBlockReferenceView.prototype.className = "data-block reference";

    DataBlockReferenceView.prototype.viewDidRender = function() {
      return this.$el.draggable({
        zIndex: 3000,
        start: this.startDrag,
        stop: this.stopDrag,
        cursorAt: {
          left: 10 + 50,
          top: 10
        }
      }).data("originalModel", this.model);
    };

    DataBlockReferenceView.prototype.startDrag = function(e, ui) {
      this.$el.css({
        'position': "absolute",
        'margin-left': ui.offset.left + 50 - e.offsetX,
        'margin-top': ui.offset.top - 30,
        'z-index': 3000,
        "width": "100px",
        "height": "20px",
        "cursor": "pointer"
      });
      this.$el.appendTo($(".front-container"));
      this.$el.animate({
        'width': '20px',
        "height": "20px",
        'margin-left': ui.offset.left + 50
      }, 120);
      return this.$el.html("+");
    };

    DataBlockReferenceView.prototype.stopDrag = function(e, ui) {
      $(ui.helper).remove();
      return this.remove();
    };

    return DataBlockReferenceView;

  })(quadrigram.Views.DataBlockView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockEditableView = (function(_super) {
    __extends(DataBlockEditableView, _super);

    function DataBlockEditableView() {
      this.showDataChange = __bind(this.showDataChange, this);
      this.previewBlock = __bind(this.previewBlock, this);
      this.selectBlock = __bind(this.selectBlock, this);
      this.updateOptions = __bind(this.updateOptions, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.changeFromModel = __bind(this.changeFromModel, this);
      this.changeFromEditor = __bind(this.changeFromEditor, this);
      this.resetToOneValue = __bind(this.resetToOneValue, this);
      this.activateListInput = __bind(this.activateListInput, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DataBlockEditableView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockEditableView.prototype.template = JST['app/scripts/templates/blocks/dataBlockEditable.hbs'];

    DataBlockEditableView.prototype.viewDidRender = function() {
      var specificContainer;
      this.inputEl = $("<input></input>");
      $(this.el).find(".input-component").append(this.inputEl);
      this.inputEl.val(this.model.getValue);
      if (this.model.get("internalOfSlot").get("ownerSlotGroup") instanceof quadrigram.Models.PropertyModel || this.model.get("internalOfSlot").get("ownerSlotGroup") instanceof quadrigram.Models.PreProperty) {
        specificContainer = $(".viz-inspector-ui-front");
      } else {
        specificContainer = $(".front-container");
      }
      if (this.model.get("internalOfSlot")) {
        switch (this.model.get("internalOfSlot").get("dataType")) {
          case "text":
            this.inputEl.inputWithFormat({
              "forceValueToFormat": /(.+)/
            });
            break;
          case "number":
            this.inputEl.inputWithFormat({
              "forceValueToFormat": /(-)?\s?(\d*[\.,]?\d*)/,
              "formatDefaults": "|"
            });
            break;
          case "number_px":
            this.inputEl.inputWithFormat({
              "forceValueToFormat": /(-)?(\d+)\s?(px)?/,
              "formatDefaults": "||px"
            });
            break;
          case "color":
            this.inputEl.colorInput({
              "contextualContainer": $(".front-container")
            });
            break;
          case "colorscale":
            this.inputEl.colorGradientInput({
              "contextualContainer": specificContainer
            });
            break;
          case "options":
            this.inputEl.inputWithOptions({
              "options": this.model.get("internalOfSlot").options,
              "contextualContainer": specificContainer,
              "autoOpenContextual": true,
              "forceValueToOption": true
            });
            break;
          case "percentage":
            this.inputEl.percentageInput();
            break;
          case "date":
            elog("input date not available");
            break;
          case "boolean":
            this.inputEl.booleanInput();
            break;
          case "noinput":
            this.inputEl.noInput({
              "label": "Drop data here",
              "background": "#CCC",
              "color": "#FFF",
              "opacity": 0.6
            });
            break;
          case "imageurl":
            this.inputEl.imageUrl({
              "contextualContainer": $(".front-container")
            });
            break;
          default:
            this.inputEl.inputWithFormat({
              "forceValueToFormat": /(.+)/
            });
        }
      } else {
        this.inputEl.inputWithFormat({
          "forceValueToFormat": /(.+)/
        });
      }
      if (this.model.get("internalOfSlot").get("multiValue")) {
        this.$el.find(".list-editor-toggle").on("mousedown", this.activateListInput);
      } else {
        this.$el.find(".list-editor-toggle").addClass("hidden");
        this.$el.find(".qm-input-wrapper").addClass("no-table-toggler");
      }
      this.inputEl.on("change", this.changeFromEditor);
      this.model.on("change", this.changeFromModel);
      this.pseudoBlockView = new quadrigram.Views.DataBlockEditableTable({
        model: this.model,
        binding: true
      });
      this.pseudoBlockView.render();
      $(this.el).find(".data-drop-value").append(this.pseudoBlockView.$el);
      this.pseudoBlockView.on("popped", this.resetToOneValue);
      return this.changeFromModel();
    };

    DataBlockEditableView.prototype.activateListInput = function() {
      var _this = this;
      this.inputEl.blur();
      if (this.model.activate != null) {
        this.isNew = true;
        this.model.activate();
      }
      return setTimeout(function() {
        if (_this.model.get("data").length > 0) {
          _this.model.setDataManual([new quadrigram.Models.QValue(_this.model.get("data")[0].value, _this.model.get("data")[0].id), new quadrigram.Models.QValue("", "")]);
        } else {
          _this.model.setDataManual([new quadrigram.Models.QValue("", ""), new quadrigram.Models.QValue("", "")]);
        }
        return _this.pseudoBlockView.previewBlock();
      }, 100);
    };

    DataBlockEditableView.prototype.resetToOneValue = function() {
      return this.model.setDataManual([new quadrigram.Models.QValue(this.model.get("data")[0].value, this.model.get("data")[0].id)]);
    };

    DataBlockEditableView.prototype.changeFromEditor = function(value) {
      this.model.setDataManual([new quadrigram.Models.QValue(this.inputEl.val(), 0)]);
      if (this.model.get("internalOfSlot").get("ownerSlotGroup").get("propId") === "fillColors") {
        return quadrigram.milestoneTracker.trackMilestone("colors", "changed");
      }
    };

    DataBlockEditableView.prototype.changeFromModel = function() {
      if (this.model.get("data").length > 1) {
        this.pseudoBlockView.$el.removeClass("hidden");
        return this.inputEl.parent().addClass("hidden");
      } else {
        this.pseudoBlockView.$el.addClass("hidden");
        this.inputEl.val(this.model.getValue());
        return this.inputEl.parent().removeClass("hidden");
      }
    };

    DataBlockEditableView.prototype.viewWillRemove = function() {
      if (this.inputEl) {
        this.inputEl.off("change", this.changeFromEditor);
        this.inputEl.remove();
      }
      if (this.pseudoBlockView) {
        this.pseudoBlockView.remove();
      }
      return this.model.off("change", this.changeFromModel);
    };

    DataBlockEditableView.prototype.updateOptions = function() {
      if (this.inputEl.inputWithOptions("instance") != null) {
        return this.inputEl.inputWithOptions("instance").updateOptions();
      }
    };

    DataBlockEditableView.prototype.selectBlock = function() {};

    DataBlockEditableView.prototype.previewBlock = function() {};

    DataBlockEditableView.prototype.showDataChange = function() {};

    return DataBlockEditableView;

  })(quadrigram.Views.DataBlockView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockCollectionElementView = (function(_super) {
    __extends(DataBlockCollectionElementView, _super);

    function DataBlockCollectionElementView() {
      this.displayPill = __bind(this.displayPill, this);
      this.onOut = __bind(this.onOut, this);
      this.onHover = __bind(this.onHover, this);
      this.replaceModel = __bind(this.replaceModel, this);
      this.viewDidRemove = __bind(this.viewDidRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DataBlockCollectionElementView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockCollectionElementView.prototype.template = JST['app/scripts/templates/blocks/dataBlockCollectionElement.hbs'];

    DataBlockCollectionElementView.prototype.events = {
      "mouseover": "onHover",
      "mouseout": "onOut"
    };

    DataBlockCollectionElementView.prototype.viewDidRender = function() {
      if (!this.blockView) {
        this.blockView = new quadrigram.Views.DataBlockSourceView({
          "model": this.model,
          "binding": false
        });
        this.blockView.render();
        this.blockView.$el.find(".data-block-background").addClass("minimized");
        this.blockView.$el.find(".data-block-name > span").addClass("minimized");
        this.$el.find(".data-block-item-container").append(this.blockView.$el);
        return this.model.on("replace-model", this.replaceModel);
      }
    };

    DataBlockCollectionElementView.prototype.viewDidRemove = function() {
      if (this.blockView != null) {
        return this.blockView.remove();
      }
    };

    DataBlockCollectionElementView.prototype.replaceModel = function(model) {
      return this.model = model;
    };

    DataBlockCollectionElementView.prototype.onHover = function(ev) {
      var _this = this;
      this.hoverState = true;
      this.funcHover || (this.funcHover = _.throttle(function() {
        if (_this.hoverState === true && _this.mouseState !== _this.hoverState) {
          _this.mouseState = _this.hoverState;
          return _this.displayPill(true);
        } else {

        }
      }, 300, {
        trailing: true,
        leading: false
      }));
      return this.funcHover();
    };

    DataBlockCollectionElementView.prototype.onOut = function() {
      var _this = this;
      this.hoverState = false;
      this.funcOut || (this.funcOut = _.throttle(function() {
        if (_this.hoverState === false && _this.mouseState !== _this.hoverState) {
          _this.mouseState = _this.hoverState;
          return _this.displayPill(false);
        } else {

        }
      }, 300, {
        trailing: true,
        leading: false
      }));
      return this.funcOut();
    };

    DataBlockCollectionElementView.prototype.displayPill = function(state) {
      if (state === true) {
        this.$(".data-block-name > span").removeClass("minimized", 100);
        return this.$(".data-block-background").removeClass("minimized", 200);
      } else {
        this.$(".data-block-name > span").addClass("minimized", 100);
        return this.$(".data-block-background").addClass("minimized", 200);
      }
    };

    return DataBlockCollectionElementView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.CustomBlockCollectionElementView = (function(_super) {
    __extends(CustomBlockCollectionElementView, _super);

    function CustomBlockCollectionElementView() {
      this.selectElement = __bind(this.selectElement, this);
      this.doNothing = __bind(this.doNothing, this);
      this.editBlock = __bind(this.editBlock, this);
      this.deleteBlock = __bind(this.deleteBlock, this);
      this.startChangingName = __bind(this.startChangingName, this);
      this.viewDidRemove = __bind(this.viewDidRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = CustomBlockCollectionElementView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    CustomBlockCollectionElementView.prototype.template = JST['app/scripts/templates/blocks/customBlockCollectionElement.hbs'];

    CustomBlockCollectionElementView.prototype.events = {
      "click .delete": "deleteBlock",
      "click .edit": "editBlock",
      "click .list-item": "doNothing"
    };

    CustomBlockCollectionElementView.prototype.viewDidRender = function() {
      this.blockView = new quadrigram.Views.DataBlockLabelable({
        "model": this.model,
        "binding": true
      });
      this.blockView.render();
      this.blockView.$el.on("click", this.selectElement);
      return this.$el.find(".list-item").prepend(this.blockView.$el);
    };

    CustomBlockCollectionElementView.prototype.viewDidRemove = function() {
      return this.blockView.remove();
    };

    CustomBlockCollectionElementView.prototype.startChangingName = function() {
      return this.blockView.startChangingName();
    };

    CustomBlockCollectionElementView.prototype.deleteBlock = function(event) {
      event.preventDefault();
      event.stopPropagation();
      return quadrigram.router.dataModels.currentProject.deleteCustomBlock(this.model.get("id"));
    };

    CustomBlockCollectionElementView.prototype.editBlock = function(event) {
      event.preventDefault();
      event.stopPropagation();
      this.trigger("select", this);
      return this.startChangingName();
    };

    CustomBlockCollectionElementView.prototype.doNothing = function(event) {
      event.preventDefault();
      event.stopPropagation();
      return this.trigger("select", this);
    };

    CustomBlockCollectionElementView.prototype.selectElement = function(event) {
      event.preventDefault();
      event.stopPropagation();
      return this.trigger("select", this);
    };

    return CustomBlockCollectionElementView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockCollectionView = (function(_super) {
    __extends(DataBlockCollectionView, _super);

    function DataBlockCollectionView() {
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.replaceOneModel = __bind(this.replaceOneModel, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.init = __bind(this.init, this);
      _ref = DataBlockCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockCollectionView.prototype.template = JST['app/scripts/templates/blocks/dataBlockCollection.hbs'];

    DataBlockCollectionView.prototype.modelView = quadrigram.Views.DataBlockCollectionElementView;

    DataBlockCollectionView.prototype.bindModelViews = false;

    DataBlockCollectionView.prototype.init = function(options) {
      DataBlockCollectionView.__super__.init.call(this, options);
      this.fullCollection = options.fullCollection;
      return this.filters = options.filters;
    };

    DataBlockCollectionView.prototype.viewDidRender = function() {
      return this.fullCollection.on("add", this.replaceOneModel);
    };

    DataBlockCollectionView.prototype.replaceOneModel = function(activatedModel) {
      var f, idx, preblock, skip;
      for (f in this.filters) {
        if (activatedModel.get(f) !== this.filters[f]) {
          skip = true;
        }
      }
      if (!skip) {
        preblock = _.find(this.collection, function(el) {
          return el.get("jsonKey") === activatedModel.get("jsonKey");
        });
        if (preblock) {
          idx = this.collection.indexOf(preblock);
          this.collection.splice(idx, 1, activatedModel);
        }
      }
      return this.replaceModels(this.collection);
    };

    /*
    replaceArray:(newArray)=>
      @replaceModels(newArray)
      @renderVisible()
    */


    DataBlockCollectionView.prototype.viewWillRemove = function() {
      return this.fullCollection.off("add", this.replaceOneModel);
    };

    return DataBlockCollectionView;

  })(Backbone.ArrayOfModelsView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.VisualizerView = (function(_super) {
    __extends(VisualizerView, _super);

    function VisualizerView() {
      this.startDownload = __bind(this.startDownload, this);
      this.canRender = __bind(this.canRender, this);
      this.requestDownloadImageURL = __bind(this.requestDownloadImageURL, this);
      this.calculateNumberDomain = __bind(this.calculateNumberDomain, this);
      this.remove = __bind(this.remove, this);
      this.updateOutput = __bind(this.updateOutput, this);
      this.toggleDisplayAttribute = __bind(this.toggleDisplayAttribute, this);
      this.getYDomain = __bind(this.getYDomain, this);
      this.getXDomain = __bind(this.getXDomain, this);
      this.setMode = __bind(this.setMode, this);
      this.setSelected = __bind(this.setSelected, this);
      this.visualizerParentChanged = __bind(this.visualizerParentChanged, this);
      this.visualizerDidResize = __bind(this.visualizerDidResize, this);
      this.visualizerAfterDidUpdateItems = __bind(this.visualizerAfterDidUpdateItems, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this._cleanChanges = __bind(this._cleanChanges, this);
      this._execBehaviorsAfterDidUpdate = __bind(this._execBehaviorsAfterDidUpdate, this);
      this._execBehaviorsAfterResize = __bind(this._execBehaviorsAfterResize, this);
      this._execBehaviorsAfterUpdate = __bind(this._execBehaviorsAfterUpdate, this);
      this._execBehaviorsBeforeUpdate = __bind(this._execBehaviorsBeforeUpdate, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      this._creatingVisualizerStructures = __bind(this._creatingVisualizerStructures, this);
      this.checkParentChange = __bind(this.checkParentChange, this);
      this.didResize = __bind(this.didResize, this);
      this._handleResize = __bind(this._handleResize, this);
      this._updateContentResize = __bind(this._updateContentResize, this);
      this._updateContent = __bind(this._updateContent, this);
      this.createBehavior = __bind(this.createBehavior, this);
      this.createBehaviors = __bind(this.createBehaviors, this);
      this._finishRender = __bind(this._finishRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      this.resetLeave = __bind(this.resetLeave, this);
      this.mouseEnter = __bind(this.mouseEnter, this);
      this.forceFocus = __bind(this.forceFocus, this);
      this.mouseMove = __bind(this.mouseMove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = VisualizerView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VisualizerView.prototype.template = JST['app/scripts/templates/visualizers/visualizer.hbs'];

    VisualizerView.prototype.className = "viz-view";

    VisualizerView.prototype.firstResize = true;

    VisualizerView.prototype.resizing = false;

    VisualizerView.prototype.init = function() {};

    VisualizerView.prototype.viewDidRender = function() {
      /*
      if @behaviors.zoom? || @ instanceof quadrigram.Views.PointsInAMapView || @behaviors.axis instanceof quadrigram.Models.ZoomableXAndYAxisBehavior
        @$el.prepend("<div class='zoom-cover'></div>")
        @zoomCover = @$el.find(".zoom-cover")
        @zoomCover.addClass("active")
        @zoomCover.attr("data-ui-tip-id","zoom-cover")
        @zoomCover.addClass("ui-tip-target")
        #@$el.on("mouseenter",@mouseEnter)
        @$el.on("mouseleave",@resetLeave)
        @$el.on("click tap",@forceFocus)
        #@$el.on("mousemove",@mouseMove)
        #@$el.on("mousemove",@mouseMove)
      */

    };

    VisualizerView.prototype.mouseMove = function(e) {
      /*
      if @_lastScreenPos? && (@_lastScreenPos.x != e.screenX || @_lastScreenPos.y != e.screenY)
        @_moveTimeout = setTimeout(()=>
          @zoomCover.removeClass("active")
        ,400);
      */

      if ((this._lastScreenPos != null) && (this._lastScreenPos.x !== e.screenX || this._lastScreenPos.y !== e.screenY)) {
        this.zoomCover.removeClass("active");
      }
      return this._lastScreenPos = {
        x: e.screenX,
        y: e.screenY
      };
    };

    VisualizerView.prototype.forceFocus = function(e) {
      return this.zoomCover.removeClass("active");
    };

    VisualizerView.prototype.mouseEnter = function(e) {
      if ((this._lastScreenPos == null) || (this._lastScreenPos.x !== e.screenX || this._lastScreenPos.y !== e.screenY)) {
        log("-> and moved");
        return this.zoomCover.removeClass("active");
      }
    };

    VisualizerView.prototype.resetLeave = function(e) {
      this._lastScreenPos = null;
      log("leaved viz");
      return this.zoomCover.addClass("active");
    };

    VisualizerView.prototype.viewWillRender = function() {};

    VisualizerView.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    VisualizerView.prototype._finishRender = function() {
      this.$el.parents('li.gridster-item.gs-w').on('qresize', this._handleResize);
      this.$el.parents('li.gridster-item.gs-w').on('qresizeEnd', this.didResize);
      this.$el.parents('li.gridster-item.gs-w').on('parentChange', this.checkParentChange);
      this.$el.prepend("<div class='temp-background'></div>");
      this.$el.prepend("<div class='viz-view-background'></div>");
      this.model.on("change", this._updateContent);
      this.createBehaviors();
      VisualizerView.__super__._finishRender.call(this);
      return this.didResize();
    };

    /*
    handleOrientationChange:(e) =>
      _.delay(@didResize,500)
    */


    VisualizerView.prototype.createBehaviors = function() {
      var behavior, behaviorPath, _i, _len, _ref1, _results;
      if (this.behaviors == null) {
        this.behaviors = {};
      }
      _ref1 = this.model.behaviors;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        behaviorPath = _ref1[_i];
        behavior = this.createBehavior(behaviorPath);
        _results.push(this.behaviors[behavior.constructor.field] = behavior);
      }
      return _results;
    };

    VisualizerView.prototype.createBehavior = function(behaviorPath, storeInBehaviors) {
      var behavior, behaviorClass, childrenBehavior, childrenBehaviorPath, childrenBehaviors, _i, _len, _ref1;
      behaviorClass = eval(behaviorPath);
      childrenBehaviors = {};
      _ref1 = behaviorClass.behaviors;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        childrenBehaviorPath = _ref1[_i];
        childrenBehavior = this.createBehavior(childrenBehaviorPath);
        childrenBehaviors[childrenBehavior.constructor.field] = childrenBehavior;
      }
      behavior = new behaviorClass(this, childrenBehaviors);
      return behavior;
    };

    /*
    checkInView:()=>
      element = this.$el
      parent = this.$el.closest(".gridster")
      if element.offset().top > window.innerHeight
        return false
      return true
    */


    VisualizerView.prototype._updateContent = function() {
      var _this = this;
      this._creatingVisualizerStructures();
      if (!this.values || !this.ids) {
        return;
      }
      this.model.original.userInteractive = false;
      this.visualizerWillExecBehaviors1();
      this._execBehaviorsBeforeUpdate();
      this.visualizerWillUpdateItems();
      this.updateItems();
      this._execBehaviorsAfterUpdate();
      this.visualizerDidUpdateItems();
      this._execBehaviorsAfterDidUpdate();
      this.visualizerAfterDidUpdateItems();
      this._cleanChanges();
      this.toggleDisplayAttribute();
      this.model.original.userInteractive = true;
      return _.delay(function() {
        return _this.model.original.trigger("graphicalUpdate", _this.model.original);
      }, 100);
    };

    VisualizerView.prototype._updateContentResize = function() {
      var _this = this;
      if (!this.values || !this.ids) {
        return;
      }
      this.resizing = true;
      this.visualizerWillExecBehaviors1();
      this._execBehaviorsBeforeUpdate();
      this.visualizerWillUpdateItems();
      this.updateItems();
      this._execBehaviorsAfterResize();
      this.visualizerDidUpdateItems();
      this._execBehaviorsAfterDidUpdate();
      this.visualizerDidResize();
      this.visualizerAfterDidUpdateItems();
      this.resizing = false;
      return _.delay(function() {
        return _this.model.original.trigger("graphicalUpdate", _this.model.original);
      }, 100);
    };

    VisualizerView.prototype._handleResize = function() {
      /*
      if(@firstResize)
        @_updateContent()
        @firstResize = false
        return
      else
        @$el.trigger('onResize')
        #porque este lazyREsize????
        #@lazyResize()
      */

      this.$el.trigger('onResize');
      /*
      if(!@resizing)
        $('.layout-guides-container').addClass("resizing", 200)
        @$el.parents(".viz-container").addClass("resizing", 200)
      */

      return this.resizing = true;
    };

    VisualizerView.prototype.didResize = function() {
      if (this.firstResize) {
        this._updateContent();
        this.firstResize = false;
      } else {
        this._updateContentResize();
      }
      this.$el.trigger('didResize');
      return this.resizing = false;
    };

    VisualizerView.prototype.checkParentChange = function() {
      var newParent;
      if ((this.$currentParent == null) || !this.$currentParent.is(this.$el.closest(".gridster"))) {
        newParent = true;
      }
      this.$currentParent = this.$el.closest(".gridster");
      if (newParent) {
        return this.visualizerParentChanged();
      }
    };

    VisualizerView.prototype._creatingVisualizerStructures = function() {
      var behavior, behaviorKey;
      for (behaviorKey in this.behaviors) {
        behavior = this.behaviors[behaviorKey];
        if (behavior.executeStructureStage) {
          behavior.executeStructureStage();
        }
      }
      return this.setIdsAndValues();
    };

    VisualizerView.prototype.setIdsAndValues = function() {
      this.model.original._ids = this.ids;
      return this.model.original._values = this.values;
    };

    VisualizerView.prototype._execBehaviorsBeforeUpdate = function() {
      var behavior, behaviorKey, _results;
      _results = [];
      for (behaviorKey in this.behaviors) {
        behavior = this.behaviors[behaviorKey];
        if (behavior.executeBeforeUpdateStage) {
          _results.push(behavior.executeBeforeUpdateStage());
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    VisualizerView.prototype._execBehaviorsAfterUpdate = function() {
      var behavior, behaviorKey, _results;
      _results = [];
      for (behaviorKey in this.behaviors) {
        behavior = this.behaviors[behaviorKey];
        if (behavior.executeAfterUpdateStage) {
          _results.push(behavior.executeAfterUpdateStage());
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    VisualizerView.prototype._execBehaviorsAfterResize = function() {
      var behavior, behaviorKey, _results;
      _results = [];
      for (behaviorKey in this.behaviors) {
        behavior = this.behaviors[behaviorKey];
        if (behavior.executeAfterResize) {
          _results.push(behavior.executeAfterResize());
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    VisualizerView.prototype._execBehaviorsAfterDidUpdate = function() {
      var behavior, behaviorKey, _results;
      _results = [];
      for (behaviorKey in this.behaviors) {
        behavior = this.behaviors[behaviorKey];
        if (behavior.executeAfterDidUpdateStage) {
          _results.push(behavior.executeAfterDidUpdateStage());
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    VisualizerView.prototype._cleanChanges = function() {
      this.changedData = false;
      this.model.changed = {};
      return this.model.original.changed = {};
    };

    VisualizerView.prototype.visualizerWillExecBehaviors1 = function() {};

    VisualizerView.prototype.visualizerWillUpdateItems = function() {};

    VisualizerView.prototype.updateItems = function() {};

    VisualizerView.prototype.visualizerDidUpdateItems = function() {};

    VisualizerView.prototype.visualizerAfterDidUpdateItems = function() {};

    VisualizerView.prototype.visualizerDidResize = function() {};

    VisualizerView.prototype.visualizerParentChanged = function() {};

    VisualizerView.prototype.setSelected = function(value) {};

    VisualizerView.prototype.setMode = function(value) {};

    VisualizerView.prototype.getXDomain = function() {
      return elog("getXDomain not defined!");
    };

    VisualizerView.prototype.getYDomain = function() {
      return elog("getYDomain not defined!");
    };

    VisualizerView.prototype.toggleDisplayAttribute = function() {
      this.$el.css('display', 'none');
      return this.$el.css('display', 'inherit');
    };

    VisualizerView.prototype.updateOutput = function(behaviorName, newValue, newMeta) {
      this.model.original.triggering = true;
      this.model.original.updateOutput(behaviorName, newValue, newMeta);
      return this.model.original.triggering = false;
    };

    VisualizerView.prototype.remove = function() {
      /*
      try
        @$el.removeResize(@_handleResize)
      catch e
        log "visualizerView:remove Eception:",e
      */

      this.model.off("childModified");
      this.model.off("change", this._updateContent);
      this.$el.parents('li.gridster-item.gs-w').off('qresize', this._handleResize);
      this.$el.parents('li.gridster-item.gs-w').off('qresizeEnd', this.didResize);
      this.$el.parents('li.gridster-item.gs-w').off('parentChange', this.checkParentChange);
      /*
      @$el.parents('.gridster-item.gs-w').off('resizeEnd',@didResize)
      @$el.parents('.gridster ul').off('gridsterResize', @didResize)
      */

      if (this.svg) {
        $(this.svg[0][0]).find("*").remove();
        this.svg.remove();
        this.$el.remove();
      }
      return VisualizerView.__super__.remove.apply(this, arguments);
    };

    VisualizerView.prototype.calculateNumberDomain = function(values, accumulate, field) {
      var item, max, min, output, _i, _len;
      if (values.length === 0) {
        return [0, 1];
      }
      if (!field) {
        field = "value";
      }
      output = [];
      min = Infinity;
      max = -Infinity;
      if (_.isArray(values[0].value)) {
        for (_i = 0, _len = values.length; _i < _len; _i++) {
          item = values[_i];
          if (item.value.length === 0) {
            continue;
          }
          min = Math.min(min, d3.min(item.value, function(item2, index) {
            output = 0;
            if (!accumulate) {
              output = +item2.value;
            } else {
              if (isNaN(item2.value0)) {
                output = parseFloat(item2.value);
              } else {
                output = parseFloat(item2.value) + parseFloat(item2.value0);
              }
            }
            if (isNaN(output)) {
              output = 0;
            }
            return output;
          }));
          max = Math.max(max, d3.max(item.value, function(item2, index) {
            output = 0;
            if (!accumulate) {
              output = +item2.value;
            } else {
              if (isNaN(item2.value0)) {
                output = parseFloat(item2.value);
              } else {
                output = parseFloat(item2.value) + parseFloat(item2.value0);
              }
            }
            if (isNaN(output)) {
              output = 0;
            }
            return output;
          }));
        }
        output = [min, max];
      } else {
        output = d3.extent(values, function(item, index) {
          return +item[field];
        });
      }
      return output;
    };

    VisualizerView.prototype.requestDownloadImageURL = function(type) {
      if (this.behaviors.svg) {
        return this.behaviors.svg.requestDownloadImageURL(this.startDownload, type);
      } else if (this.behaviors.axis) {
        return this.behaviors.axis.behaviors.svg.requestDownloadImageURL(this.startDownload, type);
      } else if (this.behaviors.map) {
        return this.behaviors.map.requestDownloadImageURL(this.startDownload);
      }
    };

    VisualizerView.prototype.canRender = function(type) {
      if (this.behaviors.map && type === "png") {
        return true;
      }
      if ((this.behaviors.svg != null) || (this.behaviors.axis != null)) {
        return true;
      }
      return false;
    };

    VisualizerView.prototype.startDownload = function(url, extension) {
      var a;
      a = document.createElement("a");
      document.body.appendChild(a);
      a.setAttribute("download", this.model.original.get("blockGroup").get("label") + "." + extension);
      a.setAttribute("href", url);
      a.style["display"] = "none";
      a.click();
      a.remove();
      return quadrigram.achievementTracker.trackDirectAction("saveImage");
      /*
      if @vizView && @vizView.behaviors.axis
        @vizView.behaviors.axis.behaviors.svg.openSVGDownloadImage()
      */

    };

    return VisualizerView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.VisualizerContainerView = (function(_super) {
    __extends(VisualizerContainerView, _super);

    function VisualizerContainerView() {
      this.encode_as_img_and_link = __bind(this.encode_as_img_and_link, this);
      this.submit_download_form = __bind(this.submit_download_form, this);
      this.handlePrintViz = __bind(this.handlePrintViz, this);
      this._hideCurrentSize = __bind(this._hideCurrentSize, this);
      this.updateSizeFeedback = __bind(this.updateSizeFeedback, this);
      this.showCurrentSize = __bind(this.showCurrentSize, this);
      this.setMode = __bind(this.setMode, this);
      this.requestDownloadURL = __bind(this.requestDownloadURL, this);
      this.handleDownloadViz = __bind(this.handleDownloadViz, this);
      this.handleRemoveViz = __bind(this.handleRemoveViz, this);
      this.handleOutputViz = __bind(this.handleOutputViz, this);
      this.setOutputSelected = __bind(this.setOutputSelected, this);
      this.setSelected = __bind(this.setSelected, this);
      this.selectOnClick = __bind(this.selectOnClick, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.handleNewLabel = __bind(this.handleNewLabel, this);
      this.handleDrop = __bind(this.handleDrop, this);
      this.handleDropAccept = __bind(this.handleDropAccept, this);
      this.handleMouseDown = __bind(this.handleMouseDown, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = VisualizerContainerView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VisualizerContainerView.prototype.template = JST['app/scripts/templates/visualizers/visualizerContainer.hbs'];

    VisualizerContainerView.prototype.downloadButtonsTemplate = JST['app/scripts/templates/visualizers/downloadButtons.hbs'];

    VisualizerContainerView.prototype.events = {
      "click .delete-viz-button": "handleRemoveViz",
      "click .output-viz-button": "handleOutputViz",
      "click .print-viz-button": "handlePrintViz",
      "click .download-viz-button": "handleDownloadViz"
    };

    VisualizerContainerView.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    VisualizerContainerView.prototype.viewWillRender = function() {};

    VisualizerContainerView.prototype.viewDidRender = function() {
      var className, viewClass, vizModel,
        _this = this;
      className = this.model.constructor.name.replace("Model", "");
      viewClass = eval("quadrigram.Views." + className + "View");
      vizModel = this.model.getFlatModel();
      this.vizView = new viewClass({
        model: vizModel
      });
      this.vizView.render();
      _.defer(function() {
        if (!_this.vizView.canRender("svg") && !_this.vizView.canRender("png")) {
          return _this.$el.find(".download-viz-button").addClass("hidden");
        }
      });
      this.$el.find(".viz-view-container").append(this.vizView.$el);
      this.$el.find(".viz-label").html(this.model.get("blockGroup").get("label"));
      this.model.get("blockGroup").on("change:label", this.handleNewLabel);
      if (className === "TextArea" || className === "RectangleArea") {
        this.$el.find(".viz-label").addClass("hidden");
      }
      if (!this.model.get("blockGroup").hasOutputs || !this.model.get("blockGroup").hasOutputs()) {
        this.$el.find(".output-viz-button").addClass("hidden");
      }
      this.$el.on("click", this.selectOnClick);
      this.$el.parent().find(".gs-resize-handle-both").on("mouseover", function() {
        return _this.showCurrentSize();
      });
      this.vizView.$el.on("onResize", this.showCurrentSize);
      this.hideCurrentSize = _.debounce(this._hideCurrentSize, 1000);
      this.trigger("renderFinished");
      return this.$el.on("mousedown", this.handleMouseDown);
      /*
      _.defer( ()=>
        @$el.droppable({
          drop: @handleDrop,
          #over: @handleDrag
          #hoverClass: "drop-hover"
          ##TODO: here we can filter for things like "datablock-edtiable-table"
          #accept: ".data-block"
          accept: @handleDropAccept
            
          greedy: true
        })
      )
      */

    };

    VisualizerContainerView.prototype.handleMouseDown = function(e) {
      if (quadrigram.router.appViews.projectView.D_pressed) {
        quadrigram.router.appViews.projectView.D_pressed = false;
        this.model.duplicate();
        e.stopPropagation();
        return e.preventDefault();
      }
    };

    VisualizerContainerView.prototype.handleDropAccept = function(draggEl) {
      if (!draggEl.hasClass("reference") && (draggEl.hasClass("file-block") || draggEl.hasClass("formula-block") || draggEl.hasClass("visualizer-block"))) {
        if (this.model.get("propertiesCollection").findWhere({
          "propId": "data"
        }) || this.model.prePropertiesCollection.findWhere({
          "propId": "data"
        })) {
          return true;
        }
      }
      return false;
    };

    VisualizerContainerView.prototype.handleDrop = function(e, ui) {
      var classesBefore, newClone, parentBefore, pos1,
        _this = this;
      if (this.model.get("propertiesCollection").findWhere({
        "propId": "data"
      }) == null) {
        this.model.prePropertiesCollection.findWhere({
          "propId": "data"
        }).activate();
      }
      this.trigger('selected', this.model);
      parentBefore = ui.helper.parent();
      classesBefore = ui.helper.attr("class");
      newClone = $(ui.helper).clone(true);
      parentBefore.append(newClone);
      log("parent before", parentBefore);
      newClone.stop();
      pos1 = quadrigram.router.appViews.uiView.vizInspector.$el.offset();
      newClone.animate({
        "top": pos1.top + 100,
        "left": pos1.left
      }, 200, 'easeInQuart', function() {
        var pos2;
        pos2 = quadrigram.router.appViews.uiView.vizInspector.dataSlotPosition();
        quadrigram.router.appViews.uiView.vizInspector.contentView.$el.find("li[data='data']").trigger("click");
        return newClone.animate({
          "top": pos2.top + 6,
          "left": pos2.left + 70,
          "margin-left": 0
        }, 200, 'easeOutQuart', function() {
          newClone.remove();
          return _this.vizView.model.original.insertToDataSlot($(ui.draggable).data("originalModel"));
        });
      });
      return true;
    };

    VisualizerContainerView.prototype.handleNewLabel = function() {
      return this.$el.find(".viz-label").html(this.model.get("blockGroup").get("label"));
    };

    VisualizerContainerView.prototype.viewWillRemove = function() {
      log("VisualizerContainerView:remove ?");
      this.$el.closest("li").addClass("hidden");
      this.$el.off("click", this.selectOnClick);
      this.model.get("blockGroup").off("change:label", this.handleNewLabel);
      if (this.vizView) {
        return this.vizView.remove();
      }
    };

    VisualizerContainerView.prototype.selectOnClick = function(e) {
      if (this.$el.hasClass("edit-mode") && !$(e.target).hasClass("delete-viz-button") && !$(e.target).hasClass("output-viz-button")) {
        return this.trigger("selected", this.model);
      }
    };

    VisualizerContainerView.prototype.setSelected = function(value) {
      if (value) {
        this.$el.addClass("selected");
        this.$el.removeClass("not-selected");
      } else {
        this.$el.removeClass("selected");
        this.$el.addClass("not-selected");
      }
      if (this.vizView) {
        return this.vizView.setSelected(value);
      }
    };

    VisualizerContainerView.prototype.setOutputSelected = function(value) {
      if (value) {
        return this.$el.addClass("output-selected");
      } else {
        return this.$el.removeClass("output-selected");
      }
    };

    VisualizerContainerView.prototype.handleOutputViz = function() {
      quadrigram.tracker.sendEvent({
        event_type: 301
      });
      return quadrigram.router.appViews.uiView.toolbar.filesExplorer.selectVisualizerOutput(this.model.get("blockGroup").id);
    };

    VisualizerContainerView.prototype.handleRemoveViz = function() {
      return quadrigram.router.dataModels.currentProject.removeVisualizer(this.model);
    };

    VisualizerContainerView.prototype.handleDownloadViz = function() {
      var buttons, cover, ctx, downloadMenu,
        _this = this;
      downloadMenu = $(this.downloadButtonsTemplate());
      $("body").append(downloadMenu);
      cover = downloadMenu.find(".cover");
      /*
      cover.css({
        position: "absolute";
        top: "0px";
        left: "0px";
        "z-index": 999999;
      })
      */

      cover.attr("width", $(window).innerWidth());
      cover.attr("height", $(window).innerHeight());
      ctx = cover[0].getContext('2d');
      ctx.fillStyle = "rgba(0, 0, 0, 0.5)";
      ctx.fillRect(0, 0, $(window).innerWidth(), $(window).innerHeight());
      ctx.clearRect(this.$el.offset().left, this.$el.offset().top, this.$el.width(), this.$el.height());
      cover.on("click", function() {
        return downloadMenu.remove();
      });
      buttons = downloadMenu.find(".button-container");
      buttons.css("left", this.$el.offset().left + this.$el.width() / 2 - 120);
      buttons.css("top", this.$el.offset().top - 50);
      if (!this.vizView.canRender("svg")) {
        buttons.find(".svg").css("display", "none");
      }
      buttons.find(".svg").on("click", function() {
        _this.requestDownloadURL("svg");
        return downloadMenu.remove();
      });
      return buttons.find(".png").on("click", function() {
        _this.requestDownloadURL("png");
        return downloadMenu.remove();
      });
    };

    VisualizerContainerView.prototype.requestDownloadURL = function(type) {
      return this.vizView.requestDownloadImageURL(type);
    };

    VisualizerContainerView.prototype.setMode = function(newMode) {
      this.currentMode = newMode;
      if (this.vizView) {
        this.vizView.setMode(newMode);
      }
      if (this.currentMode === "preview") {
        this.$el.find(".context-menu").css("display", "none");
        return this.$el.removeClass("edit-mode");
      } else {
        this.$el.find(".context-menu").css("display", "");
        return this.$el.addClass("edit-mode");
      }
    };

    VisualizerContainerView.prototype.showCurrentSize = function() {
      if (!quadrigram.environment === "editor") {
        return;
      }
      this.$el.find(".size-feedback-container").removeClass("hidden");
      this.updateSizeFeedback();
      return this.hideCurrentSize();
    };

    VisualizerContainerView.prototype.updateSizeFeedback = function() {
      return this.$el.find(".size-feedback").html(this.$el.width() + "px x " + this.$el.height() + "px");
    };

    VisualizerContainerView.prototype._hideCurrentSize = function() {
      return this.$el.find(".size-feedback-container").addClass("hidden");
    };

    VisualizerContainerView.prototype.handlePrintViz = function() {};

    VisualizerContainerView.prototype.submit_download_form = function(output_format) {
      var form, svg, svg_xml;
      svg = this.$el.find('.bkg-svg')[0];
      svg_xml = (new XMLSerializer).serializeToString(svg);
      this.$el.parent().append('<form id="svgform">\
      <input type="hidden" id="output_format" name="output_format" value="svg">\
      <input type="hidden" id="data" name="data">\
      </form>');
      form = document.getElementById('svgform');
      form['output_format'].value = output_format;
      form['data'].value = svg_xml;
      form.submit();
    };

    VisualizerContainerView.prototype.encode_as_img_and_link = function() {
      var b64, svg;
      $('svg').attr({
        version: '1.1',
        xmlns: 'http://www.w3.org/2000/svg'
      });
      svg = this.$el.find('.bkg-svg').parent().html();
      b64 = unescape(encodeURIComponent(svg));
      this.$el.parent().append($('<a href=\'data:image/svg+xml;base64,\n' + b64 + '\' title=\'file.svg\'>Download</a>'));
    };

    return VisualizerContainerView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.VizInspectorContentView = (function(_super) {
    __extends(VizInspectorContentView, _super);

    function VizInspectorContentView() {
      this.remove = __bind(this.remove, this);
      this.detachToolbar = __bind(this.detachToolbar, this);
      this.filterInternal = __bind(this.filterInternal, this);
      this.renderFamily = __bind(this.renderFamily, this);
      this.selectFamily = __bind(this.selectFamily, this);
      this.familyClicked = __bind(this.familyClicked, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      this.render = __bind(this.render, this);
      _ref = VizInspectorContentView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VizInspectorContentView.prototype.template = JST['app/scripts/templates/UI/vizInspectorContent.hbs'];

    VizInspectorContentView.prototype.render = function() {
      return VizInspectorContentView.__super__.render.call(this);
    };

    VizInspectorContentView.prototype.viewWillRender = function() {
      var f, famName, famOb, prop, templateFamilies, _i, _j, _len, _len1, _ref1, _ref2,
        _this = this;
      this.familiesOrder = ["data", "network", "style", "select", "axis", "features", "geo", "tooltip", "textstyles"];
      this.familiesNames = {
        data: "data",
        style: "style",
        select: "select",
        axis: "axis",
        features: "features",
        geo: "geo",
        tooltip: "tooltip",
        textstyles: "text",
        text: "text",
        network: "network"
      };
      famOb = {};
      _ref1 = this.model.getPropertiesCollection().models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        prop = _ref1[_i];
        if (!prop.get("internal")) {
          famOb[prop.get("family")] = true;
        }
      }
      this.families = [];
      for (famName in famOb) {
        this.families.push(famName);
      }
      this.families.splice(this.families.indexOf("layout"), 1);
      this.families.sort(function(a, b) {
        if (_this.familiesOrder.indexOf(a) < 0) {
          return 1;
        }
        if (_this.familiesOrder.indexOf(b) < 0) {
          return -1;
        }
        return _this.familiesOrder.indexOf(a) > _this.familiesOrder.indexOf(b);
      });
      if (this.model.constructor.name === "TextAreaModel") {
        this.families.unshift("text");
        this.families.splice(this.families.indexOf("data"), 1);
      }
      templateFamilies = [];
      _ref2 = this.families;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        f = _ref2[_j];
        templateFamilies.push({
          id: f,
          label: this.familiesNames[f]
        });
      }
      return this.templateData.families = templateFamilies;
    };

    VizInspectorContentView.prototype.viewDidRender = function() {
      this.$el.find("li").on("click", this.familyClicked);
      if (this.model.latestFamilyId) {
        return this.selectFamily(this.model.latestFamilyId);
      } else {
        return this.$el.find("[data=" + this.families[0] + "]").trigger("click");
      }
    };

    VizInspectorContentView.prototype.familyClicked = function(e) {
      return this.selectFamily($(e.currentTarget).attr("data"));
    };

    VizInspectorContentView.prototype.selectFamily = function(familyId) {
      if (this.currentId !== familyId) {
        this.model.latestFamilyId = familyId;
        this.$el.find("li").removeClass("selected");
        this.renderFamily(familyId);
        return this.$el.find("li[data ='" + familyId + "']").addClass("selected");
      }
    };

    VizInspectorContentView.prototype.renderFamily = function(familyId) {
      var lastFamily, subCol,
        _this = this;
      lastFamily = this.currentFamily;
      if (this.toolbar) {
        $(this.toolbar).detach();
      }
      subCol = new Backbone.Collection(this.model.getPropertiesCollection().where({
        "family": familyId
      }));
      this.currentId = familyId;
      subCol = this.filterInternal(subCol);
      subCol.comparator = "sortingWeight";
      subCol.sort();
      if (familyId === "text") {
        this.toolbar = quadrigram.router.managers.fontManager.textbarManager.theToolbar.container;
        this.$el.find(".family-container").append(this.toolbar);
        this.trigger("rendered");
        if (lastFamily) {
          return lastFamily.remove();
        }
      } else {
        this.currentFamily = new quadrigram.Views.PropertiesFamily({
          collection: subCol
        });
        if (this.toolbar) {
          $(this.toolbar).trigger("detach");
          $(this.toolbar).detach();
          this.toolbar = null;
        }
        this.currentFamily.render();
        return this.currentFamily.on("rendered", function() {
          _this.currentFamily.off("rendered");
          if (lastFamily) {
            lastFamily.remove();
          }
          _this.$el.find(".family-container").append(_this.currentFamily.$el);
          _this.$el.find(".family-container").off('scroll');
          _this.$el.find(".family-container").on('scroll', function() {
            $(this).closest(".viz-inspector-container").find('.viz-inspector-ui-front').css("top", "-" + $(this).scrollTop() + "px");
            return $(this).closest(".viz-inspector-container").find('.viz-inspector-ui-front').css("clip", "rect(" + ($(this).scrollTop() + 52) + "px 230px 1000px 0px");
          });
          return _this.trigger("rendered");
        });
      }
    };

    VizInspectorContentView.prototype.filterInternal = function(propertiesCollection) {
      var filteredCollection, prop, _i, _len, _ref1;
      filteredCollection = new Backbone.Collection;
      _ref1 = propertiesCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        prop = _ref1[_i];
        if ((prop.get("internal") == null) || prop.get("internal") === false) {
          if (prop instanceof quadrigram.Models.PreProperty || prop instanceof quadrigram.Models.PropertyModel) {
            filteredCollection.add(prop);
          }
        }
      }
      return filteredCollection;
    };

    VizInspectorContentView.prototype.detachToolbar = function() {
      if (this.toolbar) {
        $(this.toolbar).trigger("detach");
        return $(this.toolbar).detach();
      }
    };

    VizInspectorContentView.prototype.remove = function(options) {
      if (this.toolbar && (!options || !options.preserveToolbar)) {
        $(this.toolbar).trigger("detach");
        $(this.toolbar).detach();
      }
      if (this.currentFamily) {
        this.currentFamily.remove();
      }
      return VizInspectorContentView.__super__.remove.call(this);
    };

    return VizInspectorContentView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.SlotView = (function(_super) {
    __extends(SlotView, _super);

    function SlotView() {
      this.animateWrongData = __bind(this.animateWrongData, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.focusOutSlot = __bind(this.focusOutSlot, this);
      this.focusOnSlot = __bind(this.focusOnSlot, this);
      this.renderInternalBlock = __bind(this.renderInternalBlock, this);
      this.renderBlock = __bind(this.renderBlock, this);
      this.handleDrag = __bind(this.handleDrag, this);
      this.handleDrop = __bind(this.handleDrop, this);
      this.toggleFunctionBlock = __bind(this.toggleFunctionBlock, this);
      this.updateView = __bind(this.updateView, this);
      this.replaceModel = __bind(this.replaceModel, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = SlotView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SlotView.prototype.template = JST['app/scripts/templates/blocks/slot.hbs'];

    SlotView.prototype.className = "slot";

    SlotView.prototype.events = {
      "click": "focusOnSlot",
      "focusout": "focusOutSlot"
    };

    SlotView.prototype.functionAvailable = true;

    SlotView.prototype.allowBlockPreview = true;

    SlotView.prototype.viewWillRender = function() {
      this.templateData.needsLabel = this.needsLabel;
      return this.templateData.label = this.model.get("slotLabel") ? this.model.get("slotLabel") : this.model.get("slotId");
    };

    SlotView.prototype.viewDidRender = function() {
      this.$el.find(".slot-container").droppable({
        drop: this.handleDrop,
        over: this.handleDrag,
        hoverClass: "drop-hover",
        accept: ".data-block",
        greedy: true
      });
      if (this.functionAvailable) {
        this.$el.find(".function-btn").on("click", this.toggleFunctionBlock);
        this.$el.find(".function-btn").removeClass("not-available");
      }
      this.model.on("change", this.updateView);
      this.model.on("replace-model", this.replaceModel);
      this.model.on("wrongData", this.animateWrongData);
      return this.updateView();
    };

    SlotView.prototype.replaceModel = function(model) {
      var e, oldModel;
      oldModel = this.model;
      this.model = model;
      for (e in oldModel._events) {
        if (!this.model._events[e]) {
          this.model._events[e] = [];
        }
        this.model._events[e] = this.model._events[e].concat(oldModel._events[e]);
      }
      return oldModel.off();
    };

    SlotView.prototype.updateView = function() {
      if (this.currentView) {
        this.currentView.remove();
      }
      if (this.model.get("externalBlock")) {
        return this.renderBlock(this.model.get("externalBlock"));
      } else {
        return this.renderInternalBlock(this.model.get("internalBlock"));
      }
    };

    SlotView.prototype.toggleFunctionBlock = function(e) {
      return this.model.createAndInsertFunctionBlock();
    };

    SlotView.prototype.handleDrop = function(e, ui) {
      var block;
      block = $(ui.draggable).data("originalModel");
      if (block != null) {
        if (block.constructor.name === "FunctionBlockModel" && block.dependsOn(this.model.get("ownerSlotGroup").get("ownerBlock"))) {
          elog("Should never put a block inside of itself!!!!");
        } else {
          this.model.setExternalBlock(block);
        }
      } else {
        $(ui.helper).remove();
        throw "Dropped block has lost its data... (Firefox issue)";
      }
      if (block != null) {
        quadrigram.achievementTracker.checkBlockInSlot(block, this.model);
      }
      if (block != null) {
        if (block instanceof quadrigram.Models.FunctionBlockModel && block.get("origin") === "file" && this.model.get("ownerSlotGroup").get("propId") === "data") {
          quadrigram.milestoneTracker.trackMilestone("data_manager", "bind_data");
        }
      }
      if (block != null) {
        if (block instanceof quadrigram.Models.FunctionBlockModel && block.get("origin") !== "file" && block.get("operator").get("currentOperation") === "Filter") {
          quadrigram.milestoneTracker.trackMilestone("operations", "filter");
        }
      }
      if (block != null) {
        if (block.get("role") === "output") {
          return quadrigram.milestoneTracker.trackMilestone("syncronize", "use_output");
        }
      }
    };

    SlotView.prototype.handleDrag = function(e, ui) {
      if (this.currentView && this.currentView.el === ui.draggable[0]) {
        this.currentView = null;
        return this.model.popBlock();
      }
    };

    SlotView.prototype.renderBlock = function(dataModel) {
      var blockView;
      blockView = new quadrigram.Views.DataBlockReferenceView({
        model: dataModel,
        binding: false
      });
      blockView.render();
      $(this.el).find(".slot-container .slot-body").html($(blockView.el));
      return this.currentView = blockView;
    };

    SlotView.prototype.renderInternalBlock = function(dataModel) {
      var blockView;
      blockView = new quadrigram.Views.DataBlockEditableView({
        model: dataModel
      });
      blockView.render();
      $(this.el).find(".slot-container .slot-body").html($(blockView.el));
      return this.currentView = blockView;
    };

    SlotView.prototype.focusOnSlot = function() {
      return $(this.el).addClass('selected');
    };

    SlotView.prototype.focusOutSlot = function() {
      return $(this.el).removeClass('selected');
    };

    SlotView.prototype.viewWillRemove = function() {
      this.currentView.remove();
      this.currentView = null;
      this.model.off("change", this.updateView);
      this.model.off("replace-model", this.replaceModel);
      return this.model.off("wrongData", this.animateWrongData);
    };

    SlotView.prototype.animateWrongData = function() {
      var _this = this;
      log("should animate pop");
      $(this.el).find(".slot-body").addClass('wrong-data');
      $(this.el).find(".data-block").effect("shake", {
        distance: 5,
        times: 6
      });
      $(this.el).find(".slot-body").qtip({
        style: {
          classes: "error-tip",
          tip: {
            corner: true,
            offset: 5
          }
        },
        content: {
          text: "Wrong kind of data for this visualizer!"
        },
        position: {
          my: "top center",
          at: "bottom center",
          viewport: $("body"),
          adjust: {
            mouse: false,
            method: 'flip flip',
            resize: false
          }
        },
        hide: {
          event: "remove"
        },
        show: {
          event: "none",
          ready: true
        }
      });
      return _.delay(function() {
        $(_this.el).find(".slot-body").removeClass('wrong-data');
        return $(_this.el).find(".slot-body").qtip("destroy", true);
      }, 2000);
    };

    return SlotView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockLabelable = (function(_super) {
    __extends(DataBlockLabelable, _super);

    function DataBlockLabelable() {
      this.blockNameChanged = __bind(this.blockNameChanged, this);
      this.startChangingName = __bind(this.startChangingName, this);
      this.labelChanged = __bind(this.labelChanged, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DataBlockLabelable.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockLabelable.prototype.template = JST['app/scripts/templates/blocks/dataBlockLabelable.hbs'];

    DataBlockLabelable.prototype.viewDidRender = function() {
      var _this = this;
      DataBlockLabelable.__super__.viewDidRender.call(this);
      this.$el.find(".data-block-name").val(this.model.get("label"));
      return _.defer(function() {
        _this.$el.find(".data-block-name").editableSpan();
        _this.$el.find(".data-block-name").on("change", _this.labelChanged);
        if (_this.model.get("defaultLabel")) {
          _this.startChangingName();
          return _this.model.unset("defaultLabel", {
            "silent": true
          });
        }
      });
    };

    DataBlockLabelable.prototype.viewWillRemove = function() {
      return this.$el.find(".data-block-name").off("change", this.labelChanged);
    };

    DataBlockLabelable.prototype.labelChanged = function() {
      return this.blockNameChanged(this.$el.find(".data-block-name")[0].value);
    };

    DataBlockLabelable.prototype.startChangingName = function() {
      return this.$el.find(".data-block-name").editableSpan("startEditing");
    };

    DataBlockLabelable.prototype.blockNameChanged = function(newValue) {
      return this.model.set("label", newValue);
    };

    return DataBlockLabelable;

  })(quadrigram.Views.DataBlockSourceView);

}).call(this);

(function() {
  'use strict';
  var IdManager,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  IdManager = (function() {
    function IdManager() {
      this.getId = __bind(this.getId, this);
      this.addToList = __bind(this.addToList, this);
    }

    IdManager.prototype._exclude = [];

    IdManager.prototype.addToList = function(idsToList) {
      if (_.isArray(idsToList)) {
        return this._exclude = this._exclude.concat(idsToList);
      } else {
        return this._exclude.push(idsToList);
      }
    };

    IdManager.prototype.getId = function(prefix) {
      var candidate;
      candidate = _.uniqueId(prefix);
      while (this._exclude.indexOf(candidate) !== -1) {
        candidate = _.uniqueId();
      }
      this.addToList(candidate);
      return candidate;
    };

    return IdManager;

  })();

  quadrigram.idManager = new IdManager();

}).call(this);

(function() {
  'use strict';
  var LabelManager,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  LabelManager = (function() {
    function LabelManager() {
      this.isEmptyObject = __bind(this.isEmptyObject, this);
      this.getPropperName = __bind(this.getPropperName, this);
      this.removeFromList = __bind(this.removeFromList, this);
      this.addToList = __bind(this.addToList, this);
    }

    LabelManager.prototype._exclude = {};

    LabelManager.prototype.addToList = function(nameWithIndex) {
      var index, name;
      if (nameWithIndex.lastIndexOf("(") > 0) {
        name = nameWithIndex.substring(0, nameWithIndex.lastIndexOf("("));
        index = +nameWithIndex.substring(nameWithIndex.lastIndexOf("(") + 1, nameWithIndex.lastIndexOf(")"));
      } else {
        name = nameWithIndex;
        index = 0;
      }
      if (!this._exclude[name]) {
        this._exclude[name] = {};
      }
      return this._exclude[name][index] = true;
    };

    LabelManager.prototype.removeFromList = function(nameWithIndex) {
      var index, name;
      if (!nameWithIndex) {
        return;
      }
      if (nameWithIndex.lastIndexOf("(") > 0) {
        name = nameWithIndex.substring(0, nameWithIndex.lastIndexOf("("));
        index = +nameWithIndex.substring(nameWithIndex.lastIndexOf("(") + 1, nameWithIndex.lastIndexOf(")"));
      } else {
        name = nameWithIndex;
        index = 0;
      }
      return delete this._exclude[name][index];
    };

    LabelManager.prototype.getPropperName = function(name) {
      var index, result;
      if (name.indexOf("(") > 0) {
        name = name.substring(0, name.indexOf("("));
      }
      if (!this._exclude[name] || this.isEmptyObject(this._exclude[name])) {
        result = name;
      } else {
        index = 1;
        while (this._exclude[name][index] === true) {
          index = index + 1;
        }
        result = name + "(" + index + ")";
      }
      this.addToList(result);
      return result;
    };

    LabelManager.prototype.isEmptyObject = function(obj) {
      var prop;
      for (prop in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, prop)) {
          return false;
        }
      }
      return true;
    };

    return LabelManager;

  })();

  quadrigram.labelManager = new LabelManager();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PropertyView = (function(_super) {
    __extends(PropertyView, _super);

    function PropertyView() {
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.toggleHidden = __bind(this.toggleHidden, this);
      this.setCollapsed = __bind(this.setCollapsed, this);
      this.addFormatSlots = __bind(this.addFormatSlots, this);
      this.formatChanged = __bind(this.formatChanged, this);
      this.changeFormat = __bind(this.changeFormat, this);
      this.replaceModel = __bind(this.replaceModel, this);
      this.requestActivation = __bind(this.requestActivation, this);
      this.setSelectWidth = __bind(this.setSelectWidth, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = PropertyView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PropertyView.prototype.template = JST['app/scripts/templates/blocks/property.hbs'];

    PropertyView.prototype.viewWillRender = function() {
      var f, formats, label, _i, _j, _len, _len1, _ref1, _ref2;
      if (_.isArray(this.model.propDef.formats)) {
        formats = [];
        _ref1 = this.model.propDef.formats;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          f = _ref1[_i];
          formats.push({
            "value": f,
            "label": f
          });
        }
        return this.templateData.formats = formats;
      } else {
        formats = [];
        _ref2 = Object.keys(this.model.propDef.formats);
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          f = _ref2[_j];
          if (this.model.propDef.formats[f].label != null) {
            label = this.model.propDef.formats[f].label;
          } else if (quadrigram.router.managers.formatManager.formatDefinitions[f].label != null) {
            label = quadrigram.router.managers.formatManager.formatDefinitions[f].label;
          } else {
            label = f;
          }
          if (!this.model.propDef.formats[f].hidden && !this.model.propDef.formats[f].deprecated) {
            formats.push({
              "value": f,
              "label": label
            });
          } else if (this.model.get("currentFormat") === f && this.model.propDef.formats[f].deprecated) {
            formats.push({
              "value": f,
              "label": label + " (deprecated)"
            });
          }
        }
        return this.templateData.formats = formats;
      }
    };

    PropertyView.prototype.viewDidRender = function() {
      var f,
        _this = this;
      if (this.model.propDef.uiTipContent != null) {
        this.$el.find(".property-label.ui-tip-target").attr("data-ui-tip-id", this.model.propDef.label);
        quadrigram.router.managers.uiTooltipManager.resgisterContent(this.model.propDef.label, this.model.propDef.uiTipContent);
      }
      for (f in this.model.propDef.formats) {
        if (quadrigram.router.managers.formatManager.formatDefinitions[f].uiTipContent != null) {
          quadrigram.router.managers.uiTooltipManager.resgisterContent(f, quadrigram.router.managers.formatManager.formatDefinitions[f].uiTipContent);
        }
      }
      this.slotViews = [];
      this.addFormatSlots();
      this.$el.find(".format-selector").selectmenuWithTooltips({
        width: 100,
        change: function(e) {
          var format;
          format = e.target.value;
          _this.requestActivation();
          return _this.changeFormat(format);
        },
        appendTo: this.$el.find(".propertyBody")
      });
      this.model.on("change:slotsCollection", this.formatChanged);
      this.$el.find('h5').on('click', this.toggleHidden);
      this.$el.find(".format-selector").val(this.model.get("currentFormat"));
      this.$el.find(".format-selector").selectmenuWithTooltips("refresh");
      _.defer(function() {
        if (Object.keys(_this.model.propDef.formats).length > 1) {
          _this.$el.find(".format-selector").selectmenuWithTooltips("widget").attr("data-ui-tip-id", "format-selector");
        } else {
          _this.$el.find(".format-selector").selectmenuWithTooltips("widget").attr("data-ui-tip-id", Object.keys(_this.model.propDef.formats)[0]);
        }
        return _this.$el.find(".format-selector").selectmenuWithTooltips("widget").addClass("ui-tip-target");
      });
      this.setCollapsed(this.model.get("hidden"));
      this.model.on("replace-model", this.replaceModel);
      return this.setSelectWidth();
    };

    PropertyView.prototype.setSelectWidth = function() {};

    PropertyView.prototype.requestActivation = function() {
      if (this.model.activate) {
        return this.model.activate();
      }
    };

    PropertyView.prototype.replaceModel = function(model) {
      var e, oldModel;
      oldModel = this.model;
      this.model = model;
      for (e in oldModel._events) {
        if (!this.model._events[e]) {
          this.model._events[e] = [];
        }
        this.model._events[e] = this.model._events[e].concat(oldModel._events[e]);
      }
      return oldModel.off();
    };

    PropertyView.prototype.changeFormat = function(format) {
      return this.model.set("currentFormat", format);
    };

    PropertyView.prototype.formatChanged = function(e) {
      this.$el.find("option[value=" + this.model.get("currentFormat") + "]").attr("selected", "selected");
      this.setSelectWidth();
      return this.addFormatSlots();
    };

    PropertyView.prototype.addFormatSlots = function() {
      var slotModel, slotTipId, slotView, tipContent, _i, _j, _len, _len1, _ref1, _ref2, _results;
      _ref1 = this.slotViews;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slotView = _ref1[_i];
        slotView.remove();
      }
      this.slotViews = [];
      _ref2 = this.model.get("slotsCollection").models;
      _results = [];
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        slotModel = _ref2[_j];
        slotView = new quadrigram.Views.SlotView({
          model: slotModel,
          binding: false
        });
        if (this.model.get("slotsCollection").models.length > 1) {
          slotView.needsLabel = true;
        }
        this.$el.find(".property-container").append(slotView.$el);
        slotView.render();
        slotTipId = this.model.get("currentFormat") + "_" + slotModel.get("slotId");
        slotView.$el.find(".slot-label").attr("data-ui-tip-id", slotTipId);
        if ((this.model.propDef.formats[this.model.get("currentFormat")].uiTipContents != null) && (this.model.propDef.formats[this.model.get("currentFormat")].uiTipContents[slotModel.get("slotId")] != null)) {
          tipContent = this.model.propDef.formats[this.model.get("currentFormat")].uiTipContents[slotModel.get("slotId")];
        } else {
          tipContent = _.findWhere(quadrigram.router.managers.formatManager.formatDefinitions[this.model.get("currentFormat")].slots, {
            "id": slotModel.get("slotId")
          }).uiTipContent;
        }
        if (tipContent != null) {
          quadrigram.router.managers.uiTooltipManager.resgisterContent(slotTipId, tipContent);
        }
        _results.push(this.slotViews.push(slotView));
      }
      return _results;
    };

    PropertyView.prototype.setCollapsed = function(value) {
      if (value) {
        this.$el.find('.property-list-item').addClass("collapsed");
        this.$el.find('.propertyBody').css("display", "none");
        return this.$el.find('h5').addClass('selected');
      }
    };

    PropertyView.prototype.toggleHidden = function(e) {
      this.model.set("hidden", !this.model.get("hidden"));
      if (this.model.get("hidden")) {
        this.$el.find('.propertyBody').slideUp(300);
        this.$el.find('h5').addClass('selected');
        return this.$el.find('.property-list-item').addClass("collapsed");
      } else {
        this.$el.find('.propertyBody').slideDown(300);
        this.$el.find('h5').removeClass('selected');
        return this.$el.find('.property-list-item').removeClass("collapsed");
      }
    };

    PropertyView.prototype.viewWillRemove = function() {
      var slotView, _i, _len, _ref1;
      this.model.off("change:slotsCollection", this.formatChanged);
      if (this.slotViews != null) {
        _ref1 = this.slotViews;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          slotView = _ref1[_i];
          slotView.remove();
        }
      }
      return this.slotViews = [];
    };

    return PropertyView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PropertiesFamily = (function(_super) {
    __extends(PropertiesFamily, _super);

    function PropertiesFamily() {
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = PropertiesFamily.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PropertiesFamily.prototype.template = JST['app/scripts/templates/UI/propertiesFamily.hbs'];

    PropertiesFamily.prototype.modelView = quadrigram.Views.PropertyView;

    PropertiesFamily.prototype.className = "family-content";

    PropertiesFamily.prototype.bindModelViews = false;

    PropertiesFamily.prototype.viewWillRender = function() {};

    PropertiesFamily.prototype.viewDidRender = function() {
      var _this = this;
      return _.delay(function() {
        return _this.trigger("rendered");
      }, 80);
    };

    return PropertiesFamily;

  })(Backbone.CollectionView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.Toolbar = (function(_super) {
    __extends(Toolbar, _super);

    function Toolbar() {
      this.setFunctionBlockTarget = __bind(this.setFunctionBlockTarget, this);
      this.closeBlockEditor = __bind(this.closeBlockEditor, this);
      this.openBlockEditor = __bind(this.openBlockEditor, this);
      this.closeDataManager = __bind(this.closeDataManager, this);
      this.openDataManager = __bind(this.openDataManager, this);
      this.toggleBlockEditor = __bind(this.toggleBlockEditor, this);
      this.toggleDataManager = __bind(this.toggleDataManager, this);
      this.datamanagerClicked = __bind(this.datamanagerClicked, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.closeToolsTooltip = __bind(this.closeToolsTooltip, this);
      this.init = __bind(this.init, this);
      _ref = Toolbar.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Toolbar.prototype.template = JST['app/scripts/templates/UI/toolbar.hbs'];

    Toolbar.prototype.events = {
      "click .draw": "shapeClicked",
      "click .data-manager-toggle": "datamanagerClicked",
      "click .function-manager-toggle": "functionmanagerClicked",
      "click .layout": "layoutClicked"
    };

    Toolbar.prototype.init = function() {
      var _this = this;
      $(window).on("viz:dragging", this.closeToolsTooltip);
      return $(window).on("tools:leave", function() {
        return _this.closeToolsTooltip();
      });
    };

    Toolbar.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    Toolbar.prototype.closeToolsTooltip = function(delay) {
      /*
      quadrigram.tester=@$el
      $('.qtip-tools').animate
        opacity:0
      , delay||100, "swing", ()=>
        $('.qtip-tools').hide()
      */

      return $('.qtip-tools').hide();
    };

    Toolbar.prototype.viewDidRender = function() {
      var tooltipTools,
        _this = this;
      this.dataFactoryEl = $("<div class='data-factory-container'></div>");
      this.filesExplorer = new quadrigram.Views.DataFactoryView({
        model: this.model.get("blockGroupsCollection")
      });
      this.filesExplorer.render();
      this.functionsExplorer = new quadrigram.Views.BlockInspectorView({
        model: this.model
      });
      this.functionsExplorer.render();
      this.dataFactoryEl.append(this.filesExplorer.$el);
      this.dataFactoryEl.append(this.functionsExplorer.$el);
      this.$el.find(".tools-submenu").append(this.dataFactoryEl);
      tooltipTools = [
        {
          "class": '.basic',
          group: 'charts'
        }, {
          "class": '.text',
          group: 'text'
        }, {
          "class": '.draw',
          group: 'draw'
        }, {
          "class": '.media',
          group: 'media'
        }, {
          "class": '.controls',
          group: 'controls'
        }
      ];
      _.each(tooltipTools, function(tooldata) {
        return _this.$(tooldata["class"]).qtip({
          style: 'qtip-tools',
          content: {
            text: function() {
              var toolsDrag;
              $('.qtip-tools').stop();
              toolsDrag = new quadrigram.Views.ToolsDragTipList({
                model: new Backbone.Model({
                  "group": tooldata.group
                })
              });
              toolsDrag.render();
              tooldata.view = toolsDrag;
              return toolsDrag.$el;
            }
          },
          hide: {
            event: 'unfocus',
            delay: 600
          },
          show: {
            delay: 100
          },
          events: {
            show: function(event, api) {
              $('.qtip-tools').stop();
              return $('.qtip-tools').hide();
            }
          },
          position: {
            my: 'top center',
            at: 'bottom center'
          }
        });
      });
      _.delay(this.openDataManager, 5);
      this.functionsExplorer.$el.hide();
      return this.functionsExplorer.$el.addClass("closed");
    };

    Toolbar.prototype.viewWillRender = function() {};

    Toolbar.prototype.viewWillRemove = function() {
      log("will remove");
      $(window).off("viz:dragging", this.closeToolsTooltip);
      $(window).off("tools:leave", this.closeToolsTooltip);
      this.filesExplorer.remove();
      return this.functionsExplorer.remove();
    };

    Toolbar.prototype.datamanagerClicked = function(e) {
      return this.toggleDataManager();
    };

    Toolbar.prototype.toggleDataManager = function() {
      this.$el.find(".tools-submenu").toggleClass("closed");
      if (this.$el.find(".tools-submenu").hasClass("closed")) {
        this.$el.find(".data-manager-toggle").removeClass("open");
        return this.closeDataManager();
      } else {
        this.$el.find(".data-manager-toggle").addClass("open");
        return this.openDataManager();
      }
    };

    Toolbar.prototype.toggleBlockEditor = function() {};

    Toolbar.prototype.openDataManager = function() {
      this.$el.find(".data-manager-toggle").find(".title-icon").css("transform", "rotate(90deg)");
      this.filesExplorer._changeBlockGroupCollection(this.filesExplorer.selectedMenu);
      this.$el.find(".tools-submenu").removeClass("closed");
      return this.$el.find(".tools-submenu").slideDown(300);
    };

    Toolbar.prototype.closeDataManager = function() {
      quadrigram.router.appViews.projectView.outputDeselectAll();
      this.$el.find(".tools-submenu").addClass("closed");
      this.$el.find(".data-manager-toggle").find(".title-icon").css("transform", "rotate(0deg)");
      return this.$el.find(".tools-submenu").slideUp(300);
    };

    Toolbar.prototype.openBlockEditor = function() {
      this.functionsExplorer.$el.removeClass("closed");
      return this.functionsExplorer.$el.slideDown(100);
    };

    Toolbar.prototype.closeBlockEditor = function() {
      this.functionsExplorer.$el.addClass("closed");
      return this.functionsExplorer.$el.slideUp(100);
    };

    Toolbar.prototype.setFunctionBlockTarget = function(block) {
      if (block == null) {
        this.functionsExplorer.setTarget(null);
        return this.closeBlockEditor();
      } else {
        this.functionsExplorer.setTarget(block);
        if (this.functionsExplorer.$el.hasClass("closed")) {
          return this.openBlockEditor();
        }
      }
    };

    Toolbar.prototype.layoutClicked = function(e) {
      return quadrigram.router.appViews.uiView.openSettings();
    };

    return Toolbar;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PagesToolbar = (function(_super) {
    __extends(PagesToolbar, _super);

    function PagesToolbar() {
      this.isInside = __bind(this.isInside, this);
      this.checkOver = __bind(this.checkOver, this);
      this.checkPageLabels = __bind(this.checkPageLabels, this);
      this.updateSelection = __bind(this.updateSelection, this);
      this.handleSelection = __bind(this.handleSelection, this);
      this.updateIndexes = __bind(this.updateIndexes, this);
      this.saveOrder = __bind(this.saveOrder, this);
      this.createNewPage = __bind(this.createNewPage, this);
      this.deletePage = __bind(this.deletePage, this);
      this.removePage = __bind(this.removePage, this);
      this.addPage = __bind(this.addPage, this);
      this.transportViz = __bind(this.transportViz, this);
      this.changeLayoutSettings = __bind(this.changeLayoutSettings, this);
      this.renderAll = __bind(this.renderAll, this);
      this.show = __bind(this.show, this);
      this.hide = __bind(this.hide, this);
      this.setState = __bind(this.setState, this);
      this.toggleToolbar = __bind(this.toggleToolbar, this);
      this.loadPages = __bind(this.loadPages, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = PagesToolbar.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PagesToolbar.prototype.template = JST['app/scripts/templates/UI/pagesToolbar.hbs'];

    PagesToolbar.prototype.className = "pages-toolbar-container closed";

    PagesToolbar.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    PagesToolbar.prototype.viewWillRender = function() {
      this.pageViews || (this.pageViews = {});
      this.pagesCollection = quadrigram.router.dataModels.currentProject.get("pagesCollection");
      this.layoutSettings = quadrigram.router.dataModels.currentProject.get("layout-settings");
      this.pagesCollection.on("add", this.addPage);
      this.pagesCollection.on("remove", this.removePage);
      return quadrigram.router.dataModels.currentProject.on("change:layout-settings", this.changeLayoutSettings);
    };

    PagesToolbar.prototype.viewDidRender = function() {
      var _this = this;
      this.$el.find(".thumbs-ul").sortable({
        revert: 200,
        distance: 5,
        axis: "y",
        start: function(event, ui) {
          return ui.item.addClass("dragging");
        },
        stop: function(event, ui) {
          ui.item.removeClass("dragging");
          _this.saveOrder();
          return quadrigram.router.appViews.projectView.layoutManager.updatePageButtons();
        }
      });
      this.$el.find(".new-page-button").on("click", this.createNewPage);
      this.$el.find(".pages-toggle").on("click", this.toggleToolbar);
      this.$el.find(".page-settings-button").on("click", function() {
        return quadrigram.router.appViews.uiView.openSettings("pages");
      });
      quadrigram.router.dataModels.currentProject.off("change:layout-settings", this.changeLayoutSettings);
      return quadrigram.router.appViews.projectView.layoutManager.on("pageChanged", this.updateSelection);
    };

    PagesToolbar.prototype.viewWillRemove = function() {
      this.pagesCollection.off("add", this.addPage);
      return this.pagesCollection.off("remove", this.removePage);
    };

    PagesToolbar.prototype.loadPages = function() {
      var p, _i, _len, _ref1;
      _ref1 = this.pagesCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        this.addPage(p);
      }
      if (this.pagesCollection.models.length === 1) {
        this.setState("closed");
      }
      return this.updateIndexes();
    };

    PagesToolbar.prototype.toggleToolbar = function() {
      return this.setState();
    };

    PagesToolbar.prototype.setState = function(state) {
      var delayTime,
        _this = this;
      if (state == null) {
        this.$el.toggleClass("closed");
      } else if (state === "closed") {
        this.$el.addClass("closed");
      } else {
        this.$el.removeClass("closed");
      }
      if (!this.$el.hasClass("closed")) {
        delayTime = 0;
      } else {
        delayTime = 500;
      }
      return _.delay(function() {
        if (!_this.$el.hasClass("closed")) {
          _this.$el.find(".pages-toolbar-content").css("display", "block");
        } else {
          _this.$el.find(".pages-toolbar-content").css("display", "none");
        }
        quadrigram.router.appViews.projectView.layoutManager.updatePageButtons();
        return quadrigram.router.resizeProject();
      }, delayTime);
    };

    PagesToolbar.prototype.hide = function() {
      var _this = this;
      if (!this.$el.hasClass("closed")) {
        this.wasopen = true;
        this.setState("closed");
      } else {
        this.wasopen = false;
      }
      return _.delay(function() {
        return _this.$el.hide();
      }, 500);
    };

    PagesToolbar.prototype.show = function() {
      var _this = this;
      this.$el.show();
      if (this.wasopen) {
        return _.defer(function() {
          return _this.setState("open");
        });
      }
    };

    PagesToolbar.prototype.renderAll = function() {
      var pid, pv, _ref1, _results;
      _ref1 = this.pageViews;
      _results = [];
      for (pid in _ref1) {
        pv = _ref1[pid];
        _results.push(pv.updateLayout());
      }
      return _results;
    };

    PagesToolbar.prototype.changeLayoutSettings = function() {
      var pid, pv, _ref1, _results;
      _ref1 = this.pageViews;
      _results = [];
      for (pid in _ref1) {
        pv = _ref1[pid];
        _results.push(pv.resizePage());
      }
      return _results;
    };

    PagesToolbar.prototype.transportViz = function(vizModel, sourcePage, targetPage) {
      var newPageThumb, oldPageThumb;
      log("transporting", vizModel, "from", sourcePage, "to", targetPage);
      oldPageThumb = this.pageViews[sourcePage.get("id")];
      newPageThumb = this.pageViews[targetPage.get("id")];
      if (oldPageThumb != null) {
        oldPageThumb.removeViz(vizModel);
      }
      if (newPageThumb != null) {
        newPageThumb.addViz(vizModel);
        return newPageThumb.updateVizContent(vizModel);
      }
    };

    PagesToolbar.prototype.addPage = function(p) {
      var pageView;
      if (p.get("id") === "_headerPage") {
        return;
      }
      pageView = new quadrigram.Views.PageThumb({
        model: p
      });
      pageView.parentView = this;
      pageView.render();
      this.$el.find(".thumbs-ul").append(pageView.$el);
      pageView.addLabel();
      pageView.on("labelChanged", this.checkPageLabels);
      pageView.on("selected", this.handleSelection);
      pageView.on("delete", this.deletePage);
      this.pageViews[p.get("id")] = pageView;
      return this.updateIndexes();
    };

    PagesToolbar.prototype.removePage = function(p) {
      if (p.get("id") === "_headerPage") {
        return;
      }
      this.pageViews[p.get("id")].remove();
      delete this.pageViews[p.get("id")];
      return this.updateIndexes();
    };

    PagesToolbar.prototype.deletePage = function(pageId) {
      return this.pagesCollection.remove(pageId);
    };

    PagesToolbar.prototype.createNewPage = function() {
      var label, newPage, nextIndex;
      nextIndex = quadrigram.router.appViews.projectView.layoutManager.getRealPagesArray().length;
      label = "Page" + (nextIndex + 1);
      label = quadrigram.labelManager.getPropperName(label);
      newPage = new quadrigram.Models.Page({
        label: label
      });
      this.pagesCollection.add(newPage);
      quadrigram.router.appViews.projectView.layoutManager.navigateToPage(newPage.get("id"));
      return quadrigram.achievementTracker.trackDirectAction("pageAdded");
    };

    PagesToolbar.prototype.saveOrder = function() {
      var newOrder;
      newOrder = this.$el.find(".thumbs-ul").sortable("toArray");
      this.pagesCollection.comparator = function(a, b) {
        var orderA, orderB;
        orderA = newOrder.indexOf(a.get("id"));
        orderB = newOrder.indexOf(b.get("id"));
        if (a.get("id") === "_headerPage") {
          return 1;
        } else if (b.get("id") === "_headerPage") {
          return -1;
        }
        if (orderA === -1) {
          return 1;
        }
        if (orderB === -1) {
          return -1;
        }
        if (orderA > orderB) {
          return 1;
        } else {
          return -1;
        }
      };
      this.pagesCollection.sort();
      return this.updateIndexes();
    };

    PagesToolbar.prototype.updateIndexes = function() {
      var i, p, _i, _len, _ref1;
      _ref1 = this.pagesCollection.models;
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        p = _ref1[i];
        if (this.pageViews[p.get("id")] != null) {
          this.pageViews[p.get("id")].isOnlyPage = false;
          this.pageViews[p.get("id")].updateIndex(i + 1);
        }
      }
      if (this.pagesCollection.models.length === 1) {
        if (this.pageViews[this.pagesCollection.models[0].get("id")] != null) {
          return this.pageViews[this.pagesCollection.models[0].get("id")].isOnlyPage = true;
        }
      }
    };

    PagesToolbar.prototype.handleSelection = function(view) {
      log("clicked", view);
      return quadrigram.router.appViews.projectView.layoutManager.navigateToPage(view.model.get("id"));
    };

    PagesToolbar.prototype.updateSelection = function() {
      var currentPageObject, p, pid, _ref1, _results;
      currentPageObject = quadrigram.router.appViews.projectView.layoutManager.getCurrentPage();
      if (currentPageObject != null) {
        _ref1 = this.pageViews;
        _results = [];
        for (pid in _ref1) {
          p = _ref1[pid];
          p.$el.removeClass("selected");
          if (pid === currentPageObject.model.get("id")) {
            _results.push(p.$el.addClass("selected"));
          } else {
            _results.push(void 0);
          }
        }
        return _results;
      }
    };

    PagesToolbar.prototype.checkPageLabels = function() {
      var hasRepeat, p, usedNames, _i, _len, _ref1;
      usedNames = {};
      _ref1 = this.pagesCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        p = _ref1[_i];
        if (usedNames[p.get("label")] != null) {
          hasRepeat = true;
        }
        usedNames[p.get("label")] = true;
      }
      if (hasRepeat) {
        this.$el.find(".page-name-comment").html("*WARNING: pages cant have the same name. Doubleclick on a page name to change it");
        return this.$el.find(".page-name-comment").addClass("has-repeats");
      } else {
        this.$el.find(".page-name-comment").html("*doubleclick on a page name to change it");
        return this.$el.find(".page-name-comment").removeClass("has-repeats");
      }
    };

    PagesToolbar.prototype.checkOver = function(rawPos) {
      var key, p, pos, _ref1, _ref2;
      pos = {};
      pos.x = rawPos.x;
      pos.y = rawPos.y;
      _ref1 = this.pageViews;
      for (key in _ref1) {
        p = _ref1[key];
        p.$el.removeClass("drag-focus");
      }
      _ref2 = this.pageViews;
      for (key in _ref2) {
        p = _ref2[key];
        if (this.isInside(pos, p.$el[0].getBoundingClientRect())) {
          log("iniside!", p.model.get("id"));
          p.$el.addClass("drag-focus");
          return p.model;
        }
      }
      log("outside...");
      return null;
    };

    PagesToolbar.prototype.isInside = function(p, rect) {
      return p.x > rect.left && p.x < rect.right && p.y > rect.top && p.y < rect.bottom;
    };

    return PagesToolbar;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.FunctionBlockModel = (function(_super) {
    __extends(FunctionBlockModel, _super);

    function FunctionBlockModel() {
      this.removeFromProject = __bind(this.removeFromProject, this);
      this.dependenciesFetchState = __bind(this.dependenciesFetchState, this);
      this.dependsOn = __bind(this.dependsOn, this);
      this.toJSON = __bind(this.toJSON, this);
      this.handleOperationEnd = __bind(this.handleOperationEnd, this);
      this.runOperator = __bind(this.runOperator, this);
      this.setOperation = __bind(this.setOperation, this);
      this.postModelSetup = __bind(this.postModelSetup, this);
      this.modelSetup = __bind(this.modelSetup, this);
      this.create = __bind(this.create, this);
      _ref = FunctionBlockModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    FunctionBlockModel.prototype.relations = [
      {
        type: Backbone.HasOne,
        key: 'operator',
        relatedModel: "quadrigram.Models.OperatorModel",
        includeInJSON: true,
        reverseRelation: {
          type: Backbone.HasOne,
          key: 'ownerBlock',
          bubbleUp: false,
          includeInJSON: Backbone.Model.prototype.idAttribute
        }
      }
    ];

    FunctionBlockModel.prototype.create = function() {
      var date;
      date = new Date();
      this.set("creation_date", date.getTime());
      return this.set("operator", new quadrigram.Models.OperatorModel());
    };

    FunctionBlockModel.prototype.modelSetup = function(options) {
      FunctionBlockModel.__super__.modelSetup.call(this, options);
      return this.set("fetchState", "processing", {
        silent: true
      });
    };

    FunctionBlockModel.prototype.postModelSetup = function() {
      var _this = this;
      this.get("operator").on("change:currentOperation", function() {
        return _this.runOperator();
      });
      /*
      @.get("operator").on("change:currentExpression",()=>
        #log "+++++++++ fb-changed:currentExpression"
        @runOperator()
      )
      */

      this.get("operator").on("childModified", function() {
        return _this.runOperator();
      });
      return this.runOperator();
    };

    FunctionBlockModel.prototype.setOperation = function(opKey, silent) {
      return this.get("operator").set("currentOperation", opKey, {
        "silent": silent
      });
    };

    FunctionBlockModel.prototype.runOperator = function() {
      var depfetchstate;
      if (this.staticData) {
        this.set("fetchState", "ready");
        return;
      }
      depfetchstate = this.dependenciesFetchState();
      if (depfetchstate === "ready") {
        this.set("fetchState", "processing");
        if (this._events["operation-end"] == null) {
          this.on("operation-end", this.handleOperationEnd);
        }
        return this.get("operator").getOperationResult(this);
      } else {
        return this.handleOperationEnd({
          data: null,
          metaData: null
        });
      }
    };

    FunctionBlockModel.prototype.handleOperationEnd = function(resultObject) {
      this.set({
        "metaData": resultObject.metaData,
        "data": resultObject.data
      }, {
        "silent": true
      });
      this.set({
        "fetchState": this.dependenciesFetchState()
      }, {
        "silent": true
      });
      return this.trigger("change:fetchState");
    };

    FunctionBlockModel.prototype.toJSON = function(options) {
      return FunctionBlockModel.__super__.toJSON.call(this, options);
    };

    FunctionBlockModel.prototype.dependsOn = function(targetBlock) {
      var slot, _i, _len, _ref1;
      if (targetBlock === this) {
        return true;
      }
      _ref1 = this.get("operator").get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        if (targetBlock === slot.get("externalBlock")) {
          return true;
        } else if ((slot.get("externalBlock") != null) && slot.get("externalBlock").constructor.name === "FunctionBlockModel") {
          if (slot.get("externalBlock").dependsOn(targetBlock)) {
            return true;
          }
        }
      }
      return false;
    };

    FunctionBlockModel.prototype.dependenciesFetchState = function() {
      var b, bstate, result, slot, _i, _len, _ref1;
      result = "ready";
      _ref1 = this.get("operator").get("slotsCollection").models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        slot = _ref1[_i];
        b = slot.get("externalBlock");
        if (b) {
          bstate = b.get("fetchState");
          if (bstate !== "ready") {
            result = "waiting";
          }
        }
      }
      return result;
    };

    FunctionBlockModel.prototype.removeFromProject = function() {
      if (this.get("operator") != null) {
        this.get("operator").removeFromProject();
      }
      return FunctionBlockModel.__super__.removeFromProject.call(this);
    };

    /*
    detachAndDestroy:()=>
      super()
      #@get("operator").unregister()
      @get("operator").destoryR()
    
    
    destroyR:()=>
      
      if @get("operator")?
        @get("operator").destroyR()
      super()
    */


    return FunctionBlockModel;

  })(quadrigram.Models.DataBlockModel);

  quadrigram.Models.FunctionBlockModel.setup();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.EditableBlockModel = (function(_super) {
    __extends(EditableBlockModel, _super);

    function EditableBlockModel() {
      this.create = __bind(this.create, this);
      _ref = EditableBlockModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    EditableBlockModel.prototype.create = function() {
      EditableBlockModel.__super__.create.call(this);
      return this.set("metaData", {
        "valueLabel": "Custom value",
        "idLabel": "Custom id",
        "viewMode": "cell"
      }, {
        silent: true
      });
    };

    return EditableBlockModel;

  })(quadrigram.Models.DataBlockModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ExternalBlockModel = (function(_super) {
    __extends(ExternalBlockModel, _super);

    function ExternalBlockModel() {
      this.modelSetup = __bind(this.modelSetup, this);
      _ref = ExternalBlockModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExternalBlockModel.prototype.modelSetup = function(options) {
      ExternalBlockModel.__super__.modelSetup.call(this);
      return this.set("fetchState", "loading", {
        silent: true
      });
    };

    return ExternalBlockModel;

  })(quadrigram.Models.DataBlockModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.BarChartView = (function(_super) {
    __extends(BarChartView, _super);

    function BarChartView() {
      this.valuesDomainAdjustment = __bind(this.valuesDomainAdjustment, this);
      this.xDomainAdjustment = __bind(this.xDomainAdjustment, this);
      this.yDomainAdjustment = __bind(this.yDomainAdjustment, this);
      this.updateItems = __bind(this.updateItems, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      this.setAxisDirection = __bind(this.setAxisDirection, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      _ref = BarChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BarChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    BarChartView.prototype.yAxisType = "bands";

    BarChartView.prototype.xAxisType = "linear";

    BarChartView.prototype.followMouse = false;

    BarChartView.prototype.chartType = "barchart";

    BarChartView.prototype.yAxisPadding = true;

    BarChartView.prototype.xAxisPadding = true;

    BarChartView.prototype.init = function() {
      BarChartView.__super__.init.call(this);
      if (quadrigram.router.getDevice() !== "Desktop") {
        return this.followMouse = true;
      }
    };

    BarChartView.prototype.getXDomainValues = function() {
      if (this.xAxisType === "bands") {
        return this.ids;
      } else {
        return this.calculateNumberDomain(this.values, false, "value");
      }
    };

    BarChartView.prototype.getYDomainValues = function() {
      if (this.xAxisType === "bands") {
        return this.calculateNumberDomain(this.values, false, "value");
      } else {
        return this.ids;
      }
    };

    BarChartView.prototype.visualizerWillExecBehaviors1 = function() {
      return this.dimensions = ["value"];
    };

    BarChartView.prototype.setAxisDirection = function() {
      var axeIds;
      axeIds = this.model.get("IdsOnAxis");
      if (!axeIds) {
        axeIds = "Vertical";
      }
      if (axeIds === "Vertical") {
        this.yAxisType = "linear";
        return this.xAxisType = "bands";
      } else {
        this.yAxisType = "bands";
        return this.xAxisType = "linear";
      }
    };

    BarChartView.prototype.checkAxisChanged = function() {
      return (this.model.changed["IdsOnAxis"] != null) || (this.model.changed["gapBetweenBars"] != null) || (this.model.changed["dimensionAsItems"] != null) || (this.model.changed["sortByValue"] != null);
    };

    BarChartView.prototype.updateItems = function() {
      var self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("rect").attr("class", "bar");
      this.items.exit().remove();
      size = this.items.size();
      if (size < 200 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.items.select(".bar").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.items.select(".bar");
      }
      self = this;
      if (this.behaviors.axis.xScale.type === "linear") {
        return updateD3Object.attr("x", function(d) {
          return Math.max(0, self.behaviors.axis.xScale(Math.min(0, d.value)));
        }).attr("width", function(d) {
          var domainValue, domainWidth, realWidth, realX;
          realWidth = _this.behaviors.axis.xScale(d.value) - _this.behaviors.axis.xScale(Math.max(0, _this.behaviors.axis.xScale.domain()[0]));
          realX = self.behaviors.axis.xScale(Math.min(0, d.value));
          if (d.value < 0) {
            domainValue = _this.behaviors.axis.xScale.domain()[0];
            if (domainValue > 0) {
              realWidth = 0;
            } else {
              domainWidth = _this.behaviors.axis.xScale(domainValue) - _this.behaviors.axis.xScale(0);
              realWidth = Math.abs(Math.max(domainWidth, realWidth));
            }
          } else {
            realWidth = Math.max(0, realWidth);
          }
          return realWidth;
        }).attr("y", function(d) {
          return _this.behaviors.axis.yScale(d.id);
        }).attr("height", this.behaviors.axis.yScale.rangeBand());
      } else {
        return updateD3Object.attr("x", function(d, i) {
          return _this.behaviors.axis.xScale(d.id);
        }).attr("width", this.behaviors.axis.xScale.rangeBand()).attr("y", function(d) {
          var limit, value;
          value = self.behaviors.axis.yScale(Math.max(0, d.value));
          limit = self.behaviors.axis.yScale.range()[0];
          if (value > limit) {
            d3.select(this).style("display", "none");
          } else {
            d3.select(this).style("display", "");
          }
          return value;
        }).attr("height", function(d) {
          return Math.abs(_this.behaviors.axis.yScale(d.value) - _this.behaviors.axis.yScale(Math.max(0, _this.behaviors.axis.yScale.domain()[0])));
        });
      }
    };

    BarChartView.prototype.yDomainAdjustment = function(interval) {
      if (this.yAxisType === "linear") {
        return this.valuesDomainAdjustment(interval);
      } else {
        return interval;
      }
    };

    BarChartView.prototype.xDomainAdjustment = function(interval) {
      if (this.yAxisType === "bands") {
        return this.valuesDomainAdjustment(interval);
      } else {
        return interval;
      }
    };

    BarChartView.prototype.valuesDomainAdjustment = function(interval) {
      if ((interval[0] > 0 && 0 < interval[1])) {
        if (interval[0] < interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] < interval[0]) {
          interval[1] = 0;
        }
      } else if ((interval[0] < 0 && 0 < interval[1]) || (interval[0] > 0 && 0 > interval[1])) {

      } else if ((interval[0] < 0 && 0 > interval[1])) {
        if (interval[0] > interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] > interval[0]) {
          interval[1] = 0;
        }
      }
      return interval;
    };

    return BarChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DonutChartView = (function(_super) {
    __extends(DonutChartView, _super);

    function DonutChartView() {
      this.resizeLabelsAndDraw = __bind(this.resizeLabelsAndDraw, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.checkShowLabels = __bind(this.checkShowLabels, this);
      this.calculateRadiusWithLabel = __bind(this.calculateRadiusWithLabel, this);
      this.calculateRadiusWithoutLabel = __bind(this.calculateRadiusWithoutLabel, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DonutChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DonutChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    DonutChartView.prototype.followMouse = true;

    DonutChartView.prototype.chartType = "donut";

    DonutChartView.prototype.showLabel = true;

    DonutChartView.prototype.labelMaxLength = 25;

    DonutChartView.prototype.stylableTexts = [".donut-label"];

    DonutChartView.prototype.init = function() {
      DonutChartView.__super__.init.call(this);
      this.arc = d3.svg.arc();
      this.outerArc = d3.svg.arc();
      return this.pie = d3.layout.pie().value(function(d) {
        return d.value;
      }).sort(null);
    };

    DonutChartView.prototype.viewDidRender = function() {
      return this.labelsLayer = d3.select(this.$el[0]).append("div").attr("class", "donut-labels-layer");
    };

    DonutChartView.prototype.visualizerWillUpdateItems = function() {
      var valueEntry, _i, _len, _ref1, _results;
      if (!this.canvas) {
        this.canvas = this.behaviors.svg.root.append("g").attr("class", "donut-canvas");
      }
      this.filteredValues = [];
      _ref1 = this.values;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        valueEntry = _ref1[_i];
        if (valueEntry.value > 0) {
          _results.push(this.filteredValues.push(valueEntry));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    DonutChartView.prototype.calculateRadiusWithoutLabel = function() {
      this.radius = Math.min(this.behaviors.svg.size.width, this.behaviors.svg.size.height) / 2 - 10;
      return this.arc.outerRadius(this.radius).innerRadius(parseFloat(this.model.get("innerRadius")) / 100 * this.radius);
    };

    DonutChartView.prototype.calculateRadiusWithLabel = function() {
      var maxLengthLabel;
      maxLengthLabel = 0;
      this.labelsLayer.selectAll(".donut-label").each(function(d) {
        return maxLengthLabel = Math.max($(this).width(), maxLengthLabel);
      });
      this.maxLengthLabel = Math.min(this.behaviors.svg.size.width / 0.3, maxLengthLabel);
      this.radius = Math.min(this.behaviors.svg.size.width - 2 * this.maxLengthLabel, this.behaviors.svg.size.height) / 2 - 30;
      this.arc.outerRadius(this.radius).innerRadius(parseFloat(this.model.get("innerRadius")) / 100 * this.radius);
      return this.outerArc.innerRadius(this.radius + 20).outerRadius(this.radius + 20);
    };

    DonutChartView.prototype.checkShowLabels = function() {
      var size;
      if (this.model.get("labelsOption") === "show") {
        this.showLabel = true;
        return;
      }
      if (this.model.get("labelsOption") === "hide") {
        this.showLabel = false;
        return;
      }
      if (this.model.get("labelsOption") === "auto") {
        size = this.items.size();
        if (size > 20) {
          this.showLabel = false;
        } else {
          this.showLabel = true;
        }
      }
    };

    DonutChartView.prototype.updateItems = function() {
      var self,
        _this = this;
      this.canvas.style("transform", "translate(" + this.behaviors.svg.size.width / 2 + "px," + this.behaviors.svg.size.height / 2 + "px)");
      this.items = this.canvas.selectAll(".item").data(this.pie(this.filteredValues), function(d, i) {
        return d.id = d.data.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("path").attr("class", "sector");
      this.itemsEnter.each(function(d, i) {
        return _this.labelsLayer.append("div").attr("class", "label-item").attr("data-id", _this.escape(d.id)).append("div").attr("class", "donut-label");
      });
      this.itemsEnter.append("polyline").attr("class", "line");
      this.items.exit().remove();
      this.items.exit().each(function(d, i) {
        return _this.labelsLayer.select("[data-id='" + _this.escape(d.id) + "']").remove();
      });
      self = this;
      return this.items.each(function(d, i) {
        var label, labelContainer;
        labelContainer = self.labelsLayer.select("[data-id='" + self.escape(d.id) + "']");
        labelContainer.style("width", "15%");
        label = labelContainer.select(".donut-label");
        return label.text(d.id);
      });
    };

    DonutChartView.prototype.escape = function(str) {
      str = str.replace(/'/g, "%27");
      return str;
    };

    DonutChartView.prototype.visualizerDidUpdateItems = function() {
      return this.resizeLabelsAndDraw();
    };

    DonutChartView.prototype.resizeLabelsAndDraw = function() {
      var arc, labelMaxLength, maxLengthLabel, midAngle, outerArc, radius, self, size, transitionTime, transitionType, visHeight, visWidth;
      arc = this.arc;
      outerArc = this.outerArc;
      visWidth = this.behaviors.svg.size.width;
      visHeight = this.behaviors.svg.size.height;
      size = this.items.size();
      midAngle = function(d) {
        return d.startAngle + (d.endAngle - d.startAngle) / 2;
      };
      this.checkShowLabels();
      labelMaxLength = this.labelMaxLength;
      if (size < 100 && this.animationActive) {
        transitionTime = this.model.get("transition")[1];
      } else {
        transitionTime = 0;
      }
      transitionType = this.model.get("transition")[0];
      self = this;
      if (this.showLabel) {
        this.calculateRadiusWithLabel();
        maxLengthLabel = this.maxLengthLabel;
        radius = this.radius;
        this.items.each(function(d, i) {
          var label, labelContainer, pos;
          labelContainer = self.labelsLayer.select("[data-id='" + self.escape(d.id) + "']");
          label = labelContainer.select(".donut-label");
          labelContainer.style("width", "auto");
          pos = outerArc.centroid(d);
          pos[0] = visWidth / 2;
          if (midAngle(d) > Math.PI) {
            pos[0] = -visWidth / 2 + maxLengthLabel + 10 - $(label[0][0]).width();
          } else {
            pos[0] = visWidth / 2 - maxLengthLabel - 10;
          }
          pos[0] = pos[0] + self.behaviors.svg.size.width / 2;
          pos[1] = pos[1] + self.behaviors.svg.size.height / 2;
          return labelContainer.transition().duration(transitionTime).ease(transitionType).style("top", pos[1] + "px").style("left", pos[0] + "px").style("display", "block");
        });
        this.items.select(".line").transition().duration(transitionTime).ease(transitionType).attr("stroke", "#000").attr("stroke-width", "1px").attr("fill", "none").attr("stroke-opacity", "1").attr("points", function(d) {
          var interpolate, posA, posB, posC;
          this._current = this._current || d;
          interpolate = d3.interpolate(this._current, d);
          this._current = interpolate(0);
          posA = arc.centroid(d);
          posB = outerArc.centroid(d);
          posC = outerArc.centroid(d);
          if (midAngle(d) > Math.PI) {
            posC[0] = -visWidth / 2 + maxLengthLabel + 20;
          } else {
            posC[0] = visWidth / 2 - maxLengthLabel - 20;
          }
          return [posA, posB, posC];
        }).style("display", "inherit");
      } else {
        this.items.select(".line").style("display", "none");
        this.items.each(function(d, i) {
          var label, labelContainer;
          labelContainer = self.labelsLayer.select("[data-id='" + self.escape(d.id) + "']");
          label = labelContainer.select(".donut-label");
          return labelContainer.style("display", "none");
        });
        this.calculateRadiusWithoutLabel();
        radius = this.radius;
      }
      return this.items.select(".sector").transition().duration(transitionTime).ease(transitionType).attrTween("d", function(d) {
        var interpolate;
        this._current = this._current || d;
        interpolate = d3.interpolate(this._current, d);
        this._current = interpolate(0);
        return function(t) {
          return arc(interpolate(t));
        };
      });
    };

    return DonutChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.HistogramView = (function(_super) {
    __extends(HistogramView, _super);

    function HistogramView() {
      this.valuesDomainAdjustment = __bind(this.valuesDomainAdjustment, this);
      this.xDomainAdjustment = __bind(this.xDomainAdjustment, this);
      this.yDomainAdjustment = __bind(this.yDomainAdjustment, this);
      this._handleResize = __bind(this._handleResize, this);
      this.updateOutputBins = __bind(this.updateOutputBins, this);
      this.setBins = __bind(this.setBins, this);
      this.createBinItems = __bind(this.createBinItems, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      this.setAxisDirection = __bind(this.setAxisDirection, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      _ref = HistogramView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    HistogramView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    HistogramView.prototype.yAxisType = "bands";

    HistogramView.prototype.xAxisType = "linear";

    HistogramView.prototype.yAxisPadding = true;

    HistogramView.prototype.xAxisPadding = true;

    HistogramView.prototype.followMouse = false;

    HistogramView.prototype.chartType = "barchart";

    HistogramView.prototype.firstExec = true;

    HistogramView.prototype.getXDomainValues = function() {
      if (this.xAxisType === "bands") {
        return this.ids;
      } else {
        return this.calculateNumberDomain(this.binValues, false, "value");
      }
    };

    HistogramView.prototype.getYDomainValues = function() {
      if (this.xAxisType === "bands") {
        return this.calculateNumberDomain(this.binValues, false, "value");
      } else {
        return this.ids;
      }
    };

    HistogramView.prototype.init = function() {
      HistogramView.__super__.init.call(this);
      if (quadrigram.router.getDevice() !== "Desktop") {
        this.followMouse = true;
      }
      return this.histogram = d3.layout.histogram().value(function(d) {
        return +d.value;
      });
    };

    /*
    visualizerWillExecBehaviors1_OLD:() =>
      if @firstExec
        @behaviors.selection.on("selection:change",@updateOutputBins)
      if @resizing
        return
    
      @serieValues = JSON.parse(JSON.stringify(@values))
      itemMetadata = @serieValues[0].metadata
      if itemMetadata.value.label = "Bins"
        itemMetadata.value.label = "Items on bin:"
      generalMetadata = @serieValues.metadata
      generalLabel    = @serieValues.label
      @setBins()       
      @values = @histogram(@serieValues)
      @ids = []
      @values.forEach((valueEntry) =>
          valueEntry.id = "["+Math.round(valueEntry.x*100)/100+", "+Math.round((valueEntry.x+valueEntry.dx)*100)/100+"]"
          valueEntry.value = valueEntry.y
          valueEntry.metadata = itemMetadata
          @ids.push(valueEntry.id)
        )
      @values.metadata = generalMetadata
      @values.label = generalLabel
      #log "HistogramView::visualizerWillExecBehaviors1 -> histogramValues = ",@values
    */


    HistogramView.prototype.setAxisDirection = function() {
      var axeIds;
      axeIds = this.model.get("IdsOnAxis");
      if (!axeIds) {
        axeIds = "Vertical";
      }
      if (axeIds === "Vertical") {
        this.yAxisType = "linear";
        return this.xAxisType = "bands";
      } else {
        this.yAxisType = "bands";
        return this.xAxisType = "linear";
      }
    };

    HistogramView.prototype.checkAxisChanged = function() {
      return (this.model.changed["IdsOnAxis"] != null) || (this.model.changed["gapBetweenBars"] != null) || (this.model.changed["bins"] != null);
    };

    HistogramView.prototype.visualizerWillUpdateItems = function() {
      return this.behaviors.tooltip.baseObjects = "binValues";
    };

    HistogramView.prototype.updateItems = function() {
      /*
      @items = @behaviors.axis.graph.selectAll(".item")
        .data(@values,(d,i) ->
          if bins == quadrigram.Models.VisualizerModel.DEACTIVATED || !bins  
            i
          else
            d.id
        )
      */

      var self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.binValues, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("rect").attr("class", "bar");
      this.items.exit().remove();
      size = this.items.size();
      if (size < 200 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.items.select(".bar").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.items.select(".bar");
      }
      self = this;
      if (this.yAxisType === "bands") {
        return updateD3Object.attr("x", function(d) {
          return self.behaviors.axis.xScale(0);
        }).attr("width", function(d) {
          var realWidth;
          return realWidth = _this.behaviors.axis.xScale(d.value);
        }).attr("y", function(d) {
          return _this.behaviors.axis.yScale(d.id);
        }).attr("height", this.behaviors.axis.yScale.rangeBand());
      } else {
        return updateD3Object.attr("x", function(d, i) {
          return _this.behaviors.axis.xScale(d.id);
        }).attr("width", this.behaviors.axis.xScale.rangeBand()).attr("y", function(d) {
          return self.behaviors.axis.yScale(Math.max(0, d.value));
        }).attr("height", function(d) {
          return Math.abs(_this.behaviors.axis.yScale(d.value) - _this.behaviors.axis.yScale(Math.max(0, _this.behaviors.axis.yScale.domain()[0])));
        });
      }
    };

    HistogramView.prototype.visualizerWillExecBehaviors1 = function() {
      this.createBinItems();
      return this.dimensions = ["value"];
    };

    HistogramView.prototype.createBinItems = function() {
      var itemMetadata,
        _this = this;
      if (this.firstExec) {
        this.behaviors.selection.on("selection:change", this.updateOutputBins);
      }
      if (this.resizing) {
        return;
      }
      this.setBins();
      this.binValues = [];
      this.binValues = this.histogram(this.values);
      this.changedData = true;
      this.ids = [];
      itemMetadata = this.values[0].metadata;
      return this.binValues.forEach(function(valueEntry) {
        valueEntry.id = "[" + Math.round(valueEntry.x * 100) / 100 + ", " + Math.round((valueEntry.x + valueEntry.dx) * 100) / 100 + "]";
        valueEntry.value = valueEntry.y;
        valueEntry.metadata = itemMetadata;
        return _this.ids.push(valueEntry.id);
      });
    };

    HistogramView.prototype.setBins = function() {
      var bin, bins, cleanedBins, _i, _len;
      bins = this.model.get("bins");
      if (bins === quadrigram.Models.VisualizerModel.DEACTIVATED || (bins == null)) {
        return this.histogram.bins();
      } else {
        if (_.isArray(bins)) {
          cleanedBins = [];
          for (_i = 0, _len = bins.length; _i < _len; _i++) {
            bin = bins[_i];
            cleanedBins.push(+bin.value);
          }
          bins = cleanedBins;
        } else {
          bins = +bins;
        }
        return this.histogram.bins(bins);
      }
    };

    HistogramView.prototype.updateOutputBins = function() {
      var candidateIds, selectedBinCandidate, selectedItem, selectedItemsInBin, selectedMaxBin, selectedMinBin, selectedValuesInBin, _i, _len, _ref1;
      selectedValuesInBin = [];
      selectedItemsInBin = [];
      selectedMinBin = Infinity;
      selectedMaxBin = -Infinity;
      _ref1 = this.behaviors.selection.selectedItems;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        selectedItem = _ref1[_i];
        selectedBinCandidate = _.findWhere(this.binValues, {
          id: selectedItem
        });
        if (selectedBinCandidate) {
          selectedValuesInBin = selectedValuesInBin.concat(selectedBinCandidate);
          candidateIds = selectedBinCandidate.map(function(v) {
            return {
              id: v.id,
              value: v.id
            };
          });
          selectedItemsInBin = selectedItemsInBin.concat(candidateIds);
          selectedMinBin = Math.min(selectedMinBin, selectedBinCandidate.x);
          selectedMaxBin = Math.max(selectedMaxBin, selectedBinCandidate.x + selectedBinCandidate.dx);
        }
      }
      this.updateOutput("selectedValuesInBin", selectedValuesInBin);
      this.updateOutput("selectedItemsInBin", selectedItemsInBin);
      this.updateOutput("minimumBinValue", selectedMinBin);
      return this.updateOutput("maximumBinValue", selectedMaxBin);
    };

    HistogramView.prototype._handleResize = function() {
      this.resizing = true;
      return HistogramView.__super__._handleResize.call(this);
    };

    HistogramView.prototype.yDomainAdjustment = function(interval) {
      if (this.yAxisType === "linear") {
        return this.valuesDomainAdjustment(interval);
      } else {
        return interval;
      }
    };

    HistogramView.prototype.xDomainAdjustment = function(interval) {
      if (this.yAxisType === "bands") {
        return this.valuesDomainAdjustment(interval);
      } else {
        return interval;
      }
    };

    HistogramView.prototype.valuesDomainAdjustment = function(interval) {
      if ((interval[0] > 0 && 0 < interval[1])) {
        if (interval[0] < interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] < interval[0]) {
          interval[1] = 0;
        }
      } else if ((interval[0] < 0 && 0 < interval[1]) || (interval[0] > 0 && 0 > interval[1])) {

      } else if ((interval[0] < 0 && 0 > interval[1])) {
        if (interval[0] > interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] > interval[0]) {
          interval[1] = 0;
        }
      }
      return interval;
    };

    return HistogramView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.LineChartView = (function(_super) {
    __extends(LineChartView, _super);

    function LineChartView() {
      this.updateCircles = __bind(this.updateCircles, this);
      this.updateCircles_OLD = __bind(this.updateCircles_OLD, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.createLineFunction = __bind(this.createLineFunction, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      _ref = LineChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LineChartView.prototype.template = JST['app/scripts/templates/visualizers/lineChart.hbs'];

    LineChartView.prototype.xAxisType = "auto";

    LineChartView.prototype.yAxisType = "linear";

    LineChartView.prototype.yAxisPadding = true;

    LineChartView.prototype.xAxisPadding = false;

    LineChartView.prototype.followMouse = true;

    LineChartView.prototype.mainColorDimension = "lineColors";

    LineChartView.prototype.getXDomainValues = function() {
      return this.behaviors.dataController.getXDomainValues();
    };

    LineChartView.prototype.getYDomainValues = function() {
      return this.calculateNumberDomain(this.values, false, "value");
    };

    LineChartView.prototype.visualizerWillExecBehaviors1 = function() {
      return this.dimensions = ["value"];
    };

    LineChartView.prototype.setIdsAndValues = function() {
      this.model.original._ids = this.idsItems;
      return this.model.original._values = this.values;
    };

    LineChartView.prototype.checkAxisChanged = function() {
      return this.model.changed["dimensionAsItems"] != null;
    };

    LineChartView.prototype.createLineFunction = function() {
      var _this = this;
      return this.lineFunction = d3.svg.line().x(function(d, i) {
        return _this.behaviors.axis.xScale(d.id);
      }).y(function(d, i) {
        return _this.behaviors.axis.yScale(d.value);
      }).defined(function(d, i) {
        return !isNaN(d.value);
      });
    };

    LineChartView.prototype.visualizerWillUpdateItems = function() {
      var tension;
      this.displayBreakpoints = this.model.get("displayBreakpoints") === true || this.model.get("displayBreakpoints") === "true";
      switch (this.model.get("interpolation")) {
        case "Smooth":
          this.lineInterpolation = "basis";
          break;
        case "Steps":
          this.lineInterpolation = "step";
          break;
        default:
          this.lineInterpolation = "cardinal";
      }
      if (this.displayBreakpoints) {
        tension = 1;
      } else {
        tension = 0.9;
      }
      if (this.lineFunction == null) {
        this.createLineFunction();
      }
      return this.lineFunction.interpolate(this.lineInterpolation).tension(tension);
    };

    LineChartView.prototype.updateItems = function() {
      var self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      self = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        if (self.values.length === 1 && self.__LastValuesLength === 1) {
          return "__onlyOne__";
        } else {
          return d.id;
        }
      });
      this.__LastValuesLength = this.values.length;
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("path").attr("class", "line-path").attr("fill", "none").attr("pointer-events", "stroke");
      this.itemsEnter.append("path").attr("class", "hit-area-path dont-render").attr("fill", "none").attr("pointer-events", "stroke").attr("stroke", "rgba(255,0,0,0)").attr("stroke-width", "5px");
      this.itemsEnter.append("g").attr("class", "breakpoints");
      this.items.exit().remove();
      size = this.ids.length * this.idsItems.length;
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.items.select(".line-path").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.items.select(".line-path");
      }
      self = this;
      updateD3Object.attr("d", function(d) {
        var sortedLine;
        sortedLine = d.value.sort(function(a, b) {
          if (self.behaviors.axis.xScale(a.id) > self.behaviors.axis.xScale(b.id)) {
            return 1;
          } else {
            return -1;
          }
        });
        return self.lineFunction(sortedLine);
      });
      return this.items.select(".hit-area-path").attr("d", function(d) {
        var sortedLine;
        sortedLine = d.value.sort(function(a, b) {
          if (self.behaviors.axis.xScale(a.id) > self.behaviors.axis.xScale(b.id)) {
            return 1;
          } else {
            return -1;
          }
        });
        return self.lineFunction(sortedLine);
      });
    };

    LineChartView.prototype.visualizerDidUpdateItems = function() {
      if (this.displayBreakpoints === true) {
        return this.updateCircles();
      } else {
        return this.items.each(function(objectLine, indexLine) {
          return d3.select(this).select(".breakpoints").selectAll(".dot").remove();
        });
      }
    };

    LineChartView.prototype.updateCircles_OLD = function() {
      /*
      self = @
      @items.each((objectLine,indexLine) ->
      
          ##WRONG: pero mejor que lo de antes que petaba... :)
          radius = 2#self.behaviors.selection.behaviors.items.lineThicknessScale(objectLine.id)
      
          circles = d3.select(@).select(".breakpoints").selectAll(".dot").data(objectLine.value,(objectBreakpoint,indexBreakpoint) -> return objectBreakpoint.id)
      
          circlesEnter = circles.enter().append("circle")
            .attr("class","dot")
      
          circles.exit().remove()
      
          circles.attr("cx", (objectBreakpoint,indexBreakpoint)=>
              return self.behaviors.axis.xScale(objectBreakpoint.id)
          )
          .attr("cy", (objectBreakpoint,indexBreakpoint)=>
            if !isNaN(objectBreakpoint.value)
              return self.behaviors.axis.yScale(objectBreakpoint.value)
            else
              return 0
          )
          .attr("fill", (objectBreakpoint,indexBreakpoint)->
            return "#FFF"
          )
          .attr("r", radius)
          .style("display",(d)->
            if !isNaN(d.value) then "block" else "none"
          )
        )
      */

    };

    LineChartView.prototype.updateCircles = function() {
      var self;
      self = this;
      return this.items.each(function(objectLine, indexLine) {
        var circles, circlesEnter, radius, shape, size,
          _this = this;
        radius = 2;
        circles = d3.select(this).select(".breakpoints").selectAll(".dot").data(objectLine.value, function(objectBreakpoint, indexBreakpoint) {
          return objectBreakpoint.id;
        });
        circlesEnter = circles.enter().append("g").attr("class", "dot");
        circles.exit().remove();
        shape = self.behaviors.selection.behaviors.items.styleItems[objectLine.id].shapeType;
        size = self.behaviors.selection.behaviors.items.styleItems[objectLine.id].shapeSize.replace("px", "");
        circles.each(function(d) {
          d3.select(this);
          return self.behaviors.svgshapes.drawShape(d3.select(this), shape, size);
        });
        circles.attr("transform", function(bpd) {
          var x, y;
          x = self.behaviors.axis.xScale(bpd.id);
          if (!isNaN(bpd.value)) {
            y = self.behaviors.axis.yScale(bpd.value);
          } else {
            y = 0;
          }
          return "translate(" + x + "," + y + ")";
        });
        return circles.attr("fill", function(objectBreakpoint, indexBreakpoint) {
          return "#FFF";
        }).style("display", function(d) {
          if (!isNaN(d.value)) {
            return "block";
          } else {
            return "none";
          }
        });
      });
    };

    return LineChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.LineAndBarChartView = (function(_super) {
    __extends(LineAndBarChartView, _super);

    function LineAndBarChartView() {
      this.barDomainAdjustment = __bind(this.barDomainAdjustment, this);
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.createLineFunction = __bind(this.createLineFunction, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      this.setAxisDirection = __bind(this.setAxisDirection, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      _ref = LineAndBarChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LineAndBarChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    LineAndBarChartView.prototype.yAxisType = "auto";

    LineAndBarChartView.prototype.xAxisType = "bands";

    LineAndBarChartView.prototype.followMouse = false;

    LineAndBarChartView.prototype.followMouse2 = true;

    LineAndBarChartView.prototype.chartType = "lineandbar";

    LineAndBarChartView.prototype.init = function() {
      LineAndBarChartView.__super__.init.call(this);
      if (quadrigram.router.getDevice() !== "Desktop") {
        return this.followMouse = true;
      }
    };

    LineAndBarChartView.prototype.getXDomainValues = function() {
      return this.behaviors.dataController.getXDomainValues();
    };

    LineAndBarChartView.prototype.getYDomainValues = function(dimensionId) {
      var result;
      if ((dimensionId == null) || this.model.get("uniformAxes") === "true") {
        return this.calculateNumberDomain(this.values, false, "value");
      } else {
        if (dimensionId === "bars") {
          result = this.calculateNumberDomain(this.values1, false, "value");
        } else {
          result = this.calculateNumberDomain(this.values2, false, "value");
        }
        return result;
      }
    };

    LineAndBarChartView.prototype.visualizerWillExecBehaviors1 = function() {
      return this.dimensions = ["bars", "lines"];
    };

    LineAndBarChartView.prototype.setAxisDirection = function() {};

    LineAndBarChartView.prototype.checkAxisChanged = function() {
      return (this.model.changed["gapBetweenBars"] != null) || (this.model.changed["dimensionAsItems"] != null);
    };

    LineAndBarChartView.prototype.createLineFunction = function() {
      var _this = this;
      return this.lineFunction = d3.svg.line().x(function(d, i) {
        return _this.behaviors.axis.xScale(d.id) + _this.behaviors.axis.xScale.rangeBand() / 2;
      }).y(function(d, i) {
        return _this.behaviors.axis.yScales["lines"](d.value);
      });
    };

    LineAndBarChartView.prototype.visualizerWillUpdateItems = function() {
      this.displayBreakpoints = this.model.get("displayBreakpoints") === true || this.model.get("displayBreakpoints") === "true";
      this.lineInterpolation = "cardinal";
      if (this.displayBreakpoints === true) {
        this.lineInterpolation = "linear";
      }
      if (this.lineFunction == null) {
        this.createLineFunction();
      }
      return this.lineFunction.interpolate(this.lineInterpolation).tension(0.9);
    };

    LineAndBarChartView.prototype.updateItems = function() {
      var self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      if (!this.linesCanvas) {
        this.barsCanvas = this.behaviors.axis.graph.append("g").attr("class", "bars-canvas");
        this.linesCanvas = this.behaviors.axis.graph.append("g").attr("class", "lines-canvas");
      }
      this.lineItems = this.linesCanvas.selectAll(".second-item").data(this.values2, function(d, i) {
        return d.id;
      });
      this.lineItemsEnter = this.lineItems.enter().append("g").attr("class", "second-item");
      this.lineItemsEnter.append("path").attr("class", "line-path").attr("fill", "none").attr("pointer-events", "stroke");
      this.lineItemsEnter.append("path").attr("class", "hit-area-path dont-render").attr("fill", "none").attr("pointer-events", "stroke").attr("stroke", "rgba(255,0,0,0)").attr("stroke-width", "5px");
      this.lineItemsEnter.append("g").attr("class", "breakpoints");
      this.lineItems.exit().remove();
      size = this.ids2.length * this.idsItems2.length;
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.lineItems.select(".line-path").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.lineItems.select(".line-path");
      }
      self = this;
      updateD3Object.attr("d", function(d) {
        var sortedLine;
        sortedLine = d.value.sort(function(a, b) {
          if (self.behaviors.axis.xScale(a.id) > self.behaviors.axis.xScale(b.id)) {
            return 1;
          } else {
            return -1;
          }
        });
        return self.lineFunction(sortedLine);
      });
      this.lineItems.select(".hit-area-path").attr("d", function(d) {
        var sortedLine;
        sortedLine = d.value.sort(function(a, b) {
          if (self.behaviors.axis.xScale(a.id) > self.behaviors.axis.xScale(b.id)) {
            return 1;
          } else {
            return -1;
          }
        });
        return self.lineFunction(sortedLine);
      });
      this.barItems = this.barsCanvas.selectAll(".item").data(this.values1, function(d, i) {
        return d.id;
      });
      this.barItemsEnter = this.barItems.enter().append("g").attr("class", "item");
      this.barItemsEnter.append("rect").attr("class", "bar");
      this.barItems.exit().remove();
      this.items = this.barItems;
      this.items2 = this.lineItems;
      size = this.barItems.size();
      if (size < 200 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.barItems.select(".bar").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.barItems.select(".bar");
      }
      self = this;
      if (this.yAxisType === "bands") {
        return updateD3Object.attr("x", function(d) {
          return Math.max(0, self.behaviors.axis.xScale(Math.min(0, d.value)));
        }).attr("width", function(d) {
          var domainValue, domainWidth, realWidth, realX;
          realWidth = _this.behaviors.axis.xScale(d.value) - _this.behaviors.axis.xScale(Math.max(0, _this.behaviors.axis.xScale.domain()[0]));
          realX = self.behaviors.axis.xScale(Math.min(0, d.value));
          if (d.value < 0) {
            domainValue = _this.behaviors.axis.xScale.domain()[0];
            if (domainValue > 0) {
              realWidth = 0;
            } else {
              domainWidth = _this.behaviors.axis.xScale(domainValue) - _this.behaviors.axis.xScale(0);
              realWidth = Math.abs(Math.max(domainWidth, realWidth));
            }
          } else {
            realWidth = Math.max(0, realWidth);
          }
          return realWidth;
        }).attr("y", function(d) {
          return _this.behaviors.axis.yScales["bars"](d.id);
        }).attr("height", this.behaviors.axis.yScales["bars"].rangeBand());
      } else {
        return updateD3Object.attr("x", function(d, i) {
          return _this.behaviors.axis.xScale(d.id);
        }).attr("width", this.behaviors.axis.xScale.rangeBand()).attr("y", function(d) {
          var limit, value;
          value = self.behaviors.axis.yScales["bars"](Math.max(0, d.value));
          limit = self.behaviors.axis.yScales["bars"].range()[0];
          if (value > limit) {
            d3.select(this).style("display", "none");
          } else {
            d3.select(this).style("display", "");
          }
          return value;
        }).attr("height", function(d) {
          return Math.abs(_this.behaviors.axis.yScales["bars"](d.value) - _this.behaviors.axis.yScales["bars"](Math.max(0, _this.behaviors.axis.yScales["bars"].domain()[0])));
        });
      }
    };

    LineAndBarChartView.prototype.barDomainAdjustment = function(interval) {
      if ((interval[0] > 0 && 0 < interval[1])) {
        if (interval[0] < interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] < interval[0]) {
          interval[1] = 0;
        }
      } else if ((interval[0] < 0 && 0 < interval[1]) || (interval[0] > 0 && 0 > interval[1])) {

      } else if ((interval[0] < 0 && 0 > interval[1])) {
        if (interval[0] > interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] > interval[0]) {
          interval[1] = 0;
        }
      }
      return interval;
    };

    return LineAndBarChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.RadarChartView = (function(_super) {
    __extends(RadarChartView, _super);

    function RadarChartView() {
      this.yDomainAdjustment = __bind(this.yDomainAdjustment, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.createLineFunction = __bind(this.createLineFunction, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      this.updateZIndex = __bind(this.updateZIndex, this);
      this.enableZoom = __bind(this.enableZoom, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = RadarChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RadarChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    RadarChartView.prototype.xAxisType = "auto";

    RadarChartView.prototype.yAxisType = "linear";

    RadarChartView.prototype.yAxisPadding = false;

    RadarChartView.prototype.xAxisPadding = false;

    RadarChartView.prototype.followMouse = true;

    RadarChartView.prototype.mainColorDimension = "lineColors";

    RadarChartView.prototype.viewDidRender = function() {
      var zoomBkg,
        _this = this;
      this.zoom = d3.behavior.zoom().scaleExtent([1, 10]);
      this.zoom.on("zoom", this.updateZIndex);
      zoomBkg = this.behaviors.axis.behaviors.svg.root.insert("rect", ":first-child").attr("fill", "none").attr("class", "zoom-bkg").attr("width", "100%").attr("height", "100%");
      /*
      zoomBkg.on("mouseenter",()=>
        if !@zoomActive
          zoomBkg.classed("ui-tip-target",true)
        else
          zoomBkg.classed("ui-tip-target",false)
      )
      */

      this.$el.on("click", function(e) {
        return _this.enableZoom(true);
      });
      return this.$el.on("mouseleave", function() {
        return _this.enableZoom(false);
      });
    };

    RadarChartView.prototype.enableZoom = function(value) {
      this.zoomActive = value;
      if (this.zoomActive) {
        return this.behaviors.axis.behaviors.svg.root.call(this.zoom);
      } else {
        return this.behaviors.axis.behaviors.svg.root.on("onwheel.zoom", null).on("onmousewheel.zoom", null).on("mousewheel.zoom", null).on("wheel.zoom", null);
      }
    };

    RadarChartView.prototype.updateZIndex = function() {
      var $rootEl;
      $rootEl = $(this.behaviors.axis.graph.node());
      if (this.lastScale < d3.event.scale) {
        log("zoomin");
        $rootEl.find(".item").first().appendTo($rootEl);
      } else if (this.lastScale > d3.event.scale) {
        $rootEl.find(".item").last().prependTo($rootEl);
        log("zoomout");
      }
      return this.lastScale = d3.event.scale;
    };

    RadarChartView.prototype.getXDomainValues = function() {
      return this.behaviors.dataController.getXDomainValues();
    };

    RadarChartView.prototype.getYDomainValues = function(dimensionId) {
      var result;
      if ((dimensionId == null) || this.model.get("uniformAxes") === "true") {
        return this.calculateNumberDomain(this.values, false, "value");
      } else {
        result = d3.extent(this.values, function(line) {
          var found;
          found = _.findWhere(line.value, {
            id: dimensionId
          });
          if (found != null) {
            return +found.value;
          } else {
            return null;
          }
        });
        return result;
      }
    };

    RadarChartView.prototype.setIdsAndValues = function() {
      this.model.original._ids = this.idsItems;
      return this.model.original._values = this.values;
    };

    RadarChartView.prototype.checkAxisChanged = function() {
      return this.model.changed["dimensionAsItems"] != null;
    };

    RadarChartView.prototype.visualizerWillExecBehaviors1 = function() {
      return this.dimensions = this.behaviors.dataController.getXDomainValues();
    };

    RadarChartView.prototype.createLineFunction = function() {
      var _this = this;
      this.lineFunction = d3.svg.line.radial().angle(function(d) {
        return 2 * Math.PI * _this.dimensions.indexOf(d.id) / _this.dimensions.length;
      }).radius(function(d) {
        return _this.behaviors.axis.yScales[d.id](d.value);
      });
      return this.areaFunction = d3.svg.area.radial().angle(function(d) {
        return 2 * Math.PI * _this.dimensions.indexOf(d.id) / _this.dimensions.length;
      }).innerRadius(0).outerRadius(function(d) {
        return _this.behaviors.axis.yScales[d.id](d.value);
      });
      /*
      @lineFunction = d3.svg.line()
        .x (d, i)=>
          #return @behaviors.axis.xScale(d.id)
          return @behaviors.axis.getXPos(d.id,d.value)
        .y (d, i)=>
          #return @behaviors.axis.yScales[d.id](d.value)
          return @behaviors.axis.getYPos(d.id,d.value)
        .defined (d,i)=>
          return !isNaN(d.value)
      */

    };

    RadarChartView.prototype.visualizerWillUpdateItems = function() {
      var tension;
      this.displayBreakpoints = this.model.get("displayBreakpoints") === true || this.model.get("displayBreakpoints") === "true";
      switch (this.model.get("interpolation")) {
        case "Smooth":
          this.lineInterpolation = "basis";
          break;
        case "Steps":
          this.lineInterpolation = "step";
          break;
        default:
          this.lineInterpolation = "cardinal";
      }
      if (this.displayBreakpoints) {
        tension = 1;
      } else {
        tension = 0.9;
      }
      if (this.lineFunction == null) {
        return this.createLineFunction();
      }
      /*
      @lineFunction.interpolate(@lineInterpolation)
        .tension(tension)
      */

    };

    RadarChartView.prototype.updateItems = function() {
      var self, size, transitionTime, transitionType, updateD3ObjectAreas, updateD3ObjectLines,
        _this = this;
      switch (this.model.get("interpolation")) {
        case "Curves":
          this.lineInterpolation = "cardinal-closed";
          break;
        case "Segments":
          this.lineInterpolation = "linear-closed";
          break;
        default:
          this.lineInterpolation = "linear-closed";
      }
      this.lineFunction.interpolate(this.lineInterpolation);
      this.areaFunction.interpolate(this.lineInterpolation);
      self = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        if (self.values.length === 1 && self.__LastValuesLength === 1) {
          return "__onlyOne__";
        } else {
          return d.id;
        }
      });
      this.__LastValuesLength = this.values.length;
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("path").attr("class", "line-path").attr("fill", "none").attr("pointer-events", "stroke");
      this.itemsEnter.append("path").attr("class", "hit-area-path dont-render").attr("fill", "none").attr("pointer-events", "stroke").attr("stroke", "rgba(255,0,0,0)").attr("stroke-width", "5px");
      this.itemsEnter.append("path").attr("class", "area-path").attr("pointer-events", "fill");
      this.items.exit().remove();
      size = this.ids.length * this.idsItems.length;
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3ObjectLines = this.items.select(".line-path").transition().duration(transitionTime).ease(transitionType);
        updateD3ObjectAreas = this.items.select(".area-path").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3ObjectLines = this.items.select(".line-path");
        updateD3ObjectAreas = this.items.select(".area-path");
      }
      self = this;
      updateD3ObjectLines.attr("d", function(d) {
        return self.lineFunction(d.value);
      });
      updateD3ObjectAreas.attr("d", function(d) {
        return self.areaFunction(d.value);
      });
      return this.items.select(".hit-area-path").attr("d", function(d) {
        return self.lineFunction(d.value);
      });
    };

    RadarChartView.prototype.visualizerDidUpdateItems = function() {
      var _this = this;
      return this.items.select(".area-path").attr("pointer-events", function(d, i) {
        if (_this.behaviors.selection.behaviors.items.styleItems[d.id]["fillColors"] === "transparent" || _this.behaviors.selection.behaviors.items.styleItems[d.id]["fillOpacities"] === 0) {
          return "none";
        } else {
          return "fill";
        }
      });
    };

    RadarChartView.prototype.yDomainAdjustment = function(interval) {
      if ((interval[0] > 0 && 0 < interval[1])) {
        if (interval[0] < interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] < interval[0]) {
          interval[1] = 0;
        }
      } else if ((interval[0] < 0 && 0 < interval[1]) || (interval[0] > 0 && 0 > interval[1])) {

      } else if ((interval[0] < 0 && 0 > interval[1])) {
        if (interval[0] > interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] > interval[0]) {
          interval[1] = 0;
        }
      }
      return interval;
    };

    return RadarChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.StackedAreaChartView = (function(_super) {
    __extends(StackedAreaChartView, _super);

    function StackedAreaChartView() {
      this.yDomainAdjustment = __bind(this.yDomainAdjustment, this);
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.createStackFunction = __bind(this.createStackFunction, this);
      this.createAreaFunction = __bind(this.createAreaFunction, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      this.fillStackValues = __bind(this.fillStackValues, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      _ref = StackedAreaChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    StackedAreaChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    StackedAreaChartView.prototype.xAxisType = "auto";

    StackedAreaChartView.prototype.yAxisType = "linear";

    StackedAreaChartView.prototype.yAxisPadding = true;

    StackedAreaChartView.prototype.xAxisPadding = false;

    StackedAreaChartView.prototype.accumulate = true;

    StackedAreaChartView.prototype.followMouse = true;

    StackedAreaChartView.prototype.chartType = "stackedareachart";

    StackedAreaChartView.prototype.extraAmplitudeDomain = 0.30;

    StackedAreaChartView.prototype.setIdsAndValues = function() {
      this.model.original._ids = this.idsItems;
      this.values = this.fillStackValues(this.values);
      return this.model.original._values = this.values;
    };

    StackedAreaChartView.prototype.fillStackValues = function(values) {
      var i, maxLength, v, _i, _j, _k, _len, _len1, _ref1;
      if (values != null) {
        maxLength = 0;
        for (_i = 0, _len = values.length; _i < _len; _i++) {
          v = values[_i];
          maxLength = Math.max(v.value.length, maxLength);
        }
        for (_j = 0, _len1 = values.length; _j < _len1; _j++) {
          v = values[_j];
          if (v.value.length < maxLength) {
            for (i = _k = 0, _ref1 = maxLength - v.value.length - 1; 0 <= _ref1 ? _k <= _ref1 : _k >= _ref1; i = 0 <= _ref1 ? ++_k : --_k) {
              v.value.push({
                id: "null",
                value: 0,
                value0: 0
              });
            }
          }
        }
      }
      return values;
    };

    StackedAreaChartView.prototype.getXDomainValues = function() {
      return this.behaviors.dataController.getXDomainValues();
    };

    StackedAreaChartView.prototype.getYDomainValues = function() {
      return this.calculateNumberDomain(this.values, true, "value");
    };

    StackedAreaChartView.prototype.createAreaFunction = function() {
      var _this = this;
      return this.areaFunction = d3.svg.area().x(function(d, i) {
        return _this.behaviors.axis.xScale(d.id);
      }).y0(function(d, i) {
        return _this.behaviors.axis.yScale(Math.max(d.value0, 0));
      }).y1(function(d, i) {
        return _this.behaviors.axis.yScale(Math.max(d.value0 + d.value, d.value0));
      });
    };

    StackedAreaChartView.prototype.createStackFunction = function() {
      return this.stack = d3.layout.stack().values(function(d) {
        return d.value;
      }).y(function(d) {
        return parseFloat(d.value);
      }).out(function(d, y0, y) {
        if (!isNaN(y0) && y0 !== "") {
          d.value0 = parseFloat(y0);
        } else {
          d.value0 = 0;
        }
        if (!isNaN(y) && y !== "") {
          return d.value = parseFloat(y);
        } else {
          return d.value = 0;
        }
      });
    };

    StackedAreaChartView.prototype.visualizerWillExecBehaviors1 = function() {
      if (!this.stack) {
        this.createStackFunction();
      }
      this.values = this.stack(this.values);
      return this.dimensions = ["value"];
    };

    StackedAreaChartView.prototype.visualizerWillUpdateItems = function() {
      if (this.areaFunction == null) {
        this.createAreaFunction();
        this.lineInterpolation = "cardinal";
        return this.areaFunction.interpolate(this.lineInterpolation).tension(0.9);
      }
    };

    StackedAreaChartView.prototype.updateItems = function() {
      var self,
        _this = this;
      self = this;
      self = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        if (self.values.length === 1 && self.__LastValuesLength === 1) {
          return "__onlyOne__";
        } else {
          return d.id;
        }
      });
      this.__LastValuesLength = this.values.length;
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("path").attr("class", "area-path");
      this.items.exit().remove();
      return this.items.select(".area-path").attr("d", function(d) {
        var sortedLine;
        sortedLine = d.value.sort(function(a, b) {
          if (self.behaviors.axis.xScale(a.id) > self.behaviors.axis.xScale(b.id)) {
            return 1;
          } else {
            return -1;
          }
        });
        return self.areaFunction(sortedLine);
      });
    };

    StackedAreaChartView.prototype.yDomainAdjustment = function(interval) {
      if ((interval[0] > 0 && 0 < interval[1])) {
        if (interval[0] < interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] < interval[0]) {
          interval[1] = 0;
        }
      } else if ((interval[0] < 0 && 0 < interval[1]) || (interval[0] > 0 && 0 > interval[1])) {

      } else if ((interval[0] < 0 && 0 > interval[1])) {
        if (interval[0] > interval[1]) {
          interval[0] = 0;
        }
        if (interval[1] > interval[0]) {
          interval[1] = 0;
        }
      }
      return interval;
    };

    return StackedAreaChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PictoGramView = (function(_super) {
    __extends(PictoGramView, _super);

    function PictoGramView() {
      this.bestGridSize = __bind(this.bestGridSize, this);
      this.cloneSelection = __bind(this.cloneSelection, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.loadSVG = __bind(this.loadSVG, this);
      this.iconUrlFromId = __bind(this.iconUrlFromId, this);
      this._updateContent = __bind(this._updateContent, this);
      _ref = PictoGramView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PictoGramView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    PictoGramView.prototype.yAxisType = "bands";

    PictoGramView.prototype.xAxisType = "linear";

    PictoGramView.prototype.followMouse = true;

    PictoGramView.prototype.chartType = "pictogram";

    PictoGramView.prototype._updateContent = function() {
      var _this = this;
      if (!this.graph) {
        this.graph = this.behaviors.svg.root.append("g").attr("class", "graph");
      }
      return this.loadSVG(function() {
        return PictoGramView.__super__._updateContent.apply(_this, arguments);
      });
    };

    PictoGramView.prototype.iconUrlFromId = function(id) {
      if (id.currentFormat === "ImageUrl") {
        return id[0];
      } else {
        switch (id) {
          case "person":
            return "./images/control_parts/pictogram/pictogram_icons_man.svg";
          case "bus":
            return "./images/control_parts/pictogram/pictogram_icons_bus.svg";
          case "car":
            return "./images/control_parts/pictogram/pictogram_icons_car.svg";
          case "clock":
            return "./images/control_parts/pictogram/pictogram_icons_clock.svg";
          case "bar":
            return "./images/control_parts/pictogram/pictogram_icons_bar.svg";
          case "boat":
            return "./images/control_parts/pictogram/pictogram_icons_boat.svg";
          case "calendar":
            return "./images/control_parts/pictogram/pictogram_icons_calendar.svg";
          case "check":
            return "./images/control_parts/pictogram/pictogram_icons_check.svg";
          case "coin":
            return "./images/control_parts/pictogram/pictogram_icons_coin.svg";
          case "country":
            return "./images/control_parts/pictogram/pictogram_icons_country.svg";
          case "credit_card":
            return "./images/control_parts/pictogram/pictogram_icons_credit_card.svg";
          case "document":
            return "./images/control_parts/pictogram/pictogram_icons_document.svg";
          case "down":
            return "./images/control_parts/pictogram/pictogram_icons_down.svg";
          case "flight":
            return "./images/control_parts/pictogram/pictogram_icons_flight.svg";
          case "hotel":
            return "./images/control_parts/pictogram/pictogram_icons_hotel.svg";
          case "heart":
            return "./images/control_parts/pictogram/pictogram_icons_heart.svg";
          case "house":
            return "./images/control_parts/pictogram/pictogram_icons_house.svg";
          case "music":
            return "./images/control_parts/pictogram/pictogram_icons_music.svg";
          case "next":
            return "./images/control_parts/pictogram/pictogram_icons_next.svg";
          case "not_interested":
            return "./images/control_parts/pictogram/pictogram_icons_not_interested.svg";
          case "note":
            return "./images/control_parts/pictogram/pictogram_icons_note.svg";
          case "radio":
            return "./images/control_parts/pictogram/pictogram_icons_radio.svg";
          case "shopping_car":
            return "./images/control_parts/pictogram/pictogram_icons_shopping-car.svg";
          case "star":
            return "./images/control_parts/pictogram/pictogram_icons_star.svg";
          case "train":
            return "./images/control_parts/pictogram/pictogram_icons_train.svg";
          case "up":
            return "./images/control_parts/pictogram/pictogram_icons_up.svg";
          case "walk":
            return "./images/control_parts/pictogram/pictogram_icons_walk.svg";
        }
      }
    };

    PictoGramView.prototype.loadSVG = function(callback) {
      var imgURL,
        _this = this;
      if ((this.model.changed["icon_url"] != null) || !this.iconDef) {
        this.iconChanged = true;
        imgURL = this.iconUrlFromId(this.model.get("icon_url"));
        this.iconDef = this.graph.append("g");
        return jQuery.get(imgURL, (function(data) {
          var $svg, DOMElementBBox, self;
          $svg = d3.select(data).selectAll("rect,circle,ellipse,line,polyline,polygon,path");
          $svg.attr("fill", null);
          $svg.attr("stroke", null);
          self = _this;
          $svg.each(function() {
            var _this = this;
            return self.iconDef.append((function() {
              return _this;
            }));
          });
          DOMElementBBox = _this.iconDef[0][0].getBBox();
          _this.originalSize = [DOMElementBBox.width, DOMElementBBox.height];
          _this.originalPos = [DOMElementBBox.x, DOMElementBBox.y];
          $(_this.iconDef[0][0]).detach();
          return callback();
        }), 'xml');
      } else {
        this.iconChanged = false;
        return callback();
      }
    };

    PictoGramView.prototype.updateItems = function() {
      var barValues, dx, dy, gridObject, item, preBarValues, row, rowDx, scale, self, sum, v, val, width, _i, _j, _k, _l, _len, _len1, _len2, _ref1, _ref2, _ref3;
      this.iconValues = [];
      this.iconCountChanged = this.iconCount !== this.model.get("numIcons");
      if (this.iconCountChanged) {
        d3.select(this.$el[0]).selectAll(".icon").remove();
      }
      this.iconCount = this.model.get("numIcons");
      this.percentPadding = this.model.get("iconPadding") / 100;
      this.pixelPadding = [this.originalSize[0] * this.percentPadding, this.originalSize[0] * this.percentPadding];
      this.iconRatio = (this.originalSize[1] + 2 * this.pixelPadding[0]) / (this.originalSize[0] + 2 * this.pixelPadding[1]);
      gridObject = this.bestGridSize(this.behaviors.svg.size.width, this.behaviors.svg.size.height, this.iconCount, this.iconRatio);
      preBarValues = [];
      sum = 0;
      _ref1 = this.values;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        v = _ref1[_i];
        sum += +v.value;
      }
      width = 0;
      dx = 0;
      _ref2 = this.values;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        item = _ref2[_j];
        width = this.iconCount * (+item.value) / sum;
        preBarValues.push({
          id: item.id,
          dx: dx,
          width: width
        });
        dx = dx + width;
        width = 0;
      }
      barValues = [];
      for (row = _k = 0, _ref3 = gridObject.rows - 1; 0 <= _ref3 ? _k <= _ref3 : _k >= _ref3; row = 0 <= _ref3 ? ++_k : --_k) {
        rowDx = row * gridObject.cols;
        for (_l = 0, _len2 = preBarValues.length; _l < _len2; _l++) {
          val = preBarValues[_l];
          barValues.push({
            pictoId: row + "_" + val.id,
            id: val.id,
            width: val.width,
            dx: val.dx - rowDx,
            height: 1,
            dy: row
          });
        }
      }
      this.items = this.graph.selectAll(".item").data(this.values, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.items.exit().remove();
      self = this;
      scale = gridObject.size[0] / (self.originalSize[0] + 2 * self.pixelPadding[0]);
      if (this.iconChanged === true) {
        this.items.selectAll(".icon").remove();
      }
      this.items.each(function(itemData, itemIndex) {
        var bar, globaldx, globaldy, segmentItems, segmentItemsEnter, thisItemBarValues, transition, transitionTime, transitionType, _len3, _m;
        d3.select(this).selectAll("path,polygon").attr("vector-effect", "non-scaling-stroke");
        thisItemBarValues = [];
        for (_m = 0, _len3 = barValues.length; _m < _len3; _m++) {
          bar = barValues[_m];
          if (bar.id === itemData.id) {
            thisItemBarValues.push(bar);
          }
        }
        segmentItems = d3.select(this).selectAll(".segment-item").data(thisItemBarValues, function(d, i) {
          return d.pictoId;
        });
        segmentItemsEnter = segmentItems.enter().append("g").attr("class", "segment-item");
        segmentItemsEnter.append("clipPath").attr("class", "clip-path").attr("id", function(d) {
          return d.pictoId;
        }).append("rect").attr("class", "rectangle").attr("fill", "#ddd").attr("opacity", "0.5").attr("stroke-width", "3px").attr("stroke", "#000000");
        segmentItemsEnter.append("g").attr("class", "icon-container").attr("clip-path", function(d, i) {
          return "url(#" + d.pictoId + ")";
        });
        segmentItemsEnter.each(function(d, i) {
          return this._current = {
            width: d.width,
            dx: d.dx
          };
        });
        globaldx = -self.originalPos[0];
        globaldy = -self.originalPos[1];
        if (self.animationActive && self.iconChanged === false && self.iconCountChanged === false) {
          transitionType = self.model.get("transition")[0];
          transitionTime = self.model.get("transition")[1];
          transition = segmentItems.transition().duration(transitionTime).ease(transitionType);
        } else {
          transition = segmentItems.transition().duration(0);
        }
        /*
        transitionType = self.model.get("transition")[0]
        transitionTime = self.model.get("transition")[1]
        
        transition = segmentItems.transition().duration(transitionTime).ease(transitionType)
        */

        transition.select(".rectangle").attr("width", function(d, i) {
          return d.width * gridObject.size[0];
        }).attr("height", function(d, i) {
          return d.height * gridObject.size[1];
        }).attr("x", function(d, i) {
          return d.dx * gridObject.size[0];
        }).attr("y", function(d, i) {
          return d.dy * gridObject.size[1];
        });
        transition.tween("myTween", function(newd, i) {
          var interpolation;
          interpolation = d3.interpolate(this._current, newd);
          this._current = interpolation(0);
          return function(t) {
            var currentIcons, d, d3Object, icon, _n, _ref4, _results;
            d = interpolation(t);
            d3Object = d3.select(this);
            currentIcons = d3.select(this);
            _results = [];
            for (i = _n = 0, _ref4 = self.iconCount - 1; 0 <= _ref4 ? _n <= _ref4 : _n >= _ref4; i = 0 <= _ref4 ? ++_n : --_n) {
              if (i > Math.ceil(self.iconCount / gridObject.rows) - 1 || i < Math.floor(d.dx) || i > Math.ceil(d.dx + d.width - 1)) {
                _results.push(currentIcons.select("#icon_" + i).remove());
              } else if (i < Math.ceil(self.iconCount / gridObject.rows)) {
                if (currentIcons.select("#icon_" + i)[0][0] == null) {
                  icon = d3Object.select(".icon-container").append("g").attr("class", "icon").attr("id", "icon_" + i);
                  self.cloneSelection(icon, self.iconDef, 1);
                } else {
                  icon = currentIcons.select("#icon_" + i);
                }
                _results.push(icon.attr("transform", "scale(" + scale + ") translate(" + (globaldx + i * gridObject.size[0] / scale) + "," + (globaldy + d.dy * gridObject.size[1] / scale) + ")"));
              } else {
                _results.push(void 0);
              }
            }
            return _results;
          };
        });
        return segmentItems.exit().remove();
      });
      dx = this.pixelPadding[0] * scale + (this.behaviors.svg.size.width - gridObject.cols * gridObject.size[0]) / 2;
      dy = this.pixelPadding[1] * scale + (this.behaviors.svg.size.height - gridObject.rows * gridObject.size[1]) / 2;
      return this.graph.attr("transform", "translate(" + dx + "," + dy + ")");
    };

    PictoGramView.prototype.visualizerDidUpdateItems = function() {
      return this.behaviors.selection.behaviors.items.update();
    };

    PictoGramView.prototype.cloneSelection = function(appendTo, toCopy, times) {
      toCopy.each(function() {
        var clone, i;
        i = 0;
        while (i < times) {
          clone = appendTo.node().appendChild(this.cloneNode(true));
          d3.select(clone).attr('class', 'clone');
          i++;
        }
      });
      return appendTo.selectAll('.clone');
    };

    PictoGramView.prototype.bestGridSize = function(width, height, items, iconRatio) {
      var actualBest, best, bestExact, bestExactValue, bestValue, computedSize, dSize, f, factors, h, hSize, size, w, wSize, _i, _j, _len, _ref1, _results;
      best = [1, items];
      bestValue = Infinity;
      bestExact = [1, items];
      bestExactValue = Infinity;
      factors = (function() {
        _results = [];
        for (var _i = 1, _ref1 = Math.ceil(Math.sqrt(items)); 1 <= _ref1 ? _i <= _ref1 : _i >= _ref1; 1 <= _ref1 ? _i++ : _i--){ _results.push(_i); }
        return _results;
      }).apply(this);
      for (_j = 0, _len = factors.length; _j < _len; _j++) {
        f = factors[_j];
        computedSize = Math.max(width / f, height / (items / f));
        if (width < height) {
          w = f;
          h = Math.ceil(items / f);
        } else {
          h = f;
          w = Math.ceil(items / f);
        }
        wSize = width / w;
        hSize = height / h;
        if (iconRatio * wSize * h < height) {
          wSize = width / w;
          hSize = wSize * iconRatio;
        } else {
          hSize = height / h;
          wSize = hSize / iconRatio;
        }
        dSize = width * height - w * h * wSize * hSize;
        if (items % f === 0) {
          if (bestExactValue > dSize) {
            bestExactValue = dSize;
            bestExact = [w, h];
          }
        } else {
          if (bestValue > dSize) {
            bestValue = dSize;
            best = [w, h];
          }
        }
      }
      if (bestExactValue < bestValue) {
        actualBest = bestExact;
      } else {
        actualBest = best;
      }
      if ((width / actualBest[0]) * iconRatio < height / actualBest[1]) {
        size = [width / actualBest[0], (width / actualBest[0]) * iconRatio];
      } else {
        size = [(height / actualBest[1]) / iconRatio, height / actualBest[1]];
      }
      return {
        size: size,
        cols: actualBest[0],
        rows: actualBest[1]
      };
    };

    return PictoGramView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.MatrixChartView = (function(_super) {
    __extends(MatrixChartView, _super);

    function MatrixChartView() {
      this.outItem = __bind(this.outItem, this);
      this.overItem = __bind(this.overItem, this);
      this.updateItems = __bind(this.updateItems, this);
      this.centerGraph = __bind(this.centerGraph, this);
      this.calculateYAxisArea = __bind(this.calculateYAxisArea, this);
      this.makeYAxis = __bind(this.makeYAxis, this);
      this.makeXAxis = __bind(this.makeXAxis, this);
      this.updateAxis = __bind(this.updateAxis, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      _ref = MatrixChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    MatrixChartView.prototype.template = JST['app/scripts/templates/visualizers/lineChart.hbs'];

    MatrixChartView.prototype.xAxisType = "bands";

    MatrixChartView.prototype.yAxisType = "bands";

    MatrixChartView.prototype.followMouse = true;

    MatrixChartView.prototype.mainColorDimension = "fillColors";

    MatrixChartView.prototype.stylableTexts = [".tick"];

    MatrixChartView.prototype.margin = 10;

    MatrixChartView.prototype.setIdsAndValues = function() {
      var allIds, allValues, i, j, newValue, v, w, xids, yids, _i, _j, _len, _len1, _ref1, _ref2;
      allValues = [];
      allIds = [];
      xids = [];
      yids = [];
      if (!this.values) {
        return;
      }
      _ref1 = this.values;
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        v = _ref1[i];
        yids.push(v.id);
        _ref2 = v.value;
        for (j = _j = 0, _len1 = _ref2.length; _j < _len1; j = ++_j) {
          w = _ref2[j];
          newValue = _.clone(w);
          newValue.rowId = v.id;
          newValue.colId = w.id;
          if (i === 0) {
            xids.push(w.id);
          }
          newValue.id = "[" + v.id + "," + w.id + "]";
          newValue.name = v.id + ", " + w.id;
          allValues.push(newValue);
          allIds.push(newValue.id);
        }
      }
      this.axisIds = {
        x: xids,
        y: yids
      };
      this.allValues = allValues;
      this.idsItems = allIds;
      this.model.original._ids = this.idsItems;
      return this.model.original._values = this.allValues;
    };

    MatrixChartView.prototype.viewDidRender = function() {
      this.root = this.behaviors.svg.root.append("g").attr("class", "matrix");
      this.graph = this.root.append("g").attr("class", "graph");
      this.xAxisEl = this.root.append("g").attr("class", "x-axis");
      return this.yAxisEl = this.root.append("g").attr("class", "y-axis");
    };

    MatrixChartView.prototype.visualizerWillExecBehaviors1 = function() {
      return this.updateAxis();
    };

    MatrixChartView.prototype.visualizerWillUpdateItems = function() {
      this.behaviors.tooltip.baseObjects = "allValues";
      return this.updateAxis();
    };

    MatrixChartView.prototype.visualizerDidUpdateItems = function() {
      var color, rgb;
      if (this.model.get("valueFills").indexOf("linear-gradient") >= 0) {
        this.model.get("fillColors")[0] = this.allValues;
        this.model.get("fillColors")[1] = this.model.get("valueFills");
      } else {
        this.model.get("fillColors")[0] = this.allValues;
        color = d3.rgb(this.model.get("valueFills"));
        rgb = "rgb(" + color.r + "," + color.g + "," + color.b + ")";
        this.model.get("fillColors")[1] = "linear-gradient(90deg, " + rgb + "," + rgb + " 100%)";
      }
      return this.behaviors.selection.behaviors.items.updateConfig({});
    };

    MatrixChartView.prototype.updateAxis = function() {
      var height, left, max, maxValue, min, minValue, rangeX, rangeY, top, width;
      width = this.behaviors.svg.size.width - 2 * this.margin;
      height = this.behaviors.svg.size.height - 2 * this.margin;
      rangeX = [0, width];
      rangeY = [0, height];
      this.xScale = d3.scale.ordinal();
      this.xScale.domain(this.axisIds.x).rangeBands(rangeX);
      this.yScale = d3.scale.ordinal();
      this.yScale.domain(this.axisIds.y).rangeBands([0, this.xScale.rangeBand() * this.axisIds.y.length]);
      this.xScale.rangeBand(Math.ceil(this.xScale.rangeBand()));
      this.yScale.rangeBand(Math.ceil(this.yScale.rangeBand()));
      this.xAxisEl.call(this.makeXAxis());
      this.yAxisEl.call(this.makeYAxis());
      this.xAxisEl.selectAll(".tick").selectAll("text").style("text-anchor", "start").attr("y", "-5").attr("x", "5").attr("transform", "rotate(-45 0 0)");
      left = this.calculateYAxisArea();
      top = this.calculateXAxisArea();
      if (this.model.get("showLabels") !== "true") {
        left = 0;
        top = 0;
        this.xAxisEl.style("display", "none");
        this.yAxisEl.style("display", "none");
      } else {
        this.xAxisEl.style("display", "block");
        this.yAxisEl.style("display", "block");
      }
      rangeX = [0, width - left];
      rangeY = [0, height - top];
      if (rangeX[1] / this.axisIds.x.length < rangeY[1] / this.axisIds.y.length) {
        this.xScale.rangeBands(rangeX);
        this.yScale.rangeBands([0, this.xScale.rangeBand() * this.axisIds.y.length]);
      } else {
        this.yScale.rangeBands(rangeY);
        this.xScale.rangeBands([0, this.yScale.rangeBand() * this.axisIds.x.length]);
      }
      this.xAxisEl.call(this.makeXAxis());
      this.yAxisEl.call(this.makeYAxis());
      this.xAxisEl.selectAll(".tick").selectAll("text").style("text-anchor", "start").attr("y", "-5").attr("x", "5").attr("transform", "rotate(-45 0 0)");
      this.xAxisEl.selectAll(".tick").each(function(d, i) {
        return d3.select(this).attr("data-id", d);
      });
      this.yAxisEl.selectAll(".tick").each(function(d, i) {
        return d3.select(this).attr("data-id", d);
      });
      this.graph.attr("transform", "translate(" + left + "," + top + ")");
      this.yAxisEl.attr("transform", "translate(" + left + "," + top + ")");
      this.xAxisEl.attr("transform", "translate(" + left + "," + top + ")");
      this.radiusScale = d3.scale.sqrt();
      minValue = d3.min(this.allValues, function(d) {
        return Math.abs(d.value);
      });
      maxValue = d3.max(this.allValues, function(d) {
        return Math.abs(d.value);
      });
      this.radiusScale.domain([minValue, maxValue]);
      if (this.model.get("cellSize") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        min = parseFloat(this.model.get("cellSize")[0]) || this.xScale.rangeBand() / 20;
        max = parseFloat(this.model.get("cellSize")[1]) || this.xScale.rangeBand() / 2;
      } else {
        min = max = this.xScale.rangeBand() / 2;
      }
      this.radiusScale.range([min, max]);
      return this.totalSize = {
        width: left + this.xScale.rangeBand() * this.axisIds.x.length,
        height: top + this.yScale.rangeBand() * this.axisIds.y.length
      };
    };

    MatrixChartView.prototype.makeXAxis = function() {
      return d3.svg.axis().scale(this.xScale).orient("top");
    };

    MatrixChartView.prototype.makeYAxis = function() {
      return d3.svg.axis().scale(this.yScale).orient("left");
    };

    MatrixChartView.prototype.calculateYAxisArea = function() {
      return this.yAxisEl.node().getBBox().width;
      /*
      @maxYTextWidth = maxYTextWidth = 0
      yAxisTick = @yAxisEl.selectAll('.tick')[0]
      
      if yAxisTick.length > 0
        maxYTextWidth = yAxisTick[0].getBBox().width
        @yAxisEl.selectAll(".tick").each(() ->
          maxYTextWidth = Math.max(maxYTextWidth,this.getBBox().width)
        )
        @maxYTextWidth = parseInt(maxYTextWidth)
      
      yAxisLabelHeight = if @yAxisLabel? && @yAxisLabel.text().length>0 then @yAxisLabel[0][0].getBBox().height + @yAxisLabelPadding else 0
      
      @maxYTextWidth # + @size.margin.left + yAxisLabelHeight
      */

    };

    MatrixChartView.prototype.calculateXAxisArea = function() {
      return this.xAxisEl.node().getBBox().height;
      /*
      @maxTextHeight = maxTextHeight = 0
      # see if exists any .tick
      xAxisTick = @xAxisEl.selectAll('.tick')[0]
      
      if xAxisTick.length > 0
        # get the first .tick height
        maxTextHeight = xAxisTick[0].getBBox().height
      
        @xAxisEl.selectAll(".tick").each(() ->
          maxTextHeight = Math.max(maxTextHeight,this.getBBox().height)
        )
        @maxTextHeight = parseInt(maxTextHeight)
      
      xAxisLabelHeight = if @xAxisLabel? && @xAxisLabel.text().length>0 then @xAxisLabel[0][0].getBBox().height + @xAxisLabelPadding else 0
      
      @maxTextHeight #+ @size.margin.bottom + xAxisLabelHeight
      */

    };

    MatrixChartView.prototype.centerGraph = function() {
      var dx, dy;
      dx = (this.behaviors.svg.size.width - this.totalSize.width) / 2;
      dy = (this.behaviors.svg.size.height - this.totalSize.height) / 2;
      return this.root.attr("transform", "translate(" + dx + "," + dy + ")");
    };

    MatrixChartView.prototype.updateItems = function() {
      var currentShapes, self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      this.items = this.graph.selectAll(".item").data(this.allValues, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("rect").attr("class", "matrix-rect").attr("shape-rendering", "crispEdges").on("mouseover", this.overItem).on("mouseout", this.outItem);
      this.itemsEnter.append("circle").attr("class", "matrix-circle").on("mouseover", this.overItem).on("mouseout", this.outItem);
      if (this.model.get("cellShape") === "square") {
        this.items.select(".matrix-circle").style("display", "none");
        this.items.select(".matrix-rect").style("display", "block");
        currentShapes = this.items.select(".matrix-rect");
      } else {
        this.items.select(".matrix-rect").style("display", "none");
        this.items.select(".matrix-circle").style("display", "block");
        currentShapes = this.items.select(".matrix-circle");
      }
      this.items.exit().remove();
      size = this.idsItems.length;
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = currentShapes.transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = currentShapes;
      }
      self = this;
      updateD3Object.attr("x", function(d) {
        var w;
        if (!isNaN(_this.radiusScale(d.value))) {
          w = 2 * _this.radiusScale(d.value);
        } else {
          w = 0;
        }
        return _this.xScale(d.colId) + _this.xScale.rangeBand() / 2 - w / 2;
      }).attr("y", function(d) {
        var w;
        if (!isNaN(_this.radiusScale(d.value))) {
          w = 2 * _this.radiusScale(d.value);
        } else {
          w = 0;
        }
        return _this.yScale(d.rowId) + _this.xScale.rangeBand() / 2 - w / 2;
      }).attr("cx", function(d) {
        return _this.xScale(d.colId) + _this.xScale.rangeBand() / 2;
      }).attr("cy", function(d) {
        return _this.yScale(d.rowId) + _this.yScale.rangeBand() / 2;
      }).attr("width", function(d) {
        if (!isNaN(_this.radiusScale(d.value))) {
          return 2 * _this.radiusScale(d.value);
        } else {
          return 0;
        }
      }).attr("height", function(d) {
        if (!isNaN(_this.radiusScale(d.value))) {
          return 2 * _this.radiusScale(d.value);
        } else {
          return 0;
        }
      }).attr("r", function(d) {
        if (!isNaN(_this.radiusScale(d.value))) {
          return _this.radiusScale(d.value);
        } else {
          return 0;
        }
      });
      return this.centerGraph();
    };

    MatrixChartView.prototype.overItem = function(d, i) {
      this.xAxisEl.selectAll("[data-id='" + d.colId + "']").attr("font-weight", "bold");
      return this.yAxisEl.selectAll("[data-id='" + d.rowId + "']").attr("font-weight", "bold");
    };

    MatrixChartView.prototype.outItem = function(d, i) {
      this.xAxisEl.selectAll(".tick").attr("font-weight", "normal");
      return this.yAxisEl.selectAll(".tick").attr("font-weight", "normal");
    };

    return MatrixChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ParalelCoordsView = (function(_super) {
    __extends(ParalelCoordsView, _super);

    function ParalelCoordsView() {
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.createLineFunction = __bind(this.createLineFunction, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      _ref = ParalelCoordsView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ParalelCoordsView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    ParalelCoordsView.prototype.xAxisType = "auto";

    ParalelCoordsView.prototype.yAxisType = "linear";

    ParalelCoordsView.prototype.yAxisPadding = true;

    ParalelCoordsView.prototype.xAxisPadding = false;

    ParalelCoordsView.prototype.followMouse = true;

    ParalelCoordsView.prototype.mainColorDimension = "lineColors";

    ParalelCoordsView.prototype.getXDomainValues = function() {
      return this.behaviors.dataController.getXDomainValues();
    };

    ParalelCoordsView.prototype.getYDomainValues = function(dimensionId) {
      var result;
      if ((dimensionId == null) || this.model.get("uniformAxes") === "true") {
        return this.calculateNumberDomain(this.values, false, "value");
      } else {
        result = d3.extent(this.values, function(line) {
          var found;
          found = _.findWhere(line.value, {
            id: dimensionId
          });
          if (found != null) {
            return +found.value;
          } else {
            return null;
          }
        });
        return result;
      }
    };

    ParalelCoordsView.prototype.setIdsAndValues = function() {
      this.model.original._ids = this.idsItems;
      return this.model.original._values = this.values;
    };

    ParalelCoordsView.prototype.checkAxisChanged = function() {
      return this.model.changed["dimensionAsItems"] != null;
    };

    ParalelCoordsView.prototype.visualizerWillExecBehaviors1 = function() {
      return this.dimensions = this.behaviors.dataController.getXDomainValues();
    };

    ParalelCoordsView.prototype.createLineFunction = function() {
      var _this = this;
      return this.lineFunction = d3.svg.line().x(function(d, i) {
        return _this.behaviors.axis.xScale(d.id);
      }).y(function(d, i) {
        return _this.behaviors.axis.yScales[d.id](d.value);
      }).defined(function(d, i) {
        return !isNaN(d.value);
      });
    };

    ParalelCoordsView.prototype.visualizerWillUpdateItems = function() {
      var tension;
      switch (this.model.get("interpolation")) {
        case "Smooth":
          this.lineInterpolation = "basis";
          break;
        case "Steps":
          this.lineInterpolation = "step";
          break;
        default:
          this.lineInterpolation = "cardinal";
      }
      if (this.displayBreakpoints) {
        tension = 1;
      } else {
        tension = 0.9;
      }
      if (this.lineFunction == null) {
        this.createLineFunction();
      }
      return this.lineFunction.interpolate(this.lineInterpolation).tension(tension);
    };

    ParalelCoordsView.prototype.updateItems = function() {
      var self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      self = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        if (self.values.length === 1 && self.__LastValuesLength === 1) {
          return "__onlyOne__";
        } else {
          return d.id;
        }
      });
      this.__LastValuesLength = this.values.length;
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("path").attr("class", "line-path").attr("fill", "none").attr("pointer-events", "stroke");
      this.itemsEnter.append("path").attr("class", "hit-area-path dont-render").attr("fill", "none").attr("pointer-events", "stroke").attr("stroke", "rgba(255,0,0,0)").attr("stroke-width", "5px");
      this.items.exit().remove();
      size = this.ids.length * this.idsItems.length;
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.items.select(".line-path").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.items.select(".line-path");
      }
      self = this;
      updateD3Object.attr("d", function(d) {
        return self.lineFunction(d.value);
      });
      this.items.select(".hit-area-path").attr("d", function(d) {
        return self.lineFunction(d.value);
      });
      this.ghostItems = this.behaviors.axis.graph.selectAll(".ghost-item").data(this.values, function(d, i) {
        if (self.values.length === 1 && self.__LastValuesLength === 1) {
          return "__onlyOne__";
        } else {
          return d.id;
        }
      });
      this.ghostItemsEnter = this.ghostItems.enter().insert("g", ".item").attr("class", "ghost-item");
      this.ghostItemsEnter.append("path").attr("class", "line-path").attr("fill", "none").attr("pointer-events", "none").attr("stroke", "#ddd").attr("stroke-width", "1px");
      this.ghostItems.exit().remove();
      size = this.ids.length * this.idsItems.length;
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.ghostItems.select(".line-path").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.ghostItems.select(".line-path");
      }
      self = this;
      return updateD3Object.attr("d", function(d) {
        return self.lineFunction(d.value);
      });
    };

    ParalelCoordsView.prototype.visualizerDidUpdateItems = function() {};

    return ParalelCoordsView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ChoroplethView = (function(_super) {
    __extends(ChoroplethView, _super);

    function ChoroplethView() {
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.drawSvg = __bind(this.drawSvg, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this._updateContent = __bind(this._updateContent, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      _ref = ChoroplethView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ChoroplethView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    ChoroplethView.prototype.followMouse = true;

    ChoroplethView.prototype.setIdsAndValues = function() {
      this.model.original._ids = this.idsItems;
      return this.model.original._values = this.values;
    };

    ChoroplethView.prototype._updateContent = function() {
      var _this = this;
      if (!this.graph) {
        this.graph = this.behaviors.svg.root.append("g").attr("class", "graph");
      }
      return this.behaviors.dataController.loadSVG(function() {
        var o, svgIds, _i, _len, _ref1;
        svgIds = [];
        _ref1 = _this.behaviors.dataController.itemsSource;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          o = _ref1[_i];
          svgIds.push(o.id);
        }
        _this.model.original.svgIds = svgIds;
        return ChoroplethView.__super__._updateContent.apply(_this, arguments);
      });
    };

    ChoroplethView.prototype.visualizerWillUpdateItems = function() {
      if (!this.svgDrawn) {
        this.drawSvg();
        this.svgDrawn = true;
      }
      if (this.model.changed["fillColors"] != null) {
        return this.changedData = true;
      }
    };

    ChoroplethView.prototype.drawSvg = function() {
      var DOMElementBBox;
      $(this.graph.node()).html("");
      $(this.graph.node()).append(this.$svgData.children());
      DOMElementBBox = this.graph.node().getBBox();
      this.originalSize = [DOMElementBBox.width, DOMElementBBox.height];
      return this.originalPos = [DOMElementBBox.x, DOMElementBBox.y];
    };

    ChoroplethView.prototype.updateItems = function() {
      var height, margin, scale, self, translateX, translateY, width,
        _this = this;
      self = this;
      if (this.changedData) {
        _.each(this.values, function(d, i) {
          var object;
          object = _.findWhere(_this.model.get("fillColors")[0], {
            "id": d.id
          });
          if ((object != null) && object.value) {
            return d.value = object.value;
          }
        });
      }
      margin = 5;
      width = this.behaviors.svg.size.width - 2 * margin;
      height = this.behaviors.svg.size.height - 2 * margin;
      scale = Math.min(width / this.originalSize[0], height / this.originalSize[1]);
      translateX = -this.originalPos[0] * scale + (width - this.originalSize[0] * scale) / 2 + margin;
      translateY = -this.originalPos[1] * scale + (height - this.originalSize[1] * scale) / 2 + margin;
      this.graph.attr("transform", "translate(" + translateX + "," + translateY + ") scale(" + scale + ")");
      self = this;
      this.items = this.behaviors.svg.root.selectAll('.item').each(function(d, i) {
        var datum, item;
        item = d3.select(this);
        datum = _.findWhere(self.values, {
          id: this.id
        });
        item.datum(datum);
        return item.selectAll("path,polygon").attr("vector-effect", "non-scaling-stroke");
      });
    };

    ChoroplethView.prototype.visualizerDidUpdateItems = function() {};

    return ChoroplethView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.Dialog = (function(_super) {
    __extends(Dialog, _super);

    function Dialog() {
      this.close = __bind(this.close, this);
      this.refresh = __bind(this.refresh, this);
      this._createDialog = __bind(this._createDialog, this);
      this._showDialog = __bind(this._showDialog, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      this.init = __bind(this.init, this);
      _ref = Dialog.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Dialog.prototype.title = "Dialog";

    Dialog.prototype.iconClass = "no-icon";

    Dialog.prototype.resizable = false;

    Dialog.prototype.appendToSelector = ".front-container";

    Dialog.prototype.width = 940;

    Dialog.prototype.height = 400;

    Dialog.prototype.maxHeight = 560;

    Dialog.prototype.init = function(options) {
      this.options = options;
      return Dialog.__super__.init.call(this);
    };

    Dialog.prototype.viewWillRender = function() {
      var _this = this;
      return this.buttons = {
        "Ok": function() {
          return _this.close();
        }
      };
    };

    Dialog.prototype._finishRender = function() {
      this._createDialog();
      this.$el.closest(".ui-dialog").find(".ui-dialog-titlebar").append("<div class='title-container'></div>");
      this.$el.closest(".ui-dialog").find(".title-container").append("<div class='dialog-icon " + this.iconClass + "'></div>");
      this.$el.closest(".ui-dialog").find(".title-container").append(this.$el.closest(".ui-dialog").find(".ui-dialog-titlebar .ui-dialog-title"));
      Dialog.__super__._finishRender.apply(this, arguments);
      this.$el.closest(".ui-dialog").css("opacity", "0");
      return _.defer(this._showDialog);
    };

    Dialog.prototype._showDialog = function() {
      var dialogCount;
      dialogCount = $(".stackable-dialog").length - 1;
      this.$el.dialog("option", "position", {
        my: "center",
        at: "center+" + 15 * dialogCount + " center+" + 15 * dialogCount,
        of: window
      });
      return this.$el.closest(".ui-dialog").animate({
        opacity: 1
      }, 300);
    };

    Dialog.prototype._createDialog = function() {
      var dialog;
      dialog = this.$el.find(".dialog").dialog({
        modal: true,
        autoOpen: true,
        appendTo: $(this.appendToSelector),
        resizable: this.resizable,
        maxHeight: this.maxHeight,
        width: this.width,
        buttons: this.buttons,
        title: this.title,
        close: this.close
      });
      this.$el = $(dialog);
      if (this.zindexClass != null) {
        this.$el.closest(".ui-dialog").addClass(this.zindexClass);
      }
      return this.$el.addClass("stackable-dialog");
    };

    /*
    open:()=>
      log "Dialog:open"
      @$el.dialog("open")
    */


    Dialog.prototype.refresh = function() {
      return this.$el.dialog("option", "position", {
        my: "center",
        at: "center",
        of: window
      });
    };

    Dialog.prototype.close = function() {
      this.$el.dialog("destroy").remove();
      return this.remove();
    };

    return Dialog;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.AskusDialog = (function(_super) {
    __extends(AskusDialog, _super);

    function AskusDialog() {
      this.saveClicked = __bind(this.saveClicked, this);
      this.closeHandler = __bind(this.closeHandler, this);
      this.feedbackClicked = __bind(this.feedbackClicked, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = AskusDialog.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    AskusDialog.prototype.title = "Ask us...";

    AskusDialog.prototype.template = JST['app/scripts/templates/UI/dialogs/helpAskusPopup.hbs'];

    AskusDialog.prototype.width = 600;

    AskusDialog.prototype.viewWillRender = function() {
      var _this = this;
      return this.buttons = {
        "Ok": {
          click: function() {
            _this.saveClicked();
            return _this.close();
          },
          text: 'Send',
          "class": 'ok-button'
        }
      };
    };

    AskusDialog.prototype.viewDidRender = function() {
      this.$el.find(".close").on("click", this.closeHandler);
      this.$el.find(".mail-content").focus();
      return this.$el.find(".feedback-button").on("click", this.feedbackClicked);
    };

    AskusDialog.prototype.viewWillRemove = function() {
      return this.$el.find(".feedback-button").off("click");
    };

    AskusDialog.prototype.feedbackClicked = function(e) {
      return window.open("http://goo.gl/forms/G8kSgptyNj", "_blank");
    };

    AskusDialog.prototype.closeHandler = function() {
      return this.remove();
    };

    AskusDialog.prototype.saveClicked = function() {
      log("should send", this.$el.find(".mail-content").val());
      return $.ajax({
        type: "POST",
        url: quadrigram.baseUrl + "rs/user/question",
        data: JSON.stringify({
          message: this.$el.find(".mail-content").val()
        }),
        contentType: "application/json"
      });
    };

    return AskusDialog;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.TosDialog = (function(_super) {
    __extends(TosDialog, _super);

    function TosDialog() {
      this.saveClicked = __bind(this.saveClicked, this);
      this.closeHandler = __bind(this.closeHandler, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = TosDialog.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TosDialog.prototype.title = "Terms of service";

    TosDialog.prototype.template = JST['app/scripts/templates/UI/dialogs/tosDialog.hbs'];

    TosDialog.prototype.width = 600;

    TosDialog.prototype.appendToSelector = "body";

    TosDialog.prototype.viewWillRender = function() {
      var _this = this;
      return this.buttons = {
        "Ok": {
          click: function() {
            _this.saveClicked();
            return _this.close();
          },
          text: 'Accept',
          "class": 'ok-button'
        }
      };
    };

    TosDialog.prototype.viewDidRender = function() {
      this.$el.find(".close").on("click", this.closeHandler);
      this.$el.find(".mail-content").focus();
      this.$el.parent().parent().find(".ui-widget-overlay").css("z-index", 9999);
      this.$el.parent().css("z-index", 10000);
      return this.$el.parent().find(".ui-dialog-titlebar-close").css("display", "none");
    };

    TosDialog.prototype.viewWillRemove = function() {
      return this.$el.find(".feedback-button").off("click");
    };

    TosDialog.prototype.closeHandler = function() {
      return this.remove();
    };

    TosDialog.prototype.saveClicked = function() {
      log("should send tos to true");
      return quadrigram.router.managers.serverManager.acceptTos();
    };

    return TosDialog;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.dataTypeOptions = (function(_super) {
    __extends(dataTypeOptions, _super);

    function dataTypeOptions() {
      this.handleOptionChange = __bind(this.handleOptionChange, this);
      this.handleDataTypeChange = __bind(this.handleDataTypeChange, this);
      this.renderSubOptions = __bind(this.renderSubOptions, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = dataTypeOptions.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    dataTypeOptions.prototype.template = JST['app/scripts/templates/UI/dialogs/BlockPreview/dataTypeOptionsTemplate.hbs'];

    dataTypeOptions.prototype.className = "data-type-options-container";

    dataTypeOptions.prototype.viewDidRender = function() {
      /*
      @$el.find(".data-type-selector-container select").append("<option value='dataTable'> Data Table </option>")
      if @parentGroup.dataTypeOptions.network?
        @$el.find(".data-type-selector-container select").append("<option value='network'> Network </option>")
      
      @currentDataType = @parentGroup.get("buildData").dataType
      @$el.find(".data-type-selector-container select").val(@currentDataType)
      @$el.find(".data-type-selector-container select").selectmenu(
          width: 100
          change: @handleDataTypeChange
        )
      */

      var _this = this;
      this.$el.find(".learn-more-link").on("click", function() {
        return window.open(quadrigram.webUrl + "#content/networks", "_blank");
      });
      this.currentDataType = this.parentGroup.get("buildData").dataType;
      if (this.parentGroup.dataTypeOptions.network != null) {
        this.$el.find(".is-network-checkbox-container").removeClass("hidden");
        if (this.currentDataType === "network") {
          this.$el.find(".checkbox-input").attr("checked", "checked");
        }
        if (this.parentGroup.dataTypeOptions.network.pairsTable != null) {
          this.$el.find(".detected-format").html("pairs table");
        }
        if (this.parentGroup.dataTypeOptions.network.adjMatrix != null) {
          this.$el.find(".detected-format").html("adjacencies matrix");
        }
        this.$el.find(".checkbox-input").on("change", this.handleDataTypeChange);
      } else {
        this.$el.find(".data-type-selector-container").addClass("hidden");
      }
      return this.renderSubOptions();
    };

    dataTypeOptions.prototype.renderSubOptions = function() {
      if (this.currentOptions != null) {
        this.currentOptions.remove();
      }
      if (this.currentDataType === "dataTable") {
        this.currentOptions = new quadrigram.Views.dataTableOptions({
          model: this.model,
          binding: false
        });
        this.currentOptions.parentGroup = this.parentGroup;
        this.currentOptions.render();
        this.currentOptions.on("change:option", this.handleOptionChange);
        this.$el.find(".specific-options-container").append(this.currentOptions.$el);
        return this.$el.find(".specific-options-container").removeClass("hidden");
      }
      /*
      else if @currentDataType == "network"
        @currentOptions = new quadrigram.Views.networkOptions model: @model, binding: false
        @currentOptions.parentGroup = @parentGroup
        
        #if @parentGroup.get("buildData").networkFormat?
        #  @currentOptions.networkFormat = @parentGroup.get("buildData").networkFormat
        @currentOptions.render()
      */

    };

    dataTypeOptions.prototype.handleDataTypeChange = function() {
      /*
      selectEl = @$el.find(".data-type-selector-container select")[0]
      @parentGroup.get("buildData").dataType = selectEl.options[selectEl.selectedIndex].value
      
      @currentDataType = selectEl.options[selectEl.selectedIndex].value
      @renderSubOptions()
      */

      var checkboxEl;
      checkboxEl = this.$el.find(".checkbox-input");
      if (checkboxEl.is(":checked")) {
        this.currentDataType = "network";
      } else {
        this.currentDataType = "dataTable";
      }
      this.renderSubOptions();
      return this.trigger("change:option");
    };

    dataTypeOptions.prototype.handleOptionChange = function() {
      return this.trigger("change:option");
    };

    return dataTypeOptions;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.dataTableOptions = (function(_super) {
    __extends(dataTableOptions, _super);

    function dataTableOptions() {
      this.getIdKey = __bind(this.getIdKey, this);
      this.changeIdKey = __bind(this.changeIdKey, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = dataTableOptions.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    dataTableOptions.prototype.template = JST['app/scripts/templates/UI/dialogs/BlockPreview/dataTableOptionsTemplate.hbs'];

    dataTableOptions.prototype.className = "data-table-options-container";

    dataTableOptions.prototype.viewDidRender = function() {
      var idSelector, key, _i, _len, _ref1;
      if (this.$el.find(".table-viewer-header-id-selector").length === 0) {
        idSelector = $("<div class='table-viewer-header-id-selector table-viewer-cell'><select class='id-selector' name='id-selector'></select></div>");
        _ref1 = this.parentGroup.keys;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          key = _ref1[_i];
          idSelector.find("select").append($("<option value='" + key + "'>" + key + "</option>"));
        }
        idSelector.find("select").append($("<option value='__Index__'> Indexes </option>"));
        idSelector.find("select").val(this.parentGroup.get("buildData").idKey);
        this.$el.find(".id-selector-container").append(idSelector);
        return idSelector.find("select").selectmenu({
          width: 100,
          change: this.changeIdKey
        });
      }
    };

    dataTableOptions.prototype.changeIdKey = function() {
      this.model.dismissedAggregate = false;
      this.trigger("change:option");
      return quadrigram.achievementTracker.trackDirectAction("changeId");
    };

    dataTableOptions.prototype.getIdKey = function() {
      var idSelectorEl;
      idSelectorEl = this.$el.find(".id-selector")[0];
      return idSelectorEl.options[idSelectorEl.selectedIndex].value;
    };

    return dataTableOptions;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.networkOptions = (function(_super) {
    __extends(networkOptions, _super);

    function networkOptions() {
      this.getFormat = __bind(this.getFormat, this);
      this.changeFormat = __bind(this.changeFormat, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = networkOptions.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    networkOptions.prototype.template = JST['app/scripts/templates/UI/dialogs/BlockPreview/networkOptionsTemplate.hbs'];

    networkOptions.prototype.className = "network-options";

    networkOptions.prototype.viewDidRender = function() {
      var formatSelector;
      this.$el.find("select").append("<option value='pairsTable'>Pairs table</option>");
      if ((this.parentGroup.dataTypeOptions.network != null) && (this.parentGroup.dataTypeOptions.network.adjMatrix != null)) {
        this.$el.find("select").append("<option value='adjMatrix'>Adjacency matrix</option>");
      }
      if (this.parentGroup.get("buildData").networkFormat) {
        this.$el.find("select").find("option[value='" + this.parentGroup.get("buildData").networkFormat + "']").prop("selected", true);
      }
      this.$el.find("select").selectmenu({
        width: 100,
        change: this.changeFormat
      });
      formatSelector = this.$el.find(".format-selector")[0];
      this.$el.find(".learn-more-link").addClass("hidden");
      return this.$el.find(".learn-more-link").on("click", function() {
        return window.open(quadrigram.webUrl + "help/#content/networks", "_blank");
      });
    };

    networkOptions.prototype.changeFormat = function() {
      return this.trigger("change:option");
    };

    networkOptions.prototype.getFormat = function() {
      var formatSelector;
      formatSelector = this.$el.find(".format-selector")[0];
      return formatSelector.options[formatSelector.selectedIndex].value;
    };

    return networkOptions;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.BlockPreviewView = (function(_super) {
    __extends(BlockPreviewView, _super);

    function BlockPreviewView() {
      this.blockNameChanged = __bind(this.blockNameChanged, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = BlockPreviewView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BlockPreviewView.prototype.template = JST['app/scripts/templates/UI/dialogs/BlockPreview/BlockPreview.hbs'];

    BlockPreviewView.prototype.resizable = true;

    BlockPreviewView.prototype.height = 300;

    BlockPreviewView.prototype.maxHeight = 600;

    BlockPreviewView.prototype.width = 900;

    BlockPreviewView.prototype.title = "Block preview";

    BlockPreviewView.prototype.viewWillRender = function() {
      return this.title = this.model.get("label");
    };

    BlockPreviewView.prototype.viewDidRender = function() {
      var summary;
      this.$el.css("width", this.width);
      this.$el.css("height", this.height);
      this.tableView = new quadrigram.Views.TableView({
        model: this.model
      });
      this.tableView.render();
      if (this.model.get("blockGroup") instanceof quadrigram.Models.ExternalBlockGroupModel) {
        summary = "Extracted from " + this.model.get("blockGroup").get("label");
      } else if (this.model.get("blockGroup") instanceof quadrigram.Models.VizBlockGroupModel) {
        summary = "Output from " + this.model.get("blockGroup").get("ownerViz").get("blockGroup").get("label");
      } else if (this.model.get("blockGroup") instanceof quadrigram.Models.CustomBlockGroupModel) {
        summary = "Result from " + this.model.get("blockGroup").get("label");
      } else {
        summary = "";
      }
      this.$el.parent().find(".title-container").append("<div class='block-summary'>" + summary + "</div>");
      return this.$el.find(".preview-container").append(this.tableView.$el);
    };

    BlockPreviewView.prototype.viewWillRemove = function() {
      return this.tableView.remove();
    };

    BlockPreviewView.prototype.blockNameChanged = function(e, params) {
      return this.model.set("label", params.newValue);
    };

    return BlockPreviewView;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockFunctionView = (function(_super) {
    __extends(DataBlockFunctionView, _super);

    function DataBlockFunctionView() {
      this.expressionMoveRight = __bind(this.expressionMoveRight, this);
      this.expressionMoveLeft = __bind(this.expressionMoveLeft, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.renderOperator = __bind(this.renderOperator, this);
      this.expressionChanged = __bind(this.expressionChanged, this);
      this.operationChanged = __bind(this.operationChanged, this);
      this.updateContainment = __bind(this.updateContainment, this);
      this.onDrag = __bind(this.onDrag, this);
      this.onResize = __bind(this.onResize, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = DataBlockFunctionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockFunctionView.prototype.template = JST['app/scripts/templates/blocks/dataBlockFunction.hbs'];

    DataBlockFunctionView.prototype.className = "function-mega-slot";

    DataBlockFunctionView.prototype.events = {
      "click .scroll-left": "expressionMoveLeft",
      "click .scroll-right": "expressionMoveRight"
    };

    DataBlockFunctionView.prototype.viewWillRender = function() {
      var _this = this;
      return Handlebars.registerHelper('if_eq', function(a, b, options) {
        if (a === b) {
          return options.fn(_this);
        } else {
          return options.inverse(_this);
        }
      });
    };

    DataBlockFunctionView.prototype.viewDidRender = function() {
      this.model.get("operator").on("change:currentExpression", this.expressionChanged);
      this.model.get("operator").on("change:currentOperation", this.operationChanged);
      this.draggable = this.$(".expression-container").draggable({
        axis: "x",
        drag: this.onDrag
      });
      this.renderOperator();
      this.updateContainment();
      return $(window).on("resize", this.onResize);
    };

    DataBlockFunctionView.prototype.onResize = function() {
      return this.updateContainment();
    };

    DataBlockFunctionView.prototype.onDrag = function() {
      return this.updateContainment();
    };

    DataBlockFunctionView.prototype.updateContainment = function() {
      var maxX, maxY, minX, minY,
        _this = this;
      maxX = 240;
      minX = 0;
      maxY = 0;
      minY = 0;
      return _.delay(function() {
        var currPos, expressionWidth, megaSlotWidth, part, _i, _len, _ref1;
        megaSlotWidth = $(".mega-slot-container").width();
        expressionWidth = 0;
        _ref1 = _this.$(".expression-collection").children();
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          part = _ref1[_i];
          expressionWidth += $(part).width();
        }
        if (expressionWidth >= megaSlotWidth + 15) {
          minX = maxX + megaSlotWidth - expressionWidth - 15;
          _this.$(".expression-container").draggable("option", "containment", [minX, minY, maxX, maxY]);
          _this.$(".expression-container").draggable("option", "disabled", false);
          _this.$(".expression-collection").addClass("show-drag");
          $('.scroll-right.scroller').css({
            left: megaSlotWidth - 15 + "px"
          });
          $(".mega-slot-container").find('.scroller').show();
          currPos = _this.$el.find(".expression-container").position();
          if (expressionWidth + currPos.left < megaSlotWidth + 15) {
            $(".mega-slot-container").find('.scroll-right').hide();
          }
          if (currPos.left >= 0) {
            return $(".mega-slot-container").find('.scroll-left').hide();
          }
        } else {
          _this.$(".expression-container").draggable("option", "disabled", true);
          _this.$(".expression-collection").removeClass("show-drag");
          $(".mega-slot-container").find('.scroller').hide();
          return $('.function-mega-slot').css({
            "padding-left": "0px"
          });
        }
      }, 100);
    };

    DataBlockFunctionView.prototype.operationChanged = function(e) {
      this.renderOperator();
      return this.expressionMoveLeft();
    };

    DataBlockFunctionView.prototype.expressionChanged = function(e) {
      var _this = this;
      $(".mega-slot-container").find('.scroller').css({
        display: "none"
      });
      this.updateContainment();
      return _.delay(function() {
        return _this.expressionMoveRight();
      }, 200);
    };

    DataBlockFunctionView.prototype.renderOperator = function() {
      var expressionCollection;
      this.$el.find(".expression-container").empty();
      expressionCollection = this.model.get("operator").get("currentExpression");
      if (this.expressionView) {
        this.expressionView.remove();
      }
      this.expressionView = new quadrigram.Views.ExpressionPartCollectionView({
        model: this.model,
        collection: expressionCollection,
        binding: true
      });
      this.expressionView.render();
      this.$(".expression-container").append(this.expressionView.$el);
      return log("rendered operator");
    };

    DataBlockFunctionView.prototype.viewWillRemove = function() {
      $(window).off("resize", this.onResize);
      this.model.get("operator").off("change:currentExpression", this.expressionChanged);
      this.model.get("operator").off("change:currentOperation", this.operationChanged);
      if (this.expressionView) {
        return this.expressionView.remove();
      }
    };

    DataBlockFunctionView.prototype.expressionMoveLeft = function() {
      var _this = this;
      return _.delay(function() {
        return _this.$el.find(".expression-container").animate({
          "left": Math.min(-240 + 15 + _this.$(".expression-container").draggable("option", "containment")[2], _this.$el.find(".expression-container").position().left + $(".mega-slot-container").width() * 0.8)
        }, 400, function() {
          return _this.updateContainment();
        });
      }, 50);
    };

    DataBlockFunctionView.prototype.expressionMoveRight = function(ev) {
      var _this = this;
      return _.delay(function() {
        if (_this.$(".expression-container").draggable("option", "disabled") === false) {
          return _this.$el.find(".expression-container").animate({
            "left": Math.max(-240 + 15 + _this.$(".expression-container").draggable("option", "containment")[0], _this.$el.find(".expression-container").position().left - $(".mega-slot-container").width() * 0.8)
          }, 400, function() {
            return _this.updateContainment();
          });
        }
      }, 50);
    };

    return DataBlockFunctionView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.BlockBuilderView = (function(_super) {
    __extends(BlockBuilderView, _super);

    function BlockBuilderView() {
      this.gotoSource = __bind(this.gotoSource, this);
      this.refreshSource = __bind(this.refreshSource, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.handleBlockStrcutre = __bind(this.handleBlockStrcutre, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.close = __bind(this.close, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = BlockBuilderView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    BlockBuilderView.prototype.template = JST['app/scripts/templates/UI/dialogs/blockBuilder.hbs'];

    BlockBuilderView.prototype.title = "Create blocks from the file";

    BlockBuilderView.prototype.resizable = true;

    BlockBuilderView.prototype.height = 420;

    BlockBuilderView.prototype.maxHeight = 600;

    BlockBuilderView.prototype.width = 900;

    BlockBuilderView.prototype.viewWillRender = function() {
      var _this = this;
      this.title = this.model.get("label");
      this.iconClass = "google-icon";
      return this.buttons = {
        "Ok": {
          click: function() {
            return _this.close();
          },
          text: 'OK',
          "class": 'ok-button'
        }
      };
    };

    BlockBuilderView.prototype.close = function() {
      quadrigram.router.appViews.uiView.toolbar.filesExplorer.blockGroupCollectionView.select(this.model);
      return BlockBuilderView.__super__.close.call(this);
    };

    BlockBuilderView.prototype.viewDidRender = function() {
      var builderModel;
      this.$el.css("width", this.width);
      this.$el.css("height", this.height);
      this.$el.closest(".ui-dialog").find(".title-container").append($("<div class='refresh-btn'>  </div>"));
      this.$el.closest(".ui-dialog").find(".refresh-btn").on("click", this.refreshSource);
      this.$el.closest(".ui-dialog").find(".refresh-btn").addClass("ui-tip-target");
      this.$el.closest(".ui-dialog").find(".refresh-btn").attr("data-ui-tip-id", "refresh-file");
      this.$el.closest(".ui-dialog").find(".ui-dialog-title").on("click", this.gotoSource);
      this.$el.closest(".ui-dialog").find(".ui-dialog-title").addClass("ui-tip-target");
      this.$el.closest(".ui-dialog").find(".ui-dialog-title").attr("data-ui-tip-id", "view-on-drive");
      this.$el.closest(".ui-dialog").find(".dialog-icon").on("click", this.gotoSource);
      this.$el.closest(".ui-dialog").find(".ui-dialog-title").addClass("clickable");
      if (this.model.invalidData) {
        builderModel = this.model.get("blocksCollection").where({
          "role": "empty"
        })[0];
      } else if (this.model.get("buildData").dataType === "dataTable") {
        builderModel = this.model.get("blocksCollection").where({
          "role": "all"
        })[0];
      } else {
        builderModel = this.model.get("blocksCollection").where({
          "role": "all-network"
        })[0];
      }
      this.model.on("change-block-structure", this.handleBlockStrcutre);
      this.tableView = new quadrigram.Views.TableView({
        model: builderModel
      });
      this.tableView.isBuilder = true;
      this.tableView.parentGroup = this.model;
      this.tableView.container = this;
      this.tableView.render();
      return this.$el.find(".table-container").append(this.tableView.$el);
    };

    BlockBuilderView.prototype.handleBlockStrcutre = function() {
      var builderModel;
      if (this.model.invalidData) {
        builderModel = this.model.get("blocksCollection").where({
          "role": "empty"
        })[0];
      } else if (this.model.get("buildData").dataType === "dataTable") {
        builderModel = this.model.get("blocksCollection").where({
          "role": "all"
        })[0];
      } else {
        builderModel = this.model.get("blocksCollection").where({
          "role": "all-network"
        })[0];
      }
      return this.tableView.model = builderModel;
    };

    BlockBuilderView.prototype.viewWillRemove = function() {
      this.tableView.remove();
      return this.model.off("change-block-structure", this.handleBlockStrcutre);
    };

    BlockBuilderView.prototype.refreshSource = function() {
      return this.model.requestData({
        useFullLoader: false
      });
    };

    BlockBuilderView.prototype.gotoSource = function() {
      return window.open(this.model.get("link"), "_blank");
    };

    return BlockBuilderView;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.TextAreaView = (function(_super) {
    __extends(TextAreaView, _super);

    function TextAreaView() {
      this.getScrollDomElement = __bind(this.getScrollDomElement, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateValue = __bind(this.updateValue, this);
      this.removeFakeSelection = __bind(this.removeFakeSelection, this);
      this.hideFakeSelection = __bind(this.hideFakeSelection, this);
      this.showFakeSelection = __bind(this.showFakeSelection, this);
      this.handleClick = __bind(this.handleClick, this);
      this.didResize = __bind(this.didResize, this);
      this._handleResize = __bind(this._handleResize, this);
      this.setMode = __bind(this.setMode, this);
      this.setSelected = __bind(this.setSelected, this);
      this.updatePaddings = __bind(this.updatePaddings, this);
      this.textChanged = __bind(this.textChanged, this);
      this.setHidden = __bind(this.setHidden, this);
      this.createQuillEditor = __bind(this.createQuillEditor, this);
      this.createFlatText = __bind(this.createFlatText, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = TextAreaView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TextAreaView.prototype.template = JST['app/scripts/templates/visualizers/textArea.hbs'];

    TextAreaView.prototype.viewWillRender = function() {
      this.values = [];
      this.ids = [];
      return this.quillEditorAttributes = {
        Title112: {
          quillText: "Enter a large title here",
          quillSize: "84px",
          quillAlign: "center",
          quillFont: "Roboto",
          quillStyle: "Thin",
          quillVAlign: "top"
        },
        Title56: {
          quillText: "Enter a medium title here",
          quillSize: "56px",
          quillAlign: "center",
          quillFont: "Roboto",
          quillStyle: "Regular",
          quillVAlign: "middle"
        },
        Title45: {
          quillText: "Enter an small title here",
          quillSize: "45px",
          quillAlign: "center",
          quillFont: "Roboto",
          quillStyle: "Light",
          quillVAlign: "top"
        },
        Subtitle36: {
          quillText: "Enter a large subtitle here",
          quillSize: "36px",
          quillAlign: "left",
          quillFont: "Roboto",
          quillStyle: "Medium",
          quillVAlign: "top"
        },
        Subtitle24: {
          quillText: "Enter a medium subtitle here",
          quillSize: "24px",
          quillAlign: "left",
          quillFont: "Roboto",
          quillStyle: "Bold",
          quillVAlign: "top"
        },
        Quote18: {
          quillText: "Enter a quote text here",
          quillSize: "18px",
          quillAlign: "left",
          quillFont: "Roboto",
          quillStyle: "Bold",
          quillVAlign: "top"
        },
        Body16: {
          quillText: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce at lacus ullamcorper, vehicula odio a, volutpat metus. Nam sed laoreet felis. Cras ullamcorper fermentum risus aliquet convallis. Pellentesque at pellentesque dui. Suspendisse porttitor maximus erat, non egestas leo congue id. Duis sit amet convallis urna. Donec scelerisque, diam a volutpat tempus, metus augue imperdiet est, vel aliquam nulla libero eget lorem. Nunc neque metus, tempus at est venenatis, auctor aliquet purus.",
          quillSize: "16px",
          quillAlign: "left",
          quillFont: "Georgia",
          quillStyle: "Regular",
          quillVAlign: "top"
        },
        Caption12: {
          quillText: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce at lacus ullamcorper, vehicula odio a, volutpat metus. Nam sed laoreet felis.",
          quillSize: "12px",
          quillAlign: "left",
          quillFont: "Roboto",
          quillStyle: "Regular",
          quillVAlign: "top"
        },
        Footnote12: {
          quillText: "Enter a footnote text here",
          quillSize: "12px",
          quillAlign: "right",
          quillFont: "Roboto",
          quillStyle: "Regular",
          quillVAlign: "bottom"
        }
      };
    };

    TextAreaView.prototype.viewDidRender = function() {
      var tempQuill;
      if (quadrigram.environment === "editor") {
        return this.createQuillEditor();
      } else {
        if ($("#ql-base-style").length === 0) {
          tempQuill = new Quill($("<div/>").get(0), {});
          tempQuill.destroy();
        }
        this.createFlatText();
        return this.dontUpdate = true;
      }
    };

    TextAreaView.prototype.createFlatText = function() {
      var contents;
      contents = this.model.get("value");
      if (typeof contents === "string" || contents instanceof String) {
        this.$el.find(".quill-container").html(contents);
      }
      this.$el.find(".quill-container").addClass("ql-container");
      this.$el.addClass("exported-quill");
      if (this.model.get("scroll_enabled") === "true" || this.model.get("scroll_enabled") === true) {
        return this.$el.addClass("no-scroll");
      }
    };

    TextAreaView.prototype.createQuillEditor = function() {
      var configs,
        _this = this;
      configs = {
        styles: {
          '.editor-container': {
            'height': 'auto'
          },
          'body': {
            'padding': '0px 0px'
          },
          'span': {}
        }
      };
      this.quillEditor = new Quill(this.$el.find(".quill-container").get(0), configs);
      this.dontUpdate = true;
      /*NEW QUILL
      quadrigram.router.managers.fontManager.loadInFrame(@quillEditor.editor.renderer.iframe.contentWindow,()=>
        @setHidden(false)
      )
      */

      if (quadrigram.router.appViews.uiView) {
        quadrigram.router.managers.fontManager.textbarManager.createBarForEditor(this.quillEditor, this.model);
        this.model.original.quillId = this.quillEditor.id;
      }
      this.quillEditor.on("text-change", this.textChanged);
      $(this.quillEditor.editor.root).closest("body").on("mousedown", this.handleClick);
      $(this.quillEditor.editor.root).on("blur", function(e) {
        if (!$(e.relatedTarget).parent().hasClass("ql-link-tooltip")) {
          return _this.showFakeSelection();
        }
      });
      $(this.quillEditor.editor.root).on("focus", this.hideFakeSelection);
      $(this.quillEditor.editor.root).attr("spellcheck", false);
      if (this.model.original.options && this.model.original.options.textType) {
        this.quillEditor.setContents([
          {
            insert: this.quillEditorAttributes[this.model.get("quillEditorAttributes")].quillText,
            attributes: {
              size: this.quillEditorAttributes[this.model.get("quillEditorAttributes")].quillSize,
              font: this.quillEditorAttributes[this.model.get("quillEditorAttributes")].quillFont,
              align: this.quillEditorAttributes[this.model.get("quillEditorAttributes")].quillAlign,
              fontstyle: this.quillEditorAttributes[this.model.get("quillEditorAttributes")].quillStyle,
              valign: this.quillEditorAttributes[this.model.get("quillEditorAttributes")].quillVAlign
            }
          }
        ]);
        this.quillEditor.formatText(0, this.quillEditorAttributes[this.model.get("quillEditorAttributes")].quillText.length, "align", this.quillEditorAttributes[this.model.get("quillEditorAttributes")].quillAlign);
        this.model.original.options.texType = void 0;
        return this.textChanged();
      } else {
        return this.updateValue();
      }
    };

    TextAreaView.prototype.setHidden = function(value) {
      if (value) {
        return $(this.quillEditor.editor.root).closest("body").css("opacity", "0");
      } else {
        return $(this.quillEditor.editor.root).closest("body").css("opacity", "1");
      }
    };

    TextAreaView.prototype.textChanged = function(delta, source) {
      var contents, targetBlock;
      if (source !== "api") {
        if (this.model.original.getProperty("value") instanceof quadrigram.Models.PreProperty) {
          this.model.original.getProperty("value").activate();
        }
        targetBlock = this.model.original.getProperty("value").get("slotsCollection").where({
          "slotId": "value"
        })[0].get("internalBlock");
        contents = this.quillEditor.editor.innerHTML;
        contents = contents.replace(/fake-selected="true"/g, '');
        targetBlock.setDataManual(contents);
        this.dontUpdate = true;
        return this.updatePaddings();
      }
    };

    TextAreaView.prototype.updatePaddings = function() {
      var $quillRoot, DEFAULT_PADDING, line, linesHeight, minHeight, paddingTop, _i, _len, _ref1;
      DEFAULT_PADDING = 0;
      if (this.quillEditor != null) {
        $quillRoot = $(this.quillEditor.editor.root);
      } else {
        $quillRoot = $(this.$el.find(".quill-container"));
      }
      linesHeight = 0;
      _ref1 = $quillRoot.children();
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        line = _ref1[_i];
        if ($(line)[0].innerText !== "\n") {
          linesHeight += $(line).height();
        }
      }
      if ($quillRoot.find(".valigned-middle").length > 0) {
        minHeight = linesHeight + "px";
        paddingTop = Math.floor((this.$el.height() - linesHeight) / 2) - 1 + "px";
      } else if ($quillRoot.find(".valigned-bottom").length > 0) {
        minHeight = linesHeight + "px";
        paddingTop = Math.floor((this.$el.height() - linesHeight) - 1 - DEFAULT_PADDING) + "px";
      } else {
        minHeight = "auto";
        paddingTop = DEFAULT_PADDING + "px";
      }
      return $quillRoot.attr("style", "min-height:" + minHeight + "; padding-top:" + paddingTop + " !important");
    };

    TextAreaView.prototype.setSelected = function(value) {
      if (this.quillEditor) {
        $(this.quillEditor.editor.root).attr("contenteditable", value);
        if (value) {
          quadrigram.router.managers.fontManager.textbarManager.setActiveTarget(this.quillEditor);
          if (!this.isSelected) {
            this.quillEditor.editor.quill.setSelection(this.quillEditor.editor.quill.getLength(), this.quillEditor.editor.quill.getLength());
          }
          this.$el.css("pointer-events", "all");
          return this.isSelected = true;
        } else {
          if (this.currentMode !== "preview" && quadrigram.environment !== "exported") {
            this.$el.css("pointer-events", "none");
          }
          this.removeFakeSelection();
          return this.isSelected = false;
        }
      }
    };

    TextAreaView.prototype.setMode = function(newMode) {
      this.currentMode = newMode;
      if (this.currentMode === "preview") {
        return this.$el.css("pointer-events", "all");
      } else {
        return this.$el.css("pointer-events", "none");
      }
    };

    TextAreaView.prototype._handleResize = function() {
      if (quadrigram.environment !== "exported") {
        this.$el.css("pointer-events", "none");
      } else {
        /*
        @$el.find("iframe").contents().find("body").css({
          "font-family": "Oswald",
          "line-height": "normal",
          "font-size": "18px",
          "letter-spacing": "0px",
          "color": "#000000",
          "background-color": "none",
          "text-align": "left"
        })
        */

      }
      return TextAreaView.__super__._handleResize.apply(this, arguments);
    };

    TextAreaView.prototype.didResize = function() {
      TextAreaView.__super__.didResize.apply(this, arguments);
      return this.updatePaddings();
    };

    TextAreaView.prototype.handleClick = function(e) {
      if ($(e.target).closest(".quill-bar").length !== 0) {
        e.preventDefault();
        $(e.target).focus();
        /*
        @lastSelection = @quillEditor.editor.quill.getSelection()
        _.defer(()=>
          @quillEditor.editor.quill.setSelection(@lastSelection)
        )
        */

      }
      if (this.$el.find(".quill-container")[0] === e.target) {
        this.hideFakeSelection();
        e.preventDefault();
        return this.quillEditor.editor.quill.setSelection(this.quillEditor.editor.quill.getLength(), this.quillEditor.editor.quill.getLength());
      }
      /*
      if e.target==e.currentTarget
        e.preventDefault()
      
        @quillEditor.editor.quill.setSelection(this.quillEditor.editor.quill.getLength(),this.quillEditor.editor.quill.getLength());
      */

    };

    TextAreaView.prototype.showFakeSelection = function() {
      log("-->focusout");
      this.selectedRange = this.quillEditor.editor.selection.range;
      return this.quillEditor.editor.quill.formatText(this.selectedRange, "fakeselected", true, "user");
    };

    TextAreaView.prototype.hideFakeSelection = function() {
      log("-->focusin");
      return this.removeFakeSelection();
      /*
      if @selectedRange?
        @quillEditor.editor.selection.setRange(@selectedRange,"user")
        _.delay(()=>
          @quillEditor.editor.quill.formatText(@selectedRange,"fakeselected",false,"user")
          #@quillEditor.editor.quill.formatText(range,"background","white","user")
          _.defer(()=>
            @quillEditor.editor.selection.setRange(@selectedRange,"user")
            @selectedRange = null
          )
        ,1)
      */

    };

    TextAreaView.prototype.removeFakeSelection = function() {
      return this.$el.find("[fake-selected=true]").removeAttr("fake-selected");
    };

    TextAreaView.prototype.updateValue = function() {
      var contents;
      contents = this.model.get("value");
      if (quadrigram.environment !== "exported") {
        if (typeof contents === "string" || contents instanceof String) {
          return this.quillEditor.setHTML(contents);
        }
      }
    };

    TextAreaView.prototype.visualizerDidUpdateItems = function() {
      if (!this.dontUpdate) {
        this.updateValue();
      } else {
        this.dontUpdate = false;
      }
      return this.updatePaddings();
    };

    TextAreaView.prototype.getScrollDomElement = function() {
      return $(this.behaviors.layout.root[0]).find(".quill-container");
    };

    return TextAreaView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TextAreaModel = (function(_super) {
    __extends(TextAreaModel, _super);

    function TextAreaModel() {
      this.updateMetaSizeProperties = __bind(this.updateMetaSizeProperties, this);
      this.info = __bind(this.info, this);
      _ref = TextAreaModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TextAreaModel.behaviors = ["quadrigram.Models.LayoutBehavior"];

    TextAreaModel.meta = {
      name: "TextArea",
      properties: {
        value: {
          label: "Content",
          family: "data",
          hidden: true,
          formats: {
            Text: {
              defaults: {
                value: ""
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: "1"
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: "1"
              }
            }
          }
        },
        scroll_enabled: {
          internal: false
        },
        quillEditorAttributes: {
          label: "Quill editor attributes",
          family: "style",
          hidden: true,
          internal: true,
          formats: {
            Text: {
              defaults: {
                value: ""
              }
            }
          }
        }
      }
    };

    /*
    @info:(config) =>
      output = quadrigram.Models.VisualizerModel.mergeInfo(@meta,@behaviors)
      if config && config.textType?
        output = @updateMetaSizeProperties(config.textType, output)
    
      output
    */


    TextAreaModel.prototype.info = function(config) {
      if (this.output == null) {
        this.output = quadrigram.Models.VisualizerModel.mergeInfo(this.constructor.meta, this.constructor.behaviors);
        if (config && (config.textType != null)) {
          this.output = this.updateMetaSizeProperties(config.textType, this.output);
        }
      }
      return this.output;
    };

    TextAreaModel.prototype.updateMetaSizeProperties = function(textType, source) {
      var output;
      output = source;
      output.properties.quillEditorAttributes.formats.Text.defaults.value = textType;
      switch (textType) {
        case "Title112":
          output.properties.size_x.formats.Number.defaults.value = 14;
          output.properties.size_y.formats.Number.defaults.value = 2;
          break;
        case "Title56":
          output.properties.size_x.formats.Number.defaults.value = 10;
          output.properties.size_y.formats.Number.defaults.value = 2;
          break;
        case "Title45":
          output.properties.size_x.formats.Number.defaults.value = 6;
          output.properties.size_y.formats.Number.defaults.value = 1;
          break;
        case "Subtitle36":
          output.properties.size_x.formats.Number.defaults.value = 7;
          output.properties.size_y.formats.Number.defaults.value = 1;
          break;
        case "Subtitle24":
          output.properties.size_x.formats.Number.defaults.value = 5;
          output.properties.size_y.formats.Number.defaults.value = 1;
          break;
        case "Quote18":
          output.properties.size_x.formats.Number.defaults.value = 4;
          output.properties.size_y.formats.Number.defaults.value = 1;
          break;
        case "Body16":
          output.properties.size_x.formats.Number.defaults.value = 10;
          output.properties.size_y.formats.Number.defaults.value = 3;
          break;
        case "Caption12":
          output.properties.size_x.formats.Number.defaults.value = 5;
          output.properties.size_y.formats.Number.defaults.value = 2;
          break;
        case "Footnote12":
          output.properties.size_x.formats.Number.defaults.value = 3;
          output.properties.size_y.formats.Number.defaults.value = 1;
      }
      return output;
    };

    return TextAreaModel;

  })(quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Views.Textbar = (function() {
    Textbar.prototype.template = JST['app/scripts/templates/UI/textBar.hbs'];

    Textbar.prototype.toolbarTemplate = JST['app/scripts/templates/UI/textBarToolBar.hbs'];

    function Textbar() {
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.setActiveTarget = __bind(this.setActiveTarget, this);
      this._updateStyles = __bind(this._updateStyles, this);
      this.createBarForEditor = __bind(this.createBarForEditor, this);
      this.targets = [];
      this.toolbars = {};
      this.currentTarget = null;
      this.theToolbar = null;
      this.updateStyles = _.debounce(this._updateStyles, 400);
    }

    Textbar.prototype.createBarForEditor = function(quillEditor) {
      var contextual, self, toolbarEl,
        _this = this;
      if (this.theToolbar == null) {
        toolbarEl = $(this.toolbarTemplate({
          fontFamilies: quadrigram.router.managers.fontManager.fontsList()
        }));
        this.toolbarEl = toolbarEl;
        $(toolbarEl).find("[qm-input-type]").each(function(i) {
          var camelCased, format, style, styleCC;
          camelCased = $(this).attr("qm-input-type").replace(/-([a-z])/g, function(g) {
            return g[1].toUpperCase();
          });
          $(this)[camelCased]();
          format = $(this).attr("class").replace("ql-", "");
          styleCC = quillEditor.editor.doc.formats[format].config.style;
          if (styleCC) {
            style = styleCC.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
            return quillEditor.options.styles.body[style] = $(this).attr("qm-option-default-value");
          }
        });
        contextual = $(toolbarEl).find(".ql-font").inputWithOptions("instance").contextual;
        contextual.find("li").each(function(i, el) {
          return $(el).css("font-family", $(el).html());
        });
        self = this;
        $(toolbarEl).find(".ql-font-container .ql-font").on("valset", function() {
          $(toolbarEl).find(".ql-font-container .qm-input-element").css("font-family", $(this).val());
          return self.updateStyles($(this).val());
        });
        quillEditor.addModule('toolbar', {
          container: toolbarEl.get(0)
        });
        return this.theToolbar = quillEditor.modules['toolbar'];
      } else {
        quillEditor.modules['toolbar'] = this.theToolbar;
        return quillEditor.on(quillEditor.constructor.events.SELECTION_CHANGE, function(range) {
          if (range != null) {
            return _this.theToolbar.updateActive(range);
          }
        });
      }
    };

    Textbar.prototype._updateStyles = function(family) {
      var fontFamilyStyles;
      fontFamilyStyles = quadrigram.router.managers.fontManager.getFontStyles(family);
      return this.toolbarEl.find(".ql-fontstyle").inputWithOptions("instance").updateOptions(fontFamilyStyles, family);
    };

    Textbar.prototype.hideToolbar = function() {
      return $(window).find("[qm-input-type]").blur();
    };

    Textbar.prototype.setActiveTarget = function(quillEditor, selected, model) {
      $(this.theToolbar.container).find(".ql-link").unbind("click");
      this.theToolbar.quill = quillEditor;
      return this.theToolbar.initFormat('link', _.bind(this.theToolbar.quill.modules["link-tooltip"]._onToolbar, this.theToolbar.quill.modules["link-tooltip"]));
    };

    Textbar.prototype.viewWillRemove = function() {};

    return Textbar;

  })();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.TopMenuView = (function(_super) {
    __extends(TopMenuView, _super);

    function TopMenuView() {
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.show = __bind(this.show, this);
      this.hide = __bind(this.hide, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = TopMenuView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TopMenuView.prototype.template = JST['app/scripts/templates/UI/topMenu.hbs'];

    TopMenuView.prototype.viewDidRender = function() {};

    /*
    handleMenuResize:(e)=>
    
      ##WRONG: the +27 comes from the fact that the header is outside the uiview <- SHOULD BE INSIDE ???? la gracia es que si esta fuera se puede cargar independientemente de /rs/project...
      ##WRONG: this gets called on rollovers!?!??
      ##TODO: there is also a revise about "resize and shit"...
    
      if quadrigram.router.appViews.projectView?
        if @$el.css("display")!="none"
          quadrigram.router.appViews.projectView.resizeWithTopAt(@$el.height())
        else
          quadrigram.router.appViews.projectView.resizeWithTopAt()
    */


    TopMenuView.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    TopMenuView.prototype.hide = function() {
      return this.$el.slideUp(300);
    };

    TopMenuView.prototype.show = function() {
      return this.$el.slideDown(300);
    };

    TopMenuView.prototype.viewWillRemove = function() {};

    return TopMenuView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.FilePicker = (function(_super) {
    __extends(FilePicker, _super);

    function FilePicker() {
      this.cleanPicker = __bind(this.cleanPicker, this);
      this.retryServerRequest = __bind(this.retryServerRequest, this);
      this.offerRetry = __bind(this.offerRetry, this);
      this.resourceDeleted = __bind(this.resourceDeleted, this);
      this.resourceWasNotDeleted = __bind(this.resourceWasNotDeleted, this);
      this.resourceWasDeleted = __bind(this.resourceWasDeleted, this);
      this.handleFilePicked = __bind(this.handleFilePicked, this);
      this.resourceSelected = __bind(this.resourceSelected, this);
      this.fetchOnAllDrive = __bind(this.fetchOnAllDrive, this);
      this.fetchOnQFolder = __bind(this.fetchOnQFolder, this);
      this.setupDropZone = __bind(this.setupDropZone, this);
      this.filterResourceList = __bind(this.filterResourceList, this);
      this.setupResList = __bind(this.setupResList, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = FilePicker.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    FilePicker.prototype.template = JST['app/scripts/templates/UI/dialogs/filePicker.hbs'];

    FilePicker.prototype.errorTemplate = JST['app/scripts/templates/UI/errors/pickerError.hbs'];

    FilePicker.prototype.errorMessageTemplate = JST['app/scripts/templates/UI/errors/messageError.hbs'];

    FilePicker.prototype.dropzonePreviewTemplate = JST['app/scripts/templates/UI/dialogs/dropzonePreviewTemplate.hbs'];

    FilePicker.prototype.title = "Load files";

    FilePicker.prototype.iconClass = 'files-icon';

    FilePicker.prototype.acceptedFiles = "application/vnd.ms-excel,text/csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,.xls,.xlsx,.csv";

    FilePicker.prototype.viewWillRender = function() {
      return this.templateData.folderUrl = quadrigram.router.dataModels.user.get("userDriveFolder");
    };

    FilePicker.prototype.viewDidRender = function() {
      this.setupResList();
      this.$el.find(".list-container").append(this.resListView.$el);
      this.resListView.on("resource-selected", this.resourceSelected);
      this.resListView.on("resource-deleted", this.resourceDeleted);
      this.$el.find(".source-q").on("click", this.fetchOnQFolder);
      this.$el.find(".source-google").on("click", this.fetchOnAllDrive);
      this.$el.find(".file-list-search-input").on("keyup", this.filterResourceList);
      return this.setupDropZone();
    };

    FilePicker.prototype.setupResList = function() {
      var resList;
      resList = quadrigram.router.managers.serverManager.getResourcesList();
      resList.on("error", this.offerRetry);
      this.resListView = new quadrigram.Views.ResourcesListView({
        collection: resList
      });
      this.resListView.actionLabel = "Load file";
      this.resListView.render();
      return resList.fetch({
        success: this.cleanPicker
      });
    };

    FilePicker.prototype.filterResourceList = function() {
      var term;
      term = this.$el.find(".file-list-search-input").val();
      return this.resListView.filterList(term);
    };

    FilePicker.prototype.setupDropZone = function() {
      var dropZoneEl,
        _this = this;
      dropZoneEl = this.$el.find(".file-upload");
      return dropZoneEl.dropzone({
        url: function(files) {
          return quadrigram.baseUrl + "rs/google/resource";
        },
        maxFilesize: 20,
        addedfile: function(file) {
          _this.$el.find(".fake-progress-container").removeClass("hidden");
          _this.$el.find(".dz-default").addClass("hidden");
          _this.$el.find(".fake-progress").removeClass("success");
          return _this.$el.find(".fake-progress").css("width", "10%");
        },
        success: function(file, response) {
          if (_this.$el.find(".message-server-error").length) {
            _this.$el.find(".message-server-error").remove();
          }
          if ((response.code != null) && response.code !== 200) {
            _this.$el.find(".pb-container").append(_this.errorMessageTemplate("Error uploading new resource"));
            return _this.$el.find(".fake-progress-container").addClass("hidden");
          } else {
            _this.$el.find(".fake-progress").css("width", "100%");
            _this.$el.find(".fake-progress").addClass("success");
            setTimeout(function() {
              _this.$el.find(".fake-progress-container").addClass("hidden");
              return _this.$el.find(".dz-default").removeClass("hidden");
            }, 2000);
            return _this.resListView.refresh();
          }
        },
        withCredentials: true,
        uploadprogress: function(file, percent, bytes) {
          if (percent < 100) {
            log("setting progress to", Math.min(90, percent));
            return _this.$el.find(".fake-progress").css("width", Math.min(Math.max(percent, 10), 90) + "%");
          }
        },
        error: function(file, message) {
          if (file.accepted === false) {
            elog("This file type is not accepted!");
            if (file.type.indexOf("image") >= 0) {
              message = "Use the image picker to upload images";
            } else {
              message = "Sorry, Quadrigram can't process this type of file...";
            }
            _this.$el.find(".error-container").append(_this.errorMessageTemplate(message));
            _this.$el.find(".error-container").removeClass("hidden");
            _this.$el.find(".fake-progress-container").addClass("hidden");
            _this.$el.find(".dz-default").addClass("hidden");
            return setTimeout(function() {
              _this.$el.find(".fake-progress-container").addClass("hidden");
              _this.$el.find(".dz-default").removeClass("hidden");
              _this.$el.find(".error-container").empty();
              return _this.$el.find(".error-container").addClass("hidden");
            }, 2000);
          }
        },
        previewTemplate: this.dropzonePreviewTemplate(),
        dictDefaultMessage: "Drop files or click to upload.",
        acceptedFiles: this.acceptedFiles
      });
    };

    FilePicker.prototype.fetchOnQFolder = function() {
      var resList;
      resList = this.resListView.collection;
      resList.url = quadrigram.baseUrl + "rs/google/resources";
      this.resListView.render();
      this.resListView.showOverlay("loading");
      return resList.fetch({
        success: this.cleanPicker
      });
    };

    FilePicker.prototype.fetchOnAllDrive = function() {
      var resList;
      resList = this.resListView.collection;
      resList.url = quadrigram.baseUrl + "rs/google/resources?root=all";
      this.resListView.render();
      this.resListView.showOverlay("loading");
      return resList.fetch({
        success: this.cleanPicker
      });
    };

    FilePicker.prototype.resourceSelected = function(metadata) {
      return this.handleFilePicked(metadata);
    };

    FilePicker.prototype.handleFilePicked = function(metadata) {
      this.callBack(metadata);
      this.close();
      quadrigram.milestoneTracker.trackMilestone("data_manager", "load_file");
      return quadrigram.achievementTracker.trackDirectAction("loadData");
    };

    FilePicker.prototype.resourceWasDeleted = function(response) {
      if (!(response && (response.code != null) && response.code === 200)) {
        return this.resourceWasNotDeleted(response);
      } else {
        return this.resListView.collection.fetch({
          success: this.cleanPicker
        });
      }
    };

    FilePicker.prototype.resourceWasNotDeleted = function(response) {
      var _this = this;
      this.resListView.setState("custom", {
        "message": "Error deleting file, please try again"
      });
      return setTimeout(function() {
        return _this.resListView.hideOverlay();
      }, 3000);
    };

    FilePicker.prototype.resourceDeleted = function(metadata) {
      this.resListView.setState("custom", {
        "message": "Deleting file..."
      });
      return quadrigram.router.managers.serverManager.deleteFile(metadata, this.resourceWasDeleted, this.resourceWasNotDeleted);
    };

    FilePicker.prototype.offerRetry = function(error) {
      this.$el.find(".list-container").append(this.errorTemplate());
      return this.$el.find(".retry-overlay-message").on("click", this.retryServerRequest);
    };

    FilePicker.prototype.retryServerRequest = function(e) {
      this.$el.find(".retry-overlay").remove();
      this.$el.find(".retry-overlay-message").off("click", this.retryServerRequest);
      return this.resListView.collection.fetch({
        success: this.cleanPicker
      });
    };

    FilePicker.prototype.cleanPicker = function() {
      this.$el.find(".file-list-search-input").removeClass("disabled");
      return this.resListView.hideOverlay();
    };

    FilePicker.prototype.remove = function() {
      FilePicker.__super__.remove.call(this);
      this.$el.find(".retry-overlay-message").off("click", this.retryServerRequest);
      this.$el.find(".source-q").off("click", this.fetchOnQFolder);
      this.$el.find(".source-google").off("click", this.fetchOnAllDrive);
      return this.$el.find(".file-list-search-input").off("keyup", this.filterResourceList);
    };

    return FilePicker;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ImagePicker = (function(_super) {
    __extends(ImagePicker, _super);

    function ImagePicker() {
      this.fetchOnAllDrive = __bind(this.fetchOnAllDrive, this);
      this.fetchOnQFolder = __bind(this.fetchOnQFolder, this);
      this.setupResList = __bind(this.setupResList, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = ImagePicker.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ImagePicker.prototype.acceptedFiles = "image/*";

    ImagePicker.prototype.title = "Load images";

    ImagePicker.prototype.viewDidRender = function() {
      ImagePicker.__super__.viewDidRender.call(this);
      return this.$el.find(".file-list").addClass("image-file-list");
    };

    ImagePicker.prototype.setupResList = function() {
      var resList;
      resList = quadrigram.router.managers.serverManager.getResourcesList();
      resList.on("error", this.offerRetry);
      resList.instanceUrl = quadrigram.baseUrl + "rs/google/images";
      this.resListView = new quadrigram.Views.ImageResourceListView({
        collection: resList
      });
      this.resListView.actionLabel = "Load image";
      this.resListView.render();
      resList.fetch({
        success: this.cleanPicker
      });
      return this.$el.find(".file-list-header").addClass("hidden");
    };

    ImagePicker.prototype.fetchOnQFolder = function() {
      var resList;
      resList = this.resListView.collection = quadrigram.router.managers.serverManager.getResourcesList();
      resList.instanceUrl = quadrigram.baseUrl + "rs/google/images";
      this.resListView.render();
      this.resListView.showOverlay("loading");
      return resList.fetch({
        success: this.cleanPicker
      });
    };

    ImagePicker.prototype.fetchOnAllDrive = function() {
      var resList;
      resList = this.resListView.collection = quadrigram.router.managers.serverManager.getResourcesList();
      resList.instanceUrl = quadrigram.baseUrl + "rs/google/images?root=all";
      this.resListView.render();
      this.resListView.showOverlay("loading");
      return resList.fetch({
        success: this.cleanPicker
      });
    };

    return ImagePicker;

  })(quadrigram.Views.FilePicker);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ProjectsPicker = (function(_super) {
    __extends(ProjectsPicker, _super);

    function ProjectsPicker() {
      this.handleProjectPicked = __bind(this.handleProjectPicked, this);
      this.projectDeleted = __bind(this.projectDeleted, this);
      this.projectSelected = __bind(this.projectSelected, this);
      this.projectWasNotDeleted = __bind(this.projectWasNotDeleted, this);
      this.projectWasDeleted = __bind(this.projectWasDeleted, this);
      this.retryServerRequest = __bind(this.retryServerRequest, this);
      this.offerRetry = __bind(this.offerRetry, this);
      this.newProject = __bind(this.newProject, this);
      this.showProjectList = __bind(this.showProjectList, this);
      this.filterResourceList = __bind(this.filterResourceList, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ProjectsPicker.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ProjectsPicker.prototype.template = JST['app/scripts/templates/UI/dialogs/projectsPicker.hbs'];

    ProjectsPicker.prototype.errorTemplate = JST['app/scripts/templates/UI/errors/pickerError.hbs'];

    ProjectsPicker.prototype.title = "Open project";

    ProjectsPicker.prototype.iconClass = 'projects-icon';

    ProjectsPicker.prototype.appendToSelector = "#content";

    ProjectsPicker.prototype.zindexClass = "open-front";

    ProjectsPicker.prototype.ERROR_RENAME_MESSAGE = "Error renaming project, please try again";

    ProjectsPicker.prototype.viewWillRender = function() {
      var _this = this;
      ProjectsPicker.__super__.viewWillRender.call(this);
      this.$el.empty();
      return this.buttons = {
        "New Project": {
          click: function() {
            return _this.newProject();
          },
          text: 'New Project',
          "class": 'ok-button'
        }
      };
    };

    ProjectsPicker.prototype.viewDidRender = function() {
      var projectsList;
      log("ProjectsPicker::createContent -> contentEl = ", this.$el);
      projectsList = quadrigram.router.managers.serverManager.getProjectsList();
      projectsList.on("error", this.offerRetry);
      this.projectsListView = new quadrigram.Views.ResourcesListView({
        collection: projectsList
      });
      this.projectsListView.actionLabel = "Open";
      this.projectsListView.labelsEditable = true;
      this.projectsListView.render();
      this.$el.find(".list-container").append(this.projectsListView.$el);
      this.projectsListView.on("loaded", this.showProjectList);
      this.projectsListView.on("resource-selected", this.projectSelected);
      this.projectsListView.on("resource-deleted", this.projectDeleted);
      this.$el.find(".file-list-search-input").on("keyup", this.filterResourceList);
      return projectsList.fetch();
    };

    ProjectsPicker.prototype.filterResourceList = function() {
      var term;
      term = this.$el.find(".file-list-search-input").val();
      return this.projectsListView.filterList(term);
    };

    ProjectsPicker.prototype.showProjectList = function() {
      if (this.projectsListView.collection.models.length > 0) {
        this.$el.find(".meta-data-item[data-id='" + quadrigram.router.dataModels.currentProject.get("id") + "']").addClass("current-project");
        return this.$el.find(".file-list-search-input").removeClass("disabled");
        /*
        d3.select(@projectsListView.el).selectAll(".list-item").classed("current-project",() ->
          itemProject = d3.select(@).select(".block-group").attr("data-id")
          currentProject = quadrigram.router.dataModels.currentProject.get("id")
          return itemProject == currentProject
        )
        */

      }
    };

    ProjectsPicker.prototype.newProject = function() {
      quadrigram.router.loadProject();
      return this.close();
    };

    ProjectsPicker.prototype.offerRetry = function(error) {
      this.$el.find(".list-container").append(this.errorTemplate());
      return this.$el.find(".retry-overlay-message").on("click", this.retryServerRequest);
    };

    ProjectsPicker.prototype.retryServerRequest = function(e) {
      this.$el.find(".error-retry-button").off("click", this.retryServerRequest);
      this.$el.find(".retry-overlay").remove();
      return this.projectsListView.collection.fetch({
        success: this.showProjectList
      });
    };

    ProjectsPicker.prototype.projectWasDeleted = function(response) {
      if (!(response && (response.code != null) && response.code === 200)) {
        return this.projectWasNotDeleted(response);
      } else {
        return this.projectsListView.collection.fetch({
          success: this.showProjectList
        });
      }
    };

    ProjectsPicker.prototype.projectWasNotDeleted = function(response) {
      var _this = this;
      this.projectsListView.setState("custom", {
        "message": "Error deleting project, please try again"
      });
      return setTimeout(function() {
        return _this.projectsListView.hideOverlay();
      }, 3000);
    };

    /*
    projectWasRenamed:(response)=>
      #@projectsListView.errorDeleting = 1
      if not (response && response.code? && response.code == 200)
        @projectWasNotRenamed(response)
    
    projectWasNotRenamed:(response)=>
      @$el.append(@errorMessage(@ERROR_RENAME_MESSAGE))
    */


    ProjectsPicker.prototype.projectSelected = function(metadata) {
      this.$el.find(".message-server-error").remove();
      return this.handleProjectPicked(metadata);
    };

    ProjectsPicker.prototype.projectDeleted = function(metadata) {
      this.projectsListView.setState("custom", {
        "message": "Deleting project..."
      });
      return quadrigram.router.managers.serverManager.deleteProject(metadata, this.projectWasDeleted, this.projectWasNotDeleted);
    };

    /*
    projectRenamed:(metadata)=>
      log "PROJECT SHOUD BE RENAMED!"
      quadrigram.router.managers.serverManager.renameProject(metadata,@projectWasRenamed,@projectWasNotRenamed)
    */


    ProjectsPicker.prototype.handleProjectPicked = function(metadata) {
      log("ProjectsPicker::handleProjectPicked -> metadata = ", metadata);
      this.callBack(metadata);
      return this.close();
    };

    ProjectsPicker.prototype.remove = function() {
      ProjectsPicker.__super__.remove.call(this);
      this.$el.find(".error-retry-button").off("click", this.retryServerRequest);
      return this.$el.find(".file-list-search-input").off("keyup", this.filterResourceList);
    };

    return ProjectsPicker;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.MetaProject = (function(_super) {
    __extends(MetaProject, _super);

    function MetaProject() {
      _ref = MetaProject.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    return MetaProject;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.MetaResource = (function(_super) {
    __extends(MetaResource, _super);

    function MetaResource() {
      _ref = MetaResource.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    return MetaResource;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.metaResourceCollection = (function(_super) {
    __extends(metaResourceCollection, _super);

    function metaResourceCollection() {
      this.parse = __bind(this.parse, this);
      this.retryErrorHandler = __bind(this.retryErrorHandler, this);
      this.url = __bind(this.url, this);
      _ref = metaResourceCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    metaResourceCollection.prototype.url = function() {
      return this.instanceUrl;
    };

    metaResourceCollection.prototype.model = quadrigram.Models.MetaResource;

    metaResourceCollection.prototype.initialize = function() {
      return this.instanceUrl = quadrigram.baseUrl + "rs/google/resources";
    };

    metaResourceCollection.prototype.retryErrorHandler = function(data) {
      console.log('error on fetch resource list: ' + data.error);
      this.trigger('error', data.error);
      return null;
    };

    metaResourceCollection.prototype.parse = function(data) {
      if ((data.code != null) && data.code !== 200) {
        return this.retryErrorHandler(data);
      } else {
        return data.body;
      }
    };

    return metaResourceCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.metaProjectCollection = (function(_super) {
    __extends(metaProjectCollection, _super);

    function metaProjectCollection() {
      this.parse = __bind(this.parse, this);
      this.retryErrorHandler = __bind(this.retryErrorHandler, this);
      this.url = __bind(this.url, this);
      _ref = metaProjectCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    metaProjectCollection.prototype.url = function() {
      return this.instanceUrl;
    };

    metaProjectCollection.prototype.model = quadrigram.Models.MetaProject;

    metaProjectCollection.prototype.initialize = function() {
      return this.instanceUrl = quadrigram.baseUrl + "rs/google/projects";
    };

    metaProjectCollection.prototype.retryErrorHandler = function(data) {
      console.log('error on fetch project list: ' + data.error);
      this.trigger('error', data.error);
      return null;
    };

    metaProjectCollection.prototype.parse = function(data) {
      if ((data.code != null) && data.code !== 200) {
        return this.retryErrorHandler(data);
      } else {
        return data.body;
      }
    };

    return metaProjectCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.MetadataItem = (function(_super) {
    __extends(MetadataItem, _super);

    function MetadataItem() {
      this.triggerEdited = __bind(this.triggerEdited, this);
      this.triggerDelete = __bind(this.triggerDelete, this);
      this.triggerPreview = __bind(this.triggerPreview, this);
      this.triggerSelected = __bind(this.triggerSelected, this);
      this.getTypeFromMimeType = __bind(this.getTypeFromMimeType, this);
      this.getFormattedDate = __bind(this.getFormattedDate, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = MetadataItem.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    MetadataItem.prototype.template = JST['app/scripts/templates/UI/metadataItem.hbs'];

    MetadataItem.prototype.className = "list-item";

    MetadataItem.prototype.events = {
      "click .action-btn": "triggerSelected",
      "click .delete-btn": "triggerDelete"
    };

    MetadataItem.prototype.viewWillRender = function() {
      var _this = this;
      Handlebars.registerHelper('convertToDate', function(ms, options) {
        return _this.getFormattedDate(new Date(ms));
      });
      Handlebars.registerHelper('convertToType', function(mimeType, options) {
        return _this.getTypeFromMimeType(mimeType);
      });
      return Handlebars.registerHelper('ifNotToolarge', function(fileSize, options) {
        if (!_.isNaN(fileSize) && Number(fileSize) / 1000000 < 20) {
          return options.fn(_this);
        } else {
          return options.inverse(_this);
        }
      });
    };

    MetadataItem.prototype.getFormattedDate = function(date) {
      var day, month, year;
      year = date.getFullYear();
      month = (1 + date.getMonth()).toString();
      if (month.length === 1) {
        month = '0' + month;
      }
      day = date.getDate().toString();
      if (day.length === 1) {
        day = '0' + day;
      }
      return day + '/' + month + '/' + year;
    };

    MetadataItem.prototype.getTypeFromMimeType = function(mimeType) {
      switch (mimeType) {
        case "text/csv":
          return "CSV";
        case "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":
          return "XLSX";
        case "application/vnd.ms-excel":
          return "XLS";
        default:
          return "none";
      }
    };

    MetadataItem.prototype.triggerSelected = function() {
      return this.trigger("selected", this);
    };

    MetadataItem.prototype.triggerPreview = function() {
      return this.trigger("preview", this);
    };

    MetadataItem.prototype.triggerDelete = function(e) {
      e.stopImmediatePropagation();
      return this.trigger("delete", this);
    };

    MetadataItem.prototype.triggerEdited = function(e) {
      this.model.set("name", this.$el.find(".item-label").val());
      return this.trigger("edited", this);
    };

    return MetadataItem;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ImageMetadataItem = (function(_super) {
    __extends(ImageMetadataItem, _super);

    function ImageMetadataItem() {
      this.triggerEdited = __bind(this.triggerEdited, this);
      this.triggerDelete = __bind(this.triggerDelete, this);
      this.triggerPreview = __bind(this.triggerPreview, this);
      this.triggerSelected = __bind(this.triggerSelected, this);
      this.getTypeFromMimeType = __bind(this.getTypeFromMimeType, this);
      this.getFormattedDate = __bind(this.getFormattedDate, this);
      this.hideButton = __bind(this.hideButton, this);
      this.showButton = __bind(this.showButton, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ImageMetadataItem.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ImageMetadataItem.prototype.template = JST['app/scripts/templates/UI/imageMetadataItem.hbs'];

    ImageMetadataItem.prototype.className = "image-list-item";

    ImageMetadataItem.prototype.events = {
      "click .action-btn": "triggerSelected",
      "click .delete-btn": "triggerDelete",
      "mouseover": "showButton",
      "mouseout": "hideButton"
    };

    ImageMetadataItem.prototype.viewWillRender = function() {
      var _this = this;
      Handlebars.registerHelper('convertToDate', function(ms, options) {
        return _this.getFormattedDate(new Date(ms));
      });
      return Handlebars.registerHelper('convertToType', function(mimeType, options) {
        return _this.getTypeFromMimeType(mimeType);
      });
    };

    ImageMetadataItem.prototype.showButton = function() {
      return this.$el.find(".action-btn").removeClass("hidden");
    };

    ImageMetadataItem.prototype.hideButton = function() {
      return this.$el.find(".action-btn").addClass("hidden");
    };

    ImageMetadataItem.prototype.getFormattedDate = function(date) {
      var day, month, year;
      year = date.getFullYear();
      month = (1 + date.getMonth()).toString();
      if (month.length === 1) {
        month = '0' + month;
      }
      day = date.getDate().toString();
      if (day.length === 1) {
        day = '0' + day;
      }
      return day + '/' + month + '/' + year;
    };

    ImageMetadataItem.prototype.getTypeFromMimeType = function(mimeType) {
      switch (mimeType) {
        case "text/csv":
          return "CSV";
        case "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":
          return "XLSX";
        case "application/vnd.ms-excel":
          return "XLS";
        default:
          return "none";
      }
    };

    ImageMetadataItem.prototype.triggerSelected = function() {
      return this.trigger("selected", this);
    };

    ImageMetadataItem.prototype.triggerPreview = function() {
      return this.trigger("preview", this);
    };

    ImageMetadataItem.prototype.triggerDelete = function(e) {
      e.stopImmediatePropagation();
      return this.trigger("delete", this);
    };

    ImageMetadataItem.prototype.triggerEdited = function(e) {
      this.model.set("name", this.$el.find(".item-label").val());
      return this.trigger("edited", this);
    };

    return ImageMetadataItem;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.LoadableCollectionView = (function(_super) {
    __extends(LoadableCollectionView, _super);

    function LoadableCollectionView() {
      this.hideOverlay = __bind(this.hideOverlay, this);
      this.showOverlay = __bind(this.showOverlay, this);
      this.setState = __bind(this.setState, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.init = __bind(this.init, this);
      _ref = LoadableCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LoadableCollectionView.prototype.template = JST['app/scripts/templates/UI/loadableCollectionView.hbs'];

    LoadableCollectionView.prototype.loadingTemplate = JST['app/scripts/templates/UI/loadingOverlay.hbs'];

    LoadableCollectionView.prototype.messageTemplate = JST['app/scripts/templates/UI/messageOverlay.hbs'];

    LoadableCollectionView.prototype.emptyTemplate = JST['app/scripts/templates/visualizers/empty.hbs'];

    LoadableCollectionView.prototype.NO_DATA_MESSAGE = "No data";

    LoadableCollectionView.prototype.ERROR_MESSAGE = "Error connecting to the server";

    LoadableCollectionView.prototype.className = "loadable-list";

    LoadableCollectionView.prototype.init = function() {
      var _this = this;
      this.collection.on("request", function(model) {
        return _this.setState("loading");
      });
      /*
      @collection.on("reset",(model)=>
        @setState("loaded")
      )
      */

      this.collection.on("sync", function(model) {
        _this.setState("loaded");
        return _this.trigger("loaded");
      });
      return this.collection.on("error", function(model) {
        return _this.setState("error");
      });
      /*
      @collection.on("fetch",(model)=>
        @setState("loading")
      )
      */

    };

    LoadableCollectionView.prototype.viewDidRender = function() {
      var e, elEvents,
        _this = this;
      this.collectionView = new Backbone.CollectionView({
        collection: this.collection,
        el: this.$el.find(".items-container")
      });
      this.collectionView.template = this.emptyTemplate;
      this.collectionView.modelView = this.modelView;
      this.collectionView.on("all", function(e, options) {
        return _this.trigger(e, options);
      });
      this.collectionView.elementViewDidRender = this.elementViewDidRender;
      elEvents = _.extend({}, this.elementEvents);
      for (e in elEvents) {
        elEvents[e] = this[elEvents[e]];
      }
      this.collectionView.elementEvents = elEvents;
      return this.collectionView.render();
    };

    LoadableCollectionView.prototype.viewWillRemove = function() {
      this.off("render");
      this.collection.off();
      return this.collectionView.off();
    };

    LoadableCollectionView.prototype.setState = function(state, options) {
      if (state === "loading") {
        return this.showOverlay("loading");
      } else if (state === "loaded") {
        if (this.collection.models.length > 0) {
          return this.hideOverlay();
        } else if ((this.collection.error != null) && this.collection.models.length === 0) {
          return this.showOverlay("message", this.ERROR_MESSAGE);
        } else {
          return this.showOverlay("message", this.NO_DATA_MESSAGE);
        }
      } else if (state === "error") {
        return this.showOverlay("message", this.ERROR_MESSAGE);
      } else if (state === "custom") {
        return this.showOverlay("message", options.message);
      }
    };

    LoadableCollectionView.prototype.showOverlay = function(type, msg) {
      if (this.$overlay) {
        this.$overlay.remove();
      }
      if (type === "loading") {
        this.$overlay = $(this.loadingTemplate());
        this.$el.find(".overlay-container").append(this.$overlay);
      } else if (type === "message") {
        this.$overlay = $(this.messageTemplate(msg));
        this.$el.find(".overlay-container").append(this.$overlay);
      }
      return this.$el.find(".overlay-container").removeClass("hidden");
    };

    LoadableCollectionView.prototype.hideOverlay = function() {
      if (this.$overlay) {
        this.$overlay.remove();
      }
      return this.$el.find(".overlay-container").addClass("hidden");
    };

    return LoadableCollectionView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ResourcesListView = (function(_super) {
    __extends(ResourcesListView, _super);

    function ResourcesListView() {
      this.refresh = __bind(this.refresh, this);
      this._clickOnDeleteItem = __bind(this._clickOnDeleteItem, this);
      this._clickOnItem = __bind(this._clickOnItem, this);
      this.filterList = __bind(this.filterList, this);
      this.elementViewDidRender = __bind(this.elementViewDidRender, this);
      _ref = ResourcesListView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ResourcesListView.prototype.modelView = quadrigram.Views.MetadataItem;

    ResourcesListView.prototype.NO_DATA_MESSAGE = "No files have been uploaded yet!";

    ResourcesListView.prototype.className = "file-list";

    ResourcesListView.prototype.actionLabel = "Action";

    ResourcesListView.prototype.labelsEditable = false;

    ResourcesListView.prototype.elementEvents = {
      "selected": "_clickOnItem",
      "delete": "_clickOnDeleteItem"
    };

    ResourcesListView.prototype.elementViewDidRender = function(view) {
      view.$el.find(".action-btn").html(this.actionLabel);
      view.$el.find(".action-btn").addClass("ui-tip-target");
      view.$el.find(".action-btn").attr("data-ui-tip-id", this.actionLabel);
      view.$el.find(".delete-btn").addClass("ui-tip-target");
      return view.$el.find(".delete-btn").attr("data-ui-tip-id", "delete-file");
    };

    ResourcesListView.prototype.filterList = function(term) {
      term = term.toLowerCase();
      return d3.select(this.el).selectAll(".list-item").style("display", function(d, i) {
        var name;
        name = d3.select(this).select(".meta-data-item").attr("data-name").toLowerCase();
        if (name.indexOf(term) !== -1) {
          return "inherit";
        } else {
          return "none";
        }
      });
    };

    ResourcesListView.prototype._clickOnItem = function(itemView) {
      return this.trigger("resource-selected", itemView.model);
    };

    ResourcesListView.prototype._clickOnDeleteItem = function(itemView) {
      return this.trigger("resource-deleted", itemView.model);
    };

    ResourcesListView.prototype.refresh = function(callback) {
      var _this = this;
      this.showOverlay("loading");
      return this.collection.fetch({
        success: function() {
          _this.render();
          if (callback) {
            return callback();
          }
        }
      });
    };

    return ResourcesListView;

  })(quadrigram.Views.LoadableCollectionView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ImageResourceListView = (function(_super) {
    __extends(ImageResourceListView, _super);

    function ImageResourceListView() {
      this.refresh = __bind(this.refresh, this);
      this._clickOnDeleteItem = __bind(this._clickOnDeleteItem, this);
      this._clickOnItem = __bind(this._clickOnItem, this);
      this.elementViewDidRender = __bind(this.elementViewDidRender, this);
      this.filterList = __bind(this.filterList, this);
      _ref = ImageResourceListView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ImageResourceListView.prototype.modelView = quadrigram.Views.ImageMetadataItem;

    ImageResourceListView.prototype.NO_DATA_MESSAGE = "No files have been uploaded yet!";

    ImageResourceListView.prototype.className = "file-list";

    ImageResourceListView.prototype.actionLabel = "Action";

    ImageResourceListView.prototype.labelsEditable = false;

    ImageResourceListView.prototype.elementEvents = {
      "selected": "_clickOnItem",
      "delete": "_clickOnDeleteItem"
    };

    ImageResourceListView.prototype.filterList = function(term) {
      term = term.toLowerCase();
      return d3.select(this.el).selectAll(".image-list-item").style("display", function(d, i) {
        var name;
        name = d3.select(this).select(".image-meta-data-item").attr("data-name").toLowerCase();
        if (name.indexOf(term) !== -1) {
          return "inline-block";
        } else {
          return "none";
        }
      });
    };

    ImageResourceListView.prototype.elementViewDidRender = function(view) {
      view.$el.find(".action-btn").html(this.actionLabel);
      view.$el.find(".action-btn").addClass("ui-tip-target");
      view.$el.find(".action-btn").attr("data-ui-tip-id", this.actionLabel);
      view.$el.find(".delete-btn").addClass("ui-tip-target");
      return view.$el.find(".delete-btn").attr("data-ui-tip-id", "delete-file");
    };

    ImageResourceListView.prototype._clickOnItem = function(itemView) {
      return this.trigger("resource-selected", itemView.model);
    };

    ImageResourceListView.prototype._clickOnDeleteItem = function(itemView) {
      return this.trigger("resource-deleted", itemView.model);
    };

    ImageResourceListView.prototype.refresh = function(callback) {
      var _this = this;
      this.showOverlay("loading");
      return this.collection.fetch({
        success: function() {
          _this.render();
          if (callback) {
            return callback();
          }
        }
      });
    };

    return ImageResourceListView;

  })(quadrigram.Views.LoadableCollectionView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.SaveAsDialog = (function(_super) {
    __extends(SaveAsDialog, _super);

    function SaveAsDialog() {
      this.saveClicked = __bind(this.saveClicked, this);
      this.cancelClicked = __bind(this.cancelClicked, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = SaveAsDialog.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SaveAsDialog.prototype.template = JST['app/scripts/templates/UI/dialogs/saveAsDialog.hbs'];

    SaveAsDialog.prototype.title = "Save as...";

    SaveAsDialog.prototype.width = 400;

    SaveAsDialog.prototype.viewWillRender = function() {
      var _this = this;
      this.buttons = {
        "Ok": {
          click: function() {
            _this.saveClicked();
            return _this.close();
          },
          text: 'OK',
          "class": 'ok-button'
        }
      };
      switch (this.options.type) {
        case "saveas":
          return this.title = "Save as...";
        case "rename":
          return this.title = "Rename...";
        case "save":
          return this.title = "Save";
      }
    };

    SaveAsDialog.prototype.viewDidRender = function() {
      var _this = this;
      this.$el.find(".pname-input").qmInput();
      this.$el.find(".pname-input").val(quadrigram.router.dataModels.currentProject.get("pname"));
      this.$el.find(".pname-input").on("qm:enter", function() {
        _this.saveClicked();
        return _this.close();
      });
      return this.$el.find(".pname-input").focus();
    };

    SaveAsDialog.prototype.cancelClicked = function() {
      return this.close();
    };

    SaveAsDialog.prototype.saveClicked = function() {
      var opt;
      opt = {};
      if (this.$el.find(".pname-input")[0].value != null) {
        opt.newName = this.$el.find(".pname-input")[0].value;
      }
      return this.options.callBack(opt);
    };

    return SaveAsDialog;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ShareDialog = (function(_super) {
    __extends(ShareDialog, _super);

    function ShareDialog() {
      this.showMessageError = __bind(this.showMessageError, this);
      this.shareClicked = __bind(this.shareClicked, this);
      this.cancelClicked = __bind(this.cancelClicked, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ShareDialog.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ShareDialog.prototype.template = JST['app/scripts/templates/UI/dialogs/shareDialog.hbs'];

    ShareDialog.prototype.title = "Share the project";

    ShareDialog.prototype.width = 400;

    ShareDialog.prototype.appendToSelector = "#content";

    ShareDialog.prototype.zindexClass = "open-front";

    ShareDialog.prototype.viewWillRender = function() {
      var _this = this;
      this.buttons = {
        "Ok": {
          click: function() {
            return _this.shareClicked();
          },
          text: 'OK',
          "class": 'ok-button'
        }
      };
      return this.title = "Share the project";
    };

    ShareDialog.prototype.viewDidRender = function() {
      this.emailList = JSON.parse(localStorage.getItem('emailList'));
      if (!this.emailList || this.emailList === "") {
        this.emailList = [];
      }
      this.tokenfield = this.$('#tokenfield').tokenfield({
        autocomplete: {
          source: this.emailList,
          delay: 100
        }
      }).on('tokenfield:createdtoken', function(e) {
        var re, valid;
        re = /\S+@\S+\.\S+/;
        valid = re.test(e.attrs.value);
        if (!valid) {
          return $(e.relatedTarget).addClass('invalid');
        }
      });
      return this.$('#tokenfield').data('bs.tokenfield').$input.attr('autocomplete', false);
    };

    ShareDialog.prototype.cancelClicked = function() {
      return this.close();
    };

    ShareDialog.prototype.shareClicked = function() {
      var currentText, inputValue, inputValues, opt, re, valid, _i, _len;
      opt = {};
      opt.mails = [];
      inputValues = this.$("#tokenfield").tokenfield("getTokens");
      currentText = this.$('#tokenfield').data('bs.tokenfield').$input.val();
      if (currentText.length !== 0) {
        this.$('#tokenfield').tokenfield('createToken', currentText);
        inputValues = this.$("#tokenfield").tokenfield("getTokens");
      }
      re = /\S+@\S+\.\S+/;
      for (_i = 0, _len = inputValues.length; _i < _len; _i++) {
        inputValue = inputValues[_i];
        valid = re.test(inputValue.value);
        if (valid) {
          opt.mails.push(inputValue.value);
          if (this.emailList.indexOf(inputValue.value) === -1) {
            this.emailList.push(inputValue.value);
          }
        } else {
          this.showMessageError("Sorry, " + inputValue.value + " is not a valid email");
          return;
        }
      }
      if (opt.mails.length > 0) {
        this.options.callBack(opt);
        localStorage.setItem('emailList', JSON.stringify(this.emailList));
        return this.close();
      } else {
        return this.showMessageError("You must enter an email to share the project");
      }
    };

    ShareDialog.prototype.showMessageError = function(message) {
      return this.$(".message-error").css("display", "block").text(message);
    };

    return ShareDialog;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.RectangleAreaView = (function(_super) {
    __extends(RectangleAreaView, _super);

    function RectangleAreaView() {
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = RectangleAreaView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RectangleAreaView.prototype.template = JST['app/scripts/templates/visualizers/rectangle.hbs'];

    RectangleAreaView.prototype.viewWillRender = function() {
      this.values = [];
      return this.ids = [];
    };

    return RectangleAreaView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.SettingsDialog = (function(_super) {
    __extends(SettingsDialog, _super);

    function SettingsDialog() {
      this.saveChanges = __bind(this.saveChanges, this);
      this.showView = __bind(this.showView, this);
      this.handleClick = __bind(this.handleClick, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      this.render = __bind(this.render, this);
      _ref = SettingsDialog.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SettingsDialog.prototype.template = JST['app/scripts/templates/UI/dialogs/settingsDialog.hbs'];

    SettingsDialog.prototype.title = "Layout Settings";

    SettingsDialog.prototype.iconClass = "settings-icon";

    SettingsDialog.prototype.tabViews = {};

    SettingsDialog.prototype.width = 620;

    SettingsDialog.prototype.height = 650;

    SettingsDialog.prototype.render = function(at) {
      this.currentTabId = at || "layout";
      return SettingsDialog.__super__.render.call(this);
    };

    SettingsDialog.prototype.viewWillRender = function() {
      var _this = this;
      return this.buttons = {
        "Ok": {
          click: function() {
            _this.saveChanges();
            return _this.close();
          },
          text: 'OK',
          "class": 'ok-button'
        }
        /*
        "Cancel":
          click: ()=>
            @close()
          text: 'Cancel'
          class:'cancel-button'
        */

      };
    };

    SettingsDialog.prototype.viewDidRender = function() {
      this.$el.find(".settings-tab-btn").on("click", this.handleClick);
      this.tabViews["layout"] = new quadrigram.Views.LayoutSettings(new Backbone.Model);
      this.$el.find(".settings-container").append(this.tabViews["layout"].$el);
      this.tabViews["layout"].render();
      this.tabViews["pages"] = new quadrigram.Views.PagesSettings(new Backbone.Model);
      this.$el.find(".settings-container").append(this.tabViews["pages"].$el);
      this.tabViews["pages"].render();
      this.tabViews["style"] = new quadrigram.Views.StyleSettings(new Backbone.Model);
      this.tabViews["style"].render();
      this.$el.find(".settings-container").append(this.tabViews["style"].$el);
      this.tabViews["tooltip"] = new quadrigram.Views.TooltipSettings(new Backbone.Model);
      this.$el.find(".settings-container").append(this.tabViews["tooltip"].$el);
      this.tabViews["tooltip"].render();
      return this.showView(this.currentTabId);
    };

    SettingsDialog.prototype.viewWillRemove = function() {
      var v, _results;
      _results = [];
      for (v in this.tabViews) {
        _results.push(this.tabViews[v].remove());
      }
      return _results;
    };

    SettingsDialog.prototype.handleClick = function(e) {
      var tabId;
      tabId = $(e.target).attr("data-id");
      if (this.currentTabId !== tabId) {
        return this.showView(tabId);
      }
    };

    SettingsDialog.prototype.showView = function(tabId) {
      var tabView, tabViewKey, _ref1;
      _ref1 = this.tabViews;
      for (tabViewKey in _ref1) {
        tabView = _ref1[tabViewKey];
        tabView.$el.hide();
      }
      this.currentView = this.tabViews[tabId];
      if (this.currentView) {
        this.currentView.$el.show();
        this.currentView.showAsTab();
        this.currentTabId = tabId;
        this.$el.find(".settings-tab-btn").removeClass('current-tab');
        this.$el.find(".settings-tab-btn[data-id=" + tabId + "]").addClass('current-tab');
      }
      return this.refresh();
    };

    SettingsDialog.prototype.saveChanges = function() {
      this.$el.find("input").trigger("focusout");
      quadrigram.tracker.sendEvent({
        event_type: 304
      });
      quadrigram.router.dataModels.currentProject.set("layout-settings", this.tabViews["layout"].tempSettings);
      quadrigram.router.dataModels.currentProject.set("tooltip-settings", this.tabViews["tooltip"].tempSettings);
      return quadrigram.router.dataModels.currentProject.set("pages-settings", this.tabViews["pages"].tempSettings);
    };

    return SettingsDialog;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ToolsDragList = (function(_super) {
    __extends(ToolsDragList, _super);

    function ToolsDragList() {
      _ref = ToolsDragList.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ToolsDragList.prototype.template = JST['app/scripts/templates/UI/toolsDragList.hbs'];

    ToolsDragList.prototype.events = {
      "mousedown .visualizers-menu a": "downOnBtn"
    };

    return ToolsDragList;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ToolsDragTipList = (function(_super) {
    __extends(ToolsDragTipList, _super);

    function ToolsDragTipList() {
      this.createViz = __bind(this.createViz, this);
      this.clickOnBtn = __bind(this.clickOnBtn, this);
      this.onLeave = __bind(this.onLeave, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ToolsDragTipList.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ToolsDragTipList.prototype.template = JST['app/scripts/templates/UI/toolsDragTipList.hbs'];

    ToolsDragTipList.prototype.className = "tool-tooltip visualizers-menu";

    ToolsDragTipList.prototype.events = {
      "mousedown li .viz-drag-button": "downOnBtn",
      "mouseleave": "onLeave"
    };

    ToolsDragTipList.prototype.viewWillRender = function() {
      if (this.model.get("group") === "charts") {
        return this.templateData.dragOptions = [
          {
            "dataClass": "BarChart",
            "label": "Bar Chart",
            "icon": "chart_thumbnails/chart_thumbnails_bar-chart.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "LineChart",
            "label": "Line Chart",
            "icon": "chart_thumbnails/chart_thumbnails_line-chart.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "DonutChart",
            "label": "Donut Chart",
            "icon": "chart_thumbnails/chart_thumbnails_donut.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "LineAndBarChart",
            "label": "Line And Bar Chart",
            "icon": "chart_thumbnails/chart_thumbnails_line-barchart.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "ScatterPlot",
            "label": "Scatter Plot",
            "icon": "chart_thumbnails/chart_thumbnails_scatterplot.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "StackedAreaChart",
            "label": "Stacked Area Chart",
            "icon": "chart_thumbnails/chart_thumbnails_stacekd-area.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "StackedBarChart",
            "label": "Stacked Bar Chart",
            "icon": "chart_thumbnails/chart_thumbnails_stacked-bar-chart.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "GroupedBarChart",
            "label": "Grouped Bar Chart",
            "icon": "chart_thumbnails/chart_thumbnails_grouped-barchart.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "Histogram",
            "label": "Histogram",
            "icon": "chart_thumbnails/chart_thumbnails_histogram.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "PointsInAMap",
            "label": "Points In A Map",
            "icon": "chart_thumbnails/chart_thumbnails_points-in-map.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "HeatMap",
            "label": "Heat Map",
            "icon": "chart_thumbnails/chart_thumbnails_heatmap.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "TreeMap",
            "label": "Quadrification",
            "icon": "chart_thumbnails/chart_thumbnails_tree-map.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "NetworkVisualizer",
            "label": "Network",
            "icon": "chart_thumbnails/chart_thumbnails_network.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "RadialNetworkVisualizer",
            "label": "Radial Network",
            "icon": "chart_thumbnails/chart_thumbnails_radial-network.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "Deondogram",
            "label": "Deondogram",
            "icon": "chart_thumbnails/shapes_thumbnails_rectangle_normal.svg",
            "stateClass": "disabled"
          }, {
            "dataClass": "RadarChart",
            "label": "Radar Chart",
            "icon": "chart_thumbnails/chart_thumbnails_radar.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "ParalelCoords",
            "label": "Parallel Coordinates",
            "icon": "chart_thumbnails/chart_thumbnails_parallel-coordinates.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "PictoGram",
            "label": "Pictogram",
            "icon": "chart_thumbnails/chart_thumbnails_pictogram.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "MatrixChart",
            "label": "Matrix",
            "icon": "chart_thumbnails/chart_thumbnails_matrix-chart.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "Choropleth",
            "label": "Choropleth",
            "icon": "chart_thumbnails/chart_thumbnails_choropleth.svg",
            "stateClass": "enabled"
          }
        ];
      } else if (this.model.get("group") === "text") {
        return this.templateData.dragOptions = [
          {
            "dataClass": "Title112",
            "label": "Title 84pt",
            "icon": "text_thumbnails/Title112pt_Thmbnail.png"
          }, {
            "dataClass": "Title56",
            "label": "Title 56pt",
            "icon": "text_thumbnails/Title56pt_Thmbnail.png"
          }, {
            "dataClass": "Title45",
            "label": "Title 45pt",
            "icon": "text_thumbnails/Title45pt_Thmbnail.png"
          }, {
            "dataClass": "Subtitle36",
            "label": "Subtitle 36pt",
            "icon": "text_thumbnails/Subtitle34pt_Thmbnail.png"
          }, {
            "dataClass": "Subtitle24",
            "label": "Subtitle 24pt",
            "icon": "text_thumbnails/Subtitle24pt_Thmbnail.png"
          }, {
            "dataClass": "Quote18",
            "label": "Quote 18pt",
            "icon": "text_thumbnails/Quote18pt_Thmbnail.png"
          }, {
            "dataClass": "Body16",
            "label": "Body Text 16pt",
            "icon": "text_thumbnails/Bodytext_16pt_Thmbnail.png"
          }, {
            "dataClass": "Caption12",
            "label": "Caption 12pt",
            "icon": "text_thumbnails/Caption12pt_Thmbnail.png"
          }, {
            "dataClass": "Footnote12",
            "label": "Footnote 12pt",
            "icon": "text_thumbnails/Footnote_Thmbnail.png"
          }
        ];
      } else if (this.model.get("group") === "draw") {
        return this.templateData.dragOptions = [
          {
            "dataClass": "RectangleArea",
            "label": "Rectangle",
            "icon": "shape_thumbnails/shapes_thumbnails_rectangle.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "EllipseShape",
            "label": "Ellipse",
            "icon": "shape_thumbnails/shapes_thumbnails_ellipse.svg",
            "stateClass": "disabled"
          }, {
            "dataClass": "LineShape",
            "label": "Line",
            "icon": "shape_thumbnails/shapes_thumbnails_line.svg",
            "stateClass": "disabled"
          }, {
            "dataClass": "ArrowShape",
            "label": "Arrow",
            "icon": "shape_thumbnails/shapes_thumbnails_arrow.svg",
            "stateClass": "disabled"
          }
        ];
      } else if (this.model.get("group") === "media") {
        return this.templateData.dragOptions = [
          {
            "dataClass": "ImageControl",
            "label": "Image",
            "icon": "control_thumbnails/media_thumbnails_image.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "YoutubeControl",
            "label": "Video",
            "icon": "control_thumbnails/media_thumbnails_video.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "IFrameControl",
            "label": "IFrame",
            "icon": "control_thumbnails/media_thumbnails_iframe.svg",
            "stateClass": "enabled"
          }
        ];
      } else if (this.model.get("group") === "controls") {
        return this.templateData.dragOptions = [
          {
            "dataClass": "ListChart",
            "label": "List",
            "icon": "control_thumbnails/controls_thumbnails_list.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "DropDown",
            "label": "Dropdown",
            "icon": "control_thumbnails/controls_thumbnails_dropdown.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "LinkControl",
            "label": "Link",
            "icon": "control_thumbnails/controls_thumbnails_link.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "SliderControl",
            "label": "Slider",
            "icon": "control_thumbnails/controls_thumbnails_slider.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "RangeControl",
            "label": "Range selector",
            "icon": "control_thumbnails/controls_thumbnails_range-selector.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "PlayPauseControl",
            "label": "Animator",
            "icon": "control_thumbnails/controls_thumbnails_animator.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "DynamicTextControl",
            "label": "Dynamic text",
            "icon": "control_thumbnails/controls_thumbnails_dynamic-text.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "LegendControl",
            "label": "Legend",
            "icon": "control_thumbnails/controls_thumbnails_legend.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "ShareButtonsControl",
            "label": "Share buttons",
            "icon": "control_thumbnails/media_thumbnails_sharebuttons.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "PageNavControl",
            "label": "Page Navigator",
            "icon": "control_thumbnails/controls_thumbnails_page-navigator.svg",
            "stateClass": "enabled"
          }, {
            "dataClass": "ButtonControl",
            "label": "Button",
            "icon": "control_thumbnails/controls_thumbnails_button.svg",
            "stateClass": "enabled"
          }
        ];
      }
    };

    ToolsDragTipList.prototype.viewDidRender = function() {};

    ToolsDragTipList.prototype.downOnBtn = function(e) {
      var p0,
        _this = this;
      e.preventDefault();
      p0 = {
        "x": e.pageX,
        "y": e.pageY
      };
      this.$el.mousemove(function(em) {
        var d, p1;
        p1 = {
          "x": em.pageX,
          "y": em.pageY
        };
        d = Math.sqrt(Math.pow(p1.x - p0.x, 2) + Math.pow(p1.y - p0.y, 2));
        if (d > 5) {
          _this.$el.unbind("mousemove");
          _this.$el.unbind("mouseup");
          return _this.createViz(e, "float");
        }
      });
      return this.$el.mouseup(function() {
        _this.$el.unbind("mousemove");
        _this.$el.unbind("mouseup");
        return _this.createViz(e, "scroll");
      });
    };

    ToolsDragTipList.prototype.onLeave = function(ev) {
      return $(window).trigger("tools:leave");
    };

    ToolsDragTipList.prototype.clickOnBtn = function(e) {};

    ToolsDragTipList.prototype.createViz = function(e, addMode) {
      var chartName, options;
      options = {};
      options.iconPath = $(e.currentTarget).find("img").attr("src");
      options.initialPos = {
        "x": e.clientX,
        "y": e.clientY
      };
      if (this.model.get("group") !== "text") {
        chartName = $(e.currentTarget).attr("data-class");
        quadrigram.router.dataModels.currentProject.createVisualizer(chartName, addMode, options);
      } else if (this.model.get("group") === "text") {
        options.textType = $(e.currentTarget).attr("data-class");
        quadrigram.router.dataModels.currentProject.createVisualizer("TextArea", addMode, options);
      }
      return $(window).trigger("tools:leave");
    };

    return ToolsDragTipList;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.User = (function(_super) {
    __extends(User, _super);

    function User() {
      this.save = __bind(this.save, this);
      this.defaultErrorHandler = __bind(this.defaultErrorHandler, this);
      this.url = __bind(this.url, this);
      _ref = User.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    User.prototype.url = function() {
      quadrigram.router.performance.trackStep("Start Loading user", ["user", "load", "qdr"], {});
      return this.instanceUrl;
    };

    User.prototype.initialize = function() {
      this.bind("error", this.defaultErrorHandler);
      return this.instanceUrl = quadrigram.baseUrl + "rs/user/profile";
    };

    User.prototype.defaults = {};

    User.prototype.defaultErrorHandler = function(model, error) {
      if (error.status === 401 || error.status === 403 || error.status === 500 || error.status === 503) {
        window.location.href = quadrigram.webUrl;
      }
      if (error.status === 423) {
        return quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
          message: 2,
          type: 1,
          priority: 1,
          timeout: 0,
          mode: 0,
          "class": "userError"
        });
      }
    };

    User.prototype.validate = function(attrs, options) {};

    User.prototype.parse = function(response, options) {
      var content;
      if (response.code === 200) {
        quadrigram.router.performance.trackStep("user loaded", ["user", "load", "qdr"], {});
        content = response.body;
      } else {
        if (response.code === 423) {
          quadrigram.router.appViews.loaderView.trigger("loaderMessage", {
            message: 2,
            type: 1,
            priority: 1,
            timeout: 0,
            mode: 0,
            "class": "userError"
          });
        } else {
          elog("El usuario no est autentificado");
          window.location.href = quadrigram.webUrl;
        }
      }
      return content;
    };

    User.prototype.save = function(attrs, options) {
      options || (options = {});
      options.contentType = "application/json";
      options.data = JSON.stringify(this.toJSON());
      return Backbone.Model.prototype.save.call(this, attrs, options);
    };

    return User;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.Achievements = (function(_super) {
    __extends(Achievements, _super);

    function Achievements() {
      this.errorSaving = __bind(this.errorSaving, this);
      this.saved = __bind(this.saved, this);
      this.parse = __bind(this.parse, this);
      this.save = __bind(this.save, this);
      this.getNotificationState = __bind(this.getNotificationState, this);
      this.toggleNotifications = __bind(this.toggleNotifications, this);
      this.checkAndStore = __bind(this.checkAndStore, this);
      this.checkAutoOpen = __bind(this.checkAutoOpen, this);
      this.checkCompleted = __bind(this.checkCompleted, this);
      this.clearAll = __bind(this.clearAll, this);
      this.url = __bind(this.url, this);
      _ref = Achievements.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    Achievements.prototype.url = function() {
      return quadrigram.baseUrl + "rs/user/achievements";
    };

    Achievements.prototype.initialize = function() {};

    Achievements.prototype.clearAll = function() {
      this.set("completedAchievements", []);
      return this.save();
    };

    Achievements.prototype.checkCompleted = function(id) {
      if (this.get("completedAchievements") && _.findWhere(this.get("completedAchievements"), {
        "id": id
      })) {
        return true;
      }
      return false;
    };

    Achievements.prototype.checkAutoOpen = function(adef) {
      if ((this.get("completedAchievements") == null) || this.get("completedAchievements").length === 0) {
        return true;
      } else {
        return false;
      }
    };

    Achievements.prototype.checkAndStore = function(adef) {
      var shouldNotify;
      if (!this.get("completedAchievements")) {
        this.set("completedAchievements", []);
      }
      if (this.get("notificationsEnabled") == null) {
        this.set("notificationsEnabled", true);
      }
      if (_.findWhere(this.get("completedAchievements"), {
        "id": adef.id
      }) == null) {
        this.get("completedAchievements").push({
          id: adef.id,
          timeStamp: Date.now()
        });
        shouldNotify = true;
      } else {
        shouldNotify = false;
      }
      this.save();
      return shouldNotify && this.get("notificationsEnabled");
    };

    Achievements.prototype.toggleNotifications = function(value) {
      if (this.get("notificationsEnabled") == null) {
        this.set("notificationsEnabled", true);
      }
      if (value == null) {
        value = !this.get("notificationsEnabled");
      }
      this.set("notificationsEnabled", value);
      this.save();
      return value;
    };

    Achievements.prototype.getNotificationState = function() {
      return this.get("notificationsEnabled");
    };

    Achievements.prototype.save = function(attrs, options) {
      options || (options = {});
      options.success = this.saved;
      options.error = this.errorSaving;
      options.data = JSON.stringify(this.toJSON());
      options.contentType = 'application/json';
      return Backbone.Model.prototype.save.call(this, attrs, options);
    };

    Achievements.prototype.parse = function(data) {
      if ((data.code != null) && data.code !== 200) {
        return this.retryErrorHandler(data);
      } else {
        return data.body;
      }
    };

    Achievements.prototype.saved = function() {};

    Achievements.prototype.errorSaving = function() {};

    return Achievements;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ExpressionPart = (function(_super) {
    __extends(ExpressionPart, _super);

    function ExpressionPart() {
      _ref = ExpressionPart.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExpressionPart.prototype.undoableEvents = ["change:selected"];

    ExpressionPart.prototype.bubblingEvents = ["change:selected"];

    return ExpressionPart;

  })(quadrigram.Models.QModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Collections.ExpressionPartCollection = (function(_super) {
    __extends(ExpressionPartCollection, _super);

    function ExpressionPartCollection() {
      this.add = __bind(this.add, this);
      this.initialize = __bind(this.initialize, this);
      _ref = ExpressionPartCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExpressionPartCollection.prototype.model = quadrigram.Models.ExpressionPart;

    ExpressionPartCollection.prototype.initialize = function(options) {};

    ExpressionPartCollection.prototype.add = function(model) {
      return ExpressionPartCollection.__super__.add.apply(this, arguments);
    };

    return ExpressionPartCollection;

  })(Backbone.Collection);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ExpressionPartView = (function(_super) {
    __extends(ExpressionPartView, _super);

    function ExpressionPartView() {
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = ExpressionPartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExpressionPartView.prototype.template = JST['app/scripts/templates/blocks/operators/expressionPart.hbs'];

    ExpressionPartView.prototype.optionTemplate = JST['app/scripts/templates/blocks/operators/operatorOptions.hbs'];

    ExpressionPartView.prototype.className = "expression-part";

    ExpressionPartView.prototype.viewDidRender = function() {
      var escapedOptId, part,
        _this = this;
      part = this.model;
      this.$el.empty();
      if (part.get("type") === "slot") {
        this.slotView = new quadrigram.Views.SlotView({
          model: part.get("ownerOperator").get("slotsCollection").where({
            "slotId": part.get("partId")
          })[0],
          binding: false
        });
        this.slotView.functionAvailable = false;
        this.slotView.render();
        return this.$el.append(this.slotView.el);
      } else if (part.get("type") === "label") {
        return this.$el.append('<span class="operation-name">' + part.get("label") + '</span>');
      } else if (part.get("type") === "dynamic" && !part.get("hidden")) {
        this.optionSelector = $($.parseHTML(this.optionTemplate(part.toJSON())));
        this.$el.append(this.optionSelector);
        if (part.get("options").length > 0 && (part.get("selected") != null)) {
          escapedOptId = part.get("selected").optId.replace("'", "\\'");
          this.optionSelector.find("option[data-opt-id='" + escapedOptId + "']").attr("selected", "selected");
        }
        this.$el.find("select").selectmenu({
          width: 100,
          change: function(e, ui) {
            var selectedOption;
            selectedOption = $.grep(part.get("options"), function(o) {
              return o.optId === ui.item.element.attr("data-opt-id");
            })[0];
            return part.get("ownerOperator").changeExpressionPart(ui.item.element.closest("select").attr("data-id"), selectedOption);
          }
        });
        return this.$el.find(".ui-selectmenu-button").addClass("expression-part-selector");
      }
    };

    ExpressionPartView.prototype.viewWillRemove = function() {
      if (this.slotView) {
        this.slotView.remove();
      }
      if (this.optionSelector) {
        return this.optionSelector.off("change");
      }
    };

    return ExpressionPartView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ExpressionPartCollectionView = (function(_super) {
    __extends(ExpressionPartCollectionView, _super);

    function ExpressionPartCollectionView() {
      this.updateButton = __bind(this.updateButton, this);
      this.elementViewDidRender = __bind(this.elementViewDidRender, this);
      this.handleKeyUp = __bind(this.handleKeyUp, this);
      this.handleKeyDown = __bind(this.handleKeyDown, this);
      this.specialHandler = __bind(this.specialHandler, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = ExpressionPartCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExpressionPartCollectionView.prototype.template = JST['app/scripts/templates/blocks/operators/expressionPartCollection.hbs'];

    ExpressionPartCollectionView.prototype.modelView = quadrigram.Views.ExpressionPartView;

    ExpressionPartCollectionView.prototype.bindModelViews = true;

    ExpressionPartCollectionView.prototype.addButtonTemplate = JST['app/scripts/templates/blocks/operators/addLoopButton.hbs'];

    ExpressionPartCollectionView.prototype.className = "expression-collection";

    ExpressionPartCollectionView.prototype.viewDidRender = function() {
      var operator;
      this.updateButton();
      if (this.model.get("operator").getOperationClass().updateExternalOptions != null) {
        operator = this.model.get("operator");
        operator.getOperationClass().updateExternalOptions(operator.get("currentExpression"), operator.get("slotsCollection"));
        return operator.getOperationClass().addSpecialListener(this.specialHandler);
      }
    };

    ExpressionPartCollectionView.prototype.viewWillRemove = function() {
      var operator;
      operator = this.model.get("operator");
      if (this.model.get("operator").getOperationClass().removeSpecialListener != null) {
        return operator.getOperationClass().removeSpecialListener(this.specialHandler);
      }
    };

    ExpressionPartCollectionView.prototype.specialHandler = function() {
      var operator;
      operator = this.model.get("operator");
      return operator.getOperationClass().updateExternalOptions(operator.get("currentExpression"), operator.get("slotsCollection"));
    };

    ExpressionPartCollectionView.prototype.handleKeyDown = function(e) {
      if (event.shiftKey) {
        if (this.model.get("operator").hasLoopGroup()) {
          log("shift pressed");
          return this.$el.find(".add-more").addClass("remove-state");
        }
      }
    };

    ExpressionPartCollectionView.prototype.handleKeyUp = function(e) {
      if (event.shiftKey) {
        log("shift unpressed");
      }
      return this.$el.find(".add-more").removeClass("remove-state");
    };

    ExpressionPartCollectionView.prototype.elementViewDidRender = function() {
      return this.updateButton();
    };

    ExpressionPartCollectionView.prototype.updateButton = function() {
      var _this = this;
      if (this.model.get("operator").getOperationClass().loopGroup) {
        if (!this.addButton) {
          this.addButton = $(this.addButtonTemplate());
          this.addButton.on("click", function() {
            if (_this.addButton.find(".add-more").hasClass("remove-state")) {
              return _this.model.get("operator").removeLoopGroup();
            } else {
              return _this.model.get("operator").addLoopGroup();
            }
          });
        }
        return this.$el.append(this.addButton);
      } else {
        if (this.addButton) {
          return this.addButton.detach();
        }
      }
    };

    return ExpressionPartCollectionView;

  })(Backbone.CollectionView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RectangleAreaModel = (function(_super) {
    __extends(RectangleAreaModel, _super);

    function RectangleAreaModel() {
      _ref = RectangleAreaModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RectangleAreaModel.behaviors = ["quadrigram.Models.LayoutBehavior"];

    RectangleAreaModel.meta = {
      "name": "Rectangle",
      "properties": {}
    };

    RectangleAreaModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(RectangleAreaModel.meta, RectangleAreaModel.behaviors);
      return output;
    };

    return RectangleAreaModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TreeMapModel = (function(_super) {
    __extends(TreeMapModel, _super);

    function TreeMapModel() {
      _ref = TreeMapModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TreeMapModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.OneDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.SvgBehavior", "quadrigram.Models.TooltipBehavior", "quadrigram.Models.TextStyleBehavior"];

    TreeMapModel.meta = {
      "name": "TreeMap",
      "properties": {
        "sortByValue": {
          "label": "Sort by values",
          "family": "data",
          "sortingWeight": "2",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Descending"
              },
              "options": {
                "value": ["Descending", "Ascending"]
              }
            }
          }
        },
        "data": {
          "uiTipContent": "Insert a list of numbers to represent as rectangles",
          "label": "Area of each rectangle",
          "family": "data",
          "sortingWeight": "1",
          "requireMeta": true,
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Region 1",
                    "value": 50
                  }, {
                    "id": "Region 2",
                    "value": 10
                  }, {
                    "id": "Region 3",
                    "value": 10
                  }, {
                    "id": "Region 4",
                    "value": 20
                  }, {
                    "id": "Region 5",
                    "value": 30
                  }, {
                    "id": "Region 6",
                    "value": 40
                  }, {
                    "id": "Region 7",
                    "value": 50
                  }, {
                    "id": "Region 8",
                    "value": 60
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each rectangle",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            }
          }
        },
        "fillOpacities": {
          "label": "Fill opacity of each rectangle",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each rectangle",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#FFFFFF"
              }
            }
          }
        },
        "lineThickness": {
          "label": "Outline thickness of each rectangle",
          "formats": {
            "Px": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "1px"
              }
            }
          }
        },
        "selectionLineThickness": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "2px"
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Outline opacity of each rectangle",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "squareness": {
          "uiTipContent": "Defines the items shape: rectangles, rows or columns",
          "label": "Shapes",
          "family": "style",
          "sortingWeight": "27",
          "hidden": true,
          "formats": {
            "Options": {
              "options": {
                "value": ["Rectangles", "Rows", "Columns"]
              },
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Rectangles"
              }
            }
          }
        },
        "marginItems": {
          "uiTipContent": "Defines the margin between rectangles",
          "label": "Margins",
          "family": "style",
          "sortingWeight": "28",
          "hidden": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "0px"
              }
            }
          }
        },
        "roundedCorners": {
          "uiTipContent": "Defines the radius of the corner",
          "label": "Corners",
          "family": "style",
          "sortingWeight": "29",
          "hidden": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "0px"
              }
            }
          }
        },
        "textMode": {
          "label": "Labels",
          "uiTipContent": "Defines how to show labels on each box",
          "family": "style",
          "sortingWeight": "30",
          "hidden": true,
          "formats": {
            "Options": {
              "options": {
                "value": ["Hidden", "Normal"]
              },
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Normal"
              }
            }
          }
        },
        "transitionMode": {
          "label": "Transition algorithm",
          "uiTipContent": "Choose between a geometric transition or a data interpolation",
          "family": "style",
          "sortingWeight": "999",
          "hidden": true,
          "internal": true,
          "formats": {
            "Options": {
              "options": {
                "value": ["Geometric", "Data interpolation"]
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Data interpolation"
              }
            }
          }
        },
        textColors: {
          label: "Text color of each rectangle",
          uiTipContent: "Text color of each rectangle",
          sortingWeight: "31",
          "deprecated": true,
          family: "style",
          hidden: true,
          formats: {
            Color: {
              multiValues: {
                value: true
              },
              defaults: {
                value: "#FFFFFF"
              }
            }
          }
        },
        textAlign: {
          label: "Text align",
          family: "textstyles",
          hidden: true,
          sortingWeight: "30",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "center"
              },
              options: {
                value: ["left", "center", "right"]
              }
            }
          }
        },
        textColor: {
          label: "Text color",
          family: "textstyles",
          hidden: false,
          sortingWeight: "26",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#fff"
              }
            }
          }
        },
        textSize: {
          label: "Font size",
          family: "textstyles",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Px: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "20px"
              }
            }
          }
        },
        vAlign: {
          label: "Vertical align",
          family: "textstyles",
          hidden: true,
          sortingWeight: "40",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "middle"
              },
              options: {
                value: ["top", "middle", "bottom"]
              }
            }
          }
        }
      }
    };

    TreeMapModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TreeMapModel.meta, TreeMapModel.behaviors);
      return output;
    };

    return TreeMapModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PointsInAMapModel = (function(_super) {
    __extends(PointsInAMapModel, _super);

    function PointsInAMapModel() {
      _ref = PointsInAMapModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PointsInAMapModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.PlacesDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SVGShapesBehavior", "quadrigram.Models.CirclesBehavior", "quadrigram.Models.MapBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.MapTooltipBehavior"];

    PointsInAMapModel.meta = {
      "name": "PointsInAMap",
      "properties": {
        "places": {
          "uiTipContent": "Insert a list of latitudes and a list of longitudes to represent theese cordinates in the map",
          "sortingWeight": "1",
          "label": "Places",
          "family": "data",
          "hidden": false,
          "formats": {
            "Place": {
              "multiValues": {
                "lat": true,
                "lon": true
              },
              "defaults": {
                "lon": [
                  {
                    "id": "Barcelona",
                    "value": 2.1833
                  }, {
                    "id": "Paris",
                    "value": 2.3508
                  }, {
                    "id": "London",
                    "value": 0.1275
                  }, {
                    "id": "Rome",
                    "value": 12.5000
                  }
                ],
                "lat": [
                  {
                    "id": "Barcelona",
                    "value": 41.3833
                  }, {
                    "id": "Paris",
                    "value": 48.8567
                  }, {
                    "id": "London",
                    "value": 51.5072
                  }, {
                    "id": "Rome",
                    "value": 41.9000
                  }
                ]
              }
            },
            "PlaceUTM": {
              "multiValues": {
                "utmx": true,
                "utmy": true,
                "utmzone": true,
                "hemisphere": true
              },
              "options": {
                "hemisphere": ["S", "N"]
              },
              "defaults": {
                "utmx": [
                  {
                    "id": "Barcelona",
                    "value": 431713.4
                  }, {
                    "id": "Paris",
                    "value": 452379.9
                  }, {
                    "id": "London",
                    "value": 300662.1
                  }, {
                    "id": "Rome",
                    "value": 292624.9
                  }
                ],
                "utmy": [
                  {
                    "id": "Barcelona",
                    "value": 4581630.2
                  }, {
                    "id": "Paris",
                    "value": 5411729.2
                  }, {
                    "id": "London",
                    "value": 5710142.3
                  }, {
                    "id": "Rome",
                    "value": 4641695.9
                  }
                ],
                "utmzone": [
                  {
                    "id": "Barcelona",
                    "value": 31
                  }, {
                    "id": "Paris",
                    "value": 31
                  }, {
                    "id": "London",
                    "value": 31
                  }, {
                    "id": "Rome",
                    "value": 33
                  }
                ]
              }
            }
          }
        },
        "values": {
          "uiTipContent": "Insert a list of values that will determine the size of each point",
          "label": "Point sizes",
          "family": "data",
          "sortingWeight": "3",
          "hidden": false,
          "formats": {
            "PxByValues": {
              "defaultsNames": {
                "values": "Dummy radius"
              },
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "min": 5,
                "max": 10,
                "values": 10
              }
            },
            "PxByValuesAndDomain": {
              "defaultsNames": {
                "values": "Dummy radius"
              },
              "multiValues": {
                "values": true,
                "min": false,
                "max": false,
                "minValues": false,
                "maxValues": false
              },
              "defaults": {
                "min": 5,
                "max": 10,
                "minValues": 0,
                "maxValues": "",
                "values": 10
              }
            }
          }
        },
        "labels": {
          "uiTipContent": "Insert a list of texts that will determine the name of each point",
          "label": "Items Labels",
          "family": "data",
          "sortingWeight": "4",
          "hidden": false,
          "internal": true,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": "Barcelona"
                  }, {
                    "id": "2",
                    "value": "Paris"
                  }, {
                    "id": "3",
                    "value": "London"
                  }, {
                    "id": "4",
                    "value": "Rome"
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each point",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            },
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    id: "0",
                    value: "#8D91B9"
                  }, {
                    id: "1",
                    value: "#989FC9"
                  }, {
                    id: "2",
                    value: "#CFD4EB"
                  }, {
                    id: "3",
                    value: "#8D91B9"
                  }
                ]
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each point",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#FFFFFF"
              }
            }
          }
        },
        "bkg_color": {
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#d9d9d9"
              }
            }
          }
        },
        "shapeType": {
          "label": "Shape of each point",
          "sortingWeight": 0
        },
        "shapeSize": {
          "internal": true
        }
      }
    };

    PointsInAMapModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(PointsInAMapModel.meta, PointsInAMapModel.behaviors);
      return output;
    };

    return PointsInAMapModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.StackedBarChartModel = (function(_super) {
    __extends(StackedBarChartModel, _super);

    function StackedBarChartModel() {
      _ref = StackedBarChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    StackedBarChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TwoDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.XAndYAxisBehavior", "quadrigram.Models.StackedTooltipBehavior"];

    StackedBarChartModel.meta = {
      "name": "StackedBarChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a block with columns of numbers. Each column (or row) will be represented as a stacked bar",
          "label": "Data to plot in bar",
          "sortingWeight": "0",
          "family": "data",
          "requireMeta": true,
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "Item 1",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 20
                      }, {
                        "id": "Day 2",
                        "value": 12
                      }, {
                        "id": "Day 3",
                        "value": 20
                      }, {
                        "id": "Day 4",
                        "value": 40
                      }, {
                        "id": "Day 5",
                        "value": 30
                      }, {
                        "id": "Day 6",
                        "value": 25
                      }, {
                        "id": "Day 7",
                        "value": 12
                      }, {
                        "id": "Day 8",
                        "value": 22
                      }
                    ]
                  }, {
                    "id": "Item 2",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 20
                      }, {
                        "id": "Day 2",
                        "value": 10
                      }, {
                        "id": "Day 3",
                        "value": 15
                      }, {
                        "id": "Day 4",
                        "value": 30
                      }, {
                        "id": "Day 5",
                        "value": 20
                      }, {
                        "id": "Day 6",
                        "value": 50
                      }, {
                        "id": "Day 7",
                        "value": 50
                      }, {
                        "id": "Day 8",
                        "value": 60
                      }
                    ]
                  }, {
                    "id": "Item 3",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Day 1",
                        "value": 10
                      }, {
                        "id": "Day 2",
                        "value": 20
                      }, {
                        "id": "Day 3",
                        "value": 25
                      }, {
                        "id": "Day 4",
                        "value": 30
                      }, {
                        "id": "Day 5",
                        "value": 30
                      }, {
                        "id": "Day 6",
                        "value": 45
                      }, {
                        "id": "Day 7",
                        "value": 52
                      }, {
                        "id": "Day 8",
                        "value": 32
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each area",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(255,82,82),   rgb(128,137,124) 16.67%, rgb(0,191,165) 33.33%,  rgb(127,204,109) 50%,   rgb(253,216,53) 66.67%,  rgb(127,181,144) 83.33%, rgb(0,145,234) 100%)"
              }
            },
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    id: "0",
                    value: "#8D91BC"
                  }, {
                    id: "1",
                    value: "#989FCC"
                  }, {
                    id: "2",
                    value: "#CFD4EC"
                  }
                ]
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Line opacity of each bar",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "0"
              }
            }
          }
        },
        "selectionLineThickness": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "1px"
              }
            }
          }
        },
        "IdsOnAxis": {
          "label": "Direction of the bars",
          "family": "axis",
          "sortingWeight": "10",
          "hidden": false,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Vertical"
              },
              "options": {
                "value": ["Vertical", "Horizontal"]
              }
            }
          }
        },
        "gapBetweenBars": {
          "label": "Gap between bars",
          "family": "style",
          "sortingWeight": "29",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "10"
              }
            }
          }
        },
        "dimensionAsItems": {
          "sortingWeight": "99",
          "uiTipContent": "Determines if each item (bar color) is a row or a column of the input table"
        },
        axisXRange: {
          internal: true
        },
        "dataGaps": {
          "internal": true,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "true"
              }
            }
          }
        }
      }
    };

    StackedBarChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(StackedBarChartModel.meta, StackedBarChartModel.behaviors);
      return output;
    };

    return StackedBarChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.GroupedBarChartModel = (function(_super) {
    __extends(GroupedBarChartModel, _super);

    function GroupedBarChartModel() {
      _ref = GroupedBarChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    GroupedBarChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TwoDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.XAndYAxisBehavior", "quadrigram.Models.StackedTooltipBehavior"];

    GroupedBarChartModel.meta = {
      name: "GroupedBarChart",
      properties: {
        data: {
          uiTipContent: "Insert a block with columns of numbers. Each column (or row) will be represented as a bar and will be grouped together.",
          label: "Data to plot in grouped bars",
          family: "data",
          requireMeta: true,
          sortingWeight: "0",
          hidden: false,
          formats: {
            Number: {
              multiValues: {
                value: true
              },
              defaultsNames: {
                value: "Example data"
              },
              defaults: {
                value: [
                  {
                    "id": "Item 1",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Group 1",
                        "value": 15
                      }, {
                        "id": "Group 2",
                        "value": 12
                      }, {
                        "id": "Group 3",
                        "value": 20
                      }, {
                        "id": "Group 4",
                        "value": 40
                      }, {
                        "id": "Group 5",
                        "value": 15
                      }
                    ]
                  }, {
                    "id": "Item 2",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Group 1",
                        "value": 20
                      }, {
                        "id": "Group 2",
                        "value": 10
                      }, {
                        "id": "Group 3",
                        "value": 15
                      }, {
                        "id": "Group 4",
                        "value": 14
                      }, {
                        "id": "Group 5",
                        "value": 20
                      }
                    ]
                  }, {
                    "id": "Item 3",
                    "name": "dummy data",
                    "value": [
                      {
                        "id": "Group 1",
                        "value": 10
                      }, {
                        "id": "Group 2",
                        "value": 20
                      }, {
                        "id": "Group 3",
                        "value": 25
                      }, {
                        "id": "Group 4",
                        "value": 30
                      }, {
                        "id": "Group 5",
                        "value": 30
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        IdsOnAxis: {
          label: "Direction of the bars",
          family: "axis",
          sortingWeight: "10",
          hidden: false,
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Vertical"
              },
              options: {
                value: ["Vertical", "Horizontal"]
              }
            }
          }
        },
        fillColors: {
          label: "Fill colors of each area",
          formats: {
            ColorsByScale: {
              multiValues: {
                value: true
              },
              defaults: {
                value: "linear-gradient(90deg, rgb(255,82,82),   rgb(128,137,124) 16.67%, rgb(0,191,165) 33.33%,  rgb(127,204,109) 50%,   rgb(253,216,53) 66.67%,  rgb(127,181,144) 83.33%, rgb(0,145,234) 100%)"
              }
            },
            Color: {
              multiValues: {
                value: true
              },
              defaults: {
                value: [
                  {
                    id: 0,
                    value: "8D91BC"
                  }, {
                    id: 1,
                    value: "989FCC"
                  }, {
                    id: 2,
                    value: "CFD4EC"
                  }
                ]
              }
            }
          }
        },
        lineOpacities: {
          label: "Line opacity of each bar",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 0
              }
            }
          }
        },
        selectionLineThickness: {
          formats: {
            Number: {
              defaults: {
                value: "1px"
              }
            }
          }
        },
        gapBetweenGroups: {
          deprecated: true,
          label: "Gap between bar groups",
          family: "style",
          sortingWeight: "29",
          hidden: true,
          formats: {
            Percentage: {
              multiValues: {
                value: true
              },
              defaults: {
                value: 10
              }
            }
          }
        },
        gapBetweenBars: {
          label: "Gap between bar groups",
          family: "style",
          sortingWeight: "29",
          hidden: true,
          formats: {
            Percentage: {
              multiValues: {
                value: true
              },
              defaults: {
                value: 10
              }
            }
          }
        },
        "dimensionAsItems": {
          "uiTipContent": "Determines if each item (same colored bars) is a row or a column of the input table",
          "sortingWeight": "99"
        },
        axisXRange: {
          internal: true
        }
      }
    };

    GroupedBarChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(GroupedBarChartModel.meta, GroupedBarChartModel.behaviors);
      return output;
    };

    return GroupedBarChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PieChartModel = (function(_super) {
    __extends(PieChartModel, _super);

    function PieChartModel() {
      _ref = PieChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PieChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.OneDimDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.SvgBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.TooltipBehavior"];

    PieChartModel.meta = {
      "name": "PieChart",
      "properties": {
        "data": {
          "uiTipContent": "Insert a list of numbers to represent as sectors",
          "label": "Size of each sector",
          "family": "data",
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": 1,
                    "value": 50
                  }, {
                    "id": 2,
                    "value": 10
                  }, {
                    "id": 3,
                    "value": 10
                  }, {
                    "id": 4,
                    "value": 20
                  }, {
                    "id": 5,
                    "value": 30
                  }, {
                    "id": 6,
                    "value": 40
                  }, {
                    "id": 7,
                    "value": 50
                  }, {
                    "id": 8,
                    "value": 60
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each sector",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    id: "0",
                    value: "#91BDDD"
                  }, {
                    id: "1",
                    value: "#3B4D5F"
                  }, {
                    id: "2",
                    value: "#29A089"
                  }, {
                    id: "3",
                    value: "#9154A2"
                  }, {
                    id: "4",
                    value: "#F1CA2D"
                  }, {
                    id: "5",
                    value: "#3D88BA"
                  }, {
                    id: "6",
                    value: "#E58C3B"
                  }, {
                    id: "7",
                    value: "#9EC39C"
                  }, {
                    id: "8",
                    value: "#C14C3E"
                  }
                ]
              }
            }
          }
        },
        "fillOpacities": {
          "label": "Fill opacity of each sector",
          "formats": {
            "multiValues": {
              "value": true
            },
            "Percentage": {
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each sector",
          "formats": {
            "multiValues": {
              "value": true
            },
            "Number": {
              "defaults": {
                "value": "#FFFFFF"
              }
            }
          }
        },
        "lineThickness": {
          "label": "Outline thickness of each sector",
          "formats": {
            "multiValues": {
              "value": true
            },
            "Number": {
              "defaults": {
                "value": "1px"
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Outline opacity of each sector",
          "formats": {
            "multiValues": {
              "value": true
            },
            "Percentage": {
              "defaults": {
                "value": "100"
              }
            }
          }
        }
      }
    };

    PieChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(PieChartModel.meta, PieChartModel.behaviors);
      return output;
    };

    return PieChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ScatterPlotModel = (function(_super) {
    __extends(ScatterPlotModel, _super);

    function ScatterPlotModel() {
      _ref = ScatterPlotModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ScatterPlotModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.ScatterDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.SVGShapesBehavior", "quadrigram.Models.CirclesBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.ZoomableXAndYAxisBehavior", "quadrigram.Models.TooltipBehavior"];

    ScatterPlotModel.meta = {
      "name": "ScatterPlot",
      "properties": {
        "dataXAxis": {
          "uiTipContent": "Insert a list of numbers that will determine the X coordinate of each point",
          "label": "Values at X Axis",
          "family": "data",
          "hidden": false,
          "sortingWeight": "1",
          "requireMeta": true,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example data X"
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": 50
                  }, {
                    "id": "2",
                    "value": 10
                  }, {
                    "id": "3",
                    "value": 10
                  }, {
                    "id": "4",
                    "value": 20
                  }, {
                    "id": "5",
                    "value": 30
                  }, {
                    "id": "6",
                    "value": 40
                  }, {
                    "id": "7",
                    "value": 50
                  }, {
                    "id": "8",
                    "value": 60
                  }
                ]
              }
            }
          }
        },
        "dataYAxis": {
          "uiTipContent": "Insert a list of numbers that will determine the Y coordinate of each point",
          "label": "Values at Y Axis",
          "family": "data",
          "hidden": false,
          "sortingWeight": "2",
          "requireMeta": true,
          "formats": {
            "Number": {
              "defaultsNames": {
                "value": "Example data Y"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": 20
                  }, {
                    "id": "2",
                    "value": 30
                  }, {
                    "id": "3",
                    "value": 40
                  }, {
                    "id": "4",
                    "value": 60
                  }, {
                    "id": "5",
                    "value": 20
                  }, {
                    "id": "6",
                    "value": 80
                  }, {
                    "id": "7",
                    "value": 30
                  }, {
                    "id": "8",
                    "value": 20
                  }
                ]
              }
            }
          }
        },
        "dataRadius": {
          "uiTipContent": "Insert a list of numbers that will determine the radius of each point",
          "label": "Values as Radius of each dot",
          "family": "data",
          "hidden": false,
          "sortingWeight": "3",
          "formats": {
            "PxByValues": {
              "defaultsNames": {
                "values": "Example data radius"
              },
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "min": 5,
                "max": 10,
                "values": [
                  {
                    "id": "1",
                    "value": 10
                  }, {
                    "id": "2",
                    "value": 60
                  }, {
                    "id": "3",
                    "value": 20
                  }, {
                    "id": "4",
                    "value": 30
                  }, {
                    "id": "5",
                    "value": 40
                  }, {
                    "id": "6",
                    "value": 10
                  }, {
                    "id": "7",
                    "value": 70
                  }, {
                    "id": "8",
                    "value": 30
                  }
                ]
              }
            },
            "PxByValuesAndDomain": {
              "defaultsNames": {
                "values": "Dummy radius"
              },
              "multiValues": {
                "values": true,
                "min": false,
                "minValues": false,
                "maxValues": false
              },
              "defaults": {
                "min": 5,
                "max": 10,
                "minValues": 0,
                "maxValues": "",
                "values": [
                  {
                    "id": "1",
                    "value": 10
                  }, {
                    "id": "2",
                    "value": 60
                  }, {
                    "id": "3",
                    "value": 20
                  }, {
                    "id": "4",
                    "value": 30
                  }, {
                    "id": "5",
                    "value": 40
                  }, {
                    "id": "6",
                    "value": 10
                  }, {
                    "id": "7",
                    "value": 70
                  }, {
                    "id": "8",
                    "value": 30
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each point",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            },
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#989FCC"
              }
            }
          }
        },
        "fillOpacities": {
          "label": "Fill opacity of each point",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each point",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#ffffff"
              }
            }
          }
        },
        "lineThickness": {
          "label": "Outline thickness of each point",
          "formats": {
            "Px": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "2px"
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Outline opacity of each point",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "tooltipValue": {
          "target": "xValue",
          "label": "Tooltip's X Value"
        },
        "axisLabels": {
          "internal": true
        },
        "tooltipValueY": {
          "target": "yValue",
          "label": "Tooltip's Y Value",
          "role": "value",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "PrefixSufix": {
              "multiValues": {
                "prefix": false,
                "sufix": false
              },
              "defaults": {
                "label": "",
                "prefix": "",
                "sufix": ""
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipValueRadius": {
          "target": "radiusValue",
          "label": "Tooltip's Radius Value",
          "role": "value",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "PrefixSufix": {
              "multiValues": {
                "prefix": false,
                "sufix": false
              },
              "defaults": {
                "label": "",
                "prefix": "",
                "sufix": ""
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "zoom": {
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "X and Y"
              },
              "options": {
                "value": ["X and Y", "Only X", "Only Y", "None"]
              }
            }
          }
        },
        "shapeType": {
          "label": "Shape of each point",
          "sortingWeight": 0
        },
        "shapeSize": {
          "internal": true
        }
      }
    };

    ScatterPlotModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ScatterPlotModel.meta, ScatterPlotModel.behaviors);
      return output;
    };

    return ScatterPlotModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.NetworkVisualizerModel = (function(_super) {
    __extends(NetworkVisualizerModel, _super);

    function NetworkVisualizerModel() {
      _ref = NetworkVisualizerModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    NetworkVisualizerModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.SvgBehavior", "quadrigram.Models.NetworkDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.SVGShapesBehavior", "quadrigram.Models.CirclesBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.RelationsBehavior", "quadrigram.Models.SelectionSVGBehavior", "quadrigram.Models.SelectionNetworkBehavior", "quadrigram.Models.ZoomableBehavior", "quadrigram.Models.NetworkTooltipBehavior"];

    NetworkVisualizerModel.meta = {
      "name": "Network",
      "properties": {
        "network": {
          "uiTipContent": "Insert a list of nodes and a its relations",
          "sortingWeight": "1",
          "label": "Network",
          "family": "data",
          "hidden": false,
          "formats": {
            "Network": {
              "multiValues": {
                "nodes": true,
                "relations": true
              },
              "defaults": {
                "nodes": [
                  {
                    "id": 1,
                    "value": "Node 1"
                  }, {
                    "id": 2,
                    "value": "Node 2"
                  }, {
                    "id": 3,
                    "value": "Node 3"
                  }, {
                    "id": 4,
                    "value": "Node 4"
                  }, {
                    "id": 5,
                    "value": "Node 5"
                  }, {
                    "id": 6,
                    "value": "Node 6"
                  }, {
                    "id": 7,
                    "value": "Node 7"
                  }, {
                    "id": 8,
                    "value": "Node 8"
                  }, {
                    "id": 9,
                    "value": "Node 9"
                  }, {
                    "id": 10,
                    "value": "Node 10"
                  }
                ],
                "relations": [
                  {
                    "id": "name",
                    "name": "Names",
                    "value": [
                      {
                        "id": "1->2",
                        "value": "From Node 1 to Node 2"
                      }, {
                        "id": "1->3",
                        "value": "From Node 1 to Node 3"
                      }, {
                        "id": "1->7",
                        "value": "From Node 1 to Node 7"
                      }, {
                        "id": "1->9",
                        "value": "From Node 1 to Node 9"
                      }, {
                        "id": "2->4",
                        "value": "From Node 2 to Node 4"
                      }, {
                        "id": "3->2",
                        "value": "From Node 3 to Node 2"
                      }, {
                        "id": "3->10",
                        "value": "From Node 3 to Node 10"
                      }, {
                        "id": "4->8",
                        "value": "From Node 4 to Node 8"
                      }, {
                        "id": "4->6",
                        "value": "From Node 4 to Node 6"
                      }, {
                        "id": "5->4",
                        "value": "From Node 5 to Node 4"
                      }, {
                        "id": "5->3",
                        "value": "From Node 5 to Node 3"
                      }, {
                        "id": "5->2",
                        "value": "From Node 5 to Node 2"
                      }, {
                        "id": "5->1",
                        "value": "From Node 5 to Node 1"
                      }, {
                        "id": "5->9",
                        "value": "From Node 5 to Node 9"
                      }, {
                        "id": "8->6",
                        "value": "From Node 8 to Node 6"
                      }, {
                        "id": "8->10",
                        "value": "From Node 8 to Node 10"
                      }
                    ]
                  }, {
                    "id": "Weight",
                    "name": "Weights",
                    "value": [
                      {
                        "id": "1->2",
                        "value": "5"
                      }, {
                        "id": "1->3",
                        "value": "10"
                      }, {
                        "id": "1->7",
                        "value": "12"
                      }, {
                        "id": "1->9",
                        "value": "18"
                      }, {
                        "id": "2->4",
                        "value": "20"
                      }, {
                        "id": "3->2",
                        "value": "15"
                      }, {
                        "id": "3->10",
                        "value": "7"
                      }, {
                        "id": "4->8",
                        "value": "13"
                      }, {
                        "id": "4->6",
                        "value": "20"
                      }, {
                        "id": "5->4",
                        "value": "10"
                      }, {
                        "id": "5->3",
                        "value": "4"
                      }, {
                        "id": "5->2",
                        "value": "25"
                      }, {
                        "id": "5->1",
                        "value": "10"
                      }, {
                        "id": "5->9",
                        "value": "12"
                      }, {
                        "id": "8->6",
                        "value": "2"
                      }, {
                        "id": "8->10",
                        "value": "10"
                      }
                    ]
                  }, {
                    "id": "Origin",
                    "name": "Origin",
                    "value": [
                      {
                        "id": "1->2",
                        "value": "1"
                      }, {
                        "id": "1->3",
                        "value": "1"
                      }, {
                        "id": "1->7",
                        "value": "1"
                      }, {
                        "id": "1->9",
                        "value": "1"
                      }, {
                        "id": "2->4",
                        "value": "2"
                      }, {
                        "id": "3->2",
                        "value": "3"
                      }, {
                        "id": "3->10",
                        "value": "3"
                      }, {
                        "id": "4->8",
                        "value": "4"
                      }, {
                        "id": "4->6",
                        "value": "4"
                      }, {
                        "id": "5->4",
                        "value": "5"
                      }, {
                        "id": "5->3",
                        "value": "5"
                      }, {
                        "id": "5->2",
                        "value": "5"
                      }, {
                        "id": "5->1",
                        "value": "5"
                      }, {
                        "id": "5->9",
                        "value": "5"
                      }, {
                        "id": "8->6",
                        "value": "8"
                      }, {
                        "id": "8->10",
                        "value": "8"
                      }
                    ]
                  }, {
                    "id": "Destination",
                    "name": "Destination",
                    "value": [
                      {
                        "id": "1->2",
                        "value": "2"
                      }, {
                        "id": "1->3",
                        "value": "3"
                      }, {
                        "id": "1->7",
                        "value": "7"
                      }, {
                        "id": "1->9",
                        "value": "9"
                      }, {
                        "id": "2->4",
                        "value": "4"
                      }, {
                        "id": "3->2",
                        "value": "2"
                      }, {
                        "id": "3->10",
                        "value": "10"
                      }, {
                        "id": "4->8",
                        "value": "8"
                      }, {
                        "id": "4->6",
                        "value": "6"
                      }, {
                        "id": "5->4",
                        "value": "4"
                      }, {
                        "id": "5->3",
                        "value": "3"
                      }, {
                        "id": "5->2",
                        "value": "2"
                      }, {
                        "id": "5->1",
                        "value": "1"
                      }, {
                        "id": "5->9",
                        "value": "9"
                      }, {
                        "id": "8->6",
                        "value": "6"
                      }, {
                        "id": "8->10",
                        "value": "10"
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "values": {
          "uiTipContent": "Insert a list of values that will determine the size of each node",
          "label": "Radius of each node",
          "family": "data",
          "sortingWeight": "3",
          "hidden": false,
          "formats": {
            "PxByValues": {
              "defaultsNames": {
                "values": "Values"
              },
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "min": 5,
                "max": 10,
                "values": 10,
                "values": [
                  {
                    "id": 1,
                    "value": 3
                  }, {
                    "id": 2,
                    "value": 6
                  }, {
                    "id": 3,
                    "value": 7
                  }, {
                    "id": 4,
                    "value": 8
                  }
                ]
              }
            },
            "PxRange": {
              "multiValues": {
                "min": false,
                "max": false
              },
              "defaults": {
                "min": 5,
                "max": 10
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each node",
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            },
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#8D91BC"
              }
            },
            "ColorsByCategories": {
              "multiValues": {
                "colors": true,
                "categories": true
              },
              "idSource": {
                "colors": "categories"
              },
              "defaults": {
                "defaultColor": "#AAAAAA"
              }
            },
            "ColorsByValues": {
              "multiValues": {
                "values": true,
                "colorscale": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": "1"
                  }, {
                    "id": "2",
                    "value": "2"
                  }, {
                    "id": "3",
                    "value": "3"
                  }, {
                    "id": "4",
                    "value": "4"
                  }, {
                    "id": "5",
                    "value": "5"
                  }
                ],
                "colorscale": "linear-gradient(90deg, rgb(243,243,255), rgb(63,81,151) 100%)"
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each node",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#FFFFFF"
              }
            }
          }
        },
        "linePadding": {
          "uiTipContent": "Determines the the separation between nodes and relations",
          "label": "Link Padding",
          "intenral": true,
          "sortingWeight": "99",
          "family": "style",
          "hidden": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "0px"
              }
            }
          }
        },
        "charge": {
          "uiTipContent": "Controls how much all nodes repel each other",
          "sortingWeight": "202",
          "label": "Repulsion between nodes",
          "family": "network",
          "hidden": false,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "30"
              }
            }
          }
        },
        "linkDistance": {
          "label": "Attraction between related nodes",
          "uiTipContent": " Controls how much connected nodes atract each other",
          "sortingWeight": "204",
          "family": "network",
          "hidden": false,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "70"
              }
            }
          }
        },
        "draggableNodes": {
          "uiTipContent": "Determines whether the nodes should be draggable",
          "label": "Draggale nodes",
          "family": "select",
          "multivalue": false,
          "hidden": true,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": 'true'
              }
            }
          }
        },
        "zoomable": {
          "uiTipContent": "Defines whether the visualization should be zoomable and/or panable",
          "label": "Allow pan and zoom",
          "family": "network"
        },
        "zoom": {
          "uiTipContent": "Defines the zoom level of the network",
          "label": "Zoom",
          "family": "network"
        },
        "forceSelection": {
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "false"
              }
            }
          }
        },
        "shapeType": {
          "label": "Shape of each node",
          "sortingWeight": 0
        },
        "shapeSize": {
          "internal": true
        }
      }
    };

    NetworkVisualizerModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(NetworkVisualizerModel.meta, NetworkVisualizerModel.behaviors);
      return output;
    };

    return NetworkVisualizerModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RadialNetworkVisualizerModel = (function(_super) {
    __extends(RadialNetworkVisualizerModel, _super);

    function RadialNetworkVisualizerModel() {
      _ref = RadialNetworkVisualizerModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RadialNetworkVisualizerModel.behaviors = ["quadrigram.Models.RadialNetworkDataControllerBehavior", "quadrigram.Models.MessagesBehavior", "quadrigram.Models.SvgBehavior", "quadrigram.Models.TextStyleSVGBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.RelationsRadialNetworkBehavior", "quadrigram.Models.SelectionRadialNetworkBehavior", "quadrigram.Models.SVGShapesBehavior", "quadrigram.Models.CirclesBehavior", "quadrigram.Models.TransitionBehavior"];

    RadialNetworkVisualizerModel.meta = {
      "name": "Radial Network",
      "properties": {
        "network": {
          "uiTipContent": "Insert a list of nodes and a its relations",
          "sortingWeight": "1",
          "label": "Network",
          "family": "data",
          "hidden": false,
          "formats": {
            "Network": {
              "multiValues": {
                "nodes": true,
                "relations": true
              },
              "defaults": {
                "nodes": [
                  {
                    "id": "Node 1",
                    "value": "Node 1"
                  }, {
                    "id": "Node 2",
                    "value": "Node 2"
                  }, {
                    "id": "Node 3",
                    "value": "Node 3"
                  }, {
                    "id": "Node 4",
                    "value": "Node 4"
                  }, {
                    "id": "Node 5",
                    "value": "Node 5"
                  }, {
                    "id": "Node 6",
                    "value": "Node 6"
                  }, {
                    "id": "Node 7",
                    "value": "Node 7"
                  }, {
                    "id": "Node 8",
                    "value": "Node 8"
                  }, {
                    "id": "Node 9",
                    "value": "Node 9"
                  }, {
                    "id": "Node 10",
                    "value": "Node 10"
                  }
                ],
                relations: [
                  {
                    "id": "name",
                    "name": "Names",
                    "value": [
                      {
                        "id": "Node 1->Node 2",
                        "value": "From Node 1 to Node 2"
                      }, {
                        "id": "Node 1->Node 3",
                        "value": "From Node 1 to Node 3"
                      }, {
                        "id": "Node 1->Node 7",
                        "value": "From Node 1 to Node 7"
                      }, {
                        "id": "Node 1->Node 9",
                        "value": "From Node 1 to Node 9"
                      }, {
                        "id": "Node 2->Node 4",
                        "value": "From Node 2 to Node 4"
                      }, {
                        "id": "Node 3->Node 2",
                        "value": "From Node 3 to Node 2"
                      }, {
                        "id": "Node 3->Node 10",
                        "value": "From Node 3 to Node 10"
                      }, {
                        "id": "Node 4->Node 8",
                        "value": "From Node 4 to Node 8"
                      }, {
                        "id": "Node 4->Node 6",
                        "value": "From Node 4 to Node 6"
                      }, {
                        "id": "Node 5->Node 4",
                        "value": "From Node 5 to Node 4"
                      }, {
                        "id": "Node 5->Node 3",
                        "value": "From Node 5 to Node 3"
                      }, {
                        "id": "Node 5->Node 2",
                        "value": "From Node 5 to Node 2"
                      }, {
                        "id": "Node 5->Node 1",
                        "value": "From Node 5 to Node 1"
                      }, {
                        "id": "Node 5->Node 9",
                        "value": "From Node 5 to Node 9"
                      }, {
                        "id": "Node 8->Node 6",
                        "value": "From Node 8 to Node 6"
                      }, {
                        "id": "Node 8->Node 10",
                        "value": "From Node 8 to Node 10"
                      }
                    ]
                  }, {
                    "id": "weight",
                    "name": "Weights",
                    "value": [
                      {
                        "id": "Node 1->Node 2",
                        "value": "5"
                      }, {
                        "id": "Node 1->Node 3",
                        "value": "10"
                      }, {
                        "id": "Node 1->Node 7",
                        "value": "12"
                      }, {
                        "id": "Node 1->Node 9",
                        "value": "18"
                      }, {
                        "id": "Node 2->Node 4",
                        "value": "20"
                      }, {
                        "id": "Node 3->Node 2",
                        "value": "15"
                      }, {
                        "id": "Node 3->Node 10",
                        "value": "7"
                      }, {
                        "id": "Node 4->Node 8",
                        "value": "13"
                      }, {
                        "id": "Node 4->Node 6",
                        "value": "20"
                      }, {
                        "id": "Node 5->Node 4",
                        "value": "10"
                      }, {
                        "id": "Node 5->Node 3",
                        "value": "4"
                      }, {
                        "id": "Node 5->Node 2",
                        "value": "25"
                      }, {
                        "id": "Node 5->Node 1",
                        "value": "10"
                      }, {
                        "id": "Node 5->Node 9",
                        "value": "12"
                      }, {
                        "id": "Node 8->Node 6",
                        "value": "2"
                      }, {
                        "id": "Node 8->Node 10",
                        "value": "10"
                      }
                    ]
                  }, {
                    "id": "Origin",
                    "name": "Origin",
                    "value": [
                      {
                        "id": "Node 1->Node 2",
                        "value": "Node 1"
                      }, {
                        "id": "Node 1->Node 3",
                        "value": "Node 1"
                      }, {
                        "id": "Node 1->Node 7",
                        "value": "Node 1"
                      }, {
                        "id": "Node 1->Node 9",
                        "value": "Node 1"
                      }, {
                        "id": "Node 2->Node 4",
                        "value": "Node 2"
                      }, {
                        "id": "Node 3->Node 2",
                        "value": "Node 3"
                      }, {
                        "id": "Node 3->Node 10",
                        "value": "Node 3"
                      }, {
                        "id": "Node 4->Node 8",
                        "value": "Node 4"
                      }, {
                        "id": "Node 4->Node 6",
                        "value": "Node 4"
                      }, {
                        "id": "Node 5->Node 4",
                        "value": "Node 5"
                      }, {
                        "id": "Node 5->Node 3",
                        "value": "Node 5"
                      }, {
                        "id": "Node 5->Node 2",
                        "value": "Node 5"
                      }, {
                        "id": "Node 5->Node 1",
                        "value": "Node 5"
                      }, {
                        "id": "Node 5->Node 9",
                        "value": "Node 5"
                      }, {
                        "id": "Node 8->Node 6",
                        "value": "Node 8"
                      }, {
                        "id": "Node 8->Node 10",
                        "value": "Node 8"
                      }
                    ]
                  }, {
                    "id": "Destination",
                    "name": "Destination",
                    "value": [
                      {
                        "id": "Node 1->Node 2",
                        "value": "Node 2"
                      }, {
                        "id": "Node 1->Node 3",
                        "value": "Node 3"
                      }, {
                        "id": "Node 1->Node 7",
                        "value": "Node 7"
                      }, {
                        "id": "Node 1->Node 9",
                        "value": "Node 9"
                      }, {
                        "id": "Node 2->Node 4",
                        "value": "Node 4"
                      }, {
                        "id": "Node 3->Node 2",
                        "value": "Node 2"
                      }, {
                        "id": "Node 3->Node 10",
                        "value": "Node 10"
                      }, {
                        "id": "Node 4->Node 8",
                        "value": "Node 8"
                      }, {
                        "id": "Node 4->Node 6",
                        "value": "Node 6"
                      }, {
                        "id": "Node 5->Node 4",
                        "value": "Node 4"
                      }, {
                        "id": "Node 5->Node 3",
                        "value": "Node 3"
                      }, {
                        "id": "Node 5->Node 2",
                        "value": "Node 2"
                      }, {
                        "id": "Node 5->Node 1",
                        "value": "Node 1"
                      }, {
                        "id": "Node 5->Node 9",
                        "value": "Node 9"
                      }, {
                        "id": "Node 8->Node 6",
                        "value": "Node 6"
                      }, {
                        "id": "Node 8->Node 10",
                        "value": "Node 10"
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        "nodeLabels": {
          "uiTipContent": "Insert a list of labels that will override the name each node",
          "label": "Node Labels",
          "family": "data",
          "sortingWeight": "2",
          "hidden": true,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Label"
              }
            }
          }
        },
        "values": {
          "uiTipContent": "Insert a list of values that will determine the size of each node",
          "label": "Node Values",
          "family": "data",
          "sortingWeight": "3",
          "internal": true,
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example data"
              },
              "defaults": {
                "value": 10
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each node",
          "internal": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#FFFFFF"
              }
            }
          }
        },
        "forceSelection": {
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "false"
              }
            }
          }
        },
        "shapeType": {
          "hidden": true,
          "internal": true
        },
        "shapeSize": {
          "internal": true
        },
        "fillColors": {
          "label": "Text color of each node name",
          "uiTipContent": "Defines the color of each node name",
          "sortingWeight": "0",
          "hidden": false,
          "formats": {
            "ColorsByScale": {
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            }
          }
        },
        "linkColors": {
          "sortingWeight": "11",
          "formats": {
            "Color": {
              "defaults": {
                "value": "#444444"
              }
            }
          }
        },
        "forceSelection": {
          "hidden": true,
          "internal": true
        },
        "fillOpacities": {
          "sortingWeight": "12",
          "label": "Opacity of each node name",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "lineThickness": {
          "sortingWeight": "13",
          "label": "Line thickness of each node",
          "internal": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "0px"
              }
            }
          }
        },
        "lineOpacities": {
          "sortingWeight": "14",
          "internal": true,
          "label": "Line opacity of each node"
        },
        "textColor": {
          "internal": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "linkOpacities": {
          "sortingWeight": "16"
        },
        "linkThickness": {
          "sortingWeight": "15",
          "uiTipContent": "Defines the thickness the links",
          "label": "Thickness of the links",
          "family": "style",
          "formats": {
            "Px": {
              "idSource": {
                "value": "visualizer.idsRelations"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "1px"
              }
            }
          }
        }
      }
    };

    RadialNetworkVisualizerModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(RadialNetworkVisualizerModel.meta, RadialNetworkVisualizerModel.behaviors);
      return output;
    };

    return RadialNetworkVisualizerModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.HeatMapModel = (function(_super) {
    __extends(HeatMapModel, _super);

    function HeatMapModel() {
      _ref = HeatMapModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    HeatMapModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.PlacesDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TransitionBehavior", "quadrigram.Models.MapBehavior"];

    HeatMapModel.meta = {
      "name": "PointsInAMap",
      "properties": {
        "places": {
          "uiTipContent": "Insert a list of latitudes and a list of longitudes to represent cordinates of each hot spot",
          "sortingWeight": "0",
          "label": "Hot spots",
          "family": "data",
          "hidden": false,
          "formats": {
            "Place": {
              "multiValues": {
                "lat": true,
                "lon": true
              },
              "defaults": {
                "lon": [
                  {
                    "id": "1",
                    "value": 2.1833
                  }, {
                    "id": "2",
                    "value": 2.3508
                  }, {
                    "id": "3",
                    "value": 0.1275
                  }, {
                    "id": "4",
                    "value": 12.5000
                  }
                ],
                "lat": [
                  {
                    "id": "1",
                    "value": 41.3833
                  }, {
                    "id": "2",
                    "value": 48.8567
                  }, {
                    "id": "3",
                    "value": 51.5072
                  }, {
                    "id": "4",
                    "value": 41.9000
                  }
                ]
              }
            }
          }
        },
        "values": {
          "uiTipContent": "Insert a list of values that will determine the intensity of each hot spot",
          "label": "Hot spot intensities",
          "family": "data",
          "sortingWeight": "1",
          "hidden": true,
          "formats": {
            "Number": {
              "defaultsNames": {
                "value": "Dummy radius"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 10
              }
            },
            "ByValues": {
              "label": "Numbers with fixed domain",
              "multiValues": {
                "values": true
              },
              "defaults": {
                "values": 50,
                "min": 0,
                "max": 100
              }
            },
            "IntensitiesByValues": {
              "deprecated": true,
              "defaultsNames": {
                "values": "Dummy radius"
              },
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 10,
                "min": 0,
                "max": 100
              }
            }
          }
        },
        "radius": {
          "uiTipContent": "Scaling factor for the hotspots",
          "label": "Hot spot action radius",
          "family": "data",
          "sortingWeight": "2",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": 20
              }
            }
          }
        },
        "grouping": {
          "uiTipContent": "How much close hotspots will fuse",
          "label": "Hot spot base intensity",
          "family": "data",
          "sortingWeight": "3",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": 50
              }
            }
          }
        },
        "gradient": {
          "uiTipContent": "Color scale of the heatMap",
          "label": "Color scale",
          "family": "style",
          "sortingWeight": "0",
          "hidden": false,
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            }
          }
        },
        "bkg_color": {
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#d9d9d9"
              }
            }
          }
        },
        "zoomable": {
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "false"
              }
            }
          }
        }
      }
    };

    HeatMapModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(HeatMapModel.meta, HeatMapModel.behaviors);
      return output;
    };

    return HeatMapModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  quadrigram.Models.Behavior = (function() {
    Behavior.stage = "";

    function Behavior(visualizer, childrenBehaviors, params) {
      this.checkOwnPropertyChanged = __bind(this.checkOwnPropertyChanged, this);
      this.info = __bind(this.info, this);
      this.createOutputs = __bind(this.createOutputs, this);
      this.initialize = __bind(this.initialize, this);
      _.extend(this, Backbone.Events);
      this.behaviors = childrenBehaviors;
      this.visualizer = visualizer;
      this.createOutputs();
      this.initialize(params);
    }

    Behavior.prototype.initialize = function(params) {};

    Behavior.prototype.createOutputs = function() {
      var behaviorInfo, blockGroup, currentBlock, outputBlock, outputBlocks, outputId, outputInfo, outputLabel, outputType, _results;
      if (!this.visualizer) {
        return;
      }
      blockGroup = this.visualizer.model.original.get("blockGroup");
      outputBlocks = [];
      behaviorInfo = this.info();
      _results = [];
      for (outputId in behaviorInfo.outputs) {
        outputInfo = behaviorInfo.outputs[outputId];
        currentBlock = blockGroup.get("blocksCollection").find(function(candidate) {
          return candidate.get("outputId") === outputId;
        });
        outputLabel = outputInfo.label ? outputInfo.label : outputId;
        outputType = outputInfo.outputType ? outputInfo.outputType : "default";
        if (!currentBlock && !outputInfo.deprecated) {
          outputBlock = new quadrigram.Models.DataBlockModel;
          outputBlock.set({
            "blockGroup": blockGroup,
            "outputOwnerViz": this.visualizer.model.original,
            "role": "output",
            "outputId": outputId,
            "outputType": outputType,
            "label": outputLabel,
            "origin": "visualizer"
          }, {
            "silent": true
          });
          _results.push(outputBlock.setData(outputInfo["default"]));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    Behavior.prototype.info = function() {
      if (this.output == null) {
        this.output = quadrigram.Models.VisualizerModel.mergeInfo(this.constructor.meta, this.constructor.behaviors);
      }
      return this.output;
    };

    Behavior.prototype.checkOwnPropertyChanged = function() {
      var key, ownChange;
      ownChange = false;
      for (key in this.visualizer.model.changed) {
        if (key in this.constructor.meta.properties) {
          ownChange = true;
        }
      }
      return ownChange;
    };

    return Behavior;

  })();

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.LayoutBehavior = (function(_super) {
    __extends(LayoutBehavior, _super);

    function LayoutBehavior() {
      this.updateBackground = __bind(this.updateBackground, this);
      this.setScrollEnabled = __bind(this.setScrollEnabled, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      this.initialize = __bind(this.initialize, this);
      _ref = LayoutBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LayoutBehavior.field = "layout";

    LayoutBehavior.behaviors = [];

    LayoutBehavior.stage = "";

    LayoutBehavior.prototype.initialize = function(params) {
      return this.root = d3.select(this.visualizer.el);
    };

    LayoutBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(LayoutBehavior.meta, LayoutBehavior.behaviors);
      return output;
    };

    LayoutBehavior.meta = {
      "name": "Layout",
      "properties": {
        "page": {
          "label": "Page",
          "family": "layout",
          "hidden": true,
          "sortingWeight": "1000",
          "multivalue": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": -1
              }
            }
          }
        },
        "col": {
          "label": "Column",
          "family": "layout",
          "hidden": true,
          "sortingWeight": "1000",
          "multivalue": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "row": {
          "label": "Row",
          "family": "layout",
          "hidden": true,
          "sortingWeight": "1000",
          "multivalue": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "size_x": {
          "label": "Width",
          "family": "layout",
          "sortingWeight": "1000",
          "multivalue": false,
          "hidden": true,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "size_y": {
          "label": "Height",
          "family": "layout",
          "sortingWeight": "1000",
          "multivalue": false,
          "hidden": true,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "scroll_enabled": {
          "uiTipContent": "Enables or disables the capacity of scrolling when having a text overflow",
          "label": "Always hide the scrollbar",
          "family": "style",
          "sortingWeight": "30",
          "multivalue": false,
          "hidden": true,
          "internal": "true",
          "formats": {
            "Boolean": {
              "defaults": {
                "value": true
              }
            }
          }
        },
        "bkg_color": {
          "uiTipContent": "Defines the color of the background for this chart",
          "label": "Background color",
          "family": "style",
          "sortingWeight": "31",
          "multivalue": false,
          "hidden": true,
          "formats": {
            "Color": {
              "label": "Color",
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "transparent"
              }
            }
          }
        },
        "bkg_image": {
          "uiTipContent": "Defines a background image for this chart",
          "label": "Background image",
          "family": "style",
          "sortingWeight": "32",
          "hidden": true,
          "formats": {
            "ImageUrl": {
              "label": "Image",
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "",
                "scale": "cover",
                "repeat": "false"
              },
              "options": {
                "scale": ["contain", "cover", "stretch", "preserve"]
              }
            },
            "Text": {
              "deprecated": true,
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "bkg_opacity": {
          "uiTipContent": "Defines the opacity of the background for this chart",
          "label": "Background opacity",
          "family": "style",
          "sortingWeight": "33",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        }
      }
    };

    LayoutBehavior.prototype.executeBeforeUpdateStage = function() {
      this.updateBackground();
      return this.setScrollEnabled();
    };

    LayoutBehavior.prototype.setScrollEnabled = function() {
      var domElement;
      if ((this.visualizer.model.get("scroll_enabled") != null) && (this.visualizer.getScrollDomElement != null)) {
        domElement = this.visualizer.getScrollDomElement();
        if (this.visualizer.model.get("scroll_enabled") === "true" || this.visualizer.model.get("scroll_enabled") === true) {
          return domElement.css("overflow-y", "hidden");
        } else {
          return domElement.css("overflow-y", "auto");
        }
      }
    };

    LayoutBehavior.prototype.updateBackground = function() {
      var bckgColor, bckgImage, bckgOpacity, color, opacity, style,
        _this = this;
      if (!this.visualizer.backgroundEl) {
        this.visualizer.backgroundEl = this.visualizer.$el.find(".viz-view-background");
      }
      if (this.visualizer.model.get("bkg_image").currentFormat === "ImageUrl") {
        bckgImage = this.visualizer.model.get("bkg_image")[0];
      } else {
        bckgImage = this.visualizer.model.get("bkg_image");
      }
      bckgColor = this.visualizer.model.get("bkg_color");
      bckgOpacity = this.visualizer.model.get("bkg_opacity");
      if ((bckgImage != null) && (typeof bckgImage === "string" || bckgImage instanceof String) && bckgImage !== "") {
        quadrigram.router.managers.serverManager.getImageUrl(bckgImage, function(resultUrl) {
          return _this.visualizer.backgroundEl.css("background-image", "url('" + resultUrl + "')");
        });
      } else {
        this.visualizer.backgroundEl.css("background-image", "none");
      }
      if (this.visualizer.model.get("bkg_image").currentFormat === "ImageUrl") {
        this.visualizer.backgroundEl.css(LayoutBehavior.calculateCSS(this.visualizer.model.get("bkg_image")[1], this.visualizer.model.get("bkg_image")[2]));
      }
      if ((bckgColor != null) && bckgColor !== "" && bckgColor !== "transparent") {
        color = d3.rgb(bckgColor);
        style = "rgb(" + color.r + "," + color.g + "," + color.b + ")";
        this.visualizer.backgroundEl.css("background-color", style);
      } else {
        this.visualizer.backgroundEl.css("background-color", "transparent");
      }
      opacity = 1;
      if ((bckgOpacity != null) && bckgOpacity !== "") {
        opacity = bckgOpacity / 100;
        return this.visualizer.backgroundEl.css("opacity", opacity);
      }
      /*
      if quadrigram.environment != "editor"
        if (bckgColor? && bckgColor != "" && bckgColor != "none") && !(bckgImage? && (typeof bckgImage == "string" || bckgImage instanceof String) && bckgImage != "" )
          @visualizer.backgroundEl.css("outline","solid 1px "+style)
        else
          @visualizer.backgroundEl.css("outline","")
      */

    };

    LayoutBehavior.calculateCSS = function(size, repeat) {
      var css;
      css = {};
      switch (size) {
        case "cover":
          css["background-size"] = "cover";
          break;
        case "contain":
          css["background-size"] = "contain";
          break;
        case "stretch":
          css["background-size"] = "100% 100%";
          break;
        case "preserve":
          css["background-size"] = "auto";
      }
      switch (repeat) {
        case "true":
          css["background-repeat"] = "repeat";
          break;
        case "false":
          css["background-repeat"] = "no-repeat";
      }
      css["background-position"] = "center center";
      return css;
    };

    return LayoutBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.XAxisBehavior = (function(_super) {
    __extends(XAxisBehavior, _super);

    function XAxisBehavior() {
      this.makeXGridBoldAxis = __bind(this.makeXGridBoldAxis, this);
      this.makeXGridAxis = __bind(this.makeXGridAxis, this);
      this.addXGrid = __bind(this.addXGrid, this);
      this.updateXTitle = __bind(this.updateXTitle, this);
      this.updateXLabels = __bind(this.updateXLabels, this);
      this.setClip = __bind(this.setClip, this);
      this.drawXAxis = __bind(this.drawXAxis, this);
      this.updateXAxis = __bind(this.updateXAxis, this);
      this.updateTicks = __bind(this.updateTicks, this);
      this.getExternalInterval = __bind(this.getExternalInterval, this);
      this.cleanAxis = __bind(this.cleanAxis, this);
      this.adjustDomain = __bind(this.adjustDomain, this);
      this.setScale = __bind(this.setScale, this);
      this.setRange = __bind(this.setRange, this);
      this.createScale = __bind(this.createScale, this);
      this.calculateYAxisRestrains = __bind(this.calculateYAxisRestrains, this);
      this.calculateXAxisRestrains = __bind(this.calculateXAxisRestrains, this);
      this.afterDimensionAxisUpdate = __bind(this.afterDimensionAxisUpdate, this);
      this.drawDimensionAxis = __bind(this.drawDimensionAxis, this);
      this.updateDimensionAxis = __bind(this.updateDimensionAxis, this);
      this.setupDimensionAxis = __bind(this.setupDimensionAxis, this);
      this.drawAllDimensionAxes = __bind(this.drawAllDimensionAxes, this);
      this.updateAllDimensionAxes = __bind(this.updateAllDimensionAxes, this);
      this.beforeDimensionAxisUpdate = __bind(this.beforeDimensionAxisUpdate, this);
      this.startCanvasSize = __bind(this.startCanvasSize, this);
      this.updateCanvasSize = __bind(this.updateCanvasSize, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      this.createAxisFunction = __bind(this.createAxisFunction, this);
      this.initialize = __bind(this.initialize, this);
      _ref = XAxisBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    XAxisBehavior.field = "axis";

    XAxisBehavior.behaviors = ["quadrigram.Models.SvgBehavior", "quadrigram.Models.TextStyleSVGBehavior"];

    XAxisBehavior.stage = "beforeUpdate";

    XAxisBehavior.prototype.allowAxisReRender = true;

    XAxisBehavior.prototype.defaultGridOpacity = 0.7;

    XAxisBehavior.prototype.defaultExtraAmplitudeDomain = 0.1;

    XAxisBehavior.prototype.defaultAmplitudeForScalingBands = 0.1;

    XAxisBehavior.prototype.defaultOuterPadding = 0.1;

    XAxisBehavior.prototype.maxTextHeight = 0;

    XAxisBehavior.prototype.maxYTextWidth = 0;

    XAxisBehavior.prototype.xAxisLabelPadding = 10;

    XAxisBehavior.prototype.yAxisLabelPadding = 10;

    XAxisBehavior.prototype.firstExec = true;

    XAxisBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(XAxisBehavior.meta, XAxisBehavior.behaviors);
      return output;
    };

    XAxisBehavior.meta = {
      name: "axis",
      properties: {
        axisXTitle: {
          "uiTipContent": "Defines the title of the X Axis",
          label: "X Axis title",
          sortingWeight: "0",
          family: "axis",
          hidden: true,
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        axisXRange: {
          "uiTipContent": "Defines the visible range of values on Axis",
          label: "Visible range of X Axis",
          sortingWeight: "3",
          family: "axis",
          hidden: true,
          internal: false,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            StringRange: {
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            },
            SimpleRange: {
              deprecated: true,
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            }
          }
        },
        axisRange: {
          "uiTipContent": "Defines the visible range of values on Axis",
          label: "DEPRECATED",
          sortingWeight: "999",
          deprecated: true,
          family: "axis",
          hidden: true,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            SimpleRange: {
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            }
          }
        },
        axisLabels: {
          "uiTipContent": "Defines the text to display on the axes ticks",
          label: "X axis ticks",
          sortingWeight: "5",
          family: "axis",
          multivalue: false,
          hidden: true,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Text: {
              multiValues: {
                value: true
              },
              defaults: {
                value: "Axis Label"
              },
              idSource: {
                value: "visualizer.xTicks"
              }
            }
          }
        },
        xAxisGrid: {
          "uiTipContent": "Determines whether to show vertical grid lines underneath the chart",
          label: "Show vertical grid lines",
          sortingWeight: "6",
          family: "axis",
          multivalue: false,
          hidden: true,
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: 'true'
              }
            }
          }
        },
        axisLineColor: {
          "uiTipContent": "Defines the color of the axes",
          label: "Color of axes lines",
          sortingWeight: "8",
          family: "axis",
          hidden: true,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#888888"
              }
            }
          }
        },
        axisTextColor: {
          "uiTipContent": "Defines the color of the axes values (ticks)",
          label: "Color of axes values",
          internal: "true",
          sortingWeight: "9",
          family: "axis",
          multivalue: false,
          hidden: true,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#444444"
              }
            }
          }
        },
        axisLegendColor: {
          "uiTipContent": "Defines the color of the axes titles",
          label: "Color of axes titles",
          sortingWeight: "91",
          internal: "true",
          family: "axis",
          multivalue: false,
          hidden: true,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#000000"
              }
            }
          }
        },
        detectLinear: {
          "uiTipContent": "Determines if the values should be treated as numbers or dates, or simply as labels",
          label: "Autodetect data type",
          sortingWeight: "92",
          family: "axis",
          hidden: true,
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        uniformAxes: {
          "uiTipContent": "Defines if all the axis should be scaled uniformly or if each axis has its own minimum and maximum",
          label: "Uniform axes",
          sortingWeight: "55",
          family: "axis",
          hidden: true,
          internal: true,
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "false"
              }
            }
          }
        }
      }
    };

    XAxisBehavior.prototype.axisGrid = {
      xAxis: {
        xGridTicks: 4
      }
    };

    XAxisBehavior.prototype.initialize = function(params) {
      var idViz;
      this.graphWrapper = this.behaviors.svg.root.append("g").attr("class", "graph-wrapper");
      this.graph = this.graphWrapper.append("g").attr("class", "graph");
      this.xAxisEl = this.behaviors.svg.root.insert("g", ".graph-wrapper").attr("class", "x-axis");
      /*
      @yAxisEl = @behaviors.svg.root.insert("g",".graph-wrapper")
        .attr("class", "y-axis")
      */

      idViz = this.idViz = this.visualizer.model.original.get("id");
      this.size = {
        width: 200,
        height: 200,
        margin: {
          left: 10,
          right: 15,
          top: 15,
          bottom: 10
        },
        axisX: {
          type: "linear",
          accumulate: false
        }
      };
      /*
        axisY:
          type:"linear"
          accumulate:false
      */

      this.vizDefs = this.behaviors.svg.root.append("defs");
      this.clipPath = this.vizDefs.append("clipPath").attr("id", "axisClip-" + idViz);
      this.clipPathRect = this.clipPath.append("rect").attr("class", "clip-path-rect");
      this.graphWrapper.attr("clip-path", "url(#axisClip-" + idViz + ")");
      this.createAxisFunction();
      this.config = {
        ids: [5],
        values: [
          {
            id: 5,
            value: 10
          }
        ],
        axisLineColor: "#888888",
        axisTextColor: "#444444",
        axisLegendColor: "#000000"
      };
      this.xAxisLabel = this.xAxisEl.append("text").attr("class", "x-axis-label").style("text-anchor", "middle");
      /*
      @yAxisLabel = @yAxisEl.append("text")
        .attr("class", "y-axis-label").style("text-anchor","middle")
      */

      this.visualizer.$el.on('didResize', this.setClip);
      return this.behaviors.style.addStylableTexts([".x-axis-label", ".tick", ".y-axis-label"]);
    };

    XAxisBehavior.prototype.createAxisFunction = function() {
      return this.xAxis = d3.svg.axis().tickPadding(5).tickSize(5).orient("bottom");
      /*
      @yAxis = d3.svg.axis()
        .tickPadding(5)
        .tickSize(5)
        .orient("left")
      */

    };

    XAxisBehavior.prototype.behaviorChecking = function() {
      if (this.firstExec || this.visualizer.resizing || this.checkOwnPropertyChanged() || (this.visualizer.model.changed["data"] != null) || ((this.visualizer.checkAxisChanged != null) && this.visualizer.checkAxisChanged())) {
        this.firstExec = false;
        return true;
      }
    };

    XAxisBehavior.prototype.executeBeforeUpdateStage = function() {
      var ids, items, model, values;
      this.allowAxisReRender = true;
      if (!this.behaviorChecking()) {
        return;
      }
      model = this.visualizer.model;
      items = this.visualizer.itemsEnter;
      values = this.visualizer.values;
      ids = this.visualizer.ids;
      if (this.visualizer.setAxisDirection) {
        this.visualizer.setAxisDirection();
        if (this.visualizer.model.changed["IdsOnAxis"] != null) {
          this.createAxisFunction();
        }
      }
      this.updateCanvasSize({
        width: this.visualizer.$el.width(),
        height: this.visualizer.$el.height(),
        axisX: {
          type: this.visualizer.xAxisType,
          field: this.visualizer.xAxisField
        },
        axisY: {
          type: this.visualizer.yAxisType,
          field: this.visualizer.yAxisField,
          accumulate: this.visualizer.accumulate
        }
      });
      this.updateConfig({
        values: values,
        ids: ids,
        axisLineColor: model.get("axisLineColor"),
        axisTextColor: model.get("axisTextColor"),
        axisLegendColor: model.get("axisLegendColor")
      });
      if (model.get("gapBetweenBars") != null) {
        this.defaultAmplitudeForScalingBands = model.get("gapBetweenBars") / 100;
      }
      return this.startCanvasSize();
    };

    XAxisBehavior.prototype.updateConfig = function(newConfig) {
      var field, _results;
      _results = [];
      for (field in newConfig) {
        _results.push(this.config[field] = newConfig[field]);
      }
      return _results;
    };

    XAxisBehavior.prototype.updateCanvasSize = function(newSize) {
      var field;
      for (field in newSize) {
        this.size[field] = newSize[field];
      }
      return this.behaviors.svg.updateSize({
        width: this.size.width,
        height: this.size.height
      });
    };

    XAxisBehavior.prototype.startCanvasSize = function() {
      var count, lastRestrains;
      this.xAxisRestrains = {
        left: 0,
        right: 0
      };
      this.yAxisRestrains = {
        top: 0,
        bottom: 0
      };
      this.updateXAxis();
      this.drawXAxis();
      this.updateXTitle();
      this.yAxisRestrains = this.calculateYAxisRestrains();
      this.updateAllDimensionAxes();
      this.drawAllDimensionAxes();
      this.afterDimensionAxisUpdate();
      this.behaviors.style.executeBeforeUpdateStage();
      this.xAxisRestrains = this.calculateXAxisRestrains();
      lastRestrains = {};
      count = 0;
      while (count < 4 && (!_.isMatch(lastRestrains.x, this.xAxisRestrains) || !_.isMatch(lastRestrains.y, this.yAxisRestrains))) {
        count += 1;
        lastRestrains.x = _.clone(this.xAxisRestrains);
        lastRestrains.y = _.clone(this.yAxisRestrains);
        this.drawXAxis();
        this.yAxisRestrains = this.calculateYAxisRestrains();
        this.drawAllDimensionAxes();
        this.afterDimensionAxisUpdate();
        this.xAxisRestrains = this.calculateXAxisRestrains();
        if (this.xAxisRestrains.left < lastRestrains.x.left) {
          this.xAxisRestrains.left = lastRestrains.x.left;
        }
        if (this.xAxisRestrains.right < lastRestrains.x.right) {
          this.xAxisRestrains.right = lastRestrains.x.right;
        }
        this.drawXAxis();
        this.behaviors.style.executeBeforeUpdateStage();
      }
      this.addXGrid();
      return _.delay(this.setClip, 200);
    };

    XAxisBehavior.prototype.beforeDimensionAxisUpdate = function() {};

    XAxisBehavior.prototype.updateAllDimensionAxes = function() {
      var self, yAxisEnter;
      this.yScales = {};
      this.yAxes = {};
      this.visualizer.model.original.dimensions = this.visualizer.dimensions;
      this.yAxisEls = this.behaviors.svg.root.selectAll(".dimension").data(this.visualizer.dimensions);
      yAxisEnter = this.yAxisEls.enter().insert("g", ".graph-wrapper").attr("class", "dimension");
      this.yAxisEls.exit().remove();
      this.beforeDimensionAxisUpdate();
      self = this;
      yAxisEnter.each(function(d, i) {
        return self.setupDimensionAxis(d3.select(this), d, i);
      });
      return this.yAxisEls.each(function(d, i) {
        self.yAxes[d] = d3.svg.axis().tickPadding(5).tickSize(5).orient("left");
        return self.updateDimensionAxis(d3.select(this), d, i);
      });
    };

    XAxisBehavior.prototype.drawAllDimensionAxes = function() {
      var self;
      self = this;
      return this.yAxisEls.each(function(d, i) {
        self.yAxes[d] = d3.svg.axis().tickPadding(5).tickSize(5).orient("left");
        return self.drawDimensionAxis(d3.select(this), d, i);
      });
    };

    XAxisBehavior.prototype.setupDimensionAxis = function(selection, dimensionId, i) {};

    XAxisBehavior.prototype.updateDimensionAxis = function(selection, dimensioinId, i) {};

    XAxisBehavior.prototype.drawDimensionAxis = function(selection, dimensioinId, i) {};

    XAxisBehavior.prototype.afterDimensionAxisUpdate = function() {};

    XAxisBehavior.prototype.calculateXAxisRestrains = function() {
      return {
        left: 0,
        right: 0
      };
    };

    XAxisBehavior.prototype.calculateYAxisRestrains = function() {
      var bottom, maxTextHeight, xAxisLabelHeight, xAxisTick;
      this.maxTextHeight = maxTextHeight = 0;
      xAxisTick = this.xAxisEl.selectAll('.tick')[0];
      if (xAxisTick.length > 0) {
        maxTextHeight = xAxisTick[0].getBBox().height;
        this.xAxisEl.selectAll(".tick").each(function() {
          return maxTextHeight = Math.max(maxTextHeight, this.getBBox().height);
        });
        this.maxTextHeight = parseInt(maxTextHeight);
      }
      xAxisLabelHeight = (this.xAxisLabel != null) && this.xAxisLabel.text().length > 0 ? this.xAxisLabel[0][0].getBBox().height + this.xAxisLabelPadding : 0;
      bottom = this.maxTextHeight + this.size.margin.bottom + xAxisLabelHeight;
      return {
        top: 0,
        bottom: bottom
      };
    };

    XAxisBehavior.prototype.createScale = function(domainValues, type, adjustmentOptions) {
      var areDates, areFloats, areInts, baseScale, detectedType, parser, resultScale, tickFormat, v, _i, _len;
      areDates = true;
      areFloats = true;
      areInts = true;
      for (_i = 0, _len = domainValues.length; _i < _len; _i++) {
        v = domainValues[_i];
        if (areDates && (quadrigram.router.dataModels.currentProject.timeFormat.parse(String(v)) == null)) {
          areDates = false;
        }
        if (areFloats && (String(v).match(/^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) == null)) {
          areFloats = false;
        }
        if (areInts && (String(v).match(/^\d+$/) == null)) {
          areInts = false;
        }
      }
      if (areDates) {
        detectedType = "time";
        parser = function(a) {
          return quadrigram.router.dataModels.currentProject.timeFormat.parse(String(a));
        };
        tickFormat = quadrigram.router.dataModels.currentProject.timeFormat;
      } else if (areInts) {
        detectedType = "linear";
        parser = function(a) {
          return parseInt(a);
        };
        tickFormat = d3.format("d");
      } else if (areFloats) {
        detectedType = "linear";
        parser = function(a) {
          return parseFloat(a);
        };
        tickFormat = function(v) {
          var ff;
          ff = d3.format(",.f")(v);
          if (ff.length > 5) {
            ff = d3.format(",.f")(v.toPrecision(5));
          }
          return ff;
        };
      } else {
        detectedType = "points";
        parser = function(a) {
          return a;
        };
      }
      if (this.visualizer.model.get("detectLinear") === "false") {
        parser = function(a) {
          return a;
        };
        tickFormat = null;
        if (type === "auto") {
          type = "points";
        }
      } else if ((type != null) && type !== "auto") {

      } else {
        type = detectedType;
      }
      baseScale = this.setScale(type);
      resultScale = function(value) {
        return baseScale(parser(value));
      };
      jQuery.extend(true, resultScale, baseScale);
      if (tickFormat != null) {
        resultScale._tickFormat = tickFormat;
      }
      resultScale.baseScale = baseScale;
      resultScale.parser = parser;
      resultScale.type = type;
      resultScale.domainValues = domainValues;
      resultScale.adjustmentOptions = adjustmentOptions;
      return resultScale;
    };

    XAxisBehavior.prototype.setRange = function(scale, range) {
      switch (scale.type) {
        case "linear":
          scale.range(range);
          scale.baseScale.range(range);
          break;
        case "time":
          scale.range(range);
          scale.baseScale.range(range);
          break;
        case "bands":
          scale.rangeRoundBands(range, this.defaultAmplitudeForScalingBands);
          scale.baseScale.rangeRoundBands(range, this.defaultAmplitudeForScalingBands);
          break;
        case "points":
          scale.rangePoints(range).range();
          scale.baseScale.rangePoints(range).range();
      }
      scale.originalExtent = range[1] - range[0];
      scale.baseScale.originalExtent = range[1] - range[0];
      return this.adjustDomain(scale, scale.domainValues, scale.adjustmentOptions);
    };

    XAxisBehavior.prototype.setScale = function(type) {
      var outputScale;
      switch (type) {
        case "linear":
          outputScale = d3.scale.linear();
          break;
        case "time":
          outputScale = d3.time.scale();
          break;
        case "bands":
          outputScale = d3.scale.ordinal();
          break;
        case "points":
          outputScale = d3.scale.ordinal();
      }
      return outputScale;
    };

    XAxisBehavior.prototype.adjustDomain = function(baseScale, domainValues, adjustmentOptions) {
      var amplitude, externalInterval, interval, max, min, scale, scaledRange, scaledUnit, translate, unit, v, _i, _len;
      if (baseScale.type !== "time" && baseScale.type !== "linear") {
        interval = [];
        for (_i = 0, _len = domainValues.length; _i < _len; _i++) {
          v = domainValues[_i];
          interval.push(baseScale.parser(v));
        }
      } else {
        interval = d3.extent(domainValues, function(d) {
          return baseScale.parser(d);
        });
      }
      baseScale.zoomTransform = {
        translate: 0,
        scale: 1
      };
      if ((adjustmentOptions.externalProperty != null) && (externalInterval = this.getExternalInterval(adjustmentOptions.externalProperty))) {
        if (baseScale.type === "linear" || baseScale.type === "time") {
          if ((externalInterval[0] != null) && externalInterval[0] !== "") {
            interval[0] = +baseScale.parser(externalInterval[0]);
          }
          if ((externalInterval[1] != null) && externalInterval[1] !== "") {
            interval[1] = +baseScale.parser(externalInterval[1]);
          }
          baseScale.domain(interval);
        } else {
          if ((externalInterval[0] != null) && externalInterval[0] !== "") {
            min = interval.indexOf(externalInterval[0]);
          } else {
            min = 0;
          }
          if ((externalInterval[1] != null) && externalInterval[1] !== "") {
            max = interval.indexOf(externalInterval[1]);
          } else {
            max = interval.length - 1;
          }
          baseScale.domain(interval);
          scale = domainValues.length / (max + 1 - min);
          unit = baseScale.originalExtent / interval.length;
          scaledUnit = unit * scale;
          translate = -min * scaledUnit;
          baseScale.zoomTransform = {
            translate: translate,
            scale: scale
          };
          scaledRange = [-min * scaledUnit, -min * scaledUnit + scaledUnit * interval.length];
          if (baseScale.type === "bands") {
            baseScale.rangeRoundBands(scaledRange, this.defaultAmplitudeForScalingBands);
          } else {
            baseScale.rangeRoundPoints(scaledRange);
          }
        }
      }
      if (adjustmentOptions.zoomTransform != null) {
        translate = adjustmentOptions.zoomTransform.translate;
        scale = adjustmentOptions.zoomTransform.scale;
        baseScale.zoomTransform = {
          translate: translate,
          scale: scale
        };
        scaledRange = [translate, translate + baseScale.originalExtent * scale];
        if (baseScale.type === "bands") {
          baseScale.rangeRoundBands(scaledRange, this.defaultAmplitudeForScalingBands);
        } else {
          baseScale.rangeRoundPoints(scaledRange);
        }
        return;
      }
      if (baseScale.type !== "linear") {
        baseScale.domain(interval);
        baseScale.domainValues = domainValues;
        return;
      }
      amplitude = Math.abs(this.defaultExtraAmplitudeDomain * (Math.abs(interval[0] - interval[1])));
      if (adjustmentOptions.specialFunction != null) {
        interval = adjustmentOptions.specialFunction(interval);
      }
      if (amplitude === 0) {
        amplitude = this.defaultExtraAmplitudeDomain * 10;
        if (interval[0] !== 0) {
          interval[0] -= amplitude;
        }
        if (interval[1] !== 0) {
          interval[1] += amplitude;
        }
      } else if (adjustmentOptions.defaultPadding === true) {
        if (interval[0] !== 0) {
          interval[0] -= amplitude;
        }
        if (interval[1] !== 0) {
          interval[1] += amplitude;
        }
      }
      baseScale.domain(interval);
      return baseScale.domainValues = domainValues;
    };

    XAxisBehavior.prototype.cleanAxis = function(axisEl, axisFunction, gridEl) {
      var dir, maxPos, outerTickSize, self, sign;
      if (axisFunction.scale().type === "linear" || axisFunction.scale().type === "time") {
        return;
      }
      self = this;
      if (axisFunction.orient() === "left" || axisFunction.orient() === "right") {
        dir = -1;
      } else {
        dir = 1;
      }
      maxPos = dir * axisFunction.scale().originalExtent;
      axisEl.selectAll(".tick").each(function(d, i) {
        var pos;
        pos = axisFunction.scale().baseScale(d) + axisFunction.scale().rangeBand() / 2;
        if (pos < 0 || pos > maxPos) {
          return d3.select(this).attr("display", "none");
        } else {
          return d3.select(this).attr("display", "block");
        }
      });
      gridEl.selectAll(".tick").each(function(d, i) {
        var pos;
        pos = axisFunction.scale().baseScale(d);
        if (pos < 0 || pos > maxPos) {
          return d3.select(this).attr("display", "none");
        } else {
          return d3.select(this).attr("display", "block");
        }
      });
      outerTickSize = 6;
      sign = dir;
      if (axisFunction.orient() === "left" || axisFunction.orient() === "right") {
        return axisEl.select(".domain").attr("d", "M" + sign * outerTickSize + "," + 0 + "H0V" + sign * (axisFunction.scale().originalExtent) + "H" + sign * outerTickSize);
      } else {
        return axisEl.select(".domain").attr("d", "M" + 0 + "," + sign * outerTickSize + "V0H" + sign * (axisFunction.scale().originalExtent) + "V" + sign * outerTickSize);
      }
    };

    XAxisBehavior.prototype.getExternalInterval = function(propertyName) {
      var property;
      property = this.visualizer.model.get(propertyName);
      if (!property) {
        return null;
      }
      if (property === quadrigram.Models.VisualizerModel.DEACTIVATED) {
        return null;
      }
      return property;
    };

    XAxisBehavior.prototype.updateTicks = function(axisEl, axisFunction, direction, axisDict) {
      var axisLength, maxSpaceForEachItem, maxTextHeight, maxTextLength, numberOfLabels, paralelRatio, paralelSize, self, step, targetNumberOfLabels, tickValues;
      if (axisFunction.scale().type !== "linear" && axisFunction.scale().type !== "time") {
        axisFunction.tickFormat(function(d) {
          if (axisFunction.scale()._tickFormat != null) {
            return axisFunction.scale()._tickFormat(d);
          } else {
            return d;
          }
        });
      }
      axisFunction.tickValues(null);
      axisEl.call(axisFunction);
      if (axisDict != null) {
        axisEl.selectAll(".tick").selectAll("text").each(function(d, i) {
          if (axisDict[d] != null) {
            return d3.select(this).text(axisDict[d]);
          }
        });
      }
      self = this;
      if (axisFunction.scale().type === "linear" || axisFunction.scale().type === "time") {
        numberOfLabels = axisFunction.ticks()[0];
      } else {
        numberOfLabels = axisFunction.scale().domain().length;
      }
      if (direction === "horizontal") {
        axisLength = this.size.graphWidth;
      } else {
        axisLength = this.size.graphHeight;
      }
      axisEl.selectAll(".tick").selectAll("text").attr("dx", "0px").attr("transform", "");
      maxSpaceForEachItem = axisLength / numberOfLabels;
      maxTextLength = 0;
      maxTextHeight = 0;
      axisEl.selectAll(".tick").selectAll("text").each(function() {
        maxTextLength = Math.max(maxTextLength, this.getComputedTextLength());
        return maxTextHeight = Math.max(maxTextHeight, this.getBBox().height);
      });
      maxTextLength *= 1.2;
      maxTextHeight *= 1.2;
      paralelSize = direction === "horizontal" ? maxTextLength : maxTextHeight;
      paralelRatio = maxSpaceForEachItem / paralelSize;
      if (paralelRatio < 1) {
        targetNumberOfLabels = Math.floor(axisLength / maxTextHeight);
        step = Math.ceil(numberOfLabels / targetNumberOfLabels);
        if (step > 1) {
          if (axisFunction.scale().type === "linear" || axisFunction.scale().type === "time") {
            axisFunction.ticks(targetNumberOfLabels);
          } else {
            tickValues = _.filter(axisFunction.scale().domain(), function(value, index) {
              return index !== numberOfLabels - 2 && (index % step === 0 || index === numberOfLabels - 1);
            });
            axisFunction.tickValues(tickValues);
          }
        }
        axisEl.call(axisFunction);
        if (axisDict != null) {
          axisEl.selectAll(".tick").selectAll("text").each(function(d, i) {
            if (axisDict[d] != null) {
              return d3.select(this).text(axisDict[d]);
            }
          });
        }
      }
      if (paralelRatio < 1 && direction === "horizontal") {
        axisEl.selectAll(".tick").selectAll("text").style("text-anchor", "end").attr("dx", "-8px").attr("dy", "0px").attr("transform", "rotate(-45)");
      }
      axisEl.selectAll(".tick").selectAll("line").attr("stroke", this.config.axisLineColor).attr("stroke-width", "1px");
      return axisEl.select(".domain").attr("stroke", this.config.axisLineColor).attr("stroke-width", "1px");
    };

    XAxisBehavior.prototype.updateXAxis = function() {
      var adjustmentOptions;
      adjustmentOptions = {
        specialFunction: this.visualizer.xDomainAdjustment,
        defaultPadding: this.visualizer.xAxisPadding,
        externalProperty: "axisXRange"
      };
      return this.xScale = this.createScale(this.visualizer.getXDomainValues(), this.visualizer.xAxisType, adjustmentOptions);
    };

    XAxisBehavior.prototype.drawXAxis = function() {
      var labelDict, range;
      this.size.graphWidth = this.size.width - (this.xAxisRestrains.left + this.xAxisRestrains.right) - this.size.margin.right;
      range = [0, this.size.graphWidth || this.size.width];
      this.setRange(this.xScale, range);
      this.xAxis.scale(this.xScale);
      this.updateXLabels();
      if ((this.axisDict != null) && this.axisDict["_x_"]) {
        labelDict = this.axisDict["_x_"];
      }
      this.updateTicks(this.xAxisEl, this.xAxis, "horizontal", labelDict);
      this.visualizer.model.original.xTicks = this.xAxisEl.selectAll(".tick").data();
      if (this.xAxisLabel != null) {
        this.xAxisLabel.attr("transform", "translate(" + ((this.size.width - (this.xAxisRestrains.left + this.xAxisRestrains.right)) / 2) + "," + (this.yAxisRestrains.bottom - this.size.margin.bottom) + ")");
        this.xAxisLabel.attr('fill', this.config.axisLegendColor);
      }
      this.graphWrapper.attr("transform", "translate(" + this.xAxisRestrains.left + "," + this.size.margin.top + ")");
      this.xAxisEl.attr("transform", "translate(" + this.xAxisRestrains.left + "," + (this.size.height - this.yAxisRestrains.bottom) + ")");
      return this.cleanAxis(this.xAxisEl, this.xAxis, this.behaviors.svg.root.select('.xgrid'));
    };

    XAxisBehavior.prototype.setClip = function() {
      var heightValue, totalHeight, totalWidth, translateXAxis, widthValue, xValue, yValue;
      totalWidth = this.behaviors.svg.root.attr("width");
      totalHeight = this.behaviors.svg.root.attr("height");
      if (!totalWidth || !totalHeight) {
        return;
      }
      translateXAxis = this.xAxisEl.attr("transform");
      if (translateXAxis) {
        xValue = 0;
        yValue = -15;
        if (translateXAxis.indexOf(",") > 0) {
          heightValue = parseFloat(translateXAxis.split(",")[1].replace(")", ""));
        } else {
          heightValue = parseFloat(translateXAxis.split(" ")[1].replace(")", ""));
        }
        widthValue = parseFloat(totalWidth) + 15;
      } else {
        xValue = 0;
        yValue = -15;
        heightValue = totalHeight + 15;
        widthValue = parseFloat(totalWidth) + 15;
      }
      return this.clipPathRect.attr("x", xValue).attr("y", yValue).attr("width", widthValue).attr("height", heightValue);
    };

    XAxisBehavior.prototype.updateXLabels = function() {
      var input,
        _this = this;
      if (!this.xScale) {
        return;
      }
      this.axisDict || (this.axisDict = {});
      this.axisDict["_x_"] = {};
      if (this.visualizer.model.get("axisLabels") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        input = this.visualizer.model.get("axisLabels");
        if (_.isArray(input)) {
          return input.forEach(function(d) {
            return _this.axisDict["_x_"][_this.xScale.parser(d.id)] = d.value;
          });
        } else {
          return this.visualizer.ids.forEach(function(d) {
            return _this.axisDict["_x_"][_this.xScale.parser(d)] = input;
          });
        }
      }
    };

    XAxisBehavior.prototype.updateXTitle = function() {
      var xLabel;
      xLabel = "";
      if (this.visualizer.model.get("axisXTitle") != null) {
        xLabel = this.visualizer.model.get("axisXTitle").trim();
      } else {
        if (this.visualizer.xAxisType === "linear") {
          xLabel = this.visualizer.values.label;
        }
      }
      if (this.xAxisLabel != null) {
        return this.xAxisLabel.text(xLabel);
      }
      /*
      yLabel = ""
      if @config.axisYTitle
        yLabel = @config.axisYTitle.trim()
      else
        if @visualizer.yAxisType == "linear"
          yLabel = @visualizer.values.label
      if @yAxisLabel?
        @yAxisLabel.text(yLabel)
      */

    };

    /*
    calculateXAxisArea: ->
      @maxTextHeight = maxTextHeight = 0
      # see if exists any .tick
      xAxisTick = @xAxisEl.selectAll('.tick')[0]
    
      if xAxisTick.length > 0
        # get the first .tick height
        maxTextHeight = xAxisTick[0].getBBox().height
    
        @xAxisEl.selectAll(".tick").each(() ->
          maxTextHeight = Math.max(maxTextHeight,this.getBBox().height)
        )
        @maxTextHeight = parseInt(maxTextHeight)
    
      xAxisLabelHeight = if @xAxisLabel? && @xAxisLabel.text().length>0 then @xAxisLabel[0][0].getBBox().height + @xAxisLabelPadding else 0
    
      @maxTextHeight + @size.margin.bottom + xAxisLabelHeight
    */


    XAxisBehavior.prototype.addXGrid = function() {
      var axisTicks, dataBounds, difference, grid, xGridXPos;
      if ($(this.behaviors.svg.root[0]).has('.xgrid').length > 0) {
        $(this.behaviors.svg.root[0]).find('.xgrid').remove();
      }
      if ($(this.behaviors.svg.root[0]).has('.xgridBold').length > 0) {
        $(this.behaviors.svg.root[0]).find('.xgridBold').remove();
      }
      if (this.visualizer.model.get("xAxisGrid") === "true") {
        xGridXPos = this.xAxisRestrains.left;
        if (this.xScale.type === "bands") {
          if (this.xScale.domain().length >= 2) {
            difference = this.xScale.baseScale(this.xScale.domain()[1]) - this.xScale.baseScale(this.xScale.domain()[0]);
            xGridXPos += -difference / 2;
          } else {
            xGridXPos += -this.xScale.rangeBand();
          }
        }
        grid = this.behaviors.svg.root.insert("g", ".graph-wrapper").attr("class", "xgrid").attr("transform", "translate(" + xGridXPos + "," + (this.size.height - this.yAxisRestrains.bottom) + ")").call(this.makeXGridAxis().tickSize(-this.size.graphHeight, 0, 0).tickFormat(""));
        grid.selectAll('line').attr('stroke', this.config.axisLineColor).attr('stroke-opacity', this.defaultGridOpacity);
        axisTicks = this.xAxisEl.selectAll('.tick');
        dataBounds = d3.extent(axisTicks.data());
        if (parseFloat(dataBounds[0]) < 0 && parseFloat(dataBounds[1]) > 0) {
          grid = this.behaviors.svg.root.insert("g", ".graph-wrapper").attr("class", "xgridBold").attr("transform", "translate(" + this.xAxisRestrains.left + "," + (this.size.height - this.yAxisRestrains.bottom) + ")").call(this.makeXGridBoldAxis().tickSize(-this.size.graphHeight, 0, 0).tickFormat(""));
          return grid.selectAll('line').attr('stroke', this.config.axisLineColor).attr('stroke-opacity', this.defaultGridOpacity);
        }
      }
    };

    /*
    addXGrid_OLD: () =>
    
      #MAAAAAL!!!!
      #MUST USE: model.get("xAxisGrid")
      #NO DEBE DEPENDER DE LA Y!!!!!
      # if there is a previous y grid, lets remove it
      if $(@behaviors.svg.root[0]).has('.xgrid').length > 0
        $(@behaviors.svg.root[0]).find('.xgrid').remove()
    
      # if there is a previous y bold axis, lets remove it
      if $(@behaviors.svg.root[0]).has('.xgridBold').length > 0
        $(@behaviors.svg.root[0]).find('.xgridBold').remove()
    
    
    
      if @config.yAxisGrid is 'true'
        # x postion depending on axis type
        xGridXPos = @yAxisRestrains.bottom
        if @xScale.type == "bands" #@size.axisX.type == "bands"
          if @xScale.domain().length >= 2
            difference = this.xScale.baseScale(this.xScale.domain()[1]) - this.xScale.baseScale(this.xScale.domain()[0])
            xGridXPos += - difference / 2
          else
            xGridXPos += - @xScale.rangeBand()
    
        grid = @behaviors.svg.root.insert("g",".graph-wrapper")
          .attr("class", "xgrid")
          .attr("transform", "translate(" + xGridXPos + "," + ( @size.height - @yAxisRestrains.bottom ) + ")")
          .call(@makeXGridAxis()
              .tickSize(-@size.graphHeight, 0, 0)
              .tickFormat(""))
    
        # set colors
        grid.selectAll('line').attr('stroke', @config.axisLineColor).attr('stroke-opacity', @defaultGridOpacity)
    
    
    
    
      axisTicks = @xAxisEl.selectAll('.tick')
      # min and max values of selected elements
      dataBounds = d3.extent(axisTicks.data())
      # if there is negative values
      if dataBounds[0] < 0 && dataBounds[1] > 0
        # if the user whats to show the bold 0 y axis
        # if @axisGrid.xAxis.showXBoldAxis
        if @config.yAxisGrid is 'true'
          grid = @behaviors.svg.root.insert("g",".graph-wrapper")
            .attr("class", "xgridBold")
            .attr("transform", "translate(" + @xAxisRestrains.left + "," + ( @size.height - @yAxisRestrains.bottom ) + ")")
            .call(@makeXGridBoldAxis()
                .tickSize(-@size.graphHeight, 0, 0)
                .tickFormat(""))
    
          # set colors
          grid.selectAll('line').attr('stroke', @config.axisLineColor).attr('stroke-opacity', @defaultGridOpacity)
    */


    XAxisBehavior.prototype.makeXGridAxis = function() {
      return d3.svg.axis().scale(this.xScale).orient("bottom").ticks(this.axisGrid.xAxis.xGridTicks).tickPadding(0);
    };

    XAxisBehavior.prototype.makeXGridBoldAxis = function() {
      return d3.svg.axis().scale(this.xScale).orient("bottom").ticks(1).tickValues([0]);
    };

    return XAxisBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.XAndYAxisBehavior = (function(_super) {
    __extends(XAndYAxisBehavior, _super);

    function XAndYAxisBehavior() {
      this.makeYGridBoldAxis = __bind(this.makeYGridBoldAxis, this);
      this.makeYGridAxis = __bind(this.makeYGridAxis, this);
      this.addYGrid = __bind(this.addYGrid, this);
      this.calculateXAxisRestrains = __bind(this.calculateXAxisRestrains, this);
      this.updateYTitle = __bind(this.updateYTitle, this);
      this.afterDimensionAxisUpdate = __bind(this.afterDimensionAxisUpdate, this);
      this.drawDimensionAxis = __bind(this.drawDimensionAxis, this);
      this.updateDimensionAxis = __bind(this.updateDimensionAxis, this);
      this.beforeDimensionAxisUpdate = __bind(this.beforeDimensionAxisUpdate, this);
      this.initialize = __bind(this.initialize, this);
      _ref = XAndYAxisBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    XAndYAxisBehavior.info = function() {
      var meta, output;
      meta = JSON.parse(JSON.stringify(XAndYAxisBehavior.meta));
      XAndYAxisBehavior.meta = output = quadrigram.Models.VisualizerModel.mergeInfo(_.deepObjectExtend(meta, XAndYAxisBehavior.extendedMeta), XAndYAxisBehavior.behaviors);
      return output;
    };

    XAndYAxisBehavior.extendedMeta = {
      properties: {
        axisYTitle: {
          "uiTipContent": "Defines the title of the Y Axis",
          label: "Y Axis title",
          sortingWeight: "0",
          family: "axis",
          hidden: true,
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        axisYRange: {
          "uiTipContent": "Defines the visible range of values on the Y Axis",
          label: "Visible range of Y Axis",
          sortingWeight: "3",
          family: "axis",
          hidden: true,
          internal: false,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            StringRange: {
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            },
            SimpleRange: {
              deprecated: true,
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            }
          }
        },
        yAxisGrid: {
          "uiTipContent": "Determines whether to show horizontal grid lines underneath the chart",
          label: "Show horizontal grid lines",
          sortingWeight: "6",
          family: "axis",
          multivalue: false,
          hidden: true,
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: 'true'
              }
            }
          }
        }
      }
    };

    XAndYAxisBehavior.prototype.initialize = function(params) {
      this.axisGrid.yAxis = {
        yGridTicks: 4
      };
      return XAndYAxisBehavior.__super__.initialize.call(this, params);
    };

    XAndYAxisBehavior.prototype.beforeDimensionAxisUpdate = function() {};

    XAndYAxisBehavior.prototype.updateDimensionAxis = function(selection, dimensionId, i) {
      var adjustmentOptions;
      adjustmentOptions = {
        specialFunction: this.visualizer.yDomainAdjustment,
        defaultPadding: true,
        externalProperty: "axisYRange"
      };
      return this.yScales[dimensionId] = this.createScale(this.visualizer.getYDomainValues(dimensionId), this.visualizer.yAxisType, adjustmentOptions);
    };

    XAndYAxisBehavior.prototype.drawDimensionAxis = function(selection, dimensionId, i) {
      var range;
      this.size.graphHeight = this.size.height - this.size.margin.top - this.yAxisRestrains.bottom;
      range = [this.size.graphHeight || this.size.height, 0];
      this.setRange(this.yScales[dimensionId], range);
      this.yAxes[dimensionId].scale(this.yScales[dimensionId]);
      this.updateTicks(selection, this.yAxes[dimensionId], "vertical");
      selection.selectAll(".tick");
      selection.select(".brush").call(this.yScales[dimensionId].brush = d3.svg.brush().y(this.yScales[dimensionId]).on("brush", this.onBrush)).selectAll("rect").attr("x", -8).attr("width", 16).attr("fill-opacity", .3).attr("stroke", "#fff").attr("shape-rendering", "crispEdges");
      return this.updateYTitle();
    };

    XAndYAxisBehavior.prototype.afterDimensionAxisUpdate = function() {
      var leftMostAxisWidth;
      this.yScale = this.yScales["value"];
      this.yAxis = this.yAxes["value"];
      this.yAxisEl = this.yAxisEls;
      leftMostAxisWidth = this.xAxisRestrains.left;
      this.yAxisEls.attr("transform", "translate(" + leftMostAxisWidth + "," + this.size.margin.top + ")");
      return this.addYGrid();
    };

    XAndYAxisBehavior.prototype.updateYTitle = function() {
      var left, leftMostAxis, maxYTextWidth, top, yAxisTick, yLabel;
      if (this.yAxisLabel == null) {
        this.yAxisLabel = this.yAxisEls.append("text").attr("class", "y-axis-label").style("text-anchor", "middle");
      }
      yLabel = "";
      if ((this.visualizer.model.get("axisYTitle") != null) && this.visualizer.model.get("axisYTitle") !== "") {
        yLabel = this.visualizer.model.get("axisYTitle").trim();
      } else {
        if (this.visualizer.yAxisType === "linear") {
          yLabel = this.visualizer.values.label;
        }
      }
      if (this.yAxisLabel != null) {
        this.yAxisLabel.text(yLabel);
      }
      leftMostAxis = this.yAxisEls;
      yAxisTick = leftMostAxis.selectAll('.tick')[0];
      maxYTextWidth = 0;
      if ((yAxisTick != null) && yAxisTick.length > 0) {
        maxYTextWidth = yAxisTick[0].getBBox().width;
        leftMostAxis.selectAll('.tick').each(function() {
          return maxYTextWidth = Math.max(maxYTextWidth, this.getBBox().width);
        });
        maxYTextWidth = parseInt(maxYTextWidth);
      }
      left = -(maxYTextWidth + this.yAxisLabelPadding);
      top = this.size.graphHeight / 2;
      this.yAxisLabel.attr("transform", "translate(" + left + "," + top + ") rotate(-90)");
      return this.yAxisLabel.attr('fill', this.config.axisLegendColor);
    };

    XAndYAxisBehavior.prototype.calculateXAxisRestrains = function() {
      var bbAxis, bbDomain, left, leftMostAxis, maxYTextWidth, mostLeftTick, mostRightTick, yAxisLabelHeight, yAxisTick;
      if (!this.yAxisEls) {
        return 0;
      }
      leftMostAxis = this.yAxisEls;
      yAxisTick = leftMostAxis.selectAll('.tick')[0];
      maxYTextWidth = 0;
      if ((yAxisTick != null) && yAxisTick.length > 0) {
        maxYTextWidth = yAxisTick[0].getBBox().width;
        leftMostAxis.selectAll('.tick').each(function() {
          return maxYTextWidth = Math.max(maxYTextWidth, this.getBBox().width);
        });
        maxYTextWidth = parseInt(maxYTextWidth);
      }
      yAxisLabelHeight = (this.yAxisLabel != null) && this.yAxisLabel.text().length > 0 ? this.yAxisLabel[0][0].getBBox().height + this.yAxisLabelPadding : 0;
      left = maxYTextWidth + this.size.margin.left + yAxisLabelHeight;
      bbAxis = this.xAxisEl.node().getBBox();
      bbDomain = this.xAxisEl.select(".domain").node().getBBox();
      mostLeftTick = bbAxis.x;
      mostRightTick = (mostLeftTick + bbAxis.width) - bbDomain.width;
      return {
        left: Math.max(left, -mostLeftTick),
        right: mostRightTick
      };
    };

    XAndYAxisBehavior.prototype.addYGrid = function() {
      var axisTicks, dataBounds, difference, grid, yGridYPos, yScale;
      yScale = this.yScales["value"];
      if ($(this.behaviors.svg.root[0]).has('.ygrid').length > 0) {
        $(this.behaviors.svg.root[0]).find('.ygrid').remove();
      }
      if ($(this.behaviors.svg.root[0]).has('.ygridBold').length > 0) {
        $(this.behaviors.svg.root[0]).find('.ygridBold').remove();
      }
      if (this.visualizer.model.get("yAxisGrid") === "true") {
        yGridYPos = this.size.margin.top + this.yAxisRestrains.top;
        if (yScale.type === "bands") {
          if (yScale.domain().length >= 2) {
            difference = yScale.baseScale(yScale.domain()[1]) - yScale.baseScale(yScale.domain()[0]);
            yGridYPos += -difference / 2;
          } else {
            yGridYPos += -yScale.rangeBand();
          }
        }
        grid = this.behaviors.svg.root.insert("g", ".graph-wrapper").attr("class", "ygrid").attr("transform", "translate(" + this.xAxisRestrains.left + "," + yGridYPos + ")").call(this.makeYGridAxis().tickSize(-this.size.graphWidth, 0, 0).tickFormat(""));
        grid.selectAll('line').attr('stroke', this.config.axisLineColor).attr('stroke-opacity', this.defaultGridOpacity);
        axisTicks = this.yAxisEls.selectAll('.tick');
        dataBounds = d3.extent(axisTicks.data());
        if (dataBounds[0] < 0 && dataBounds[1] > 0) {
          grid = this.behaviors.svg.root.insert("g", ".graph-wrapper").attr("class", "ygridBold").attr("transform", "translate(" + this.xAxisRestrains.left + "," + yGridYPos + ")").call(this.makeYGridBoldAxis().tickSize(-this.size.graphWidth, 0, 0).tickFormat(""));
          return grid.selectAll('line').attr('stroke', this.config.axisLineColor).attr('stroke-opacity', this.defaultGridOpacity);
        }
      }
    };

    XAndYAxisBehavior.prototype.makeYGridAxis = function() {
      return d3.svg.axis().scale(this.yScales["value"]).orient("left").ticks(this.axisGrid.yAxis.yGridTicks).tickPadding(0);
    };

    XAndYAxisBehavior.prototype.makeYGridBoldAxis = function() {
      return d3.svg.axis().scale(this.yScales["value"]).orient("left").ticks(1).tickValues([0]);
    };

    return XAndYAxisBehavior;

  }).call(this, quadrigram.Models.XAxisBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ZoomableXAndYAxisBehavior = (function(_super) {
    __extends(ZoomableXAndYAxisBehavior, _super);

    function ZoomableXAndYAxisBehavior() {
      this.updatePosition = __bind(this.updatePosition, this);
      this.afterDimensionAxisUpdate = __bind(this.afterDimensionAxisUpdate, this);
      this.drawXAxis = __bind(this.drawXAxis, this);
      this.enableZoom = __bind(this.enableZoom, this);
      this.initialize = __bind(this.initialize, this);
      _ref = ZoomableXAndYAxisBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ZoomableXAndYAxisBehavior.info = function() {
      var meta, output;
      meta = JSON.parse(JSON.stringify(ZoomableXAndYAxisBehavior.meta));
      meta = _.deepObjectExtend(meta, ZoomableXAndYAxisBehavior.extendedMeta);
      meta = _.deepObjectExtend(meta, ZoomableXAndYAxisBehavior.moreExtendedMeta);
      ZoomableXAndYAxisBehavior.meta = output = quadrigram.Models.VisualizerModel.mergeInfo(meta, ZoomableXAndYAxisBehavior.behaviors);
      return output;
    };

    ZoomableXAndYAxisBehavior.moreExtendedMeta = {
      "properties": {
        "zoom": {
          "uiTipContent": "Defines the pan and zoom behavior",
          "label": "Pan and Zoom",
          "family": "axis",
          "sortingWeight": "999",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "None"
              },
              "options": {
                "value": ["X and Y", "Only X", "Only Y", "None"]
              }
            }
          }
        }
      }
    };

    ZoomableXAndYAxisBehavior.prototype.initialize = function(params) {
      var svgBkg,
        _this = this;
      ZoomableXAndYAxisBehavior.__super__.initialize.call(this, params);
      this.zoom = d3.behavior.zoom().scaleExtent([1, 10]).on("zoom", this.updatePosition);
      this.zoomActive = false;
      this.zoomBkg = this.behaviors.svg.root.insert("rect", ":first-child").attr("fill", "none").attr("class", "zoom-bkg").attr("width", "100%").attr("height", "100%");
      svgBkg = this.visualizer.$el.find('.bkg-svg');
      this.visualizer.$el.append("<div class='zoom-message'></div>");
      /*
      svgBkg.attr("data-ui-tip-id","zoom-cover")
      svgBkg.on("mouseenter",()=>
        if !@zoomActive && @visualizer.model.get("zoom")!="None"
          #svgBkg.addClass("ui-tip-target")
          svgBkg.get(0).classList.add("ui-tip-target")
        else
          #svgBkg.removeClass("ui-tip-target")
          svgBkg.get(0).classList.remove("ui-tip-target")
      )
      */

      svgBkg.on("click", function(e) {
        if (!_this.visualizer.$el.closest(".viz-container").hasClass("dragging")) {
          return _this.enableZoom(true);
        }
      });
      return this.visualizer.$el.on("mouseleave", function() {
        return _this.enableZoom(false);
      });
    };

    ZoomableXAndYAxisBehavior.prototype.enableZoom = function(value) {
      this.zoomActive = value;
      if (this.zoomActive && this.visualizer.model.get("zoom") !== "None") {
        this.behaviors.svg.root.call(this.zoom);
        if (this.visualizer.model.get("zoom") === "X and Y") {
          this.zoomBkg.style("cursor", "move");
        } else if (this.visualizer.model.get("zoom") === "Only Y") {
          this.zoomBkg.style("cursor", "ns-resize");
        } else if (this.visualizer.model.get("zoom") === "Only X") {
          this.zoomBkg.style("cursor", "ew-resize");
        }
        return this.zoomBkg.style("pointer-events", "all");
      } else {
        this.behaviors.svg.root.on("onwheel.zoom", null).on("onmousewheel.zoom", null).on("mousewheel.zoom", null).on("wheel.zoom", null);
        this.zoomBkg.style("cursor", "inherit");
        return this.zoomBkg.style("pointer-events", "none");
      }
    };

    ZoomableXAndYAxisBehavior.prototype.drawXAxis = function() {
      var lastY;
      ZoomableXAndYAxisBehavior.__super__.drawXAxis.call(this);
      if (this.visualizer.model.get("zoom") === "X and Y" || this.visualizer.model.get("zoom") === "Only X") {
        if (this.xAxis.scale().invert != null) {
          return this.zoom.x(this.xAxis.scale());
        } else {
          lastY = this.zoom.translate()[1];
          return this.zoom.translate([this.xAxis.scale().zoomTransform.translate, lastY]).scale(this.xAxis.scale().zoomTransform.scale);
        }
      }
    };

    ZoomableXAndYAxisBehavior.prototype.afterDimensionAxisUpdate = function() {
      var lastX;
      ZoomableXAndYAxisBehavior.__super__.afterDimensionAxisUpdate.call(this);
      if (this.visualizer.model.get("zoom") === "X and Y" || this.visualizer.model.get("zoom") === "Only Y") {
        if (this.yAxis.scale().invert != null) {
          this.zoom.y(this.yAxis.scale());
        } else {
          lastX = this.zoom.translate()[0];
          this.zoom.translate([lastX, this.yAxis.scale().zoomTransform.translate]).scale(this.yAxis.scale().zoomTransform.scale);
        }
      }
      if (this.visualizer.model.get("zoom") === "None") {
        return this.visualizer.$el.find(".zoom-message").css("display", "none");
      } else {
        return this.visualizer.$el.find(".zoom-message").css("display", "block");
      }
    };

    ZoomableXAndYAxisBehavior.prototype.updatePosition = function() {
      var adjustmentOptions, lastX, lastY, scale, translate;
      translate = d3.event.translate;
      scale = d3.event.scale;
      if (translate[0] > 0) {
        translate[0] = 0;
      }
      if (translate[0] < this.xScale.originalExtent * (1 - scale)) {
        translate[0] = this.xScale.originalExtent * (1 - scale);
      }
      if (translate[1] > 0) {
        translate[1] = 0;
      }
      if (translate[1] < -1 * this.yScale.originalExtent * (1 - scale)) {
        translate[1] = -1 * this.yScale.originalExtent * (1 - scale);
      }
      this.zoom.translate([translate[0], translate[1]]).scale(scale);
      if (this.xAxis.scale().invert != null) {
        this.updateTicks(this.xAxisEl, this.xAxis, "horizontal");
        this.addXGrid();
      } else if (this.visualizer.model.get("zoom") === "X and Y" || this.visualizer.model.get("zoom") === "Only X") {
        adjustmentOptions = {
          specialFunction: this.visualizer.xDomainAdjustment,
          defaultPadding: this.visualizer.xAxisPadding,
          externalProperty: null,
          zoomTransform: {
            translate: translate[0],
            scale: scale
          }
        };
        this.adjustDomain(this.xScale, this.xScale.domainValues, adjustmentOptions);
        this.updateTicks(this.xAxisEl, this.xAxis, "horizontal");
        this.addXGrid();
        this.cleanAxis(this.xAxisEl, this.xAxis, this.behaviors.svg.root.select('.xgrid'));
        lastY = this.zoom.translate()[1];
        this.zoom.translate([this.xAxis.scale().zoomTransform.translate, lastY]).scale(this.xAxis.scale().zoomTransform.scale);
      }
      if (this.yAxis.scale().invert != null) {
        this.updateTicks(this.yAxisEl, this.yAxis, "vertical");
        this.addYGrid();
      } else if (this.visualizer.model.get("zoom") === "X and Y" || this.visualizer.model.get("zoom") === "Only Y") {
        adjustmentOptions = {
          specialFunction: this.visualizer.yDomainAdjustment,
          defaultPadding: this.visualizer.yAxisPadding,
          externalProperty: null,
          zoomTransform: {
            translate: translate[1],
            scale: scale
          }
        };
        this.adjustDomain(this.yScale, this.yScale.domainValues, adjustmentOptions);
        this.updateTicks(this.yAxisEl, this.yAxis, "vertical");
        this.addYGrid();
        this.cleanAxis(this.yAxisEl, this.yAxis, this.behaviors.svg.root.select('.ygrid'));
        lastX = this.zoom.translate()[0];
        this.zoom.translate([lastX, this.yAxis.scale().zoomTransform.translate]).scale(this.yAxis.scale().zoomTransform.scale);
      }
      this.visualizer.animationActive = false;
      this.visualizer.updateItems();
      this.visualizer.visualizerDidUpdateItems();
      this.behaviors.style.executeBeforeUpdateStage();
      return this.visualizer.animationActive = true;
    };

    return ZoomableXAndYAxisBehavior;

  }).call(this, quadrigram.Models.XAndYAxisBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.DoubleAxisBehavior = (function(_super) {
    __extends(DoubleAxisBehavior, _super);

    function DoubleAxisBehavior() {
      this.calculateXAxisRestrains = __bind(this.calculateXAxisRestrains, this);
      this.updateYTitles = __bind(this.updateYTitles, this);
      this.afterDimensionAxisUpdate = __bind(this.afterDimensionAxisUpdate, this);
      this.drawDimensionAxis = __bind(this.drawDimensionAxis, this);
      this.updateDimensionAxis = __bind(this.updateDimensionAxis, this);
      this.setupDimensionAxis = __bind(this.setupDimensionAxis, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      this.initialize = __bind(this.initialize, this);
      _ref = DoubleAxisBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DoubleAxisBehavior.info = function() {
      var meta, output;
      meta = JSON.parse(JSON.stringify(DoubleAxisBehavior.meta));
      DoubleAxisBehavior.meta = output = quadrigram.Models.VisualizerModel.mergeInfo(_.deepObjectExtend(meta, DoubleAxisBehavior.extendedMeta), DoubleAxisBehavior.behaviors);
      return output;
    };

    DoubleAxisBehavior.extendedMeta = {
      properties: {
        axisYTitle: {
          "uiTipContent": "Defines the title of the Y Axis",
          label: "Y Axis title",
          sortingWeight: "0",
          family: "axis",
          hidden: true,
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        axisYRange: {
          "uiTipContent": "Defines the visible range of values on the Y Axis",
          label: "Visible range of Y Axis",
          sortingWeight: "31",
          family: "axis",
          hidden: true,
          internal: false,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            StringRange: {
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            },
            SimpleRange: {
              deprecated: true,
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            }
          }
        },
        axisY2Title: {
          "uiTipContent": "Defines the title of the Y Axis",
          label: "Y2 Axis title",
          sortingWeight: "01",
          family: "axis",
          hidden: true,
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        axisY2Range: {
          "uiTipContent": "Defines the visible range of values on the Y Axis",
          label: "Visible range of Y2 Axis",
          sortingWeight: "32",
          family: "axis",
          hidden: true,
          internal: false,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            StringRange: {
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            },
            SimpleRange: {
              deprecated: true,
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            }
          }
        },
        yAxisGrid: {
          "uiTipContent": "Determines whether to show horizontal grid lines underneath the chart",
          label: "Show horizontal grid lines",
          sortingWeight: "6",
          family: "axis",
          multivalue: false,
          hidden: true,
          internal: true,
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: 'true'
              }
            }
          }
        }
      }
    };

    DoubleAxisBehavior.prototype.initialize = function(params) {
      return DoubleAxisBehavior.__super__.initialize.call(this, params);
    };

    DoubleAxisBehavior.prototype.behaviorChecking = function() {
      if (this.firstExec || this.visualizer.resizing || this.checkOwnPropertyChanged() || (this.visualizer.model.changed["data1"] != null) || (this.visualizer.model.changed["data2"] != null) || ((this.visualizer.checkAxisChanged != null) && this.visualizer.checkAxisChanged())) {
        this.firstExec = false;
        return true;
      }
    };

    DoubleAxisBehavior.prototype.setupDimensionAxis = function(selection, dimensionId, i) {
      selection.style("pointer-events", "none");
      return selection.attr("data-id", dimensionId);
    };

    DoubleAxisBehavior.prototype.updateDimensionAxis = function(selection, dimensionId, i) {
      var adjustmentOptions;
      adjustmentOptions = {
        defaultPadding: true
      };
      if (dimensionId === "bars") {
        adjustmentOptions.specialFunction = this.visualizer.barDomainAdjustment;
        adjustmentOptions.externalProperty = "axisYRange";
      } else {
        adjustmentOptions.externalProperty = "axisY2Range";
      }
      return this.yScales[dimensionId] = this.createScale(this.visualizer.getYDomainValues(dimensionId), "linear", adjustmentOptions);
    };

    DoubleAxisBehavior.prototype.drawDimensionAxis = function(selection, dimensionId, i) {
      var range;
      this.size.graphHeight = this.size.height - this.size.margin.top - this.yAxisRestrains.bottom;
      range = [this.size.graphHeight || this.size.height, 0];
      this.setRange(this.yScales[dimensionId], range);
      this.yAxes[dimensionId].scale(this.yScales[dimensionId]);
      if (dimensionId === "bars") {
        this.yAxes[dimensionId].orient("right");
      } else {
        this.yAxes[dimensionId].orient("left");
      }
      this.updateTicks(selection, this.yAxes[dimensionId], "vertical");
      /*
      selection.selectAll(".tick")
      
      selection.select(".brush")
        .call(this.yScales[dimensionId].brush = d3.svg.brush().y(this.yScales[dimensionId]).on("brush", this.onBrush))
        .selectAll("rect")
          .attr("x", -8)
          .attr("width", 16)
          .attr("fill-opacity",.3)
          .attr("stroke","#fff")
          .attr("shape-rendering","crispEdges")
      #DEBERIA SER UNA PARA CADA AXIS (yno dos veces los dos...)
      */

      return this.updateYTitles();
    };

    DoubleAxisBehavior.prototype.afterDimensionAxisUpdate = function() {
      var self;
      this.xAxisRestrains = this.calculateXAxisRestrains();
      self = this;
      return this.yAxisEls.each(function(dimensionId, i) {
        var leftMostAxisWidth, selection;
        selection = d3.select(this);
        leftMostAxisWidth = self.xAxisRestrains.left;
        if (i === 0) {
          return selection.attr("transform", "translate(" + (leftMostAxisWidth + self.xAxisEl.select(".domain").node().getBBox().width) + "," + self.size.margin.top + ")");
        } else if (i === 1) {
          return selection.attr("transform", "translate(" + leftMostAxisWidth + "," + self.size.margin.top + ")");
        }
      });
    };

    DoubleAxisBehavior.prototype.updateYTitles = function() {
      var left, leftMostAxis, maxYTextWidth, rightMostAxis, top, yAxisTick, yLabel;
      if (this.leftYAxisLabel == null) {
        this.leftYAxisLabel = this.yAxisEls.filter(function(d, i) {
          return i === 1;
        }).append("text").attr("class", "y-axis-label").style("text-anchor", "middle");
      }
      leftMostAxis = this.yAxisEls.filter(function(d, i) {
        return i === 1;
      });
      yAxisTick = leftMostAxis.selectAll('.tick')[0];
      maxYTextWidth = 0;
      if ((yAxisTick != null) && yAxisTick.length > 0) {
        maxYTextWidth = yAxisTick[0].getBBox().width;
        leftMostAxis.selectAll('.tick').each(function() {
          return maxYTextWidth = Math.max(maxYTextWidth, this.getBBox().width);
        });
        maxYTextWidth = parseInt(maxYTextWidth);
      }
      yLabel = "";
      if ((this.visualizer.model.get("axisYTitle") != null) && this.visualizer.model.get("axisYTitle") !== "") {
        yLabel = this.visualizer.model.get("axisYTitle").trim();
      } else {
        if (this.visualizer.yAxisType === "auto") {
          yLabel = this.visualizer.values2.label;
        }
      }
      if (this.leftYAxisLabel != null) {
        this.leftYAxisLabel.text(yLabel);
      }
      left = -(maxYTextWidth + this.yAxisLabelPadding);
      top = this.size.graphHeight / 2;
      this.leftYAxisLabel.attr("transform", "translate(" + left + "," + top + ") rotate(-90)");
      this.leftYAxisLabel.attr('fill', this.config.axisLegendColor);
      if (this.rightYAxisLabel == null) {
        this.rightYAxisLabel = this.yAxisEls.filter(function(d, i) {
          return i === 0;
        }).append("text").attr("class", "y-axis-label").style("text-anchor", "middle");
      }
      rightMostAxis = this.yAxisEls.filter(function(d, i) {
        return i === 0;
      });
      yAxisTick = rightMostAxis.selectAll('.tick')[0];
      maxYTextWidth = 0;
      if ((yAxisTick != null) && yAxisTick.length > 0) {
        maxYTextWidth = yAxisTick[0].getBBox().width;
        rightMostAxis.selectAll('.tick').each(function() {
          return maxYTextWidth = Math.max(maxYTextWidth, this.getBBox().width);
        });
        maxYTextWidth = parseInt(maxYTextWidth);
      }
      yLabel = "";
      if ((this.visualizer.model.get("axisY2Title") != null) && this.visualizer.model.get("axisY2Title") !== "") {
        yLabel = this.visualizer.model.get("axisY2Title").trim();
      } else {
        if (this.visualizer.yAxisType === "auto") {
          yLabel = this.visualizer.values1.label;
        }
      }
      if (this.rightYAxisLabel != null) {
        this.rightYAxisLabel.text(yLabel);
      }
      left = maxYTextWidth + this.yAxisLabelPadding;
      top = this.size.graphHeight / 2;
      this.rightYAxisLabel.attr("transform", "translate(" + left + "," + top + ") rotate(90)");
      return this.rightYAxisLabel.attr('fill', this.config.axisLegendColor);
    };

    DoubleAxisBehavior.prototype.calculateXAxisRestrains = function() {
      var bbAxis, bbDomain, left, leftMostAxis, maxYTextWidth, mostLeftTick, mostRightTick, right, rightMostAxis, yAxisLabelHeight, yAxisTick;
      if (!this.yAxisEls) {
        return 0;
      }
      leftMostAxis = this.yAxisEls.filter(function(d, i) {
        return i === 1;
      });
      yAxisTick = leftMostAxis.selectAll('.tick')[0];
      maxYTextWidth = 0;
      if ((yAxisTick != null) && yAxisTick.length > 0) {
        maxYTextWidth = yAxisTick[0].getBBox().width;
        leftMostAxis.selectAll('.tick').each(function() {
          return maxYTextWidth = Math.max(maxYTextWidth, this.getBBox().width);
        });
        maxYTextWidth = parseInt(maxYTextWidth);
      }
      yAxisLabelHeight = (this.leftYAxisLabel != null) && this.leftYAxisLabel.text().length > 0 ? this.leftYAxisLabel[0][0].getBBox().height + this.yAxisLabelPadding : 0;
      left = maxYTextWidth + this.size.margin.left + yAxisLabelHeight;
      rightMostAxis = this.yAxisEls.filter(function(d, i) {
        return i === 0;
      });
      yAxisTick = rightMostAxis.selectAll('.tick')[0];
      maxYTextWidth = 0;
      if ((yAxisTick != null) && yAxisTick.length > 0) {
        maxYTextWidth = yAxisTick[0].getBBox().width;
        rightMostAxis.selectAll('.tick').each(function() {
          return maxYTextWidth = Math.max(maxYTextWidth, this.getBBox().width);
        });
        maxYTextWidth = parseInt(maxYTextWidth);
      }
      yAxisLabelHeight = (this.rightYAxisLabel != null) && this.rightYAxisLabel.text().length > 0 ? this.rightYAxisLabel[0][0].getBBox().height + this.yAxisLabelPadding : 0;
      right = maxYTextWidth + this.size.margin.left + yAxisLabelHeight;
      bbAxis = this.xAxisEl.node().getBBox();
      bbDomain = this.xAxisEl.select(".domain").node().getBBox();
      mostLeftTick = bbAxis.x;
      mostRightTick = (mostLeftTick + bbAxis.width) - bbDomain.width;
      return {
        left: Math.max(left, -mostLeftTick),
        right: Math.max(right, mostRightTick)
      };
    };

    return DoubleAxisBehavior;

  }).call(this, quadrigram.Models.XAxisBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ParalelAxisBehavior = (function(_super) {
    __extends(ParalelAxisBehavior, _super);

    function ParalelAxisBehavior() {
      this.getFilteredValues = __bind(this.getFilteredValues, this);
      this.onBrush = __bind(this.onBrush, this);
      this.calculateXAxisRestrains = __bind(this.calculateXAxisRestrains, this);
      this.afterDimensionAxisUpdate = __bind(this.afterDimensionAxisUpdate, this);
      this.drawDimensionAxis = __bind(this.drawDimensionAxis, this);
      this.updateDimensionAxis = __bind(this.updateDimensionAxis, this);
      this.addXGrid = __bind(this.addXGrid, this);
      this.addYGrid = __bind(this.addYGrid, this);
      this.setupDimensionAxis = __bind(this.setupDimensionAxis, this);
      this.initialize = __bind(this.initialize, this);
      _ref = ParalelAxisBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ParalelAxisBehavior.info = function() {
      var meta, output;
      meta = JSON.parse(JSON.stringify(ParalelAxisBehavior.meta));
      ParalelAxisBehavior.meta = output = quadrigram.Models.VisualizerModel.mergeInfo(_.deepObjectExtend(meta, ParalelAxisBehavior.extendedMeta), ParalelAxisBehavior.behaviors);
      return output;
    };

    ParalelAxisBehavior.extendedMeta = {};

    ParalelAxisBehavior.prototype.initialize = function(params) {
      return ParalelAxisBehavior.__super__.initialize.call(this, params);
    };

    ParalelAxisBehavior.prototype.setupDimensionAxis = function(selection, dimensionId, i) {
      selection.style("pointer-events", "none");
      selection.append("g").attr("class", "brush");
      return selection.append("g").attr("class", "toggle").append("image").attr("xlink:href", "./images/general/icons_generales_delete_over.svg").attr("width", "15").attr("height", "15").attr("x", "-7.5").attr("y", "-15").style("opacity", "0.5").style("pointer-events", "all");
    };

    ParalelAxisBehavior.prototype.addYGrid = function() {};

    ParalelAxisBehavior.prototype.addXGrid = function() {};

    ParalelAxisBehavior.prototype.updateDimensionAxis = function(selection, dimensionId, i) {
      var adjustmentOptions;
      $(selection.node()).appendTo(this.visualizer.$el.find(".bkg-svg"));
      adjustmentOptions = {
        defaultPadding: true,
        externalProperty: "axisYRange"
      };
      return this.yScales[dimensionId] = this.createScale(this.visualizer.getYDomainValues(dimensionId), "linear", adjustmentOptions);
    };

    ParalelAxisBehavior.prototype.drawDimensionAxis = function(selection, dimensionId, i) {
      var range, self;
      this.size.graphHeight = this.size.height - this.size.margin.top - this.yAxisRestrains.bottom;
      range = [this.size.graphHeight || this.size.height, 0];
      this.setRange(this.yScales[dimensionId], range);
      this.yAxes[dimensionId].scale(this.yScales[dimensionId]);
      this.updateTicks(selection, this.yAxes[dimensionId], "vertical");
      selection.select(".brush").call(this.yScales[dimensionId].brush = d3.svg.brush().y(this.yScales[dimensionId]).on("brush", this.onBrush)).selectAll("rect").attr("x", -8).attr("width", 16).attr("fill-opacity", .3).attr("stroke", "#fff").attr("shape-rendering", "crispEdges");
      self = this;
      return selection.select(".toggle").style("display", "none").on("click", function(d, i) {
        self.yScales[dimensionId].brush.clear();
        self.yScales[dimensionId].brush(selection.select(".brush"));
        self.onBrush();
        return d3.select(this).style("display", "none");
      });
    };

    ParalelAxisBehavior.prototype.afterDimensionAxisUpdate = function() {
      var self;
      this.onBrush();
      self = this;
      this.yAxisEls.each(function(dimensionId, i) {
        var leftMostAxisWidth, selection;
        selection = d3.select(this);
        leftMostAxisWidth = self.xAxisRestrains.left;
        selection.attr("transform", "translate(" + (self.xScale(dimensionId) + leftMostAxisWidth) + "," + self.size.margin.top + ")");
        return selection.select(".domain").attr("d", "M-6,0" + "H6" + "M0,0V" + (-self.yAxes[dimensionId].scale().originalExtent) + "H" + 0);
      });
      return this.addYGrid();
    };

    ParalelAxisBehavior.prototype.calculateXAxisRestrains = function() {
      var bbAxis, bbDomain, left, leftMostAxis, maxYTextWidth, mostLeftTick, mostRightTick, yAxisLabelHeight, yAxisTick;
      if (!this.yAxisEls) {
        return 0;
      }
      leftMostAxis = this.yAxisEls.filter(function(d, i) {
        return i === 0;
      });
      yAxisTick = leftMostAxis.selectAll('.tick')[0];
      maxYTextWidth = 0;
      if ((yAxisTick != null) && yAxisTick.length > 0) {
        maxYTextWidth = yAxisTick[0].getBBox().width;
        leftMostAxis.selectAll('.tick').each(function() {
          return maxYTextWidth = Math.max(maxYTextWidth, this.getBBox().width);
        });
        maxYTextWidth = parseInt(maxYTextWidth);
      }
      yAxisLabelHeight = (this.yAxisLabel != null) && this.yAxisLabel.text().length > 0 ? this.yAxisLabel[0][0].getBBox().height + this.yAxisLabelPadding : 0;
      left = maxYTextWidth + this.size.margin.left + yAxisLabelHeight;
      bbAxis = this.xAxisEl.node().getBBox();
      bbDomain = this.xAxisEl.select(".domain").node().getBBox();
      mostLeftTick = bbAxis.x;
      mostRightTick = (mostLeftTick + bbAxis.width) - bbDomain.width;
      return {
        left: Math.max(left, -mostLeftTick),
        right: mostRightTick
      };
    };

    ParalelAxisBehavior.prototype.onBrush = function() {
      var actives, extents, filteredIds, filteredValues, self,
        _this = this;
      self = this;
      this.yAxisEls.each(function(d, i) {
        if (!self.yScales[d].brush.empty()) {
          return d3.select(this).select(".toggle").style("display", "block");
        } else {
          return d3.select(this).select(".toggle").style("display", "none");
        }
      });
      actives = this.visualizer.dimensions.filter(function(p) {
        return !_this.yScales[p].brush.empty();
      });
      extents = actives.map(function(p) {
        return _this.yScales[p].brush.extent();
      });
      filteredIds = [];
      this.graph.selectAll(".item").style('display', function(d) {
        if (actives.every((function(p, i) {
          var value;
          if (_.findWhere(d.value, {
            id: p
          }) != null) {
            value = _.findWhere(d.value, {
              id: p
            }).value;
            if (extents[i][0] <= value && value <= extents[i][1]) {
              return true;
            } else {
              return false;
            }
          } else {
            return false;
          }
        }))) {
          filteredIds.push({
            id: d.id,
            value: d.id
          });
          return null;
        } else {
          return 'none';
        }
      });
      this.visualizer.updateOutput("filteredIds", filteredIds);
      filteredValues = this.getFilteredValues(filteredIds);
      this.visualizer.updateOutput("filteredValues", filteredValues);
    };

    ParalelAxisBehavior.prototype.getFilteredValues = function(filteredIds) {
      var dim, entries, idEntry, output, sampleEntry, value, valueEntry, _i, _j, _k, _l, _len, _len1, _len2, _len3, _len4, _m, _ref1, _ref2, _ref3;
      if (filteredIds.length === 0) {
        return [];
      }
      output = [];
      output.label = "output";
      output.metadata = {};
      sampleEntry = this.visualizer.values[0];
      if (sampleEntry && sampleEntry.dataDimensions) {
        output.metadata.idLabel = "dimension";
        output.metadata.valueLabel = "id";
        _ref1 = sampleEntry.dataDimensions;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          dim = _ref1[_i];
          entries = [];
          for (_j = 0, _len1 = filteredIds.length; _j < _len1; _j++) {
            idEntry = filteredIds[_j];
            _ref2 = this.visualizer.values;
            for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
              valueEntry = _ref2[_k];
              if (valueEntry.id === idEntry.id) {
                entries.push({
                  id: valueEntry.id,
                  value: valueEntry[dim]
                });
              }
            }
          }
          value = new quadrigram.Models.DataBlockData(entries);
          value.set("label", "values of " + dim);
          value.metaData = {
            idLabel: "id",
            valueLabel: dim
          };
          output.push({
            id: dim,
            value: value
          });
        }
      } else {
        output.metadata.idLabel = "id";
        output.metadata.valueLabel = "value";
        for (_l = 0, _len3 = filteredIds.length; _l < _len3; _l++) {
          idEntry = filteredIds[_l];
          _ref3 = this.visualizer.values;
          for (_m = 0, _len4 = _ref3.length; _m < _len4; _m++) {
            valueEntry = _ref3[_m];
            if (valueEntry.id === idEntry.id) {
              if (_.isArray(valueEntry.value) && valueEntry.value.length > 1) {
                value = new quadrigram.Models.DataBlockData(valueEntry.value);
                value.set("label", "values of " + valueEntry.id);
                value.metaData = {
                  idLabel: "id",
                  valueLabel: "value"
                };
              } else {
                value = valueEntry.value;
              }
              output.push({
                id: valueEntry.id,
                value: value
              });
            }
          }
        }
      }
      return output;
    };

    return ParalelAxisBehavior;

  }).call(this, quadrigram.Models.XAxisBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RadialAxisBehavior = (function(_super) {
    __extends(RadialAxisBehavior, _super);

    function RadialAxisBehavior() {
      this.drawDimensionAxis = __bind(this.drawDimensionAxis, this);
      this.updateDimensionAxis = __bind(this.updateDimensionAxis, this);
      this.addXGrid = __bind(this.addXGrid, this);
      this.addYGrid = __bind(this.addYGrid, this);
      this.updateXLayout = __bind(this.updateXLayout, this);
      this.updateXAxis = __bind(this.updateXAxis, this);
      this.updateYAxis = __bind(this.updateYAxis, this);
      this.drawXAxis = __bind(this.drawXAxis, this);
      this.setupDimensionAxis = __bind(this.setupDimensionAxis, this);
      this.drawRadialGrid = __bind(this.drawRadialGrid, this);
      this.clearRadialGrid = __bind(this.clearRadialGrid, this);
      this.showAxisTicks = __bind(this.showAxisTicks, this);
      this.removeAxisTicks = __bind(this.removeAxisTicks, this);
      this.afterDimensionAxisUpdate = __bind(this.afterDimensionAxisUpdate, this);
      this.beforeDimensionAxisUpdate = __bind(this.beforeDimensionAxisUpdate, this);
      this.initialize = __bind(this.initialize, this);
      _ref = RadialAxisBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RadialAxisBehavior.info = function() {
      var meta, output;
      meta = JSON.parse(JSON.stringify(RadialAxisBehavior.meta));
      RadialAxisBehavior.meta = output = quadrigram.Models.VisualizerModel.mergeInfo(_.deepObjectExtend(meta, RadialAxisBehavior.extendedMeta), RadialAxisBehavior.behaviors);
      return output;
    };

    RadialAxisBehavior.extendedMeta = {
      properties: {
        axisXTitle: {
          internal: true
        },
        axisXRange: {
          internal: true
        },
        axisLabels: {
          internal: true
        },
        xAxisGrid: {
          internal: true
        },
        radialRange: {
          "uiTipContent": "Defines the visible range of values on the radial Axes",
          label: "Visible range of Axes",
          sortingWeight: "3",
          family: "axis",
          hidden: true,
          internal: false,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            StringRange: {
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            }
          }
        },
        axisYTitle: {
          "uiTipContent": "Defines the title of the Y Axis",
          label: "Axes titles",
          sortingWeight: "0",
          family: "axis",
          hidden: true,
          formats: {
            Text: {
              multiValues: {
                value: true
              },
              defaults: {
                value: ""
              },
              idSource: {
                value: "visualizer.dimensions"
              }
            }
          }
        }
      }
    };

    RadialAxisBehavior.prototype.initialize = function(params) {
      RadialAxisBehavior.__super__.initialize.call(this, params);
      return this.behaviors.style.addStylableTexts(".dimension");
    };

    RadialAxisBehavior.prototype.beforeDimensionAxisUpdate = function() {
      var self,
        _this = this;
      self = this;
      this.theta = 360 / this.visualizer.dimensions.length;
      this.center = {
        x: this.behaviors.svg.size.width / 2,
        y: this.behaviors.svg.size.height / 2
      };
      this.axisLength = this.center.y - 20;
      this.yAxisEls.attr("transform", function(d, i) {
        return "translate(" + _this.center.x + "," + _this.center.y + ") rotate(" + _this.theta * i + ")";
      });
      this.graphWrapper.attr("transform", "translate(" + this.center.x + "," + this.center.y + ")");
      this.graphWrapper.attr("clip-path", "");
      return _.delay(this.setClip, 200);
    };

    RadialAxisBehavior.prototype.afterDimensionAxisUpdate = function() {
      var self;
      self = this;
      this.yAxisEls.each(function(dimensionId, i) {
        var length, r, selection;
        selection = d3.select(this);
        r = self.yAxes[dimensionId].scale().range();
        length = Math.abs(r[1] - r[0]);
        return selection.select(".domain").attr("d", "M" + -6 + "," + 0 + "H0V" + (-length) + "H" + 0);
      });
      if (this.visualizer.model.get("uniformAxes") === "true") {
        this.removeAxisTicks();
        return this.drawRadialGrid();
      } else {
        this.showAxisTicks();
        return this.clearRadialGrid();
      }
    };

    RadialAxisBehavior.prototype.removeAxisTicks = function() {
      return this.yAxisEls.filter(function(d, i) {
        return i !== 0;
      }).selectAll(".tick").style("display", "none");
    };

    RadialAxisBehavior.prototype.showAxisTicks = function() {
      return this.yAxisEls.selectAll(".tick").style("display", "block");
    };

    RadialAxisBehavior.prototype.clearRadialGrid = function() {
      return this.behaviors.svg.root.selectAll(".radial-grid").remove();
    };

    RadialAxisBehavior.prototype.drawRadialGrid = function() {
      var allTicks, d, lineFunction, radialGrid, radialLines, rl, v, _i, _j, _len, _len1, _ref1,
        _this = this;
      lineFunction = d3.svg.line.radial().interpolate("linear-closed").angle(function(d) {
        return 2 * Math.PI * _this.visualizer.dimensions.indexOf(d.id) / _this.visualizer.dimensions.length;
      }).radius(function(d) {
        return _this.yScales[d.id](d.value);
      });
      radialLines = [];
      allTicks = this.yScales[this.visualizer.dimensions[0]].ticks(4);
      allTicks.push(this.yScales[this.visualizer.dimensions[0]].domain()[1]);
      for (_i = 0, _len = allTicks.length; _i < _len; _i++) {
        v = allTicks[_i];
        rl = [];
        _ref1 = this.visualizer.dimensions;
        for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
          d = _ref1[_j];
          rl.push({
            id: d,
            value: v
          });
        }
        radialLines.push(rl);
      }
      radialGrid = this.behaviors.svg.root.selectAll(".radial-grid").data(radialLines);
      radialGrid.enter().insert("g", ".graph-wrapper").attr("class", "radial-grid").append("path").attr("fill", "none").attr("stroke-opacity", "0.7").attr('stroke', this.config.axisLineColor);
      radialGrid.select("path").attr("d", function(d) {
        return lineFunction(d);
      }).attr("transform", "translate(" + this.center.x + "," + this.center.y + ")");
      return radialGrid.exit().remove();
    };

    RadialAxisBehavior.prototype.setupDimensionAxis = function(selection, dimensionId, i) {
      return selection.append("text");
    };

    RadialAxisBehavior.prototype.drawXAxis = function() {};

    RadialAxisBehavior.prototype.updateYAxis = function() {};

    RadialAxisBehavior.prototype.updateXAxis = function() {};

    RadialAxisBehavior.prototype.updateXLayout = function() {};

    RadialAxisBehavior.prototype.addYGrid = function() {};

    RadialAxisBehavior.prototype.addXGrid = function() {};

    RadialAxisBehavior.prototype.updateDimensionAxis = function(selection, dimensionId, i) {
      var adjustmentOptions;
      adjustmentOptions = {
        specialFunction: this.visualizer.yDomainAdjustment,
        defaultPadding: true,
        externalProperty: "radialRange"
      };
      return this.yScales[dimensionId] = this.createScale(this.visualizer.getYDomainValues(dimensionId), "linear", adjustmentOptions);
    };

    RadialAxisBehavior.prototype.drawDimensionAxis = function(selection, dimensionId, i) {
      var externalLabelObject, label, range,
        _this = this;
      range = [0, this.axisLength];
      this.setRange(this.yScales[dimensionId], range);
      this.yAxes[dimensionId].scale(this.yScales[dimensionId].copy().range([0, -this.axisLength]));
      this.yAxes[dimensionId].ticks(3);
      this.updateTicks(selection, this.yAxes[dimensionId], "vertical");
      externalLabelObject = _.findWhere(this.visualizer.model.get("axisYTitle"), {
        id: dimensionId
      });
      if ((externalLabelObject != null) && (externalLabelObject.value != null)) {
        label = externalLabelObject.value;
      } else {
        label = dimensionId;
      }
      return selection.select("text").attr("transform", "translate(0," + (-this.axisLength - 10) + ") rotate(" + (-this.theta * i) + ")").style("text-anchor", function(d) {
        if (_this.theta * i === 0) {
          return "middle";
        } else if (_this.theta * i < 180) {
          return "start";
        } else {
          return "end";
        }
      }).text(label);
    };

    return RadialAxisBehavior;

  }).call(this, quadrigram.Models.XAxisBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SvgBehavior = (function(_super) {
    __extends(SvgBehavior, _super);

    function SvgBehavior() {
      this.requestDownloadImageURL = __bind(this.requestDownloadImageURL, this);
      this.didResize = __bind(this.didResize, this);
      this.onResize = __bind(this.onResize, this);
      this.updateSize = __bind(this.updateSize, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      this.initialize = __bind(this.initialize, this);
      _ref = SvgBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SvgBehavior.stage = "beforeUpdate";

    SvgBehavior.prototype.initialize = function(params) {
      this.root = d3.select(this.visualizer.el).append("svg").attr("class", "bkg-svg").attr("xmlns", "http://www.w3.org/2000/svg");
      this.size = {
        width: 200,
        height: 200
      };
      $(this.root[0]).parents('.viz-view').on('onResize', this.onResize);
      return $(this.root[0]).parents('.viz-view').on('didResize', this.didResize);
    };

    SvgBehavior.field = "svg";

    SvgBehavior.behaviors = [];

    SvgBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(SvgBehavior.meta, SvgBehavior.behaviors);
      return output;
    };

    SvgBehavior.meta = {
      "name": "svg",
      "properties": {}
    };

    SvgBehavior.prototype.resizeCover = null;

    SvgBehavior.prototype.executeBeforeUpdateStage = function() {
      return this.updateSize({
        width: this.visualizer.$el.width(),
        height: this.visualizer.$el.height()
      });
    };

    SvgBehavior.prototype.updateSize = function(newSize) {
      var field;
      for (field in newSize) {
        this.size[field] = newSize[field];
      }
      return this.root.attr("width", this.size.width).attr("height", this.size.height);
    };

    SvgBehavior.prototype.onResize = function() {
      if (!this.visualizer.behaviors.axis) {
        this.updateSize({
          width: this.visualizer.$el.width(),
          height: this.visualizer.$el.height()
        });
      }
      if (this.resizeCover === null) {
        return this.setFakeGraphic();
      }
    };

    SvgBehavior.prototype.didResize = function() {
      if (this.resizeCover != null) {
        $(this.root[0]).css('display', 'visile');
        $(this.resizeCover).remove();
        return this.resizeCover = null;
      }
    };

    SvgBehavior.prototype.setFakeGraphic = function() {
      var img, rect, svg;
      if (this.resizeCover != null) {
        return;
      }
      this.resizeCover = $("<div class='resize-cover'></div>");
      svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
      rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
      img = document.createElementNS("http://www.w3.org/2000/svg", "image");
      $(this.resizeCover).css('width', '100%');
      $(this.resizeCover).css('height', '100%');
      $(svg).css('width', '100%');
      $(svg).css('height', '100%');
      $(rect).attr('width', '100%');
      $(rect).attr('height', '100%');
      $(rect).attr('opacity', '0.5');
      $(rect).attr('preserveAspectRatio', 'none');
      $(img).attr('width', '15px');
      $(img).attr('height', '15px');
      $(img).attr('x', '50%');
      $(img).attr('y', '50%');
      $(img).attr('preserveAspectRatio', 'none');
      img.setAttributeNS('http://www.w3.org/1999/xlink', 'href', 'images/expand.png');
      $(svg).attr("class", "resizeGraph");
      $(rect).attr("class", "resizeGraphBG");
      $(img).attr("class", "resizeGraphIcon");
      svg.appendChild(rect);
      svg.appendChild(img);
      this.resizeCover.append(svg);
      $(this.root[0]).css('display', 'none');
      return this.visualizer.$el.append(this.resizeCover);
    };

    SvgBehavior.prototype.requestDownloadImageURL = function(callback, type) {
      /*
      $(svgSource).prepend("
          <defs>
            <style>
             @font-face {
              font-family: 'latoregular';
              src: url(data:application/x-font-woff;charset=utf-8;base64,AAEAAAATAQAABAAwRkZUTWcnAw0AAAE8AAAAHEdERUYC8gHSAAABWAAAACxHUE9TuT6DQAAAAYQAAA5eR1NVQibDINUAAA/kAAAAYE9TLzK39vyMAAAQRAAAAGBjbWFwn9BCKgAAEKQAAAHiY3Z0IA24ETAAABKIAAAAOGZwZ21TtC+nAAASwAAAAmVnYXNwAAAAEAAAFSgAAAAIZ2x5ZpWXzhIAABUwAACO6GhlYWQDfZquAACkGAAAADZoaGVhD4EGRAAApFAAAAAkaG10eMh8UuMAAKR0AAADqGxvY2FthkuGAACoHAAAAdZtYXhwAgcBoQAAqfQAAAAgbmFtZcrz5DEAAKoUAAADJnBvc3QHjy2QAACtPAAAAuVwcmVw4TFYJAAAsCQAAAETd2ViZveLUnsAALE4AAAABgAAAAEAAAAAzD2izwAAAADMR7gzAAAAAM6hqAoAAQAAAA4AAAAkAAAAAAACAAMAAQDlAAEA5gDmAAIA5wDpAAEABAAAAAIAAAABAAAACgAwAD4AAkRGTFQADmxhdG4AGgAEAAAAAP//AAEAAAAEAAAAAP//AAEAAAABa2VybgAIAAAAAQAAAAEABAACAAAAAgAKA5wAAQMmAAQAAAA0AHIAcgB4AI4AnACqALAAugF8AYIAqgGIAZIBrAHCAeAB8gIEAj4CRAJeArAC3gLsAvIC7AMMAI4AjgCOAI4AjgCOAJwAsACwALAAsACqAKoAqgCqAKoAqgIEAuwC7AIEAHIAcgByAHIAAQBaAAsABQA5ABQAOgAlADwAFgCfABYAxAAWAAMAIv+wAFf/7wBa/98AAwAM/+YAQP/0AGD/7wABAIj/3wACAEn/7gBa/+oAMAAP/u8AEf7vAB3+7wAk/8UANwAUAET/3gBG/+sAR//rAEj/6wBK/+sAUv/rAFT/6wBV/+YAWP/qAFn/6ABc/+gAgv/FAIP/xQCE/8UAhf/FAIb/xQCH/8UAov/eAKP/3gCk/94Apf/eAKb/3gCn/94Aqf/rAKr/6wCr/+sArP/rAK3/6wC0/+sAtf/rALb/6wC3/+sAuP/rALv/6gC8/+oAvf/qAL7/6gC//+gAwf/oAMP/6wDZ/u8A3P7vAN7+7wABAFr/wQABAFr/zAACAFcADgCI/tsABgA3/98AOf/kADr/7AA8/90An//dAMT/3QAFADf/zgA5/+0APP/QAJ//0ADE/9AABwBV/78AWv/RAG3/aQB9/20AiP9EAKj/rAC6/6EABAAMABQAQAARAFX/4gBgABMABAAMAA8AQAAMAFX/6wBgAA4ADgAJ/+IADAAUAA3/zwBAABIASf/qAFX/2ABX/+oAYAATAG3/rgB9/80AiP+gAKj/wQC6/8AA3f/TAAEAWv/lAAYALf/uADj/7gCb/+4AnP/uAJ3/7gCe/+4AFAAFABAACgAQAAwAFABAABIARv/oAEf/6ABI/+gASv/oAFT/6ABgABMAqf/oAKr/6ACr/+gArP/oAK3/6ADD/+gA1wAQANgAEADaABAA2wAQAAsARv/sAEf/7ABI/+wASv/sAFT/7ACp/+wAqv/sAKv/7ACs/+wArf/sAMP/7AADAEkADwBXABEAWgARAAEASQANAAYAD/+EABH/hAAd/4QA2f+EANz/hADe/4QABgAt/+wAOP/sAJv/7ACc/+wAnf/sAJ7/7AABADQABQAKAAsAJAAmACcAKAApAC4ALwAyADMANAA1ADcAOQA6ADwAPQA+AEkATgBVAFkAWgBcAF4AggCDAIQAhQCGAIcAiQCKAIsAjACNAJIAlACVAJYAlwCYAJ8AvwDBAMQA1wDYANoA2wACCewABAAAB1AImAAgAB0AAP/a/4j/zv/F/+z/pv+lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD+5gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/5f/o/8n/8wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/rAAAAAAAAAAAAAP/l/+r/1QAA/4f/6v/p/+EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+0AAP/tAAAAFAAAAAAAAAAAAAAAAAAA/+//5gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAA/+MAAP/kAAAAAAARAAAAEQAAAAD/5AAR/+UAAAAAAAAAAAAAAAAAAAAAAAAAAP/qAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+YAAP/lAAAAAAAAAAAAAAAAAAAAAAAA/+n/2AAAAAD/o/9e/+EAAAAAAAAAAAAAAAAAAP8BABMAAAAAAAAAAAAA/zL/M/7qAAAAAAAAAAAAAP/y/4UAAAAAAAAAAP/n/+j/owAAAAAAAAAAAAAAAP9P//X/8wAA//MAAAAAAAAAAAAA/m7/zv/d/3EAAAAPAAD/qAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/lP+t/6f/p/+x/7QAEAAQABAAAP7/AAAAAP/L/7//rwAA/37/fP7x/+QAAAAP//D/s//EAAAAAAAA/7X/0v/UAAD/0gAAAAAAAAAAAAD/KQAAAAAAAP/k//UAAAAAAAD/Zv/zAAAAAAAAAAAAAAAAAAAAAP/V/9//4QAA/+EAAAAOAAAAAAAA/3IAAAAAAAD/7QAAAAAAAAAA/8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+YAAP/rAAAAAAAOAAAAAAAAAAAAAAAR/+v/4QAAABH/0f9n/+cAAAAAAAAAAAAAAAAAAAAA/2z/wf+//9j/v//GABEAEgASAAD/GgANAAAAAP/Z/+wAAAAAAAD/av/j/6AAEf/w/+n/4v+gAAAAAAANAAD/6wAA/+sAAAAAAAAAAAAAAAAAAAAAAAD/7f/lAAAAAAAAAAD/5gAAAAAAAAAAAAAAAAAA/+8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//UAAP/yAAAAAAAAAAAAAAAA//H/8QAAAAD/9QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/8wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/7AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/xAAD/8AAAAAAAAAAAAAAAAP/r//AAAAAAABAAAAAA/+0AAP/sAAAAAAAAAAAAAP9UAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPAAD/8f/zAAD/8QAAAAAAAAAAAAD/WwAAAAAAAAAAAAAAAP/XAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/7AAA/9kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAP/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/zT/Xv9V/1X/Zv9qAAcABwAHAAD+OAAAAAD/kv99/2IAAP8P/wz+IP+9AAAABf/R/2r/hgAAAAD/wAAAAAAAAAAAAAAAAP+c/8j/rf/rAAAAAAAAAAAAAAAA/+cAAAAAAAAAAAAAAAAAAP/JAAAAAAAAAAD/pf+v/73/rv+9/9IAEgAAABIAAP53AAAAAP/KAAAAAAAA/7v/6f87/+kAAAAAAAAAAAAAAAAAAAAAAAAAAP/sAAD/7AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/YAAAAAAAAAAAAAAAAAAAAAAAAAAD/eQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/dAAAAAP/tAAAAAAAAAAAAAP/1AAAAAAACADYADwAPAAEAEQARAAEAHQAdAAEAJQAlAAIAJgAmAAMAJwAnAAQAKAAoAAUAKwAsAAYALQAtAAcALgAuAAgALwAvAAkAMAAxAAYAMgAyAAQAMwAzAAoANwA3AAsAOAA4AAcAOQA5AAwAOgA6AA0AOwA7AA4APAA8AA8APQA9ABAARABEABEARQBFABIARgBGABMASABIABQASwBLABUAUABRABUAUgBSABYAUwBTABIAVQBVABcAWQBZABgAWwBbABkAXABcABgAXQBdABoAiQCJAAMAigCNAAUAjgCRAAYAkgCSAAQAkwCTAAYAlACYAAQAmwCeAAcAnwCfAA8AogCnABEAqQCpABMAqgCtABQAswCzABUAtAC4ABYAvwC/ABgAwADAABIAwQDBABgAxADEAA8A2QDZAAEA3ADcAAEA3gDeAAEAAgA4AAUABQABAAoACgABAA8ADwAMABAAEAAVABEAEQAMAB0AHQAMACQAJAACACYAJgAWACoAKgAWAC0ALQAcADIAMgAWADQANAAWADYANgAZADcANwAIADgAOAAXADkAOQAJADoAOgAYADsAOwANADwAPAAKAD0APQAOAEQARAADAEYASAAEAEoASgAEAFAAUQAFAFIAUgAGAFMAUwAFAFQAVAAEAFYAVgAHAFgAWAAQAFkAWQARAFsAWwAaAFwAXAARAF0AXQAbAG8AbwAVAIIAhwACAIkAiQAWAJQAmAAWAJoAmgAWAJsAngAXAJ8AnwAKAKIApwADAKkArQAEALMAswAFALQAuAAGALsAvgAQAL8AvwARAMEAwQARAMIAwgAWAMMAwwAEAMQAxAAKANUA1gAVANcA2AABANkA2QAMANoA2wABANwA3AAMAN4A3gAMAAIAGAAFAAUAAAAKAAoAAQAPAA8AAgARABEAAwAdAB0ABAAlACgABQArADMACQA3AD0AEgBEAEYAGQBIAEgAHABLAEsAHQBQAFMAHgBVAFUAIgBZAFkAIwBbAF0AJACJAJgAJwCbAJ8ANwCiAKcAPACpAK0AQgCzALgARwC/AMEATQDEAMQAUADXANwAUQDeAN4AVwAAAAEAAAAKAC4APAACREZMVAAObGF0bgAaAAQAAAAA//8AAQAAAAQAAAAA//8AAAABbGlnYQAIAAAAAQAAAAEABAAEAAAAAQAIAAEAEgABAAgAAQAEAOYAAgBMAAEAAQBJAAMEIAGQAAUABAWaBTMAAAEfBZoFMwAAA9EAZgIAAAACAAAAAAAAAAAA4AAC71AAIFsAAAAgAAAAAEdvb2cAQAAN+wQGZv5mAAAIdwJTIAABn08BAAAEOgWwAAAAIAACAAAAAwAAAAMAAAAcAAEAAAAAANwAAwABAAAAHAAEAMAAAAAsACAABAAMAAAADQB+AP8BUwF4AsYC3CAKIBQgGiAeICIgJiAvIDogXyCsISLgAPsE//8AAAAAAA0AIACgAVIBeALGAtwgACAQIBggHCAiICYgLyA5IF8grCEi4AD7Af//AAH/9f/j/8L/cP9M/f/96uDH4MLgv+C+4LvguOCw4Kfgg+A338Ig5QXlAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQYAAAEAAAAAAAAAAQIAAAACAAAAAAAAAAAAAAAAAAAAAQAAAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8gISIjJCUmJygpKissLS4vMDEyMzQ1Njc4OTo7PD0+P0BBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltcXV5fYGEAhoeJi5OYnqOipKalp6mrqqytr66wsbO1tLa4t7y7vb4AcmRlad14oXBr5HZqAIiaAHMAAGd3AAAAAABsfACouoFjbgAAAABtfd5igoWXwsPV1trb19i5AMHEAOPg4ebnAHnZ3ACEjIONio+QkY6VlgCUnJ2bAMXGcQAAAHoAAAAAAAAABDoFrwCbAKUAkgCgAIUAvADFAMkAxQDbAJ0AoQCxAL8AxQDJAJcAlADDAKoArQC5AI8ARAURsAAssAATS7BMUFiwSnZZsAAjPxiwBitYPVlLsExQWH1ZINSwARMuGC2wASwg2rAMKy2wAixLUlhFI1khLbADLGkYILBAUFghsEBZLbAELLAGK1ghIyF6WN0bzVkbS1JYWP0b7VkbIyGwBStYsEZ2WVjdG81ZWVkYLbAFLA1cWi2wBiyxIgGIUFiwIIhcXBuwAFktsAcssSQBiFBYsECIXFwbsABZLbAILBIRIDkvLbAJLCB9sAYrWMQbzVkgsAMlSSMgsAQmSrAAUFiKZYphILAAUFg4GyEhWRuKimEgsABSWDgbISFZWRgtsAossAYrWCEQGxAhWS2wCywg0rAMKy2wDCwgL7AHK1xYICBHI0ZhaiBYIGRiOBshIVkbIVktsA0sEhEgIDkvIIogR4pGYSOKIIojSrAAUFgjsABSWLBAOBshWRsjsABQWLBAZTgbIVlZLbAOLLAGK1g91hghIRsg1opLUlggiiNJILAAVVg4GyEhWRshIVlZLbAPLCMg1iAvsAcrXFgjIFhLUxshsAFZWIqwBCZJI4ojIIpJiiNhOBshISEhWRshISEhIVktsBAsINqwEistsBEsINKwEistsBIsIC+wBytcWCAgRyNGYWqKIEcjRiNhamAgWCBkYjgbISFZGyEhWS2wEywgiiCKhyCwAyVKZCOKB7AgUFg8G8BZLbAULLMAQAFAQkIBS7gQAGMAS7gQAGMgiiCKVVggiiCKUlgjYiCwACNCG2IgsAEjQlkgsEBSWLIAIABDY0KyASABQ2NCsCBjsBllHCFZGyEhWS2wFSywAUNjI7AAQ2MjLQAAAAABAAH//wAPAAIARAAAAmQFVQADAAcALrEBAC88sgcEGu0ysQYF3DyyAwIa7TIAsQMALzyyBQQa7TKyBwYb/DyyAQIa7TIzESERJSERIUQCIP4kAZj+aAVV+qtEBM0AAAACAKsAAAFxBbAAAwAHADMAsgAAACuxAQrpsgUCACsBsAgvsATWsAAysQcL6bACMrEHC+mxCQErALEFARESsAQ5MDEzNTMVAxEzEavGxsXMzAHeA9L8LgAAAgBQBBACSwYYAAUACwA+ALAAL7AGM7QCCgAIBCuwCDIBsAwvsAHWsQQL6bAEELEHASuxCgvpsQ0BK7EEARESsAU5sQoHERKwCzkAMDETNxEzEQczNxEzEQdQAcVl1AHFZQQQ8AEY/vL6+AEQ/vL6AAIARgAABKIFsAAbAB8BVwCyGgAAK7IVFhkzMzOyBwIAK7IICwwzMzO0AAEaBw0rswIRHB0kFzOxAAXpsxQXGBskFzK0BQQaBw0rswMQHh8kFzOxBQXpswYJCg0kFzIBsCAvsBrWsRkT6bAZELEWASuxFRPpshUWCiuzQBUTCSuzCBUWCCuxBxPpsAcvsQgT6bIHCAors0AHBAkrsBUQsQsBK7EME+mxIQErsDYauj7Q87oAFSsKuj7L858AFSsKsBoQswIaBxMrswMaBxMrswYaBxMrsBkQswkZCBMrsBYQswoWCxMrsBUQsw0VDBMrsxAVDBMrsxEVDBMrsxQVDBMrsBYQsxcWCxMrsBkQsxgZCBMrsBoQsxsaBxMrsBkQsxwZCBMrsBYQsx0WCxMrsx4WCxMrsBkQsx8ZCBMrA0AQAgMGCQoNEBEUFxgbHB0eHy4uLi4uLi4uLi4uLi4uLi6wQBoAMDETNSETITUhEzMDIRMzAzMVIwMzFSMDIxMjAyMTNyETI0YBCET/AAEcUpdSAP9Sl1LH4kTb91CYUP9Ql1CzAP9E/wGajAFcjgGg/mABoP5gjv6kjP5mAZr+ZgGajAFcAAAAAAEAcv8wBBUGnQAsAJgAsioAACuwJzOxBQbpsioFCiuzQCopCSuyEQIAK7AUM7EbBumyERsKK7NAERIJKwGwLS+wDtaxHgvpsAAg1hGxAhDpsB4QsREBK7EUDemwKSDWEbEoDemwFBCxCAErsBgysSQL6bAXMrEuASuxKR4RErAMObAoEbMLBRshJBc5sQgUERKwIjkAsRsFERK0AAEOFyQkFzkwMRM3MxQWMzI2NTQmJy4BNTQ2NzUzFR4BFSM0JiMiBhUUFhceARUUBgcVIzUuAXICvptxgZGAksrOvaaeqLnEfnB2dXmezcbOtJ2s3AGoBZqDe21ZgDI9zKql0BXd3hjvyYioe2theDZCxamsyxPAvxLXAAAFAGj/6wWDBcUADQAbAB8ALQA7AIoAsisAACuxMQfpsgQCACuxGAfptDgkKwQNK7E4B+m0EQsrBA0rsREH6QGwPC+wANaxDhPpsA4QsRQBK7EIE+mwCBCxIAErsS4T6bAuELE0ASuxKBPpsT0BK7EUDhESswsEHB8kFzmxNC4RErMdJCseJBc5ALE4MRESsRwfOTmxGBERErEdHjk5MDETNTQ2MzIWHQEUBiMiJjcUFjMyNj0BNCYjIgYVEwEXASU1NDYzMhYdARQGIyImNxQWMzI2PQE0JiMiBhVopImJpKOIiqWSUUxJUFFKS1BjAsdt/TkBX6SJiKWkh4qlklFMSVBSSUpRBEtNf66tgE1/rKx/SmdmS01KaWlK/BkEckP7jqlOf62tf06ArKyAS2dnS05KaGhKAAADAED/6wTQBcUAIQAsADkAgwCyGwAAK7IfAAArsSUD6bIJAgArsTcD6QGwOi+wANaxIgvpswYiAAgrsS0L6bAiELE0ASuxDA/psAwQsRQBK7EVD+mxOwErsS0GERKwAzmwNBG0CR8lKRAkFzmwDBKwKDmwFBGyERscOTk5ALElGxESsBw5sDcRtQAGDBgpMCQXOTAxEzQ2Ny4BNTQ2MzIWFRQGDwEBPgE1MxQGBxcHIycOASMiJDcUFjMyNjcBBw4BExQWFzc+ATU0JiMiBkCNjE5Mw6uexmlnbQFUKS6wTkq5AuVVUMJo2f7/xY6HSIw+/pcoWzt/NjaKOSlhTlFYAYh6t1xjm1Kpt7aAYo9LUP5nQZ5YhOBZ3wVmPD/mt3GSMS4Bsx1EfAKtNXNEXyZZNj1ecQAAAAABAFAEHwEWBhgABQApALAAL7QCCgAJBCsBsAYvsAHWsQQL6bEEC+mxBwErsQQBERKwBTkAMDEbATUzFQNQAcVlBB8BCfDf/uYAAAAAAQCE/jECnQZkABEAEwABsBIvsADWsQoL6bETASsAMDETNRAANx8BBgIRFRASFwcjJgCEAT6vBiaJy8qKJgav/sICRgkBigIuXQF0a/4o/qUN/qX+KHRsXQItAAABAAb+MQIfBmQAEQATAAGwEi+wA9axDQvpsRMBKwAwMRM2EhE1EAInNzMWABEVEAAHIwaHzdOBJgauAT/+wa4G/p1pAeEBXQ0BVgHjbmxd/dL+dgn+df3TXQAAAAEAHAJfA1cFsAAOACAAsgMCACsBsA8vsALWsQUT6bEQASuxBQIRErALOQAwMRM3BQMzAyUXBRMHCwEnExwxASgKoQoBJTD+0sGDtbCExgQvmm8BVv6kbpxZ/vJgAR/+6V0BEgABAE4AkgQ0BLYACwBSALAAL7AHM7EBCOmwBTKyAAEKK7NAAAoJK7IBAAors0ABAwkrAbAML7AK1rACMrEJC+mwBDKyCQoKK7NACQcJK7IKCQors0AKAAkrsQ0BKwAwMRM1IREzESEVIREjEU4BksUBj/5xxQJdsgGn/lmy/jUBywAAAAABADD+/gE7AN0ABQAlALAAL7QCCgAJBCsBsAYvsAHWsQQL6bEHASuxBAERErAFOQAwMRsBNTMVAzBGxZb+/gE8o63+zgAAAAABACMCGgINArQAAwAiALAAL7EBA+mxAQPpAbAEL7EAASu0AwwACQQrsQUBKwAwMRM1IRUjAeoCGpqaAAABAKEAAAFmAMoAAwApALIAAAArsQEK6bIAAAArsQEK6QGwBC+wANaxAwvpsQML6bEFASsAMDEzNTMVocXKygAAAQAQ/4MDFwWwAAMAEQCyAQIAKwGwBC+xBQErADAxFwEzARACYKf9oX0GLfnTAAAAAgBx/+sEEAXFAA0AGwA6ALILAAArsRED6bIEAgArsRgD6QGwHC+wANaxDgvpsA4QsRQBK7EIC+mxHQErsRQOERKxCwQ5OQAwMRMREBIzMhIZARACIyICNxQWMzI2NRE0JiMiBhVx+dbX+ffX1/rFioKCh4mCgogCKwFZARYBK/7V/ur+p/7p/tcBKu69wcC+Aau9v7+9AAABALoAAAKpBbAABQAzALIEAAArsgICACuxAQIQIMAvsQAF6QGwBi+wBNaxAwvpsgQDCiuzQAQBCSuxBwErADAxEzUlESMRugHvxQTsjjb6UATwAAABAGEAAAQmBcUAGgBvALIOAAArsQsD6bIDAgArsRYD6bIWAwors0AWGgkrAbAbL7Aa1rEZEOmwGRCxEwErsQYL6bIGEwors0AGDQkrshMGCiuzQBMOCSuxHAErsRMZERKyAwsKOTk5ALELDhESsA85sBYRsgYAEzk5OTAxEyYAMzIWFRQGBwEXIRUhNQE+ATU0JiMiBhUjYQUBBObE6Y1//oECArz8UAHdgFt/aZePvQQJvAEA5bF374n+XwWahwISj6hYbZWbjAAAAAABAGT/6wP7BcUAKgCQALIoAAArsQUD6bIFKAors0AFAQkrshwCACuxFAPpshQcCiuzQBQYCSu0DQwoHA0rsQ0D6QGwKy+wANawGDKxAhDpsBcysAIQsQgBK7ElC+mwESDWEbEfC+myER8KK7NAEQwJK7EsASuxEQIRErMFHCIoJBc5ALEMBRESsQAlOTmwDRGwIjmwFBKxGR85OTAxEzczFBYzMjY1NCYrATUzMjY1NCYjIgYVIycmNjMyFhUUBgceARUUBCMiJGQDvI17fY5+iKysg218eXOLvQIF+cnK8G1tg23++8vH/vsBegZziIiFh4Cag3V9godwBqXn18dasy8ruHLH5NcAAAAAAgA3AAAEUgWwAAoADwBYALIJAAArsgICACu0AAsJAg0rsAQzsQAD6bAGMgGwEC+wCdawDDKxCAvpsAMysggJCiuzQAgGCSuyCQgKK7NACQAJK7ERASsAsQsAERKwATmwAhGwDjkwMRM1ATMRMxUjESMRJSERJwc3AoLQycnE/kQBvAYTAVBvA/H8Opr+sAFQmgKrATIAAAABAJ3/6wQTBbAAHwDDALIdAAArsQUD6bIFHQors0AFAQkrshACACuxEwTpsw4dEAgrtBcLHRANK7EXBOkBsCAvsA/WsxAPAA4rsQIP6bEIASuxGgvpsSEBK7A2GrAmGgGxDg8uyQCxDw4uybA2Gro/pvlPABUrCgWwDxCwEMCwDhCwE8C6P2v3ZAAVKwuzFA4TEyuyFA4TIIogiiMGDhESOQCwFC4BshATFC4uLrBAGgGxCAIRErAdObAaEbEREjk5ALEOBRESsgAIGjk5OTAxEzczFBYzMjY1NCYjIgYHJxMhFSEDPgE3NhIVFAIjIiadArKJbX2KjHt0aBikVALZ/c4wLnFKyefr4bn2AXkGd4OwmYy0RkgRAx+v/mciLQIC/vbh2/72ygAAAAACAIT/6wQ3BcUAGgAnAG0AshgAACuxHgPpsgQCACuxCwPptBIkGAQNK7ESBekBsCgvsADWsRsL6bAOMrAbELEhASuxFQvpsSkBK7EhGxESswsEEhgkFzmwFRGxCAc5OQCxJB4RErAVObASEbAPObALErAIObAEEbAHOTAxExEQADMyFhcHLgEjIgYdAT4BMzISFRQCIyIAExQWMzI2NTQmIyIGB4QBOOdLkzAqMWtInL9ApV/D6PfO1v7oxKqAeYeRgWWOJQI7ARYBGAFcIhqXGR/6yRc4P/7yz+L+4wE2AQfJ2s2YkLpSRAAAAAEATQAABCYFsAAMAHkAsggAACuwBzOyAQIAK7EAA+kBsA0vsQ4BK7A2Gro/rPmDABUrCrAILg6wCsAFsQcV+Q6wBcCzBgcFEyuwCBCzCQgKEyuyCQgKIIogiiMGDhESObIGBwUREjkAsQYJLi4BswYHCAkuLi4usEAaAQCxAAgRErADOTAxEzUhFQACAwcjNxoBE00D2f74uSkQxRAq8tIFFZub/sb+G/6nnZ0BWAIeAQIAAAMAZv/rBBoFxQAXACMALwCAALIVAAArsRsD6bIJAgArsS0D6bQnIRUJDSuxJwPpAbAwL7AA1rEYC+mwBiDWEbEkC+mwGBCxHgErsRIL6bASELAMINYRsSoL6bAqL7EMC+mxMQErsSokERK1CQMVGyEPJBc5ALEhGxESsRIAOTmwJxGxDwM5ObAtErEMBjk5MDETNDY3LgE1NDYzMhYVFAYHHgEVFAQjIiQ3FBYzMjY1NCYjIgYTFBYzMjY1NCYjIgZmlH5tfO3DwPOAbX6X/vnS1v77xZh+e5qeeXuZKYNqaISHZ2mCAYp7vCwqq3LA0dHAcqsqLLx7ytXVznyNjnt4mpoCKm+Ghm9sjokAAAAAAgBT/+sEAQXFABoAJwBtALIKAAArsRED6bIDAgArsSUD6bQYHgoDDSuxGAPpAbAoL7AA1rEbC+mwGxCxFAErsCEysQcL6bEpASuxGwARErENDjk5sBQRswoRAxgkFzkAsREKERKwDTmwGBGwDjmwHhKwFTmwJRGwADkwMRM0ADMyABkBEAAjIiYnNx4BMzI2PQEOASMiAjcUFjMyNjc1NCYjIgZTAQe85AEH/uPlTZ8/Hjt/U5CtMZNa0/jFjXltkSCTjWyYA9LbARj+4/7r/qX+4/7QHR6XHxna10JHSQEF5Za6Xkl+v8TBAAACAKEAAAFmBDYAAwAHAC0AsgAAACuxAQrpsAQvsQUK6QGwCC+wANawBDKxAwvpsAYysQML6bEJASsAMDEzNTMVAzUzFaHFxcXKygNsysoAAAIAY/7+AW4ENgAFAAkAKACwBi+xBwrpAbAKL7AG1rABMrEJC+mwAzKxCwErsQkGERKwBTkAMDEbATUzFQsBNTMVY0bFljbF/v4BPKOt/s4EbsrKAAEARwBXA3cD4QAJAAATNQEVBQcVFwUVRwMw/dFVVQIvAdKVAXrJ6RIGE+TJAAAAAAIAmAGXA9oD2wADAAcAGgCwAC+xAQTpsAQvsQUE6QGwCC+xCQErADAxEzUhFQE1IRWYA0L8vgNCAZekpAGgpKQAAAAAAQCIAFcD4APhAAkAADc1JTc1JyU1ARWIAlZVVf2qA1hXxO4RBhTqw/6GlQACAD0AAAN2BcUAGgAeAG4AshsAACuxHArpsgMCACuxFgTpshYDCiuzQBYaCSsBsB8vsBrWsRkQ6bAZELEbASuwDTKxHhLpsAwysB4QsRMBK7EGC+mxIAErsR4bERKyAxAWOTk5sBMRsgoRCTk5OQCxFhwRErIABgw5OTkwMRMmNjMyFhUUBgcOARUjPgE3PgE1NCYjIgYVIwE1MxU9A+m0xdqNdDYXxQEwZmNUcWlbgLwBIc4EYqHCybSB1nA2VluRcFx1fllqcmNg+6TQ0AAAAgBy/jsGxAWXADMAQwC5ALIJAAArsA8zsR4H6bIJAAArsTcF6bAxL7QqBwAhBCuwQS+xFQfpsCQvsQMH6QGwRC+wANaxJxPpsCcQsSEBK7QGEwAfBCuxRQErsDYauj/C+nEAFSsKDrA9ELA+wLEbA/mwGsAAsxobPT4uLi4uAbMaGz0+Li4uLrBAGgGxJwARErEBKDk5sCERQAkJAxEkKi4xNTokFzmwBhKxByI5OQCxCSoRErAtObFBNxESsAw5sBURsBk5MDETEgAhIAADBgIjIiYnDgEjIiY3GgEzMhYXBzMDBhYzMjY3EgAhIAADAgAhMjY3Fw4BIyAAAQYWMzI2NyY2NxMuASMiBnITAcwBdAF7AZURCd7dSWoXMpBgfYoSF+WlaYBLBAYzCT0ze5QIEP7A/rD+zP6JDxIBUAE6WLU+JkPPY/6E/mECcAtBSkBqLAEBAi8aOR99hAHeAacCEv4M/lPW/stTTFBP8cQBAwE5NDYE/bduU+OvAX4Bq/4y/o3+iP5LKyNrKi8B8wFyjpQxPwwbEAIaDA7bAAACABQAAAUaBbAABwALACwAsgAAACuwAzOyAQIAK7QGCAABDSuxBgTpAbAML7ENASsAsQEIERKwCjkwMTMBMwEjAyEDEyEDIxQCM6kCKsmI/Z6KxwHq8AYFsPpQAXf+iQIcApcAAwC0AAAErwWwAA4AFwAgAGMAsgAAACuxDwPpsgECACuxIAPptBgXAAENK7EYA+kBsCEvsADWsQ8L6bAYMrAPELETASuxCwvpsBwg1hGxBQvpsSIBK7EcDxESsAg5ALEXDxESsAs5sBgRsAg5sCASsAU5MDEzESEyBBUUBgceARUUBCMlITI2NTQmIyE1ITI2NTQmIyG0AdvkAQJ8ZYSX/v3e/qsBVYaWfYL+jgE/boqVjP7qBbDFxWGZJRzKhsjTmoV6gJKaeWx2dQAAAQB2/+sEuwXFACMAXgCyIQAAK7EWA+myFiEKK7NAFhoJK7IEAgArsQ8D6bIPBAors0APCwkrAbAkL7AA1rETC+mwExCxGQErsAwysR0Q6bAIMrElASuxGRMRErAhOQCxDxYRErEIHTk5MDETERAAMzYXFhUUFQcjNCYjIgIVERQSMzI2NTMXFBUUBwYjIgB2ATf395KOAr20pKXExKWktL0CkJTz9/7JAlYBAwENAV8BhIDRBgYGmbL+9sX++8f+9rGcBgUGxoaKAV4AAgC0AAAE6wWwAAkAEwAwALIAAAArsQoD6bIBAgArsRMD6QGwFC+wANaxCgvpsAoQsQ4BK7EGC+mxFQErADAxMxEhIAARFRAAISczMhI9ATQCKwG0Ab8BHgFa/qb+4vr6yunpyvoFsP6h/urH/un+o5oBCtDJzgEKAAAAAAEAtAAABHoFsAALAEcAsgAAACuxCQPpsgECACuxBAPptAUIAAENK7EFA+kBsAwvsADWsQkL6bAEMrIJAAors0AJAwkrsAoys0AJBwkrsQ0BKwAwMTMRIRUhESEVIREhFbQDu/0KApv9ZQMBBbCb/imb/feaAAAAAAEAtAAABHcFsAAJAEAAsgAAACuyAQIAK7EEA+m0CAUAAQ0rsQgD6QGwCi+wANaxCQvpsAQysgkACiuzQAkDCSuzQAkHCSuxCwErADAxMxEhFSERIRUhEbQDw/0CApj9aAWwm/4Km/18AAAAAAEAeP/rBNMFxQAgAHcAsh4AACuxEwPpsgQCACuxDAPpsgwECiuzQAwICSu0GBkeBA0rsRgD6QGwIS+wANaxEAvpsBAQsRYBK7AJMrEbC+mwBzKyFhsKK7NAFhgJK7EiASuxFhARErEEHjk5sBsRsAY5ALEYExESsBs5sQwZERKwBzkwMRMREAAzMgQXByMuASMiBhURFBYzMjY3ESE1IREGBCMgAHgBPvv6AR4DArwJr6WnzOSwfJ4i/sECBDT+/8z++/6rAkIBLAEJAU72wgZ/pPrA/tLC+0IqAUub/epQhgFOAAEAtAAABQEFsAALAD8AsgAAACuwBzOyAQIAK7AFM7QKAwABDSuxCgPpAbAML7AA1rELC+mwAjKwCxCxCAErsAQysQcL6bENASsAMDEzETMRIREzESMRIRG0xQLDxcX9PQWw/W4CkvpQAoP9fQAAAAABAL4AAAGEBbAAAwAhALIAAAArsgECACsBsAQvsADWsQML6bEDC+mxBQErADAxMxEzEb7GBbD6UAAAAAABAEL/6wPDBbAAEwBHALIOAAArsQUD6bIFDgors0AFAQkrsgkCACsBsBQvsBLWsQIQ6bACELEIASuxCwvpsRUBK7EIAhESsA45ALEJBRESsBI5MDETNzMUFjMyNjURMxEUBiMiJyY1NEICvYl9bYrF98XSfHcBiwaHhZN7BB3748Pla2a/CAAAAQC0AAAFIAWwAA4APwCyAAAAK7AJM7IBAgArsAUztAMNAAENK7EDA+kBsA8vsADWsQ4L6bACMrEQASsAsQMNERKwCDmwARGwBzkwMTMRMxEzATMXCQEHIwEjEbTFmAIJ2gP9ywJeA+v98aoFsP18AoQF/UX9FQUCkf1vAAEAtAAABCoFsAAFACwAsgAAACuxAwPpsgECACsBsAYvsADWsQML6bIDAAors0ADBQkrsQcBKwAwMTMRMxEhFbTFArEFsPrqmgAAAAABALQAAAZSBbAAEQBjALIAAAArsQcMMzOyAQIAK7AFMwGwEi+wANaxEQvpsQ8P6bARELEIASuxBwvpsAcQsQoP6bAKL7ETASuxEQ8RErAOObAIEbMCBQwNJBc5sAoSsAs5ALEBABESsgMLDjk5OTAxMxEzATMBMxEjERMnASMBBxMRtPwB0AYB0PzFFAX+KIP+KgUTBbD7YQSf+lACQAJQAftvBI4B/bP9wAAAAQC0AAAFAQWwAAsARgCyAAAAK7AHM7IBAgArsAUzAbAML7AA1rELC+mwCxCxBAErsQcL6bENASuxCwARErACObAEEbAIOQCxAQARErEDCTk5MDEzETMBNxEzESMBBxG0xQK9BsXF/UMGBbD7nAIEYvpQBGYC+5wAAgBx/+sFAgXFAA0AGwA6ALILAAArsREG6bIEAgArsRgG6QGwHC+wANaxDgvpsA4QsRQBK7EIC+mxHQErsRQOERKxCwQ5OQAwMRMREAAhIAAZARAAISIAExQSMzISNRE0AiMiAhVxAT8A/wEIAUv+tf74//7Bxc2st9fYtqzNAlYBAwEKAWL+n/71/v3+9f6gAWABC8r/AAD/ywEFyAEA/wDIAAACALQAAATMBbAACgATAEIAsgAAACuyAQIAK7ETA+m0CQsAAQ0rsQkD6QGwFC+wANaxCgvpsAsysAoQsQ8BK7EFC+mxFQErALETCxESsAU5MDEzESEyBBUUBCMhGQEhMjY1NCYjIbQCLekBAv7+6f6YAWiUkpOT/pgFsPDEx+39uALin3l5ogAAAgBx/xgFOwXFABMAIQBOALIRAAArsRcG6bIEAgArsR4G6QGwIi+wANaxFAvpsBQQsRoBK7EIC+mxIwErsRoUERKyDhEEOTk5sAgRsQsNOTkAsRcRERKxCw45OTAxExEQACEgABkBFAYHFwcBDgEjIgATFBIzMhI1ETQCIyICFXEBPwD/AQgBS2Ra94f+7Dh5QP/+wcXNrLfX2LaszQJWAQMBCgFi/p/+9f79jvJU6YEBARcXAWABC8r/AAD/ywEFyAEA/wDIAAACALQAAATtBa8AGgAjAGUAsgAAACuwEDOyAQIAK7EjA+m0GRsAAQ0rsRkD6QGwJC+wANaxGgvpsBsysBoQsRQBK7AfMrEMC+mwBTKxJQErsRQaERKwCDmwDBGwETkAsRkAERKwCzmwGxGwCDmwIxKwBTkwMTMRITIWFRQGBx4BHQEUFhcVIy4BPQE0JiMhGQEhMjY1NCYjIbQCD+/8dXB4aR4lyycWinT+kgE2p5OPl/62Ba/UynCmMSevgYlEbCIYIoRGhXaQ/YkDEn+Ce4cAAQBm/+sEkgXFAC0AeACyKAAAK7EFA+myBSgKK7NABQEJK7IRAgArsRwD6bIcEQors0AcGAkrAbAuL7AO1rEfC+mwLCDWEbECEOmwHxCxCAErsBkysSUL6bEVFzIysS8BK7EIHxEStAUMESMoJBc5sCURsBQ5ALEcBRESswAOFyUkFzkwMRM3MxQWMzI2NTQmJyYkNTQkMzIXFgcUFQcjNCYjIgYVFBYXHgEVFAQjIicmNzRmArzOmJWulr/n/v0BF97vjokBArypnpOdqr/m8P7g6NqoowEBnQaMkn5sZIcuN9aiquSDf6UGBgaAnoVrX38wOd6ksNZ2c74FAAAAAAEAIgAABI4FsAAHADoAsgYAACuyAQIAK7EAA+mwAzIBsAgvsAbWsQUL6bIFBgors0AFAwkrsgYFCiuzQAYACSuxCQErADAxEzUhFSERIxEiBGz+LMUFFZub+usFFQAAAAEAk//rBNwFsAARADcAsg8AACuxBgPpsgECACuwCjMBsBIvsADWsQML6bADELEJASuxDAvpsRMBK7EJAxESsA85ADAxExEzERQWMzI2NREzERQEIyIkk8W8mqLHxf7L+fD+1QHVA9v8JaWrq6UD2/wl7vz9AAAAAAEAFgAABPkFsAAJACEAsgkAACuyAAIAK7AGMwGwCi+xCwErALEACRESsAM5MDETMwEXMzcBMwEjFtYBeCEGIQF41f3jqQWw+7pzcwRG+lAAAQA2AAAGzwWwABUA0gCyFQAAK7IODxQzMzOyAAIAK7QBBgcMDSQXMwGwFi+wANaxAQvpsAEQsQwBK7ENC+mxFwErsDYausGs8XcAFSsKsAAQsBXADrABELACwLo9n+64ABUrCgWwBi4OsAXAsRMW+QWwFMC6wmnumQAVKwqwDy4OsBDAsQgX+QWwB8C6PmbxxwAVKwoOsAwQsAvABbANELAOwAMAtQIFCAsQEy4uLi4uLgFADAIFBgcICw4PEBMUFS4uLi4uLi4uLi4uLrBAGgCxABURErIECRE5OTkwMRMzEx8BNwEzARczNxMzASMBJyMHASM2xN4bBicBC64BDSgGHdnF/qGw/uEaBhn+3LAFsPxItgG3A7j8SLu7A7j6UAPyg4P8DgABAEIAAATWBbAACwAmALIAAAArsAgzsgICACuwBTMBsAwvsQ0BKwCxAgARErEECjk5MDEzCQEzCQEzCQEjCQFCAdj+MuwBUgFU7v4yAdjr/qP+ogLeAtL9yAI4/S79IgJC/b4AAQAUAAAEzgWwAAgAMACyBwAAK7IAAgArsAMzAbAJL7AH1rEGC+mxCgErsQYHERKwAjkAsQAHERKwAjkwMRMzCQEzAREjERThAXwBfOH+AcQFsP0cAuT8UP4AAg0AAAAAAQBhAAAEbQWwAAkALgCyAAAAK7EHA+myBAIAK7EDA+kBsAovsQsBKwCxBwARErABObEEAxESsAY5MDEzNQEhNSEVASEVYQMK/QED4PzzAy6SBIObjft3mgAAAAABAI/+yAIQBoAABwA1ALAHL7EFA+mwBC+xAgPpAbAIL7AA1rQHDAALBCuwAjKxBQvptAcMAAsEK7ADMrEJASsAMDETESEVIxEzFY8Bgby8/sgHuJv5fpsAAQAn/4MDQQWwAAMAEQCyAAIAKwGwBC+xBQErADAxEzMBIye6AmC6BbD50wABAAv+yAGNBoAABwA+ALAHL7EAA+mwAy+xBAPpAbAIL7AH1rADMrQGDAALBCuwBhCxAQvpsAEvsAYQtAcMAAsEK7AHL7EJASsAMDEXMxEjNSERIQu9vQGC/n6dBoKb+EgAAAAAAQA9AtkDGAWwAAkAEQCyAQIAKwGwCi+xCwErADAxEwEzASMDJyMHAz0BK4YBKrWmEAYQowLZAtf9KQGjRkb+XQAAAAABAAT/ZgOfAAAAAwAaALIAAAArsQMD6bIAAAArAbAEL7EFASsAMDEzIRUhBAOb/GWaAAAAAQBSBLsB6gXFAAQAIgCyAgIAK7QDCgAQBCsBsAUvsADWtAMMAAoEK7EGASsAMDETNzMTI1ID5q+eBb8G/vYAAAIAav/rA/METgAjAC4AhwCyGwAAK7IhAAArsScE6bITAQArsQgD6bIIEwors0AIDAkrtAMsIRMNK7EDB+kBsC8vsADWsSQL6bAkELALINYRsQ0Q6bANL7ELEOmwJBCxHgErsQQqMjKxFwvpsTABK7EeCxESshMhJzk5ObAXEbAbOQCxAyERErEXHjk5sAgRsQ8WOTkwMRM0NjsBNTQmIyIGFSMnNDU0NzYzMhYVERQWFyMuAScOASMiJjcUFjMyNjc1IyIGavvX1nRqX3e8AnB2ubjgDBDLCgsBN7FmqbHFWlhrrBrdd48BMJuva19vYUQGBgVvXmK7sP33Omw0MUsmTmmtlEhUbkeweAACAI//6wQrBhgAEQAfAGUAsgAAACuyDQAAK7EVBumyBgEAK7EcBumyBhwKK7NABgEJKwGwIC+wANaxEgvpsAIysREO6bASELEYASuxCgvpsSEBK7ESERESsBA5sBgRsQYNOTkAsRwVERKwEDmwBhGwAzkwMTMRMxE+ATMyEhEVFAIjIiYnBxMeATMyNj0BNCYjIgYHj8Uzl2XI4OHFa540GCQme16LiImMW30lBhj9okhM/sD++xXq/uFTUY8BNVBaxqMVuutZSwAAAAABAGH/6wPyBE4AIwBeALIhAAArsRYD6bIWIQors0AWGgkrsgQBACuxDwPpsg8ECiuzQA8LCSsBsCQvsADWsRML6bATELEZASuwDDKxHQ/psAgysSUBK7EZExESsAQ5ALEPFhESsQobOTkwMRM1NBIzMhcWBxQVByM0JiMiBh0BFBYzMjY1MxcUFQYHBgciAmH76794dQECsoxrm4WEnGKVsQIBfIKr7PoCCCrnATVwbJ0FBQZji9+iKqbdeVgGBQWGaGwBATQAAAIAYv/rA/UGGAARAB8AbQCyCwAAK7IPAAArsRUG6bIEAQArsRwG6bIEHAors0AECAkrAbAgL7AA1rESC+mwEhCxGAErsAcysQoL6bAKELELDumwCy+xIQErsRgSERKxBA85ObALEbAMOQCxFQsRErAMObEEHBESsAc5MDETNRASMzIWFxEzESMnDgEjIgI3FBYzMjY3ES4BIyIGFWLfyV+TNMWhFzWaZsbgxYaNWHgmJnlVjocB9BUBBQFARkMCU/nohUxOAR/qpMVQSAH5Q0/quwAAAgBj/+sD7QROABYAHwBhALIUAAArsQ0D6bIEAQArsR0D6bQYCRQEDSuxGAPpAbAgL7AA1rEKEumwFzKwChCxGQErsQcL6bEhASuxGQoRErMJBA0UJBc5sAcRsRAROTkAsQ0UERKwETmwCRGwEDkwMRM1NAAzMhIdASEHHgEzMjY3Fw4BIyIAExchNTQmIyIGYwETvNvg/UIDA5iJZJc3TTq+h+L+9dACAfN8emOMAggs5wEz/vjcewWcyTkygDlMAS0BdgUadJynAAAAAQA4AAACyQYtABcAWACyFgAAK7IBAQArsBEzsQAF6bATMrANL7EGBukBsBgvsBbWsAIysRUL6bAQMrIVFgors0AVEwkrshYVCiuzQBYACSuxGQErALENARESsAo5sAYRsAk5MDETNTM1NDYzMhYXBy4BIyIGHQEzFSMRIxE4qbWiIkUqGBIzHFZU4eHFA6iSia29CwqWBAZnYomS/FgDqAAAAAACAGT+SwP9BE4AHQArAHYAshsAACuxIQbpsggBACuyBAEAK7EoBumwDS+xFATpAbAsL7AA1rEeC+mwHhCxFwErsCQysQoL6bAKELEIDemwCC+xLQErsR4AERKxEBE5ObAXEbMEFA0bJBc5sAgSsAc5ALEbFBESsBE5sSgNERKxBxg5OTAxEzUQEjMyFhc3MxEUBiMiJic3HgEzMjY9AQ4BIyICNxQWMzI2NxEuASMiBhVk5MlnnDQYnfLkTrVFMjWWSZCDNZRgx+TFio1ZeCcmelaNjAH0FQEFAUBTTo37wNDfKyWZHiWDhnpERQEg6aPGUUoB8kVR7LkAAAABAI8AAAQABhgAEwBNALIAAAArsAozsgYBACuxDwbpsgYPCiuzQAYBCSsBsBQvsADWsRML6bACMrATELELASuxCgvpsRUBK7ELExESsAY5ALEPABESsAM5MDEzETMRPgEzMhYVESMRNCYjIgYHEY/FOKNjrcHFc3JShSsGGP2RTlfQ2P1aAqiGgE1C/OEAAAACAJ8AAAFkBhgAAwAHAC4AsgAAACuyAQEAK7AEL7EFCukBsAgvsADWsAQysQML6bAGMrEDC+mxCQErADAxMxEzEQM1MxWfxcXFBDr7xgVPyckAAAAC/77+SwFyBhgADwATADMAsggBACuwDS+xBAbpsAQQsQAD6bAQL7ERCekBsBQvsAfWsBAysQoL6bASMrEVASsAMDEDNx4BMzI2NREzERQGIyImEzUzFUIODjQRQU3FrJkfM8zF/l2bBQdYYwST+22ntQkG/8XFAAABAJAAAAQcBhgADABBALIAAAArsAgzsgUBACu0AwsABQ0rsQMD6bIDCwors0ADAQkrAbANL7AA1rEMC+mwAjKxDgErALEDCxESsAc5MDEzETMRMwEzCQEjASMRkMV+ASjs/o4Bp+j+oYAGGPx4Aar+FP2yAfP+DQABAJ8AAAFkBhgAAwAcALIAAAArAbAEL7AA1rEDC+mxAwvpsQUBKwAwMTMRMxGfxQYY+egAAQCPAAAGbwROACMAawCyAAAAK7EQGjMzsgEBACuyBgEAK7AMM7EfBumwFTIBsCQvsADWsSML6bECD+mwIxCxGwErsRoL6bAaELERASuxEAvpsSUBK7EjAhESsAM5sRoAERKwCTmwERGwDDkAsR8AERKxAwk5OTAxMxEzFz4BMzIWFz4BMzIWFREjETQmIyIGBxURIxE0JiMiBgcRj7AONaNsbJsnM6hwpcDFbm1lfQvGcWpadB8EOo5NVWRkXGzj5P15AomghYxrCP1RAomYjUpD/N8AAAAAAQCPAAAD/QROABMATgCyAAAAK7AKM7IBAQArsgYBACuxDwbpAbAUL7AA1rETC+mxAg/psBMQsQsBK7EKC+mxFQErsRMCERKwAzmwCxGwBjkAsQ8AERKwAzkwMTMRMxc+ATMyFhURIxE0JiMiBgcRj7AONqNor8DFcXRVgycEOqFWX83W/VUCp494Ukf86wAAAgBh/+sEKgROAA0AGwA6ALILAAArsRED6bIEAQArsRgD6QGwHC+wANaxDgvpsA4QsRQBK7EIC+mxHQErsRQOERKxBAs5OQAwMRM1NAAzMgAdARQAIyIANxQWMzI2PQE0JiMiBhVhAQTf4QEF/vzg4P77xZGPjZKTjo2RAhEW8AE3/srxFvL+zAE18azg4KwWquLiqgAAAAACAI/+YAQpBE4AEQAfAF0Asg0AACuxFQPpsgEBACuyBgEAK7EcBumwAC8BsCAvsADWsREL6bASMrECE+mwERCxGAErsQoL6bEhASuxEQIRErADObAYEbENBjk5ALEVDRESsBA5sBwRsAM5MDETETMXPgEzMhIRFRQCIyImJxkBHgEzMjY9ATQmIyIGB4+XHzWeacnf4MVklzUleFeMkJGNVXgl/mAF2oxOUv7B/voV6v7hQ0P97wKzQ0vNohW47U1DAAAAAgBi/mAD6gROABEAHwBlALIPAAArsRUD6bIIAQArsgQBACuxHAPpsAsvAbAgL7AA1rESC+mwEhCxCwErsBgysQoL6bAKELEIE+mwCC+xIQErsQsSERKxBA85ObAIEbAHOQCxFQ8RErAMObEIHBESsAc5MDETNRASMzIWFzczESMRDgEjIgI3FBYzMjY3ES4BIyIGFWLfyWOWNB2WxTSOW8bgxYeMUXMnJ3NPjYgB9BUBBQFAS0h/+iYCBj0+AR/qpMtIQQIiPUbvuwAAAQCPAAACqgROAA8AOgCyAAAAK7IBAQArsgYBACuxCwjpAbAQL7AA1rEPC+mxAg/psREBK7EPAhESsAM5ALEBCxESsAM5MDEzETMXPgEzMhYXByciBgcRj7ATLodYFigNG2VOax0EOp5UXgcEtwZKQ/z7AAABAG3/6wPJBE4ALQB3ALIoAAArsQUD6bIFKAors0AFAQkrshEBACuxHAPpshwRCiuzQBwYCSsBsC4vsA7WsR8L6bAsINYRsQIQ6bAfELEIASuwGTKxJQvpsRcQ6bEvASuxCCwRErQFCxEiKCQXObAXEbAjOQCxHAURErMOFyUsJBc5MDETNzMeATMyNjU0JicuATU0NjMyFxYHFBUHIzQmIyIGFRQWFx4BFRQGIyInJjU0bQK8BZJiaXdjisXH4LS9cGsBArx3YmlmWorNyOm8z3dxAUkGaWFVRUFUHyuTf4S6YV2DBgYGR3FcQUBKHSyXf5CyaWSEBgAAAAABACL/6wJqBT8AFwBgALITAAArsQwG6bIBAQArsAUzsQAF6bAHMrIBAAors0ABBAkrAbAYL7AW1rACMrEJC+mwBDKyCRYKK7NACQcJK7IWCQors0AWAAkrsRkBKwCxDBMRErAQObAAEbAPOTAxEzUzETMRMxUjERQWMzI2NxcOASMiJjURIqzFzc0/NBEpEBoWVSt4jgOokgEF/vuS/W9MPggGhxIXkZsCkQAAAQCL/+sD/AQ6ABMAVACyDQAAK7IRAAArsQYG6bIBAQArsAozAbAUL7AA1rEDC+mwAxCxCQErsQwL6bAMELEND+mwDS+xFQErsQkDERKwETmwDRGwDjkAsQEGERKwDjkwMRMRMxEUFjMyNjcRMxEjJw4BIyImi8VmbGmJI8WxDTOgabHGAbwCfv2ArYJVTgMM+8agV17iAAABAC4AAAPkBDoACQAoALIJAAArsgABACuwBjMBsAovsAbWsQcS6bELASsAsQAJERKwAzkwMRMzARczNxMzASMuygEAEQYT+cn+cpUEOv0FTEwC+/vGAAAAAQAtAAAF3AQ6ABUAeACyFQAAK7AOM7IAAQArsQYMMzMBsBYvsADWsQEL6bABELEMASuxDQvpsRcBK7A2Gro+lvKfABUrCg6wBBCwBcCxEwj5sBLAALMEBRITLi4uLgGzBAUSEy4uLi6wQBoBsQwBERKxDhU5OQCxABURErIDCRE5OTkwMRMzExczNxMzExczNxMzASMDJw8BAyMtxLMXBhzYntkfBh2qxP7Gn9EtBivOnwQ6/VCDgwKw/VCSkgKw+8YCk7gBt/1tAAAAAQAuAAAD1AQ6AAsAJgCyAAAAK7AIM7ICAQArsAUzAbAML7ENASsAsQIAERKxBAo5OTAxMwkBMxsBMwkBIwsBLgFp/qHj4+bm/qEBaeLw8AIjAhf+cQGP/en93QGZ/mcAAQAa/ksD6AQ6ABUANACyAAEAK7AFM7AKL7ERBOkBsBYvsAXWsQYM6bEXASsAsREKERKwDTmwABGyAw4POTk5MDETMxMXMwEzAQ4BIyImJzcmFjMyNj8BGtzkIwYBCtv+OSmZghhKFBQGUws/UBsvBDr9V4gDMfsgbaILBZsBBnBEcQAAAQBeAAADugQ6AAkALgCyAAAAK7EHA+myBAEAK7EDA+kBsAovsQsBKwCxBwARErABObEEAxESsAY5MDEzNQEhNSEVASEVXgJJ/b4DM/2xAnGKAxSchvzmmgAAAAABAD/+lAKfBj0AHgBUALAYL7QXBwAhBCuwAC+xAQXpsAkvtAgHACEEKwGwHy+wG9awBDKxFAvpsAwysSABK7EUGxESsBA5ALEAFxESsRMbOTmwARGwEDmwCRKxBQ05OTAxEzUyNj0BNDY3Fw4BHQEUBgceAR0BFBYXBy4BPQE0Jj9qZ6TDKG5cVVVVVVxuKMOkZwIfk3txzqvvN3UjtYTOaaAtLqFnzYSzJHY38KrNcH0AAAABAK/+8gFNBbAAAwAcALIBAgArAbAEL7AA1rEDDemxAw3psQUBKwAwMRMRMxGvnv7yBr75QgAAAAEAFf6UAnYGPQAeAFQAsB4vtAAHACEEK7AXL7EWBemwDi+0DwcAIQQrAbAfL7AD1rAKMrEbC+mwEjKxIAErsRsDERKwBzkAsRcAERKxBBs5ObAWEbAHObAOErEKEjk5MDEXPgE9ATQ2Ny4BPQE0Jic3HgEdARQWMxUiBh0BFAYHFW1eWl5eWl5tKcKlZWxsZaXC9iSzhM1roCspoG3OhLUjdTfvq85xe5N9cM2q8DcAAQCAAZEE8AMjABkAVACwEC+xCQTpsBYvsQME6QGwGi+wANaxGRPpsBkQsQwBK7ENE+mxGwErsQwZERKxAxA5OQCxCRARErIAExk5OTmwFhGxBxQ5ObADErIGDA05OTkwMRM0NjMyFhceATMyNjUXFAYjIiYnLgEjIgYVgKuEWJZVOmA0QmGNroJak1U7YjJDXwHaiMFFRjMuck0SicpCSjAwaksAAAAAAgCQ/ooBVQQ6AAMABwAmALIFAQArsQQK6QGwCC+wANawBDKxAwvpsAYysQML6bEJASsAMDETETMRAzUzFZDFxcX+igPS/C4E4s7OAAEAa/8LA/0FJgAjAHAAsCAvtBYKAAsEK7APL7QFCgALBCsBsCQvsADWsRML6bATELEgASuwBDKxHwvpsAYysB8QsRkBK7AMMrEbD+mwCjKxJQErsR8gERKxDxY5OQCxFiARErEeITk5sA8RswoLGRskFzmwBRKxBAc5OTAxEzU0Ejc1MxUeAQ8BIzQmIyIGHQEUFjMyNjUzFxYGBxUjNSYCa761xp2/AwKzjGubhYScYpWyAwPKksa2vQIIKscBIybk3xjVkAVji9+iKqbdeVgGesoZ6OwkASQAAAABAEYAAARXBcUAIgB+ALIcAAArsR0D6bAZMrIGAgArsQ4D6bQAARwGDSuwEjOxAAPpsBQyswscBggrAbAjL7Ai1rACMrEVC+mwEjKyFSIKK7NAFRQJK7IiFQors0AiAAkrs0AiHAkrsBUQsQsBK7EKEOmxJAErsRUiERKxERk5ObALEbEGDjk5ADAxEzUzAzQ2MzIWDwEjNCYjIgYVEyEVIRcUBgchByE1Mz4BNSdGngrgvMjcBAK+fmJjdAoBov5jBh8dAt8B/DAKMDAGAmebAQ7M6dGsBnZylYX+8puVWqM7mpoNxGeVAAAAAAIAaP/lBVoE8QAjAC8AeQCyHwAAK7EbIzMzsScE6bAtL7ENBOkBsDAvsATWsSQP6bAkELEqASuxFg/psTEBK7EkBBESswEHCSMkFzmwKhGzChAcIiQXObAWErMRExkbJBc5ALEnHxESsxoAHCIkFzmwLRGzAQcTGSQXObANErMIChASJBc5MDE/AS4BNTQ2Nyc3Fz4BMzIWFzcXBx4BFRQGBxcHJw4BIyImJwcTFBIzMhI1NAIjIgJoijI1OTaSi49KsmBhskuSjJY0OTUwjoyFTbllZblLgk7xrKrx8aqs8XCMTLVjZrxOlYuSNz0+OJWMmU65ZWKzTI+Lhz5CQT2EAnq8/vcBCby6AQj++AAAAQAeAAAErwWwABYAdACyDgAAK7IAAgArsAMztBARDgANK7AJM7EQA+mwCzK0FBUOAA0rsAUzsRQD6bAHMgGwFy+wDtawEjKxDQvpsAgysg0OCiuzQA0LCSuwBjKyDg0KK7NADhAJK7AUMrEYASuxDQ4RErACOQCxABURErACOTAxEzMJATMBIRUhFSEVIREjESE1ITUhNSEe4gFnAWjg/l4BOP6BAX/+gcX+iQF3/okBNwWw/WkCl/0ym4eb/tsBJZuHmwAAAAACAJH+8gFWBbAAAwAHACIAsgUCACsBsAgvsADWsAQysQML6bAGMrEDC+mxCQErADAxExEzEQMRMxGRxcXF/vIDGPzoA8gC9v0KAAAAAgBe/hEEfAXFADMARQCiALIJAgArsRED6bIRCQors0ARDQkrsCMvsSsD6QGwRi+wANawJjKxNAvpsCgysAYg1hGxFAvpsDQQsT0BK7EaC+mwGhCwICDWEbEuC+mwLi+xIAvpsCAQsA0g1hGxDhDpsA4vsQ0Q6bFHASuxFAYRErEDMjk5sC4RQAoRCRcjKzE5OkBDJBc5sCASsRgdOTkAsRErERK2BgwgJig6QyQXOTAxEzQ2Ny4BNTQkMzIEDwEjNCYjIgYVFBYXHgEVFAYHHgEVFAQjIiQ/AhQWMzI2NTQmJy4BNxQWFx4BFz4BNTQmJy4BJw4BXl5XREQBDODpAQQEA7yejJGWhtP032BXRUb+9uHd/tIFArzBh4mdkMzv4sWI0jhKIUhQk8ovUyRJSQInW40pMothpsnfygZ2nndbY2M6RbWvXowoM4hirMPN3AYCj4d3W1tlPz+6s2RnOxEWDBRjRVtrPwwZDxNkAAACAKoE6ANbBbAAAwAHADYAsgECACuwBTOxAArpsAQysgECACuxAArpAbAIL7AA1rEDDOmwAxCxBAErsQcM6bEJASsAMDETNTMVMzUzFarb+9sE6MjIyMgAAwBY/+sF4wXEAAsAFwA1AJ0AsgkAACuxDwfpsgMCACuxFQfptDMrCQMNK7EzB+myKzMKK7NAKy8JK7QcJAkDDSuxHAfpsiQcCiuzQCQgCSsBsDYvsADWtAwTABAEK7AMELEYASuxKBPpsCgQsS4BK7AhMrEwE+mwHzKwMBCxEgErtAYTABAEK7E3ASuxLigRErYJDxUDJBwzJBc5ALEkKxEStQYMEh8AMCQXOTAxExAAISAAERAAISAAExAAMzIAERAAIyIAEzU0NjMyFg8BIzQmIyIGHQEUFjMyNjUzFxYGIyImWAGeASgBJwGe/mH+2v7Y/mJ5AVf29QFY/qj19v6p47ygnbEEApJbW15mZl5bWpICBLCdoLwC2QE7AbD+UP7F/sT+TgGyATz+9/6UAWwBCQEHAWr+lv69d63WnpUGX1eNcnh1jFZiBped1QAAAgB4ArQDEwXFACAAKwB1ALIQAgArsQgF6bAeL7EkB+mwKS+0AwcAIQQrAbAsL7AA1rEhD+mwIRCxJwErsQQbMjKxFA/psS0BK7EhABESsQwOOTmwJxGyCxAeOTk5sBQSsBg5ALEkHhESsRcbOTmwKRGxFAA5ObEIAxESsgsMEzk5OTAxEzQ2OwE1NCYjIgYVLwEmNjMyFhURFBYXIy4BJw4BIyImNxQWMzI2NzUjIgZ4qaGLPDpDSaIBBqmMhpwMDq4ICgMhcU13gq06PDNtEopLUwOYbng0P0Q2MQ0GYoKOhv7GMlgrFTAaLz56bi0wPCNuQgAAAAACAGIAdgNrA5MABgANAAATNQEzAwEjEzUBMwMBI2IBJ5T/AP+UJwEnlP8A/5QB+xMBhf5x/nIBhRMBhf5x/nIAAQB/AXcDwgMiAAUAMACwAC+xAQTpsgABCiuzQAAECSsBsAYvsATWsQML6bIEAwors0AEAAkrsQcBKwAwMRM1IREjEX8DQ8YCfaX+VQEGAAABACMCGgINArQAAwAiALAAL7EBA+mxAQPpAbAEL7EAASu0AwwACQQrsQUBKwAwMRM1IRUjAeoCGpqaAAAEAFj/6wXjBcQACwAXADIAOwCqALIJAAArsQ8H6bIDAgArsRUH6bQxMwkDDSuxMQfpsjEzCiuzQDEYCSuwKDK0GjsJAw0rsRoH6QGwPC+wANa0DBMAEAQrsAwQsRgBK7EyE+mwMzKwMhCxLAErsDcysSQT6bAdMrEoE+mwJBCxEgErtAYTABAEK7E9ASuxLDIRErMJDxUDJBc5sCQRsCA5ALExDxESsCM5sDMRtAYMEgAgJBc5sDsSsB05MDETEAAhIAAREAAhIAATEAAzMgAREAAjIgABESEyFhUUBgceAR0BFBYXFSMuAT0BNCYrARkBMz4BNTQmKwFYAZ4BKAEnAZ7+Yf7a/tj+YnkBV/b0AVj+qfX2/qkBJwEYmK1CP0I7BwqZCQRDTZ+YQVtPYoMC2QE7AbD+UP7F/sT+TgGyATz+9v6VAWwBCQEIAWn+l/1bA1KDfj5eHxpqSzgpQRUQFVEqNkhE/q4B1AE/OEk7AAEAewUeA0wFsAADAB4AsgECACuxAAXpsgECACuxAAXpAbAEL7EFASsAMDETNSEVewLRBR6SkgAAAgCAA78CfQXFAAsAFwBKALIDAgArsRUH6bIPAQArsQkH6QGwGC+wANa0DBMAHwQrsAwQsRIBK7QGEwAQBCuxGQErsRIMERKxCQM5OQCxFQ8RErEGADk5MDETNDYzMhYVFAYjIiY3FBYzMjY1NCYjIgaAmGlnlZRoapeDSTU0R0gzNUkEwGqbm2pslZVsN0hINzdLSwAAAAACAGMABAP3BPMACwAPAFkAsAwvsQ0D6bAAL7AHM7EBA+mwBTKyAAEKK7NAAAoJK7IBAAors0ABAwkrAbAQL7AK1rACMrEJD+mwBDKyCQoKK7NACQcJK7IKCQors0AKAAkrsREBKwAwMRM1IREzESEVIREjEQE1IRVjAX2xAWb+mrH+qANDAr6aAZv+ZZr+YwGd/UabmwAAAAEAdwKbAsoFxwAaAFkAsA4vsQsH6bAWL7EDB+myFgMKK7NAFhoJKwGwGy+wGtawDjKxGQ7psBkQsRMBK7EGD+mwDDKxHAErsRMZERKyAwsKOTk5ALELDhESsA85sBYRsQAGOTkwMRMmNjMyFhUUBg8BFyEVITUBPgE1NCYjIgYVI3cGqI2HmFl0mQIBaf2wAS5FLDk6Q0mhBNhjjIB0UHBphwaCggEGPEsqMj5AMgAAAQBwAo8C5AXGACoAjACyHAIAK7EUB+myFBwKK7NAFBgJK7AoL7EFB+myBSgKK7NABQEJK7AML7ENB+kBsCsvsAHWsBgysQIO6bAXMrACELEIASuwETKxJQ/psB8ysgglCiuzQAgMCSuxLAErsQIBERKwGjmwCBGxHCg5ObAlErAiOQCxDAURErAlObANEbAiObAUErAfOTAxEzczFBYzMjY1NCYrATUzMjY1NCYjIgYVIycmNjMyFhUUBgceARUUBiMiJnABo0s/SFRJSYSEQ0FJRThFogIGqX6RqEc+Rky0kn+1A3IGLjk7MD45fjk0KzowKAZed3duN1saF2BEb3x0AAABAIMEuwIkBcUABAAsALIBAgArtAAKABAEKwGwBS+wANa0AwwACgQrsQYBK7EDABESsQIEOTkAMDEbATMXAYO55gL+8gS7AQoG/vwAAQCZ/mAD8gQ6ABUAXACyDQAAK7IRAAArsQYD6bIBAQArsAozsAAvAbAWL7AA1rEVC+mwAjKwFRCxCQErsQwL6bAMELEND+mwDS+xFwErsQkVERKwETmwDRGwDjkAsQYNERKxDhQ5OTAxExEzER4BMzI2NxEzESMnDgEjIiYnEZnEAm9kYnkgxbEJLH9TSG0o/mAF2v1+soFIRgMn+8ZsP0IhI/4xAAAAAQA/AAADRAWwAAoANwCyBgAAK7IDAgArAbALL7AA1rQEDAAHBCuwBBCxBgvpsAYvsAQQtAAMAAcEK7AAL7EMASsAMDETNAAzIREjESMiAD8BA+kBGcVU6f79A9zPAQX6UAIIAQMAAAABAKECcAFnA0QAAwAiALAAL7EBCumxAQrpAbAEL7AA1rEDC+mxAwvpsQUBKwAwMRM1MxWhxgJw1NQAAAABAHf+TQGvAAAADwA+ALIHAAArsQYH6bAPL7QABwAhBCsBsBAvsAPWsQwT6bERASuxDAMRErEICTk5ALEGABESsAw5sAcRsAk5MDETMjY1NCYnNzMHHgEVFAYjd0hYSFcgjAxBVp6T/roxMTAmB4c0C1JQYHIAAAABAF8CmQGMBcUABQAsALIBAgArsQAH6bICAgArAbAGL7AE1rEDD+myBAMKK7NABAAJK7EHASsAMDETNSURIxFfAS2uBSiGF/zUAo8AAgB4ArMDKwXFAA0AGwA4ALIEAgArsRgF6bALL7ERBekBsBwvsADWsQ4P6bAOELEUASuxCA/psR0BK7EUDhESsQsEOTkAMDETNTQ2MzIWHQEUBiMiJjcUFjMyNj0BNCYjIgYVeLydnry7nZ69rVhWU1laVFRYBAF1lLu7lHWVubmVWGlqV3VUa2tUAAACAG4AmAODA7UABgANAAA3AQMzARUBMwEDMwEVAW4A//+UASf+2cYA//+UASf+2ZgBjgGP/nsT/nsBjgGP/nsT/nsAAAQAuAAABeIFxAAFAAkAFAAZAJYAshIAACuyAgIAK7EUEhAgwC+wDzOxFQfpsA0yshUUCiuzQBULCSuxAQIQIMAvsQAH6QGwGi+wBNaxAw/psgQDCiuzQAQACSuwAxCxEgErsBYysREP6bAMMrEbASuxAwQRErEGCTk5sBIRtAcICgsVJBc5ALEUEhESsAk5sBURsQoGOTmwABKyAwgYOTk5sAERsAc5MDETNSURIxETARcBJQEzETMVIxUjNSE3MxEnB7gBLa4cAsdt/TkBUQGmrX5+qv5frvMGDQUnhhf81AKP+5IEckP7jogCI/35gpiYggE2ARYAAwC4AAAF9QXEAAUACQAkAKkAshgAACuxFQfpsgICACu0DSAYAg0rsQ0H6bIgDQors0AgJAkrsQECECDAL7EAB+kBsCUvsATWsQMP6bIEAwors0AEAAkrsAMQsSQBK7AYMrEjDumwIxCxHQErsRAP6bAWMrEmASuxAwQRErEGCTk5sCQRsAs5sCMSsAc5sB0Rsw0UFQgkFzkAsSAVERK1BAYKEAMZJBc5sQAYERKxCAk5ObABEbAHOTAxEzUlESMREwEXCQEmNjMyFhUUBg8BFyEVITUBPgE1NCYjIgYVI7gBLa4pAsdt/TkB1QaojYeYWXSZAgFp/bABLkUsOTpDSaEFJ4YX/NQCj/uSBHJD+44Bx2OMgHRQcGmHBoKCAQY8SyoyPkAyAAAEAIAAAAafBccAKgAuADkAPgDcALI3AAArsDkvsDQzsToH6bAyMrI6OQors0A6MAkrsCgvsQUH6bIFKAors0AFAQkrsAwvsQ0H6bAUL7EcB+myFBwKK7NAFBgJKwGwPy+wAdawGDKxAg7psBcysAIQsQgBK7ARMrElD+mwHzKyCCUKK7NACAwJK7AlELE3ASuwOzKxNg/psDEysUABK7ECARESsBo5sAgRshwoKzk5ObAlErEiLjk5sDcRtCwtLzA6JBc5ALE6ORESsS8rOTmwKBGwPTmxDAURErAlObANEbAiObAUErIfLC05OTkwMRM3MxQWMzI2NTQmKwE1MzI2NTQmIyIGFSMnJjYzMhYVFAYHHgEVFAYjIiYJARcBJQEzETMVIxUjNSE3MxEnB4ABo0s/SFRJSYSEQ0FJRThFogIGqX6RqEc+Rky0kn+1AZACx239OQFXAaatfn6q/l+u8wYNA3MGLjk7MD45fjk0KzowKAZed3duN1saF2BEb3x0/bUEckP7jogCI/35gpiYggE2ARYAAAACAHL+dgOrBDsAGgAeAGwAshwBACuxGwrpsBgvsRAE6bIQGAors0AQFAkrAbAfL7AA1rENC+mwDRCxGwErsAYysR4S6bAHMrAeELETASuxFRDpsSABK7EbDRESsgQLAzk5ObAeEbIKEBg5OTkAsRsQERKyAAYVOTk5MDEXNDY3PgE1Mw4BBw4BFRQWMzI2NTMXFgYjIiYBNTMVcox1NRjFAjBlZFNwalqBvAMC6bPG2QFHzg1/1XI1VlyScFt2fldqcmNgBqHCyQQr0dEAAAAAAwAUAAAFGgciAAcADAAQAC8AsgAAACuwAzOyAQIAK7QGDQABDSuxBgTpsAwvAbARL7ESASsAsQENERKwDzkwMTMBMwEjAyEDEzczEyMDIQMjFAIzqQIqyYj9noqdA+avntAB6vAGBbD6UAF3/okHHAb+9vwEApcAAwAUAAAFGgceAAcACwAQACwAsgAAACuwAzOyAQIAK7QGCAABDSuxBgTpAbARL7ESASsAsQEIERKwCjkwMTMBMwEjAyEDEyEDIwMTMxcBFAIzqQIqyYj9norHAerwBjO55gL+8gWw+lABd/6JAhwClwFhAQoG/vwAAwAUAAAFGgdIAAcAEAAUACwAsgAAACuwAzOyAQIAK7QGEQABDSuxBgTpAbAVL7EWASsAsQERERKwEzkwMTMBMwEjAyEDEzU3MxcVIycHAyEDIxQCM6kCKsmI/Z6Kh/Z4+KGTkmAB6vAGBbD6UAF3/okGQRrt7hmUlPvbApcAAAADABQAAAUaB1QABwAbAB8AgQCyAAAAK7ADM7IBAgArtAYcAAENK7EGBOmwFS+xDgXpsxgOFQgrsQsF6QGwIC+wCNa0GxMAEAQrsBwysBsQsREBK7QSEwAQBCuxIQErsRsIERKwBjmwERG1AgsBFR4fJBc5sBISsQUdOTkAsQEcERKwHjmwFRGwGzmwDhKwCDkwMTMBMwEjAyEDEzQ2MzIWMzI2NRcUBiMiJiMiBhUDIQMjFAIzqQIqyYj9nopfdls4qDQpPGx3WkeaMys6BAHq8AYFsPpQAXf+iQZcXYleQS8gXoJdQS772gKXAAQAFAAABRoHDQAHAAsADwATAGgAsgAAACuwAzOyAQIAK7QGDAABDSuxBgTpsAgvsBAzsQkK6bARMgGwFC+wCNaxCwzpsAsQsRABK7ETDOmxFQErsQsIERKxBgw5ObAQEbMCAQ4PJBc5sBMSsQUNOTkAsQEMERKwDjkwMTMBMwEjAyEDEzUzFQMhAyMTNTMVFAIzqQIqyYj9nopi23YB6vAGfdsFsPpQAXf+iQZFyMj71wKXAZLIyAAEABQAAAUaB4wABwALABcAIwBxALIAAAArsAMzsgECACu0BggAAQ0rsQYE6bAVL7QbBwAUBCuwIS+0DwcAFAQrAbAkL7AM1rQYEwAQBCuwGBCxHgErtBITABAEK7ElASuxHhgRErUCAQoPFQskFzkAsQEIERKwCjmxIRsRErESDDk5MDEzATMBIwMhAxMhAyMDNDYzMhYVFAYjIiY3FBYzMjY1NCYjIgYUAjOpAirJiP2eiscB6vAGz3lXVXh3Vld5Zz4rKjw8Kis+BbD6UAF3/okCHAKXAhNUcnFVVmxsVis9Oy0tPj4AAv/sAAAHYQWwAA8AEwB+ALIMAAArsAAzsQkD6bIBAgArsQQD6bQOEAwBDSuxDgjptAUIDAENK7EFA+kBsBQvsBLWsQQL6bAEELAJINYRsQwQ6bAML7EJEOmyCQwKK7NACQcJK7NACQsJK7AMELARINYRsA0zsQgQ6bAFMrEVASsAsQQFERKxEhM5OTAxIwEhFSETIRUhEyEVIQMhAwEhAycUA3ADx/1NFAJO/bgWAsH8gQ/908oBMQG/HwUFsJv+Lpv98poBXv6iAhECxgIAAAIAdv5FBLsFxQAdAC0AiwCyGwAAK7QlBwAUBCuyBAIAK7EMA+myDAQKK7NADAgJK7AtL7QeBwAhBCsBsC4vsADWsRAL6bAQELEhASuxKhPpsCoQsRYBK7AJMrEYEOmwBzKxLwErsSEQERK3DAQTGx4kJS0kFzmwKhGxJic5OQCxGx4RErIkJyo5OTmxDCURErMHExYYJBc5MDETERAAMzIADwEjNCYjIgIVERQSMzI2NTMXFgAjIgABMjY1NCYnNzMHHgEVFAYjdgE39/cBJAQCvbSkpcTEpaS0vQIE/tjz9/7JAc9IWEhXIIwMQVaekwJWAQMBDQFf/vnZBpmy/vbF/vvH/vaxnAbN/uwBXv1pMTEwJgeHNAtSUGByAAAAAAIAtAAABHoHIgALABAAVACyAAAAK7EJA+myAQIAK7EEA+m0BQgAAQ0rsQUD6bAQLwGwES+wANaxCQvpsAQysgkACiuzQAkDCSuwCjKzQAkHCSuxEgErsQkAERKxDA05OQAwMTMRIRUhESEVIREhFQE3MxMjtAO7/QoCm/1lAwH8tQPmr54FsJv+KZv995oHHAb+9gACALQAAAR6Bx4ACwAQAEcAsgAAACuxCQPpsgECACuxBAPptAUIAAENK7EFA+kBsBEvsADWsQkL6bAEMrIJAAors0AJAwkrsAoys0AJBwkrsRIBKwAwMTMRIRUhESEVIREhFQETMxcBtAO7/QoCm/1lAwH9oLnmAv7yBbCb/imb/feaBhQBCgb+/AAAAAIAtAAABHoHSAALABQAUQCyAAAAK7EJA+myAQIAK7EEA+m0BQgAAQ0rsQUD6QGwFS+wANaxCQvpsAQysgkACiuzQAkDCSuwCjKzQAkHCSuxFgErsQkAERKxDA05OQAwMTMRIRUhESEVIREhFQE1NzMXFSMnB7QDu/0KApv9ZQMB/Mj2ePihk5IFsJv+KZv995oGQRrt7hmUlAAAAAMAtAAABHoHDQALAA8AEwBpALIAAAArsQkD6bIBAgArsQQD6bQFCAABDSuxBQPpsAwvsBAzsQ0K6bARMgGwFC+wANaxCQvpsAQysgkACiuzQAkDCSuwCjKzQAkHCSuzDAkACCuxDwzpsAkQsRABK7ETDOmxFQErADAxMxEhFSERIRUhESEVATUzFTM1MxW0A7v9CgKb/WUDAfyi2/vbBbCb/imb/feaBkXIyMjIAAAAAv/eAAABhAciAAQACAAsALIFAAArsgYCACuwBC8BsAkvsAXWsQgL6bEKASuxCAURErICBAM5OTkAMDEDNzMTIwMRMxEiA+avnhrGBxwG/vb56AWw+lAAAAIAvgAAAmgHHgADAAgAKQCyAAAAK7IBAgArAbAJL7AA1rEDC+mxCgErsQMAERKyBAUIOTk5ADAxMxEzEQMTMxcBvsa9ueYC/vIFsPpQBhQBCgb+/AAAAAAC//EAAAJXB0gACAAMACkAsgkAACuyCgIAKwGwDS+wCdaxDAvpsQ4BK7EMCRESsgMCBzk5OQAwMQM1NzMXFSMnBxMRMxEP9nj4oZOSLcYGQRrt7hmUlPm/BbD6UAAAAAAD/8sAAAJ8Bw0AAwAHAAsAQACyBAAAK7IFAgArsAAvsAgzsQEK6bAJMgGwDC+wANaxAwzpsAMQsQQBK7EHC+mwBxCxCAErsQsM6bENASsAMDEDNTMVExEzERM1MxU12xjGHdsGRcjI+bsFsPpQBkXIyAAAAAIAKgAABQkFsAANABsAXQCyDAAAK7EOA+myAwIAK7EXA+m0AQAMAw0rsBozsQED6bAYMgGwHC+wDNawAjKxDgvpsBcysg4MCiuzQA4aCSuyDA4KK7NADAAJK7AOELESASuxCAvpsR0BKwAwMRM1MxEhIAARFRAAKQEREzMyEj0BNAIrAREhFSEqqAG/AR4BWv6m/uL+QcX6yunpyvoBFP7sApebAn7+of7qx/7p/qMCl/4DAQrQyc4BCv4dmwAAAAIAtAAABQEHVAALAB8AjQCyAAAAK7AHM7IBAgArsAUzsBkvsRIF6bMcEhkIK7EPBekBsCAvsADWsQsL6bALELEMCyu0HxMAEAQrsB8QsRUBK7QWEwAQBCuwFhCxBAErsQcL6bEhASuxHwsRErECCTk5sQQWERKxAwg5OQCxAQARErEDCTk5sBkRsB85sBwSsAw5sQ8SERKwFjkwMTMRMwE3ETMRIwEHERM0NjMyFjMyNjUXFAYjIiYjIgYVtMUCvQbFxf1DBgR2WzioNCk8bHdaR5ozKzoFsPucAgRi+lAEZgL7nAZcXYleQS8gXoJdQS4AAAADAHH/6wUCBzcADQAbACAAPQCyCwAAK7ERBumyBAIAK7EYBukBsCEvsADWsQ4L6bAOELEUASuxCAvpsSIBK7EUDhESswsEHB8kFzkAMDETERAAISAAGQEQACEiABMUEjMyEjURNAIjIgIVEzczEyNxAT8A/wEIAUv+tf74//7Bxc2st9fYtqzNPwPmr54CVgEDAQoBYv6f/vX+/f71/qABYAELyv8AAP/LAQXIAQD/AMgD1gb+9gAAAwBx/+sFAgczAA0AGwAgAD0AsgsAACuxEQbpsgQCACuxGAbpAbAhL7AA1rEOC+mwDhCxFAErsQgL6bEiASuxFA4RErMLBBwfJBc5ADAxExEQACEgABkBEAAhIgATFBIzMhI1ETQCIyICFQETMxcBcQE/AP8BCAFL/rX++P/+wcXNrLfX2LaszQEqueYC/vICVgEDAQoBYv6f/vX+/f71/qABYAELyv8AAP/LAQXIAQD/AMgCzgEKBv78AAADAHH/6wUCB10ADQAbACQAPQCyCwAAK7ERBumyBAIAK7EYBukBsCUvsADWsQ4L6bAOELEUASuxCAvpsSYBK7EUDhESswsEHCAkFzkAMDETERAAISAAGQEQACEiABMUEjMyEjURNAIjIgIVEzU3MxcVIycHcQE/AP8BCAFL/rX++P/+wcXNrLfX2LaszVL2ePihk5ICVgEDAQoBYv6f/vX+/f71/qABYAELyv8AAP/LAQXIAQD/AMgC+xrt7hmUlAADAHH/6wUCB2kADQAbAC8AegCyCwAAK7ERBumyBAIAK7EYBumwKS+xIgXpsywiKQgrsR8F6QGwMC+wANaxDgvpsA4QsRwBK7QvEwAQBCuwLxCxJQErtCYTABAEK7AmELEUASuxCAvpsTEBK7ElLxEStQsRGB8EKSQXOQCxKQQRErAvObAiEbAcOTAxExEQACEgABkBEAAhIgATFBIzMhI1ETQCIyICFRM0NjMyFjMyNjUXFAYjIiYjIgYVcQE/AP8BCAFL/rX++P/+wcXNrLfX2LaszSl2WzioNCk8bHdaR5ozKzoCVgEDAQoBYv6f/vX+/f71/qABYAELyv8AAP/LAQXIAQD/AMgDFl2JXkEvIF6CXUEuAAAABABx/+sFAgciAA0AGwAfACMAYACyCwAAK7ERBumyBAIAK7EYBumwHC+wIDOxHQrpsCEyAbAkL7AA1rEOC+mwDhCxHAErsR8M6bAfELEgASuxIwzpsCMQsRQBK7EIC+mxJQErsSAfERKzCxEYBCQXOQAwMRMREAAhIAAZARAAISIAExQSMzISNRE0AiMiAhUTNTMVMzUzFXEBPwD/AQgBS/61/vj//sHFzay319i2rM0s2/vbAlYBAwEKAWL+n/71/v3+9f6gAWABC8r/AAD/ywEFyAEA/wDIAv/IyMjIAAABAFgA4QPhBHkACwAAEwkBNwkBFwkBBwkBWAFH/rl+AUYBR37+uAFIfv65/roBXwFOAU5+/rMBTX7+sv6yfgFM/rQAAAMAcf+iBQIF7QAZACUAMQBlALIRAAArsSkG6bIEAgArsSIG6QGwMi+wANaxGgvpsBoQsSwBK7EOC+mxMwErsRoAERKwFTmwLBG1BxEUBB8mJBc5sA4SsAg5ALEpERESsRQXOTmwIhGyCh4xOTk5sAQSsAc5MDETERAAITIWFzczBx4BFREQACEiJicHIzcuATcUFh8BAS4BIyICFRMeATMyEjURNCYvAXEBPwD/XqlIUZWETVX+tf74VZdAW5WLVFnFJiMGAiAyfEiszaUsaj631yEeBgJWAQMBCgFiMy6J3VTigf79/vX+oCkomupU7IpVkjQBA5QpLP8AyP11IiIA/8sBBUuGMgEAAAACAJP/6wTcByIAEQAWAD4Asg8AACuxBgPpsgECACuwCjOwFi8BsBcvsADWsQML6bADELEJASuxDAvpsRgBK7EJAxESsg8SFTk5OQAwMRMRMxEUFjMyNjURMxEUBCMiJBM3MxMjk8W8mqLHxf7L+fD+1eED5q+eAdUD2/wlpaurpQPb/CXu/P0GNAb+9gAAAAACAJP/6wTcBx4AEQAWADsAsg8AACuxBgPpsgECACuwCjMBsBcvsADWsQML6bADELEJASuxDAvpsRgBK7EJAxESsg8SFTk5OQAwMRMRMxEUFjMyNjURMxEUBCMiJAETMxcBk8W8mqLHxf7L+fD+1QHMueYC/vIB1QPb/CWlq6ulA9v8Je78/QUsAQoG/vwAAAACAJP/6wTcB0gAEQAaADsAsg8AACuxBgPpsgECACuwCjMBsBsvsADWsQML6bADELEJASuxDAvpsRwBK7EJAxESsg8SFjk5OQAwMRMRMxEUFjMyNjURMxEUBCMiJBM1NzMXFSMnB5PFvJqix8X+y/nw/tX09nj4oZOSAdUD2/wlpaurpQPb/CXu/P0FWRrt7hmUlAAAAwCT/+sE3AcNABEAFQAZAFwAsg8AACuxBgPpsgECACuwCjOwEi+wFjOxEwrpsBcyAbAaL7AA1rEDC+mwAxCxEgErsRUM6bAVELEWASuxGQzpsBkQsQkBK7EMC+mxGwErsRYVERKxDwY5OQAwMRMRMxEUFjMyNjURMxEUBCMiJBM1MxUzNTMVk8W8mqLHxf7L+fD+1c7b+9sB1QPb/CWlq6ulA9v8Je78/QVdyMjIyAACABQAAATOBx0ACAANADQAsgcAACuyAAIAK7ADMwGwDi+wB9axBgvpsQ8BK7EGBxESsgIJDTk5OQCxAAcRErACOTAxEzMJATMBESMRGwEzFwEU4QF8AXzh/gHEDLnmAv7yBbD9HALk/FD+AAINBAYBCgb+/AAAAAACAKMAAARhBbAADAAVAEsAsgAAACuyAQIAK7QLDQABDSuxCwPptAMVAAENK7EDA+kBsBYvsADWsQwL6bECDTIysAwQsREBK7EHC+mxFwErALEVDRESsAc5MDEzETMRITIEFRQEIyEZASEyNjU0JiMho8UBDegBBP786P7zAQ2Tk5OT/vMFsP7b7L2+6/7HAdOccXKfAAAAAAEAif/rBHAGEwAnAHYAsgAAACuyEAAAK7EXA+mwIy+xBAPpAbAoL7AA1rEnC+mwJxCxIAErsQcQ6bMKByAIK7EdC+mwHS+xCgvpsAcQsRoBK7ENC+mxKQErsR0nERKzBBQTIyQXObAKEbEQFzk5ALEXABESsBM5sCMRsgcNFDk5OTAxMxE0NjMyFhUUBhUUABUUBiMiJic3HgEzMjY1NAA1NDY1NCYjIgYVEYnrt6HKgQFb0bJUsSUsK4I9bGb+pY1mQmiABDrf+qyndtw5Uv7ki6eqKR6fHDBfTlQBH5JQ3UxdbKeY+8YAAAAAAwBq/+sD8wXgACAAJQAwAJoAshgAACuyHgAAK7EpBOmyEAEAK7EIA+myCBAKK7NACAwJK7QDLh4QDSuxAwfpAbAxL7AA1rEmC+mwJhCwCyDWEbEMEOmwDC+xCxDpsCYQsRsBK7EELDIysRQL6bEyASuxDAARErAOObAmEbEhIjk5sRsLERK1EB4jJCUpJBc5sBQRsBg5ALEDHhESsRQbOTmwCBGxDRM5OTAxEzQ2OwE1NCYjIgYVIycmNjMyFhURFBYXIy4BJw4BIyImEzczEyMDFBYzMjY3NSMiBmr719Z0al93vAIG67q44AwQywoLATexZqmxfAPmr56xWlhrrBrdd48BMJuva19vYUQGdsS7sP33Omw0MUsmTmmtBUIG/vb8VkhUbkeweAAAAwBq/+sD8wXcACAAKwAwAJYAshgAACuyHgAAK7EkBOmyEAEAK7EIA+myCBAKK7NACAwJK7QDKR4QDSuxAwfpAbAxL7AA1rEhC+mwIRCwCyDWEbEMEOmwDC+xCxDpsCEQsRsBK7EEJzIysRQL6bEyASuxDAARErAOObEbCxEStRAeJCwtMCQXObAUEbIYLi85OTkAsQMeERKxFBs5ObAIEbENEzk5MDETNDY7ATU0JiMiBhUjJyY2MzIWFREUFhcjLgEnDgEjIiY3FBYzMjY3NSMiBhsBMxcBavvX1nRqX3e8AgbrurjgDBDLCgsBN7FmqbHFWlhrrBrdd4+iueYC/vIBMJuva19vYUQGdsS7sP33Omw0MUsmTmmtlEhUbkeweANVAQoG/vwAAAAAAwBq/+sD8wYGACAAKQA0AJ8AshgAACuyHgAAK7EtBOmyEAEAK7EIA+myCBAKK7NACAwJK7QDMh4QDSuxAwfpAbA1L7AA1rEqC+mwKhCwCyDWEbEMEOmwDC+xCxDpsCoQsRsBK7EEMDIysRQL6bE2ASuxDAARErAOObAqEbEhIjk5sRsLERK2EB4jJCcpLSQXObAUEbIYJSY5OTkAsQMeERKxFBs5ObAIEbENEzk5MDETNDY7ATU0JiMiBhUjJyY2MzIWFREUFhcjLgEnDgEjIiYTNTczFxUjJwcDFBYzMjY3NSMiBmr719Z0al93vAIG67q44AwQywoLATexZqmxj/Z4+KGTkmpaWGusGt13jwEwm69rX29hRAZ2xLuw/fc6bDQxSyZOaa0EZxrt7hmUlPwtSFRuR7B4AAAAAAMAav/rA/MGEgAgADQAPwDIALIYAAArsh4AACuxOATpshABACuxCAPpsggQCiuzQAgMCSu0Az0eEA0rsQMH6bAuL7EnBemzMScuCCuxJAXpAbBAL7AA1rE1C+mwNDKwNRCwCyDWEbEMEOmwDC+xCxDpsDUQtCETABAEK7AhL7A1ELEbASuyBCo7MjIysRQL6bQrEwAQBCuxQQErsRshERKzEB4nLiQXObEUABESsQ4YOTkAsT0YERKyABQbOTk5sQgDERKxDRM5ObEuEBESsDQ5sCcRsCE5MDETNDY7ATU0JiMiBhUjJyY2MzIWFREUFhcjLgEnDgEjIiYTNDYzMhYzMjY1FxQGIyImIyIGFQMUFjMyNjc1IyIGavvX1nRqX3e8AgbrurjgDBDLCgsBN7FmqbFmdls4qDQpPGx3WkeaMys6DVpYa6wa3XePATCbr2tfb2FEBnbEu7D99zpsNDFLJk5prQSCXYleQS8gXoJdQS78LEhUbkeweAAABABq/+sD8wXLACAAJAAvADMAtgCyGAAAK7IeAAArsSgE6bIQAQArsQgD6bIIEAors0AIDAkrtAMtHhANK7EDB+mwIS+wMDOxIgrpsDEyAbA0L7AA1rElC+mwJRCwCyDWEbEMEOmwDC+xCxDpsyElAAgrsSQM6bAlELEbASuxBCsyMrEUC+mwFBCwMyDWEbEwDOmwMC+xMwzpsTUBK7EwJBESsxAeCCgkFzmwMxGwGDkAsS0YERKyABQbOTk5sQgDERKxDRM5OTAxEzQ2OwE1NCYjIgYVIycmNjMyFhURFBYXIy4BJw4BIyImEzUzFQMUFjMyNjc1IyIGATUzFWr719Z0al93vAIG67q44AwQywoLATexZqmxadt/WlhrrBrdd48BetsBMJuva19vYUQGdsS7sP33Omw0MUsmTmmtBGvIyPwpSFRuR7B4A4bIyAAABABq/+sD8wZKACAAKwA3AEMAwgCyGAAAK7IeAAArsSQE6bIQAQArsQgD6bIIEAors0AIDAkrtAMpHhANK7EDB+mwNS+0OwcAFAQrsEEvtC8HABQEKwGwRC+wANaxIQvpsCEQsAsg1hGxDBDpsAwvsQsQ6bAhELEsASu0OBMAEAQrsDgQsT4BK7QyEwAQBCuwMhCxGwErsQQnMjKxFAvpsUUBK7E+OBEStRAeJAg1LyQXOQCxKRgRErIAFBs5OTmxCAMRErENEzk5sUE7ERKxMiw5OTAxEzQ2OwE1NCYjIgYVIycmNjMyFhURFBYXIy4BJw4BIyImNxQWMzI2NzUjIgYTNDYzMhYVFAYjIiY3FBYzMjY1NCYjIgZq+9fWdGpfd7wCBuu6uOAMEMsKCwE3sWapscVaWGusGt13jyt5V1V4d1ZXeWc+Kyo8PCorPgEwm69rX29hRAZ2xLuw/fc6bDQxSyZOaa2USFRuR7B4BAdUcnFVVmxsVis9Oy0tPj4AAwA6/+sGfAROAC4AOQBCAK4AsiwAACuwJjOxMgPpsB8yshABACuwFjOxCAPpsEAytDsbLBANK7A2M7E7BemwAzIBsEMvsADWsS8L6bAvELALINYRsQ0Q6bANL7ELEOmwLxCxNQErsAQysRwM6bA6MrAcELE8ASuxGQvpsUQBK7E1CxESshAsMjk5ObAcEbETKTk5sDwSsxsWHyYkFzkAsTIsERKwIzmwGxGyACIpOTk5sQg7ERKyCw0TOTk5MDETNDY7ATU0JiMiBhUvASY2MzIWFz4BMzISHQEhBx4BMzI2NxcOASMiJicOASMiJjcUFjMyNjc1IyIGARchNTQmIyIGOubc5WdiZ3q8AgXlv3KvMkCvZdbn/TsCAZ2bZ4VOQzW8jIjQQjjfoKq5xWRhTKYr43iHAroCAfx4gHGKATCerVVqeW5OEgaKtVFNS1P+/OR3BZ/GNzOKLE5hWk9srpNKXVc52HABCAUfepqpAAACAGH+RQPyBE4AHQAtAIsAshsAACu0JQcAFAQrsgQBACuxDAPpsgwECiuzQAwICSuwLS+0HgcAIQQrAbAuL7AA1rEQC+mwEBCxIQErsSoT6bAqELEWASuwCTKxGA/psAcysS8BK7EhEBEStwwEExseJCUtJBc5sCoRsSYnOTkAsRseERKyJCcqOTk5sQwlERKzBxMWGCQXOTAxEzU0EjMyFg8BIzQmIyIGHQEUFjMyNjUzFxYEIyICATI2NTQmJzczBx4BFRQGI2H7677xBAKyjGubhYScYpWxAgX+/azs+gFXSFhIVyCMDEFWnpMCCCrnATXgowZji9+iKqbdeVgGjNkBNP2TMTEwJgeHNAtSUGByAAADAGP/6wPtBeEAFgAbACQAbACyFAAAK7ENA+myBAEAK7EiA+m0HQkUBA0rsR0D6QGwJS+wANaxChLpsBwysAoQsR4BK7EHC+mxJgErsQoAERKxFxg5ObAeEbYJBA0UGRobJBc5sAcSsRAROTkAsQ0UERKwETmwCRGwEDkwMRM1NAAzMhIdASEHHgEzMjY3Fw4BIyIAEzczEyMDFyE1NCYjIgZjARO82+D9QgMDmIlklzdNOr6H4v71hgPmr56wAgHzfHpjjAIILOcBM/743HsFnMk5MoA5TAEtBMMG/vb9twUadJynAAAAAwBj/+sD7QXdABYAHwAkAGcAshQAACuxDQPpsgQBACuxHQPptBgJFAQNK7EYA+kBsCUvsADWsQoS6bAXMrAKELEZASuxBwvpsSYBK7EZChEStgkEDRQgISQkFzmwBxGzEBEiIyQXOQCxDRQRErARObAJEbAQOTAxEzU0ADMyEh0BIQceATMyNjcXDgEjIgATFyE1NCYjIgYbATMXAWMBE7zb4P1CAwOYiWSXN006vofi/vXQAgHzfHpjjJG55gL+8gIILOcBM/743HsFnMk5MoA5TAEtAXYFGnScpwHHAQoG/vwAAwBj/+sD7QYHABYAHwAoAHAAshQAACuxDQPpsgQBACuxJgPptCEJFAQNK7EhA+kBsCkvsADWsQoS6bAgMrAKELEiASuxBwvpsSoBK7EKABESsRcYOTmwIhG3CQQNFBkaHR8kFzmwBxKzEBEbHCQXOQCxDRQRErARObAJEbAQOTAxEzU0ADMyEh0BIQceATMyNjcXDgEjIgATNTczFxUjJwcDFyE1NCYjIgZjARO82+D9QgMDmIlklzdNOr6H4v71mfZ4+KGTkmkCAfN8emOMAggs5wEz/vjcewWcyTkygDlMAS0D6Brt7hmUlP2OBRp0nKcAAAQAY//rA+0FzAAWABoAIwAnAIIAshQAACuxDQPpsgQBACuxIQPptBwJFAQNK7EcA+mwFy+wJDOxGArpsCUyAbAoL7AA1rEKEumwGzKzFwoACCuxGgzpsAoQsSQBK7EnDOmzHSckCCuxBwvpsSkBK7EaFxESsQkcOTmwJBGzDRQEISQXObAnErAQOQCxCQ0RErAQOTAxEzU0ADMyEh0BIQceATMyNjcXDgEjIgATNTMVAxchNTQmIyIGATUzFWMBE7zb4P1CAwOYiWSXN006vofi/vVz234CAfN8emOMAWnbAggs5wEz/vjcewWcyTkygDlMAS0D7MjI/YoFGnScpwH4yMgAAv+5AAABXgXLAAQACAApALIFAAArsgYBACsBsAkvsAXWsQgL6bEKASuxCAURErICBAM5OTkAMDEDNzMTIwMRMxFHA+avnhrFBcUG/vb7PwQ6+8YAAgCZAAACQwXHAAMACAApALIAAAArsgEBACsBsAkvsADWsQML6bEKASuxAwARErIEBQg5OTkAMDEzETMRAxMzFwGZxby55gL+8gQ6+8YEvQEKBv78AAAAAAL/zAAAAjIF8QAIAAwAKQCyCQAAK7IKAQArAbANL7AJ1rEMC+mxDgErsQwJERKyAwIHOTk5ADAxAzU3MxcVIycHExEzETT2ePihk5ItxQTqGu3uGZSU+xYEOvvGAAAAAAP/pgAAAlcFtgADAAcACwBCALIEAAArsgECACuwCTOxAArpsAgysgUBACsBsAwvsADWsQMM6bADELEEASuxBwvpsAcQsQgBK7ELDOmxDQErADAxAzUzFRMRMxETNTMVWtsYxR7bBO7IyPsSBDr7xgTuyMgAAgBI/+sEMAXtACAALQByALIeAAArsSQD6bArL7EDA+mwEC+xEQTpsBUyAbAuL7AA1rEhC+mwIRCxJwErsRsL6bAWMrEvASuxJyERErUDDBQXHgckFzmwGxGwFTkAsSskERKwADmwAxGxBgc5ObAQErIKCxc5OTmwERGxFBY5OTAxEzQAMzIWFzcuAScFJyUuASc3HgEXNxcHFhIdARQAIyIANxQWMzI2PQEuASMiBkgBFNVanzQECVVE/t5NAQAnUyw8T5A/2k3DX2j+4Nfa/unFpIyFqSOhdoOhAdLkARxKPAVtsEKlZpIWIg6kE0IufWZwaP7to9z1/skBGM+EyeSulDtR0AAAAgCPAAAD/QYSABMAJwCFALIAAAArsAozsgEBACuyBgEAK7EPBumwIS+xGgXpsyQaIQgrsRcF6QGwKC+wAdaxAg/psAIQsCcg1hG0FBMAEAQrsBQvtCcTABAEK7ASMrACELELASuwHTKxCgvptB4TABAEK7EpASuxCwERErIGDyE5OTkAsSEBERKwJzmwGhGwFDkwMTMRMxc+ATMyFhURIxE0JiMiBgcRAzQ2MzIWMzI2NRcUBiMiJiMiBhWPsA42o2ivwMVxdFWDJ212WzioNCk8bHdaR5ozKzoEOqFWX83W/VUCp494Ukf86wUaXYleQS8gXoJdQS4AAAAAAwBh/+sEKgXgAA0AEgAgAEYAsgsAACuxFgPpsgQBACuxHQPpAbAhL7AA1rETC+mwExCxGQErsQgL6bEiASuxEwARErEODzk5sBkRtAQQCxIRJBc5ADAxEzU0ADMyAB0BFAAjIgATNzMTIwMUFjMyNj0BNCYjIgYVYQEE3+EBBf784OD++6AD5q+e1ZGPjZKTjo2RAhEW8AE3/srxFvL+zAE1BLoG/vb9O6zg4KwWquLiqgAAAwBh/+sEKgXcAA0AGwAgAEYAsgsAACuxEQPpsgQBACuxGAPpAbAhL7AA1rEOC+mwDhCxFAErsQgL6bEiASuxFA4RErQECxwdICQXObAIEbEeHzk5ADAxEzU0ADMyAB0BFAAjIgA3FBYzMjY9ATQmIyIGFRsBMxcBYQEE3+EBBf784OD++8WRj42Sk46Nkca55gL+8gIRFvABN/7K8Rby/swBNfGs4OCsFqri4qoCqwEKBv78AAAAAAMAYf/rBCoGBgANABYAJABPALILAAArsRoD6bIEAQArsSED6QGwJS+wANaxFwvpsBcQsR0BK7EIC+mxJgErsRcAERKxDg85ObAdEbUEEBEUFgskFzmwCBKxEhM5OQAwMRM1NAAzMgAdARQAIyIAEzU3MxcVIycHAxQWMzI2PQE0JiMiBhVhAQTf4QEF/vzg4P77s/Z4+KGTko6Rj42Sk46NkQIRFvABN/7K8Rby/swBNQPfGu3uGZSU/RKs4OCsFqri4qoAAAAAAwBh/+sEKgYSAA0AIQAvAIMAsgsAACuxJQPpsgQBACuxLAPpsBsvsRQF6bMeFBsIK7ERBekBsDAvsADWsSIL6bAiELAhINYRtA4TABAEK7AOL7QhEwAQBCuwIhCxKAErsQgL6bAXINYRtBgTABAEK7ExASuxFyERErUEEQsbJSwkFzkAsRsEERKwITmwFBGwDjkwMRM1NAAzMgAdARQAIyIAEzQ2MzIWMzI2NRcUBiMiJiMiBhUDFBYzMjY9ATQmIyIGFWEBBN/hAQX+/ODg/vuKdls4qDQpPGx3WkeaMys6MZGPjZKTjo2RAhEW8AE3/srxFvL+zAE1A/pdiV5BLyBegl1BLv0RrODgrBaq4uKqAAAABABh/+sEKgXLAA0AEQAfACMAZQCyCwAAK7EVA+myBAEAK7EcA+mwDi+wIDOxDwrpsCEyAbAkL7AA1rESC+mzDhIACCuxEQzpsBIQsRgBK7EIC+mzIwgYCCuxIAzpsCAvsSMM6bElASuxIBERErMECxUcJBc5ADAxEzU0ADMyAB0BFAAjIgATNTMVAxQWMzI2PQE0JiMiBhUBNTMVYQEE3+EBBf784OD++43bo5GPjZKTjo2RAZ7bAhEW8AE3/srxFvL+zAE1A+PIyP0OrODgrBaq4uKqAtzIyAAAAAMARwC0BC0EsgADAAcACwAuALAEL7EFCumwAC+xAQjpsAgvsQkK6QGwDC+wBNawCDKxBwvpsAoysQ0BKwAwMRM1IRUBNTMVAzUzFUcD5v2rxsbGAlW8vP5fy8sDM8vLAAMAYf95BCoEuQAZACUAMQBoALIRAAArsSkD6bIEAQArsSID6QGwMi+wANaxGgvpsBoQsSwBK7EOC+mxMwErsRoAERKwFjmwLBG2CAQVERcfJiQXObAOErEKCTk5ALEpERESsRQXOTmwIhGxHTA5ObAEErEHCjk5MDETNTQAMzIWFzczBx4BHQEUACMiJicHIzcuATcUFhczAS4BIyIGFRMeATMyNj0BNCYnI2EBBN84Zy5KgWhYXv784DNcKkiBZGBnxSgpBgFMHUMljZGvGDghjZIjIAYCERbwATcWFJXTSuiNFvL+zBEQk8xH8JVblzACohAS4qr+dQwL4KwWUI0vAAAAAgCL/+sD/AXLABMAGABhALINAAArshEAACuxBgbpsgEBACuwCjMBsBkvsADWsQML6bADELEJASuxDAvpsAwQsQ0P6bANL7EaASuxAwARErEUFTk5sAkRsxEWFxgkFzmwDRKwDjkAsQEGERKwDjkwMRMRMxEUFjMyNjcRMxEjJw4BIyImEzczEyOLxWZsaYkjxbENM6BpscZ0A+avngG8An79gK2CVU4DDPvGoFde4gT4Bv72AAAAAAIAi//rA/wFxwATABgAYQCyDQAAK7IRAAArsQYG6bIBAQArsAozAbAZL7AA1rEDC+mwAxCxCQErsQwL6bAMELEND+mwDS+xGgErsQkDERKzERQVGCQXObANEbAOObAMErEWFzk5ALEBBhESsA45MDETETMRFBYzMjY3ETMRIycOASMiJgETMxcBi8VmbGmJI8WxDTOgabHGAV+55gL+8gG8An79gK2CVU4DDPvGoFde4gPwAQoG/vwAAAAAAgCL/+sD/AXxABMAHABqALINAAArshEAACuxBgbpsgEBACuwCjMBsB0vsADWsQML6bADELEJASuxDAvpsAwQsQ0P6bANL7EeASuxAwARErEUFTk5sAkRtBEWFxocJBc5sA0SsA45sAwRsRgZOTkAsQEGERKwDjkwMRMRMxEUFjMyNjcRMxEjJw4BIyImEzU3MxcVIycHi8VmbGmJI8WxDTOgabHGh/Z4+KGTkgG8An79gK2CVU4DDPvGoFde4gQdGu3uGZSUAAADAIv/6wP8BbYAEwAXABsAewCyDQAAK7IRAAArsQYG6bIVAgArsBkzsRQK6bAYMrIBAQArsAozAbAcL7AA1rEDC+mwFCDWEbEXDOmwAxCxCQErsQwL6bAMELAbINYRsRgM6bAYL7EbDOmwDBCxDQ/psA0vsR0BK7EYFxESsREGOTkAsQEGERKwDjkwMRMRMxEUFjMyNjcRMxEjJw4BIyImEzUzFTM1MxWLxWZsaYkjxbENM6BpscZh2/vbAbwCfv2ArYJVTgMM+8agV17iBCHIyMjIAAIAGv5LA+gFxwAVABoAPgCyAAEAK7AFM7AKL7ERBOkBsBsvsAXWsQYM6bEcASuxBgURErEYGTk5ALERChESsA05sAARsgMODzk5OTAxEzMTFzMBMwEOASMiJic3JhYzMjY/AQMTMxcBGtzkIwYBCtv+OSmZghhKFBQGUws/UBsvBLnmAv7yBDr9V4gDMfsgbaILBZsBBnBEcQSnAQoG/vwAAAAAAgCZ/mAEMwYYABEAHwBVALINAAArsRUD6bIGAQArsRwG6bAAL7ABLwGwIC+wANaxEQvpsQISMjKwERCxGAErsQoL6bEhASuxGBERErEGDTk5ALEVDRESsBA5sQYcERKwAzkwMRMRMxE+ATMyEhEVFAIjIiYnGQEeATMyNj0BNCYjIgYHmcU1lmLJ3+DFZJc1JXhXjJCRjVV4Jf5gB7j9qkRI/sH++hXq/uFDQ/3vArNDS82iFbjtTUMAAAADABr+SwPoBbYAFQAZAB0AdQCyFwIAK7AbM7EWCumwGjKyAAEAK7AFM7AKL7ERBOkBsB4vsBbWsRkM6bAZELEFASuxBgzpsx0GBQgrsRoM6bAaL7EdDOmxHwErsRkWERKyChEBOTk5sBoRsgMEFTk5OQCxEQoRErANObAAEbIDDg85OTkwMRMzExczATMBDgEjIiYnNyYWMzI2PwEBNTMVMzUzFRrc5CMGAQrb/jkpmYIYShQUBlMLP1AbL/7+2/vbBDr9V4gDMfsgbaILBZsBBnBEcQTYyMjIyAAAAgBo/+sHTwXFABcAJQCEALISAAArsQ8D6bIVAAArsRsD6bIHAgArsQoD6bIEAgArsSID6bQLDhUEDSuxCwPpAbAmL7AA1rEYC+mwGBCxHgErsQ8L6bAKMrIPHgors0APCQkrsBAys0APDQkrsScBK7EeGBESsRUEOTmwDxGwEjkAsQ8SERKwHjmxBwoRErAfOTAxExEQADMyFhchFSERIRUhESEVIQ4BIyIAExQWMzI2NxEuASMiBhVoATX5RY9PA4v9CgKb/WUDAfxqXIJD+f7JxcKpPXo6PXo8qcACQAEwAQkBTAwJm/4pm/33mgoLAUwBCdbkCQkEfwgL49UAAAMAYf/rBvcETgAiADAAOQCSALIgAAArsBozsSYD6bATMrIEAQArsAozsS0D6bA3MrQyDyAEDSuxMgPpAbA6L7AA1rEjC+mwIxCxKQErsRAS6bAxMrAQELEzASuxDQvpsTsBK7EpIxESsQQgOTmwEBGxBx05ObAzErMPChMaJBc5sA0RsRYXOTkAsSYgERKwFzmwDxGxFh05ObEtMhESsAc5MDETNTQAMzIWFz4BMzISHQEhBx4BMzI2NxcOASMiJicOASMiADcUFjMyNj0BNCYjIgYVJRchNTQmIyIGYQEE34LIQEHBbNvg/UIDA5iJZJc3TTq+h4PLQUDGf+D++8WRj42Sk46NkQMXAgHzfHpjjAIRFvABN21iYW7++Nx7BZzJOTKAOUxpYGBpATXxrODgrBaq4uKqZwUadJynAAAAAwAUAAAEzgcMAAgADAAQAFMAsgcAACuyAAIAK7ADM7AJL7ANM7EKCumwDjIBsBEvsAnWsQwM6bAMELEHASuxBgvpsAYQsQ0BK7EQDOmxEgErsQYHERKwAjkAsQAHERKwAjkwMRMzCQEzAREjEQM1MxUzNTMVFOEBfAF84f4BxPLb+9sFsP0cAuT8UP4AAg0EN8jIyMgAAAABAKsE5AMRBesACAArALAAL7AFM7QCCgAQBCsBsAkvsADWtAUMAAcEK7EKASsAsQIAERKwBzkwMRM1NzMXFSMnB6v2ePihk5IE5Brt7hmUlAAAAAABAIcE4QM9BfMAEwBPALANL7EGBemzEAYNCCuxAwXpAbAUL7AA1rQTEwAQBCuwExCxCQErtAoTABAEK7EVASuxCRMRErEDDTk5ALEQDRESsAA5sQMGERKwCjkwMRM0NjMyFjMyNjUXFAYjIiYjIgYVh3ZbOKg0KTxsd1pHmjMrOgT7XYleQS8gXoJdQS4AAAABACMCGgINArQAAwAAEzUhFSMB6gIampoAAAAAAQAjAhoCDQK0AAMAABM1IRUjAeoCGpqaAAAAAAEAIwIaAg0CtAADAAATNSEVIwHqAhqamgAAAAABAKkCiATnAyMAAwAXALAAL7EBA+mxAQPpAbAEL7EFASsAMDETNSEVqQQ+AoibmwABAI0CiAXFAyMAAwAXALAAL7EBA+mxAQPpAbAEL7EFASsAMDETNSEVjQU4AoibmwABAFAD/AFRBhgABQAlALAAL7QCCgAIBCsBsAYvsAHWsQUL6bEHASuxBQERErACOQAwMRM1EzMDFVCgYTwD/LgBZP6WsgAAAAABAFAD/QFRBhgABQAlALAAL7QCCgAIBCsBsAYvsAHWsQQL6bEHASuxBAERErAFOQAwMRsBNTMVA1A8xaAD/QFXxMH+pgAAAAABAFD/AQFRAPkABQAlALAAL7QCCgAJBCsBsAYvsAHWsQQL6bEHASuxBAERErAFOQAwMRcTNTMVA1A8xaD/AQfx3/7nAAIAUAP8ApoGGAAFAAsAQgCwAC+wBjO0AgoACAQrsAgyAbAML7AB1rEFC+mwBRCxBwErsQsL6bENASuxBQERErACObAHEbADObALErAIOQAwMRM1EzMDFTM1EzMDFVCgYTyEoGE8A/y4AWT+lrK4AWT+lrIAAgBQA/0CogYYAAUACwBCALAAL7AGM7QCCgAIBCuwCDIBsAwvsAHWsQQL6bAEELEHASuxCgvpsQ0BK7EEARESsAU5sAcRsAY5sAoSsAs5ADAxGwE1MxUDMxM1MxUDUDzFoPA8xaAD/QFXxMH+pgFXxMH+pgACAFD/EQKFARgABQALAEIAsAAvsAYztAIKAAgEK7AIMgGwDC+wAdaxBAvpsAQQsQcBK7EKC+mxDQErsQQBERKwBTmwBxGwBjmwChKwCzkAMDEXEzUzFQMzEzUzFQNQPMWg0zzFoO8BRcK4/rEBTbq4/rEAAAEAiQIXAicD4QANAC4AsAsvtAQKAAkEK7QECgAJBCsBsA4vsADWtAgMAAoEK7QIDAAKBCuxDwErADAxEzU0NjMyFh0BFAYjIiaJcF5fcXBfX3AC3TxYcHBYPFltbgAAAAMAoQAABMUAygADAAcACwBFALIAAAArsQQIMzOxAQrpsQUJMjKyAAAAK7EBCukBsAwvsADWsQML6bADELEEASuxBwvpsAcQsQgBK7ELC+mxDQErADAxMzUzFTM1MxUzNTMVocX2xd/FysrKysrKAAABAGwAmAInA7UABgAhAAGwBy+wANa0BQwACgQrsAMysQgBK7EFABESsAQ5ADAxEzUBMwMBI2wBJ5T/AP+UAh0TAYX+cf5yAAABAFgAmAITA7UABgAhAAGwBy+wANawAjK0BQwACgQrsQgBK7EFABESsAE5ADAxNwEDMwEVAVgA//+UASf+2ZgBjgGP/nsT/nsAAAAAAQBP/+sD1QXFACoA9wCyJwAAK7EgA+myCgIAK7ALM7ERA+mwEDK0AAEnCg0rsBkzsQAD6bAbMrQFBCcKDSuwFzOxBQPpsBUysw4nCggrAbArL7AC1rEGKjIysRkL6bEUHTIyshkCCiuzQBkbCSuwFjKyAhkKK7NAAgAJK7AEMrAZELENASuxLAErsDYasCYaAbEODS7JALENDi7JsDYauvLhwVwAFSsKBbAOELAQwLANELALwLr1UMDmABUrC7ALELMMCw0TK7AQELMPEA4TK7IMCw0giiCKIwYOERI5sg8QDhESOQCxDA8uLgGzCwwPEC4uLi6wQBoBALEAIBESsCM5MDETNTM1IzUzNTQAMzIWFwcuASMiBh0BIRUhFSEVIQcGFjMyNjcXDgEjIgA1T5KSkgEb5zt1QhM2cTiSqwHs/hQB7P4bAgSrkzlwNBM4ez3n/uMB4ZuImw/0ASMQD58QE86sEZuImwWKzRERnQ8QASHVAAAAAAIAZwOXBGAFsAAHABcAeACyAQIAK7EJDTMztAAHABQEK7ADMrIAAQors0AABgkrsggPEzIyMgGwGC+wBta0BRMAEAQrsgUGCiuzQAUDCSuyBgUKK7NABgAJK7AFELEIASu0FxMAEAQrsBcQsRABK7QPEwAQBCuxGQErsRAXERKxCg05OQAwMRM1IRUjESMRAREzEzMTMxEjEScDIwMHEWcBgJFeAT10oQaibl0GljOcBgVeUlL+OQHH/jkCGf56AYb95wFXAv6nAWcC/psAAAABAAAAAAQ4BDgAAwAAMREhEQQ4BDj7yAACABwAAAPVBi0AFwAbAOcAshYAACuwGDOyAQEAK7ERGTMzsQAF6bATMrAKL7ANL7AMM7EGBOmwBzIBsBwvsBbWsAIysRUL6bAQMrIVFgors0AVEwkrshYVCiuzQBYACSuwFRCxCQErsxAJGw4rsRgL6bAYL7EbC+mxHQErsDYasCYaAbEKCS7JALEJCi7JsDYauuxNwxwAFSsKBbAKELAMwLAJELAHwLruwcJeABUrC7AHELMIBwkTK7AMELMLDAoTK7IIBwkgiiCKIwYOERI5sgsMChESOQCxCAsuLgGzBwgLDC4uLi6wQBoBsRgVERKwBjkAMDETNTM1NDYzMhYXBy4BIyIGHQEzFSMRIxEBETMRHKrVvUOCWCI1eD91Z9fXxQJJxgOoknW2yB8eoBUeaGx1kvxYA6j8WAQ6+8YAAAIAOAAABCcGLQAXABsAcwCyFgAAK7AYM7IBAQArsBEzsQAF6bATMrAJL7AZM7MUCQYOK7ENBukBsBwvsBbWsAIysRUL6bAQMrIVFgors0AVEwkrshYVCiuzQBYACSuwFRCxGAErsRsL6bEdASuxGBURErEGCTk5ALENARESsAo5MDETNTM1NDYzMhYXBy4BIyIGHQEzFSMRIxEBETMROKm1oiJFKhgSMxxWVOHhxQKBxQOokomtvQsKlgQGZ2KJkvxYA6j8WAYY+egAAAMAOAAABpgGLQAXAC8AMwEyALIWAAArsS0wMzOyAQEAK7MRGSkxJBczsQAF6bITGCsyMjKwIi+wDS+wJTOxBgbpsB8yAbA0L7AW1rACMrEVC+mwEDKyFRYKK7NAFRMJK7IWFQors0AWAAkrsBUQsS4BK7AaMrEtC+mwKDKyLS4KK7NALSsJK7IuLQors0AuGAkrsC0QsSEBK7MQITMOK7EwC+mwMC+xMwvpsTUBK7A2GrAmGgGxIiEuyQCxISIuybA2GrrsTcMcABUrCg6wIhCwJMAFsCEQsB/Auu7Bwl4AFSsLsB8QsyAfIRMrsCQQsyMkIhMrsiAfISCKIIojBg4REjmyIyQiERI5ALIgIyQuLi4Bsx8gIyQuLi4usEAaAbEuFRESsQYJOTmxMC0RErAeOQCxDSIRErAKObAGEbAJOTAxEzUzNTQ2MzIWFwcuASMiBh0BMxUjESMRITUzNTQ2MzIWFwcuASMiBh0BMxUjESMRAREzETiptaIiRSoYEjMcVlTh4cUB/qrVvUOCWCI1eD91Z9fXxQJJxgOokomtvQsKlgQGZ2KJkvxYA6iSdbbIHx6gFR5obHWS/FgDqPxYBDr7xgAAAAMAOAAABuoGLQAXAC8AMwCsALIWAAArsS0wMzOyAQEAK7IRGSkzMzOxAAXpshMYKzIyMrANL7AiM7EGBumwHjKxCQXpsSExMjIBsDQvsBbWsAIysRUL6bAQMrIVFgors0AVEwkrshYVCiuzQBYACSuwFRCxLgErsBoysS0L6bAoMrItLgors0AtKwkrsi4tCiuzQC4YCSuwLRCxMAErsTML6bE1ASuxLhURErEGCTk5sTAtERKxHiE5OQAwMRM1MzU0NjMyFhcHLgEjIgYdATMVIxEjESE1MzU0NjMyFhcHLgEjIgYdATMVIxEjEQERMxE4qbWiIkUqGBIzHFZU4eHFAhqptaIiRSoYEjMcVlTh4cUCgcUDqJKJrb0LCpYEBmdiiZL8WAOokomtvQsKlgQGZ2KJkvxYA6j8WAYY+egAAQAAAAEAAFHdQ5VfDzz1AB8IAAAAAADOoagKAAAAAM6hqAr/pv4RB2EHjAAAAAgAAgAAAAAAAAABAAAId/2tAAAIAP+m/6wHYQABAAAAAAAAAAAAAAAAAAAA6gLsAEQIAAAAAf0AAAH9AAACGwCrApwAUAT8AEYEgQByBdoAaAT8AEABZwBQAqcAhAKvAAYDdAAcBIoATgGUADACMQAjAiQAoQNSABAEggBxBIEAugSBAGEEgQBkBIEANwSBAJ0EgQCEBIEATQSBAGYEgQBTAgUAoQINAGMEEABHBIEAmAQwAIgDzgA9BykAcgUuABQFHQC0BREAdgVFALQErQC0BKkAtAV0AHgFtQC0AkMAvgRqAEIFJQC0BFIAtAcHALQFtQC0BXQAcQUgALQFdABxBU0AtAT9AGYEsAAiBWoAkwUPABYHEQA2BQ8AQgTiABQEyQBhAigAjwNOACcCKAALA1gAPQOjAAQCgQBSBGYAagSMAI8EPwBhBIwAYgQ7AGMCwwA4BIwAZASMAI8CBACfAhL/vgQaAJACBACfBv4AjwSMAI8EjABhBIwAjwSMAGICvgCPBC8AbQLEACIEjACLBAYALgYOAC0EBgAuBAYAGgQGAF4CuAA/AfsArwK4ABUFbwCAAf0AAAH7AJAEYgBrBKoARgWwAGgE2wAeAfMAkQTrAF4D/QCqBkQAWAOVAHgDxgBiBHEAfwIxACMGRABYA7YAewL7AIAESQBjA2QAdwNsAHACjgCDBIwAmQPuAD8CHAChAf0AdwItAF8DpQB4A8YAbgY7ALgGrAC4BvUAgAP1AHIFLgAUBS4AFAUuABQFLgAUBS4AFAUuABQHgv/sBREAdgStALQErQC0BK0AtAStALQCQ//eAkMAvgJD//ECQ//LBWMAKgW1ALQFdABxBXQAcQV0AHEFdABxBXQAcQRIAFgFdABxBWoAkwVqAJMFagCTBWoAkwTiABQEuQCjBMUAiQRmAGoEZgBqBGYAagRmAGoEZgBqBGYAagbBADoEPwBhBDsAYwQ7AGMEOwBjBDsAYwID/7kCAwCZAgP/zAID/6YEsgBIBIwAjwSMAGEEjABhBIwAYQSMAGEEjABhBJIARwSMAGEEjACLBIwAiwSMAIsEjACLBAYAGgSiAJkEBgAaB6gAaAc+AGEE4gAUA9MAqwPTAIcDxgAAB4wAAAPGAAAHjAAAAoQAAAHjAAABQgAAAUIAAADxAAABggAAAGsAAAIxACMCMQAjAjEAIwWIAKkGfACNAaIAUAGiAFABoQBQAugAUALwAFAC1gBQArcAiQVkAKEBggAAAmcAbAJnAFgB4wAABEAATwUEAGcEOAAABHQAHATHADgHNwA4B4oAOAAAACwALAAsACwAWACQAXQCAAKcAzgDXgOMA7oD7AQuBFIEcASQBKgE9AUeBYQGCgZWBuwHYge8CEQIugjiCQwJJAlGCVwJxAqUCsYLLAuSC9AMDAxCDLQM7A0KDU4NjA2yDggORA6WDtoPPg+mECYQVhCSELoRThGAEbAR3hIKEiASUhJ0Eo4SrhM0E5oT/hRoFM4VIBWeFeYWEBZMFogWohcOF1YXohgEGGoYpBkiGXgZxBnwGlYahhrIGvYbUBtsG8QcGBwYHD4crB0iHaoeDh40HuwfGB/AIDwgXCCEIKIhWiF2IcIiDiJmIugjDiNiI5YjtCPwJBYkXCR+JPoljiZaJsIm/ic6J3on8ChMKMApKCm4KgIqSCqWKu4rGitGK3YrsCwQLIos5i1ELaQuMC6gLsIvSC+QL9gwIjB6MLYxAjF4Mg4ypDNCNAA0qDVoNiA2qjceN5A4CjiMOLY44jkSOUw50DpOOqg7BDtoO/I8YDyQPRI9bj3MPjA+mj7sP0o/uEA4QNhBJEFOQZZBlkGWQZZBlkGWQZZBlkGWQZZBlkGWQaRBskHAQdhB8EIUQjhCWkKUQs5DCEM4Q3BDcEOUQ7pDukR2RN5E6kWKRfBG1Ed0AAAAAQAAAOoARgAFAAAAAAACAAEAAgAWAAABAAFXAAAAAAAAABUBAgABAAAAAAABAAAAAAABAAAAAAACAAEAAAABAAAAAAADAAAAAQABAAAAAAAEABYAAQABAAAAAAAGAAEAFwADAAEECQAAAD4AGAADAAEECQABAAQAVgADAAEECQACAAAAWgADAAEECQADAAAAWgADAAEECQAEAAQAWgADAAEECQAFACwAXgADAAEECQAGAAIAigADAAEECQAHAEAAjAADAAEECQAJAAwAzAADAAEECQALABQA2AADAAEECQAMACYA7AADAAEECQANAFwBEgADAAEECQAOAFQBbgADAAEECQASABwBwgADAAEECQDIABYB3gADAAEECQDJADAB9H9Sb2JvdG8gUmVndWxhciBXZWJmb250fwBGAG8AbgB0ACAAZABhAHQAYQAgAGMAbwBwAHkAcgBpAGcAaAB0ACAARwBvAG8AZwBsAGUAIAAyADAAMQAyAC4AfwAuAH8AVgBlAHIAcwBpAG8AbgAgADEALgAxADAAMAAxADQAMQA7ACAAMgAwADEAMwB/AFIAbwBiAG8AdABvACAAaQBzACAAYQAgAHQAcgBhAGQAZQBtAGEAcgBrACAAbwBmACAARwBvAG8AZwBsAGUALgBHAG8AbwBnAGwAZQBHAG8AbwBnAGwAZQAuAGMAbwBtAEMAaAByAGkAcwB0AGkAYQBuACAAUgBvAGIAZQByAHQAcwBvAG4ATABpAGMAZQBuAHMAZQBkACAAdQBuAGQAZQByACAAdABoAGUAIABBAHAAYQBjAGgAZQAgAEwAaQBjAGUAbgBzAGUALAAgAFYAZQByAHMAaQBvAG4AIAAyAC4AMABoAHQAdABwADoALwAvAHcAdwB3AC4AYQBwAGEAYwBoAGUALgBvAHIAZwAvAGwAaQBjAGUAbgBzAGUAcwAvAEwASQBDAEUATgBTAEUALQAyAC4AMABSAG8AYgBvAHQAbwAgAFIAZQBnAHUAbABhAHIAVwBlAGIAZgBvAG4AdAAgADEALgAwAFQAaAB1ACAATgBvAHYAIAAgADcAIAAxADUAOgAyADYAOgA1ADAAIAAyADAAMQAzAAAAAgAAAAAAAP9qAGQAAAAAAAAAAAAAAAAAAAAAAAAAAADqAAABAgEDAAMABAAFAAYABwAIAAkACgALAAwADQAOAA8AEAARABIAEwAUABUAFgAXABgAGQAaABsAHAAdAB4AHwAgACEAIgAjACQAJQAmACcAKAApACoAKwAsAC0ALgAvADAAMQAyADMANAA1ADYANwA4ADkAOgA7ADwAPQA+AD8AQABBAEIAQwBEAEUARgBHAEgASQBKAEsATABNAE4ATwBQAFEAUgBTAFQAVQBWAFcAWABZAFoAWwBcAF0AXgBfAGAAYQEEAKMAhACFAL0AlgDoAIYAjgCLAJ0AqQCkAQUAigDaAIMAkwEGAQcAjQEIAIgAwwDeAQkAngCqAPUA9AD2AKIArQDJAMcArgBiAGMAkABkAMsAZQDIAMoAzwDMAM0AzgDpAGYA0wDQANEArwBnAPAAkQDWANQA1QBoAOsA7QCJAGoAaQBrAG0AbABuAKAAbwBxAHAAcgBzAHUAdAB2AHcA6gB4AHoAeQB7AH0AfAC4AKEAfwB+AIAAgQDsAO4AugCwALEAuwDYANkBCgELAQwBDQEOAQ8BEAERARIBEwEUARUBFgEXALIAswC2ALcAxAC0ALUAxQCHAKsBGAC+AL8BGQEaAIwBGwEcAR0BHgEfBmdseXBoMQd1bmkwMDBEB3VuaTAwQTAHdW5pMDBBRAd1bmkwMEIyB3VuaTAwQjMHdW5pMDBCNQd1bmkwMEI5B3VuaTIwMDAHdW5pMjAwMQd1bmkyMDAyB3VuaTIwMDMHdW5pMjAwNAd1bmkyMDA1B3VuaTIwMDYHdW5pMjAwNwd1bmkyMDA4B3VuaTIwMDkHdW5pMjAwQQd1bmkyMDEwB3VuaTIwMTEKZmlndXJlZGFzaAd1bmkyMDJGB3VuaTIwNUYERXVybwd1bmlFMDAwB3VuaUZCMDEHdW5pRkIwMgd1bmlGQjAzB3VuaUZCMDQAAAC4Af+FsAGNAEuwCFBYsQEBjlmxRgYrWCGwEFlLsBRSWCGwgFkdsAYrXFgAsAMgRbADK0SwBCBFsgNwAiuwAytEsAUgRbIEcAIrsAMrRLAGIEWyBXQCK7ADK0SwByBFsgY8AiuwAytEsAggRbIHLAIrsAMrRLAJIEWyCCACK7ADK0SwCiBFsgkfAiuwAytEAbALIEWwAytEsAwgRbILOQIrsQNGditEsA0gRbIMGgIrsQNGditEsA4gRbINjAIrsQNGditEsA8gRbIOIwIrsQNGditEsBAgRbIPIQIrsQNGditEsBEgRbIQIAIrsQNGditEsBIgRbIRHwIrsQNGditEsBMgRbISJwIrsQNGditEWbAUKwAAAVJ794oAAA==) format('woff'),
                   url('Roboto-Regular-webfont.ttf');
      
              }
            </style>
          </defs>"
        )
      */

      var canvas, ctx, im, svgSource, url,
        _this = this;
      if (type === "svg") {
        svgSource = svgUtils.getSVGWithStyles(this.root.node(), true);
        svgSource.setAttribute("style", "background-color:" + this.visualizer.model.get("bkg_color"));
        url = svgUtils.svgToUrl(svgSource);
        return callback(url, "svg");
      } else {
        svgSource = svgUtils.getSVGWithStyles(this.root.node());
        svgSource.setAttribute("style", "background-color:" + this.visualizer.model.get("bkg_color"));
        url = svgUtils.svgToImageUrl(svgSource);
        canvas = document.createElement('canvas');
        canvas.width = $(this.visualizer.el).width();
        canvas.height = $(this.visualizer.el).height();
        ctx = canvas.getContext('2d');
        ctx.font = "'Roboto',sans-serif";
        im = new Image();
        im.onload = function() {
          ctx.drawImage(im, 0, 0);
          return callback(canvas.toDataURL('image/png'), "png");
        };
        return im.src = url;
      }
    };

    return SvgBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.MapBehavior = (function(_super) {
    __extends(MapBehavior, _super);

    function MapBehavior() {
      this.loadImage = __bind(this.loadImage, this);
      this.drawTilesOnCanvas = __bind(this.drawTilesOnCanvas, this);
      this.requestDownloadImageURL = __bind(this.requestDownloadImageURL, this);
      this.notifiyDragChanges = __bind(this.notifiyDragChanges, this);
      this.notifiyZoomChanges = __bind(this.notifiyZoomChanges, this);
      this.goToMapView = __bind(this.goToMapView, this);
      this.goToFrame = __bind(this.goToFrame, this);
      this.centerView = __bind(this.centerView, this);
      this.setMarkerConfig = __bind(this.setMarkerConfig, this);
      this.update = __bind(this.update, this);
      this.executeAfterDidUpdateStage = __bind(this.executeAfterDidUpdateStage, this);
      this.executeAfterUpdateStage = __bind(this.executeAfterUpdateStage, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      this.enableZoom = __bind(this.enableZoom, this);
      this.initialize = __bind(this.initialize, this);
      _ref = MapBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    MapBehavior.field = "map";

    MapBehavior.behaviors = [];

    MapBehavior.prototype.firstExec = true;

    MapBehavior.stage = "map";

    MapBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(MapBehavior.meta, MapBehavior.behaviors);
      return output;
    };

    MapBehavior.meta = {
      "name": "map",
      "outputs": {
        "center": {
          "default": "",
          "outputType": "geo",
          "label": "Center"
        },
        "zoom": {
          "default": "",
          "outputType": "geo",
          "label": "Zoom"
        }
      },
      "properties": {
        "frame": {
          "uiTipContent": "Defines how to crop the map. That is where to center it and how big should it be at the same time",
          "label": "Frame boundaries",
          "family": "geo",
          "hidden": true,
          "sortingWeight": "64",
          "deprecated": true,
          "multivalue": false,
          "formats": {
            "Rectangle": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            },
            "MapView": {
              "multiValues": {
                "zoom": false,
                "center": false
              },
              "defaults": {
                "zoom": "",
                "center": ""
              }
            }
          }
        },
        "zoom": {
          "uiTipContent": "Defines the zoom level of the map",
          "label": "Zoom",
          "family": "geo",
          "hidden": false,
          "sortingWeight": "62",
          "formats": {
            "Number": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "center": {
          "uiTipContent": "Defines the coordinates of the center of the map",
          "label": "Center",
          "family": "geo",
          "sortingWeight": "61",
          "multivalue": false,
          "hidden": false,
          "formats": {
            "Text": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "zoomable": {
          "uiTipContent": "Defines whether the visualization should be zoomable and/or panable",
          "label": "Allow pan and zoom",
          "family": "geo",
          "sortingWeight": "82",
          "hidden": true,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "true"
              }
            }
          }
        },
        "tileProvider": {
          "uiTipContent": "Defines the map provider from a list of diferent looking options",
          "label": "Provider of map tiles",
          "family": "geo",
          "sortingWeight": "63",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Stamen.TonerLite"
              },
              "options": {
                "value": ["Stamen.Toner", "Stamen.TonerLite", "Stamen.Watercolor", "OpenStreetMap.BlackAndWhite", "OpenStreetMap.HOT", "Thunderforest.Transport", "Thunderforest.Landscape", "Hydda.Full", "Hydda.Base", "Esri.WorldStreetMap", "Esri.DeLorme", "Esri.WorldImagery", "MtbMap", "NASAGIBS.ViirsEarthAtNight2012"]
              }
            }
          }
        },
        "bkg_color": {
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#d9d9d9"
              }
            }
          }
        },
        "bkg_image": {
          "hidden": true,
          "internal": true
        },
        "bkg_opacity": {
          "hidden": true
        }
      }
    };

    MapBehavior.prototype.provider = null;

    MapBehavior.prototype.initialize = function(params) {
      var _this = this;
      this.config = {
        typeOfMap: "stamen",
        center: [41.3833, 2.1833]
      };
      this.markerConfig = {
        className: 'marker-container',
        html: '<svg class="marker-svg" ></svg>'
      };
      this.divMap = d3.select(this.visualizer.el).append("div").attr("class", "map").style("width", "100%").style("height", "100%");
      this.map = L.map(this.divMap.node(), {
        attributionControl: false,
        zoomAnimation: true
      }).setView(this.config.center, 10);
      this.map._initPathRoot();
      this.svg = this.divMap.select("svg");
      this.map.on("zoomanim", this.notifiyZoomChanges);
      this.map.on("drag", this.notifiyDragChanges);
      this.map.on("viewreset", this.update);
      this.visualizer.$el.append("<div class='zoom-message'></div>");
      this.zoomBkg = this.visualizer.$el.find(".leaflet-zoom-animated");
      /*
      @zoomBkg.addClass("ui-tip-target")
      @zoomBkg.on("mouseenter",()=>
        if !@zoomActive
          @zoomBkg.addClass("ui-tip-target")
        else
          @zoomBkg.removeClass("ui-tip-target")
      )
      */

      this.visualizer.$el.on("mousedown", function(e) {
        return _this.enableZoom(true);
      });
      return this.visualizer.$el.on("mouseleave", function() {
        return _this.enableZoom(false);
      });
    };

    MapBehavior.prototype.enableZoom = function(value) {
      var _this = this;
      this.zoomActive = value;
      /*
      if @zoomActive
        @behaviors.svg.root.call(@zoom)
        #@zoomBkg.off("mousewheel",@showZoomNotice)
        @zoomBkg.style("cursor","move")
      else
        @behaviors.svg.root.on("onwheel.zoom",null).on("onmousewheel.zoom",null).on("mousewheel.zoom",null).on("wheel.zoom",null)
        #@zoomBkg.on("mousewheel",@showZoomNotice)
        @zoomBkg.style("cursor","inherit")
      */

      if (this.zoomActive && this.visualizer.model.get("zoomable") !== "false") {
        this.map.touchZoom.enable();
        this.map.doubleClickZoom.enable();
        this.map.scrollWheelZoom.enable();
        this.map.boxZoom.enable();
        this.map.keyboard.enable();
        this.map.dragging.enable();
        this.visualizer.$el.find(".leaflet-control-zoom").css("visibility", "visible");
        return _.delay(function() {
          return _this.visualizer.model.original.trigger("graphicalUpdate", _this.visualizer.model.original);
        }, 1000);
      } else {
        this.map.touchZoom.disable();
        this.map.doubleClickZoom.disable();
        this.map.scrollWheelZoom.disable();
        this.map.boxZoom.disable();
        this.map.keyboard.disable();
        this.map.dragging.disable();
        if (this.visualizer.model.get("zoomable") === "false") {
          return this.visualizer.$el.find(".leaflet-control-zoom").css("visibility", "hidden");
        }
      }
    };

    MapBehavior.prototype.executeBeforeUpdateStage = function() {
      var newProvider;
      if (this.provider !== this.visualizer.model.get("tileProvider")) {
        newProvider = this.visualizer.model.get("tileProvider");
        if (newProvider === "") {
          newProvider = "Stamen";
        }
        this.provider = newProvider;
        this.map._layers = {};
        $(".leaflet-control-attribution").remove();
        L.tileLayer.provider(this.provider, {
          attributionControl: false,
          noWrap: true
        }).addTo(this.map);
        return L.control.attribution({
          position: 'bottomleft'
        }).addTo(this.map);
      }
    };

    MapBehavior.prototype.executeAfterUpdateStage = function() {
      var _this = this;
      if ((this.visualizer.model.changed["zoomable"] != null) || this.firstExec) {
        if (this.visualizer.model.get("zoomable") === "true") {
          this.map.touchZoom.enable();
          this.map.doubleClickZoom.enable();
          this.map.scrollWheelZoom.enable();
          this.map.boxZoom.enable();
          this.map.keyboard.enable();
          this.map.dragging.enable();
          this.visualizer.$el.find(".leaflet-control-zoom").css("visibility", "visible");
          _.delay(function() {
            return _this.visualizer.model.original.trigger("graphicalUpdate", _this.visualizer.model.original);
          }, 1000);
        } else {
          this.map.touchZoom.disable();
          this.map.doubleClickZoom.disable();
          this.map.scrollWheelZoom.disable();
          this.map.boxZoom.disable();
          this.map.keyboard.disable();
          this.map.dragging.disable();
          this.visualizer.$el.find(".leaflet-control-zoom").css("visibility", "hidden");
        }
      }
      if (this.visualizer.model.get("zoomable") !== "true") {
        return this.visualizer.$el.find(".zoom-message").css("display", "none");
      } else {
        return this.visualizer.$el.find(".zoom-message").css("display", "block");
      }
    };

    MapBehavior.prototype.executeAfterDidUpdateStage = function() {
      /*
      if @visualizer.model.changed["frame"]?
        @goToFrame(@visualizer.model.get("frame"))
        @notifiyDragChanges()
      */

      if ((this.visualizer.model.changed["zoom"] != null) || (this.visualizer.model.changed["center"] != null) || this.firstExec) {
        this.goToMapView(this.visualizer.model.get("center"), this.visualizer.model.get("zoom"));
        this.notifiyDragChanges();
      }
      return this.firstExec = false;
    };

    MapBehavior.prototype.update = function() {
      var self;
      if (!this.visualizer.items) {
        return;
      }
      self = this;
      return this.visualizer.items.attr("transform", function(d, i) {
        return "translate(" + self.map.latLngToLayerPoint(d.LatLng).x + "," + self.map.latLngToLayerPoint(d.LatLng).y + ")";
      });
    };

    MapBehavior.prototype.setMarkerConfig = function(markerConfig) {
      return this.markerConfig = markerConfig;
    };

    MapBehavior.prototype.centerView = function() {
      var bounds, maxPoint, minPoint;
      if ((this.visualizer.coordinates == null) || this.visualizer.coordinates.length === 0) {
        return;
      }
      minPoint = new L.latLng(d3.min(this.visualizer.coordinates, function(d) {
        return d.lat;
      }), d3.min(this.visualizer.coordinates, function(d) {
        return d.lon;
      }));
      maxPoint = new L.latLng(d3.max(this.visualizer.coordinates, function(d) {
        return d.lat;
      }), d3.max(this.visualizer.coordinates, function(d) {
        return d.lon;
      }));
      if ((minPoint != null) && (maxPoint != null)) {
        bounds = new L.latLngBounds(minPoint, maxPoint);
        return this.map.fitBounds(bounds, {
          animate: !this.firstExec
        });
      }
    };

    MapBehavior.prototype.goToFrame = function(frameBoundsStr) {
      var bounds, frameBoundsSource, northEastPoint, southWestPoint;
      if (frameBoundsStr === "") {
        return;
      }
      frameBoundsSource = frameBoundsStr.split(",");
      northEastPoint = new L.LatLng(parseFloat(frameBoundsSource[1]), parseFloat(frameBoundsSource[0]));
      southWestPoint = new L.LatLng(parseFloat(frameBoundsSource[3]), parseFloat(frameBoundsSource[2]));
      bounds = new L.LatLngBounds(northEastPoint, southWestPoint);
      return this.map.fitBounds(bounds, {
        animate: false
      });
    };

    MapBehavior.prototype.goToMapView = function(centerStr, zoom) {
      var animate, center, centerSource;
      if (centerStr !== "" && centerStr !== null) {
        centerSource = centerStr.split(",");
        center = new L.LatLng(parseFloat(centerSource[0]), parseFloat(centerSource[1]));
      } else {
        center = this.map.getCenter();
      }
      if (zoom === "") {
        zoom = this.map.getZoom();
      }
      if (this.map.getZoom() !== zoom) {
        animate = true;
      } else {
        animate = false;
      }
      return this.map.setView(center, zoom, {
        animate: animate
      });
    };

    /*
    notfiyLatLngBoundChanges:(e) =>
      latLngBounds = @map.getBounds()
      bounds = latLngBounds.toBBoxString()
      center = @map.getCenter()
      @visualizer.updateOutput("bounds",bounds)
      @visualizer.updateOutput("zoom",@map.getZoom())
      @visualizer.updateOutput("center",center.lat+","+center.lng)
    */


    MapBehavior.prototype.notifiyZoomChanges = function(e) {
      var bounds, center, latLngBounds, zoom;
      latLngBounds = this.map.getBounds();
      bounds = latLngBounds.toBBoxString();
      center = e.center;
      zoom = e.zoom;
      this.visualizer.updateOutput("bounds", bounds);
      this.visualizer.updateOutput("zoom", zoom);
      return this.visualizer.updateOutput("center", center.lat + "," + center.lng);
    };

    MapBehavior.prototype.notifiyDragChanges = function(e) {
      var bounds, center, latLngBounds;
      latLngBounds = this.map.getBounds();
      bounds = latLngBounds.toBBoxString();
      center = this.map.getCenter();
      this.visualizer.updateOutput("bounds", bounds);
      this.visualizer.updateOutput("zoom", this.map.getZoom());
      return this.visualizer.updateOutput("center", center.lat + "," + center.lng);
    };

    MapBehavior.prototype.requestDownloadImageURL = function(callback) {
      var canvas, canvasTransform, ctx, images,
        _this = this;
      canvas = document.createElement('canvas');
      canvas.width = $(this.visualizer.el).width();
      canvas.height = $(this.visualizer.el).height();
      ctx = canvas.getContext('2d');
      /*
      $(@map._container).find(".leaflet-tile").each(()->
        this.crossOrigin = "Anonymous";
        ctx.drawImage(this, $(this).css("left").replace("px",""), $(this).css("top").replace("px",""));
      )
      */

      images = $(this.map._container).find(".leaflet-tile").toArray();
      canvasTransform = this.map._mapPane._leaflet_pos;
      ctx.transform(1, 0, 0, 1, canvasTransform.x, canvasTransform.y);
      return this.drawTilesOnCanvas(images, ctx, function() {
        return _this.visualizer.drawElementsOnCanvas(ctx, function() {
          return callback(canvas.toDataURL('image/png'), "png");
        });
      });
    };

    MapBehavior.prototype.drawTilesOnCanvas = function(imagesArray, ctx, callback) {
      var original,
        _this = this;
      if (imagesArray.length === 0) {
        callback();
        return;
      }
      original = imagesArray[imagesArray.length - 1];
      imagesArray.pop();
      return this.loadImage(original, ctx, function() {
        return _this.drawTilesOnCanvas(imagesArray, ctx, callback);
      });
    };

    MapBehavior.prototype.loadImage = function(original, ctx, onLoad) {
      var im,
        _this = this;
      im = new Image();
      im.crossOrigin = 'Anonymous';
      im.onload = function() {
        ctx.drawImage(im, $(original).css("left").replace("px", ""), $(original).css("top").replace("px", ""), $(original).css("width").replace("px", ""), $(original).css("height").replace("px", ""));
        return onLoad();
      };
      return im.src = original.getAttribute("src");
    };

    return MapBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.CirclesBehavior = (function(_super) {
    __extends(CirclesBehavior, _super);

    function CirclesBehavior() {
      this.getRadiusFromValue = __bind(this.getRadiusFromValue, this);
      this.formatRange = __bind(this.formatRange, this);
      this.updateRadiusScale = __bind(this.updateRadiusScale, this);
      this.initialize = __bind(this.initialize, this);
      _ref = CirclesBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    CirclesBehavior.field = "circles";

    CirclesBehavior.behaviors = [];

    CirclesBehavior.stage = "beforeUpdate";

    CirclesBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(CirclesBehavior.meta, CirclesBehavior.behaviors);
      return output;
    };

    CirclesBehavior.meta = {
      name: "circles",
      properties: {
        maxRadius: {
          uiTipContent: "Defines the maximum radius of the circles. This value will be mapped to the highest value of the data",
          label: "Maximum Radius",
          sorting: "52",
          family: "style",
          hidden: false,
          internal: true,
          formats: {
            Number: {
              multiValues: {
                value: false
              },
              defaults: {
                "value": 15
              }
            }
          }
        },
        minRadius: {
          uiTipContent: "Defines the minimum radius of the circles. This value will be mapped to the lowest value of the data",
          label: "Minimum Radius",
          sorting: "53",
          family: "style",
          hidden: false,
          internal: true,
          formats: {
            Number: {
              multiValues: {
                value: false
              },
              defaults: {
                "value": 5
              }
            }
          }
        }
      }
    };

    CirclesBehavior.prototype.initialize = function(params) {
      this.radiusScale = d3.scale.sqrt();
      this.config = {};
      return this.defaultRange = [5, 10];
    };

    CirclesBehavior.prototype.updateRadiusScale = function(domain, range) {
      if (domain != null) {
        this.radiusScale.domain(domain);
      }
      if (range != null) {
        range = this.formatRange(range);
        return this.radiusScale.range(range);
      }
    };

    CirclesBehavior.prototype.formatRange = function(inputRange) {
      var candidate, outputRange;
      outputRange = [];
      if (inputRange[0] && _.isNumber(inputRange[0])) {
        outputRange.push(inputRange[0]);
      } else if (inputRange[0] && _.isString(inputRange[0])) {
        candidate = inputRange[0].replace("px", "");
        candidate = parseFloat(candidate);
        if (_.isNumber(candidate)) {
          outputRange.push(candidate);
        } else {
          outputRange.push(this.defaultRange[0]);
        }
      } else {
        outputRange.push(this.defaultRange[0]);
      }
      if (inputRange[1] && _.isNumber(inputRange[1])) {
        outputRange.push(inputRange[1]);
      } else if (inputRange[1] && _.isString(inputRange[1])) {
        candidate = inputRange[1].replace("px", "");
        candidate = parseFloat(candidate);
        if (_.isNumber(candidate)) {
          outputRange.push(candidate);
        } else {
          outputRange.push(this.defaultRange[1]);
        }
      } else {
        outputRange.push(this.defaultRange[1]);
      }
      return outputRange;
    };

    CirclesBehavior.prototype.getRadiusFromValue = function(value) {
      var output;
      output = this.radiusScale(value);
      if (_.isNaN(output) || output === "NaN") {
        output = this.radiusScale.range()[0];
      }
      return output;
    };

    return CirclesBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TransitionBehavior = (function(_super) {
    __extends(TransitionBehavior, _super);

    function TransitionBehavior() {
      this.notify = __bind(this.notify, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      _ref = TransitionBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TransitionBehavior.behaviors = [];

    TransitionBehavior.stage = "beforeUpdate";

    TransitionBehavior.field = "transition";

    TransitionBehavior.meta = {
      "name": "transition",
      "properties": {
        "transition": {
          "uiTipContent": "Defines the type of transition to be aplied when data changes",
          "label": "Transition",
          "family": "style",
          "sortingWeight": "9999",
          "hidden": true,
          "formats": {
            "Transition": {
              "multiValues": {
                "easeType": false,
                "time": false
              },
              "defaults": {
                "easeType": "cubic-in-out",
                "time": 500
              },
              "options": {
                "easeType": ["cubic-in-out", "linear", "circle", "elastic", "back", "bounce"]
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        }
      }
    };

    TransitionBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TransitionBehavior.meta, TransitionBehavior.behaviors);
      return output;
    };

    TransitionBehavior.prototype.executeBeforeUpdateStage = function() {
      if (this.visualizer.model.get("transition") === quadrigram.Models.VisualizerModel.DEACTIVATED || this.visualizer.resizing) {
        return this.visualizer.animationActive = false;
      } else {
        return this.visualizer.animationActive = true;
      }
    };

    TransitionBehavior.prototype.notify = function(eventType, message) {
      return this.visualizer.trigger(eventType, message);
    };

    return TransitionBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.MessagesBehavior = (function(_super) {
    __extends(MessagesBehavior, _super);

    function MessagesBehavior() {
      this.remove = __bind(this.remove, this);
      this._hideMessage = __bind(this._hideMessage, this);
      this._showNoData = __bind(this._showNoData, this);
      this._showError = __bind(this._showError, this);
      this._showLoader = __bind(this._showLoader, this);
      this.sendMessage = __bind(this.sendMessage, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      this.initialize = __bind(this.initialize, this);
      _ref = MessagesBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    MessagesBehavior.behaviors = [];

    MessagesBehavior.field = "messages";

    MessagesBehavior.meta = {};

    MessagesBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(MessagesBehavior.meta, MessagesBehavior.behaviors);
      return output;
    };

    MessagesBehavior.prototype.messageTemplate = JST['app/scripts/templates/visualizers/visualizerMessage.hbs'];

    MessagesBehavior.prototype.initialize = function(params) {
      var _this = this;
      this.visualizer.on("vizMessage", this.sendMessage);
      this.showLoader = function(message) {
        _this.messageVisible = true;
        return _this.showTimeout = setTimeout(function(message) {
          if (_this.messageVisible) {
            return _this._showLoader(message);
          }
        }, 1000, message);
      };
      this.showError = function(message) {
        _this.messageVisible = true;
        return _this.showTimeout = setTimeout(function(message) {
          if (_this.messageVisible) {
            return _this._showError(message);
          }
        }, 1100, message);
      };
      return this.showNoData = function(message) {
        _this.messageVisible = true;
        return _this.showTimeout = setTimeout(function(message) {
          if (_this.messageVisible) {
            return _this._showNoData(message);
          }
        }, 1000, message);
      };
    };

    MessagesBehavior.prototype.executeBeforeUpdateStage = function() {
      return this._hideMessage();
    };

    MessagesBehavior.prototype.sendMessage = function(messageType, messageBody) {
      if (!messageBody) {
        messageBody = "";
      }
      switch (messageType) {
        case "LoadingData":
          this.showLoader("Receiving data");
          break;
        case "EmptyData":
          this.showLoader("Loading");
          break;
        case "InvalidData":
          this.showNoData("No data to show");
          break;
        case "Error":
          this.showError(messageBody);
          break;
        case "hide":
          this._hideMessage();
          break;
      }
    };

    MessagesBehavior.prototype._showLoader = function(message) {
      /*
      if window.quadrigram.environment == "exported"
          message = ""
      */

      var loaderGif, messageView,
        _this = this;
      loaderGif = true;
      if (this.visualizer.dontUseGif) {
        loaderGif = false;
      }
      if (this.visualizer.$el.find(".message-container").length === 0) {
        messageView = $(this.messageTemplate({
          message: message,
          messageColor: "#3D5AFE",
          opacityBox: 0,
          backgroundOpacity: 0,
          loaderGif: loaderGif
        }));
        this.visualizer.$el.prepend(messageView);
        return _.defer(function() {
          return messageView.find(".viz-loading-square").removeClass("collapsed");
        });
      }
    };

    MessagesBehavior.prototype._showError = function(message) {
      var messageView;
      if (window.quadrigram.environment === "exported") {
        message = "";
      }
      messageView = this.messageTemplate({
        message: message,
        messageColor: "#FF5252",
        opacityBox: 1,
        backgroundOpacity: 1,
        loaderGif: false
      });
      this.visualizer.$el.find(".message-container").remove();
      return this.visualizer.$el.prepend(messageView);
    };

    MessagesBehavior.prototype._showNoData = function(message) {
      var messageView;
      messageView = this.messageTemplate({
        message: message,
        messageColor: "#3D5AFE",
        opacityBox: 1,
        backgroundOpacity: 1,
        loaderGif: false
      });
      this.visualizer.$el.find(".message-container").remove();
      return this.visualizer.$el.prepend(messageView);
    };

    MessagesBehavior.prototype._hideMessage = function() {
      var delay,
        _this = this;
      this.visualizer.$el.children().show();
      this.messageVisible = false;
      clearTimeout(this.showTimeout);
      this.visualizer.$el.find(".message-container").find(".viz-loading-square").addClass("collapsed");
      if (this.visualizer.dontUseGif) {
        delay = 0;
      } else {
        delay = 210;
      }
      return _.delay(function() {
        return _this.visualizer.$el.find(".message-container").remove();
      }, delay);
    };

    MessagesBehavior.prototype.remove = function() {
      return this.visualizer.off("vizMessage");
    };

    return MessagesBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RelationsBehavior = (function(_super) {
    __extends(RelationsBehavior, _super);

    function RelationsBehavior() {
      this.update = __bind(this.update, this);
      this.setWeightScale = __bind(this.setWeightScale, this);
      this.createStyleItemsByValues = __bind(this.createStyleItemsByValues, this);
      this.createStyleItemBySingleValue = __bind(this.createStyleItemBySingleValue, this);
      this.createStyleItemsById = __bind(this.createStyleItemsById, this);
      this.createStyleItemsByCategories = __bind(this.createStyleItemsByCategories, this);
      this.createStyleItemsFromSample = __bind(this.createStyleItemsFromSample, this);
      this.createLinkItems = __bind(this.createLinkItems, this);
      this.parseScale = __bind(this.parseScale, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.initialize = __bind(this.initialize, this);
      this.executeAfterUpdateStage = __bind(this.executeAfterUpdateStage, this);
      _ref = RelationsBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RelationsBehavior.field = "relations";

    RelationsBehavior.behaviors = [];

    RelationsBehavior.prototype.firstExec = true;

    RelationsBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(RelationsBehavior.meta, RelationsBehavior.behaviors);
      return output;
    };

    RelationsBehavior.meta = {
      "name": "relations",
      "properties": {
        "linkColors": {
          "label": "Color of each link",
          "uiTipContent": "Defines the color of each link",
          "family": "style",
          "sortingWeight": "31",
          "hidden": false,
          "formats": {
            "Color": {
              "idSource": {
                "value": "visualizer.idsRelations"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#000000"
              }
            },
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(243,243,255), rgb(63,81,151) 100%)"
              }
            },
            "ColorsByValues": {
              "idSource": {
                "values": "visualizer.idsRelations"
              },
              "multiValues": {
                "values": true,
                "colorscale": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": "1"
                  }, {
                    "id": "2",
                    "value": "2"
                  }, {
                    "id": "3",
                    "value": "3"
                  }, {
                    "id": "4",
                    "value": "4"
                  }, {
                    "id": "5",
                    "value": "5"
                  }
                ],
                "colorscale": "linear-gradient(90deg, rgb(207, 212, 236),rgb(141, 145, 188)  100%)"
              }
            }
          }
        },
        "linkThickness": {
          "uiTipContent": "Defines the thickness of the outline for each link",
          "label": "Thickness of each link",
          "family": "data",
          "sortingWeight": "32",
          "hidden": false,
          "formats": {
            "PxRange": {
              "multiValues": {
                "min": false,
                "max": false
              },
              "defaults": {
                "min": 1,
                "max": 3
              }
            },
            "PxByValues": {
              "idSource": {
                "values": "visualizer.idsRelations"
              },
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": 20
                  }, {
                    "id": "2",
                    "value": 30
                  }, {
                    "id": "3",
                    "value": 40
                  }, {
                    "id": "4",
                    "value": 50
                  }, {
                    "id": "5",
                    "value": 60
                  }
                ],
                "min": 1,
                "max": 3
              }
            },
            "Px": {
              "idSource": {
                "value": "visualizer.idsRelations"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "1px"
              }
            }
          }
        },
        "linkOpacities": {
          "uiTipContent": "Defines the transparency of each link",
          "label": "Opacity of each link",
          "family": "style",
          "sortingWeight": "33",
          "hidden": true,
          "formats": {
            "Percentage": {
              "idSource": {
                "value": "visualizer.idsRelations"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 100
              }
            },
            "PercentageByValues": {
              "idSource": {
                "values": "visualizer.idsRelations"
              },
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        }
      }
    };

    RelationsBehavior.prototype.executeAfterUpdateStage = function() {
      var ids, items, model, values;
      model = this.visualizer.model;
      items = this.visualizer.items;
      values = this.visualizer.values;
      ids = this.visualizer.idsRelations;
      this.changed = (this.visualizer.model.changed["linkColors"] != null) || (this.visualizer.model.changed["linkOpacities"] != null) || (this.visualizer.model.changed["linkThickness"] != null) || this.visualizer.changedData || this.firstExec;
      if (this.changed) {
        this.updateConfig({
          itemsEnter: items,
          values: values,
          ids: ids,
          linkColors: model.get("linkColors"),
          linkOpacities: model.get("linkOpacities"),
          linkThickness: model.get("linkThickness")
        });
      }
      return this.firstExec = false;
    };

    RelationsBehavior.prototype.linkItems = {};

    RelationsBehavior.prototype.linkDimensions = ["linkColors", "linkOpacities", "linkThickness"];

    RelationsBehavior.prototype.initialize = function(params) {
      return this.config = {};
    };

    RelationsBehavior.prototype.updateConfig = function(newConfig) {
      var field;
      for (field in newConfig) {
        this.config[field] = newConfig[field];
      }
      this.createLinkItems();
      return this.update();
    };

    RelationsBehavior.prototype.parseScale = function(scaleSource) {
      var angle, breakpoints, colors, matched, output, part, parts, _i, _len;
      if (scaleSource.match) {
        
        var ptrn = / ?,?rgb/
        ;
        parts = scaleSource.split(ptrn);
        angle = parts[0].match(/(d+)deg/);
        parts.unshift();
        colors = [];
        breakpoints = [];
        for (_i = 0, _len = parts.length; _i < _len; _i++) {
          part = parts[_i];
          matched = part.match(/\(([^\)]+)\) ?(\d+)?%?,?/);
          if (matched) {
            colors.push("rgb(" + matched[1] + ")");
            breakpoints.push(matched[2] / 100 || 0);
          }
        }
      }
      output = {
        colors: colors,
        breakpoints: breakpoints
      };
      return output;
    };

    RelationsBehavior.prototype.createLinkItems = function() {
      var currentFormat, linkDimension, qScale, range, values, _i, _len, _ref1, _results;
      this.styleItems = {};
      _ref1 = this.linkDimensions;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        linkDimension = _ref1[_i];
        currentFormat = this.visualizer.model.get(linkDimension);
        if (currentFormat != null) {
          currentFormat = currentFormat.currentFormat;
          switch (currentFormat) {
            case "Color":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "ColorsByCategories":
              _results.push(this.createStyleItemsByCategories(this.visualizer.model.get(linkDimension)[0], this.visualizer.model.get(linkDimension)[1], this.visualizer.model.get(linkDimension)[2], linkDimension));
              break;
            case "ColorsByValues":
              values = this.visualizer.model.get(linkDimension)[0];
              qScale = this.parseScale(this.visualizer.model.get(linkDimension)[1]);
              _results.push(this.createStyleItemsByValues(values, linkDimension, qScale.breakpoints, qScale.colors));
              break;
            case "Percentage":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "Number":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "Px":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "PercentageByValues":
              values = this.visualizer.model.get(linkDimension)[0];
              range = [parseFloat(this.visualizer.model.get(linkDimension)[1]), parseFloat(this.visualizer.model.get(linkDimension)[2])];
              _results.push(this.createStyleItemsByValues(values, linkDimension, void 0, range));
              break;
            case "ByValues":
              values = this.visualizer.model.get(linkDimension)[0];
              range = [parseFloat(this.visualizer.model.get(linkDimension)[1]), parseFloat(this.visualizer.model.get(linkDimension)[2])];
              _results.push(this.createStyleItemsByValues(values, linkDimension, void 0, range));
              break;
            case "PxByValues":
              values = this.visualizer.model.get(linkDimension)[0];
              range = [parseFloat(this.visualizer.model.get(linkDimension)[1]), parseFloat(this.visualizer.model.get(linkDimension)[2])];
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "PxRange":
              values = this.visualizer.model.get(linkDimension)[0];
              range = [parseFloat(this.visualizer.model.get(linkDimension)[0]), parseFloat(this.visualizer.model.get(linkDimension)[1])];
              _results.push(this.createStyleItemsByValues(values, linkDimension, void 0, range));
              break;
            case void 0:
              if (_.isString(this.visualizer.model.get(linkDimension)) && this.visualizer.model.get(linkDimension).indexOf("linear-gradient") !== -1) {
                qScale = this.parseScale(this.visualizer.model.get(linkDimension));
                _results.push(this.createStyleItemsFromSample(qScale.colors, linkDimension));
              } else {
                _results.push(this.createStyleItemBySingleValue(this.visualizer.model.get(linkDimension), linkDimension));
              }
              break;
            default:
              _results.push(void 0);
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    RelationsBehavior.prototype.createStyleItemsFromSample = function(sample, linkDimension) {
      var i, id, ids, scale, step, style, styles, weight, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _results;
      ids = this.config.ids;
      styles = {};
      if (sample.length > ids.length) {
        step = 1 / (ids.length - 1);
        for (i = _i = 0, _len = ids.length; _i < _len; i = ++_i) {
          id = ids[i];
          weight = step * i;
          styles[id] = sample[Math.round(weight * (sample.length - 1))];
        }
      }
      if (sample.length === ids.length) {
        styles = sample;
      }
      if (sample.length < ids.length) {
        if (sample.length < 4) {
          scale = d3.scale.linear().domain([0, ids.length - 1]).range(sample);
          for (i = _j = 0, _len1 = ids.length; _j < _len1; i = ++_j) {
            id = ids[i];
            styles[id] = scale(i);
          }
        } else {
          for (i = _k = 0, _len2 = ids.length; _k < _len2; i = ++_k) {
            id = ids[i];
            styles[id] = sample[i % sample.length];
          }
        }
      }
      _ref1 = this.config.ids;
      _results = [];
      for (_l = 0, _len3 = _ref1.length; _l < _len3; _l++) {
        id = _ref1[_l];
        if (styles[id]) {
          style = styles[id];
        } else {
          style = sample[0];
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][linkDimension] = style);
      }
      return _results;
    };

    RelationsBehavior.prototype.createStyleItemsByCategories = function(categories, styles, defaultStyle, linkDimension) {
      var categoriesCandidate, categoriesObject, getObjectFromQValue, id, style, styleCandidate, stylesObject, _i, _len, _ref1, _results,
        _this = this;
      getObjectFromQValue = function(blockList) {
        var object, objectSource, _i, _len;
        object = {};
        for (_i = 0, _len = blockList.length; _i < _len; _i++) {
          objectSource = blockList[_i];
          object[objectSource.id] = objectSource.value;
        }
        return object;
      };
      categoriesObject = getObjectFromQValue(categories);
      stylesObject = getObjectFromQValue(styles);
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        categoriesCandidate = categoriesObject[id];
        if (categoriesCandidate) {
          styleCandidate = stylesObject[categoriesCandidate];
        } else {
          styleCandidate = defaultStyle;
        }
        if (styleCandidate) {
          style = styleCandidate;
        } else {
          style = defaultStyle;
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][linkDimension] = style);
      }
      return _results;
    };

    RelationsBehavior.prototype.createStyleItemsById = function(stylesSource, linkDimension) {
      var arrayOfstyles, getStylesObject, id, itemWithoutstyleCount, style, styles, _i, _len, _ref1, _results,
        _this = this;
      getStylesObject = function(stylesSource) {
        var styleSource, styles, _i, _len;
        styles = {};
        for (_i = 0, _len = stylesSource.length; _i < _len; _i++) {
          styleSource = stylesSource[_i];
          styles[styleSource.id] = styleSource.value;
        }
        return styles;
      };
      styles = getStylesObject(stylesSource);
      arrayOfstyles = _.values(styles, linkDimension);
      itemWithoutstyleCount = 0;
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        if (styles[id]) {
          style = styles[id];
        } else {
          style = arrayOfstyles[itemWithoutstyleCount % arrayOfstyles.length];
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][linkDimension] = style);
      }
      return _results;
    };

    RelationsBehavior.prototype.createStyleItemBySingleValue = function(style, linkDimension) {
      var id, _i, _len, _ref1, _results;
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][linkDimension] = style);
      }
      return _results;
    };

    RelationsBehavior.prototype.createStyleItemsByValues = function(valuesSource, linkDimension, breakpoints, range) {
      var getValuesObject, id, scale, setScale, style, values, _i, _j, _len, _len1, _ref1, _ref2, _results, _results1,
        _this = this;
      setScale = function(values) {
        var breakpoint, realDomain, scale, valuesDomain, _i, _len;
        if (!breakpoints) {
          breakpoints = [0, 1];
        }
        valuesDomain = d3.extent(values, function(d) {
          return parseFloat(d.value);
        });
        realDomain = [];
        for (_i = 0, _len = breakpoints.length; _i < _len; _i++) {
          breakpoint = breakpoints[_i];
          realDomain.push(valuesDomain[0] + breakpoint * (valuesDomain[1] - valuesDomain[0]));
        }
        scale = d3.scale.linear().domain(realDomain).range(range);
        return scale;
      };
      getValuesObject = function(valuesSource, scale) {
        var valueSource, values, _i, _len;
        values = {};
        for (_i = 0, _len = valuesSource.length; _i < _len; _i++) {
          valueSource = valuesSource[_i];
          values[valueSource.id] = {
            originalValue: parseFloat(valueSource.value),
            value: scale(parseFloat(valueSource.value))
          };
        }
        return values;
      };
      if (_.isArray(valuesSource) && _.isArray(range)) {
        scale = setScale(valuesSource);
        values = getValuesObject(valuesSource, scale);
        _ref1 = this.config.ids;
        _results = [];
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          id = _ref1[_i];
          if (values[id]) {
            style = values[id];
          } else {
            style = {
              originalValue: void 0,
              value: scale.range()[0]
            };
          }
          if (!this.styleItems[id]) {
            this.styleItems[id] = {};
          }
          _results.push(this.styleItems[id][linkDimension] = style.value);
        }
        return _results;
      } else {
        if (_.isArray(range)) {
          style = range[0];
        } else {
          style = range;
        }
        _ref2 = this.config.ids;
        _results1 = [];
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          id = _ref2[_j];
          if (!this.styleItems[id]) {
            this.styleItems[id] = {};
          }
          _results1.push(this.styleItems[id][linkDimension] = style);
        }
        return _results1;
      }
    };

    RelationsBehavior.prototype.setWeightScale = function() {
      var domain, format, input, range;
      input = this.visualizer.model.get("linkThickness");
      format = input.currentFormat;
      domain = this.visualizer.calculateNumberDomain(this.visualizer.weightRelations, 0, false);
      switch (format) {
        case "PxByValues":
          range = [input[1], input[2]];
          break;
        case "PxRange":
          range = [input[0], input[1]];
          break;
        default:
          range = [input, input];
      }
      return this.strokeWidthScale = d3.scale.linear().domain(domain).range(range);
    };

    RelationsBehavior.prototype.update = function() {
      var links, self,
        _this = this;
      self = this;
      links = d3.select(this.visualizer.el).selectAll(".link").filter(function(d) {
        return d.id !== "root_quadrigram_reserved_id";
      });
      return links.attr("stroke", function(d, i) {
        return self.styleItems[d.id]["linkColors"];
      }).attr("stroke-opacity", function(d, i) {
        return self.styleItems[d.id]["linkOpacities"] / 100;
      }).attr("stroke-width", function(d) {
        return _this.strokeWidthScale(d.value);
      });
    };

    return RelationsBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RelationsRadialNetworkBehavior = (function(_super) {
    __extends(RelationsRadialNetworkBehavior, _super);

    function RelationsRadialNetworkBehavior() {
      this.update = __bind(this.update, this);
      _ref = RelationsRadialNetworkBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RelationsRadialNetworkBehavior.field = 'relations';

    RelationsRadialNetworkBehavior.prototype.linkDimensions = ['linkColors', 'linkOpacities', 'linkThickness'];

    RelationsRadialNetworkBehavior.prototype.update = function() {
      var links,
        _this = this;
      links = d3.select(this.visualizer.el).selectAll('.link');
      return links.style('stroke', function(d, i) {
        return _this.styleItems[d.id]["linkColors"];
      }).style('stroke-opacity', function(d, i) {
        return _this.styleItems[d.id]['linkOpacities'] / 100;
      }).attr('stroke-width', function(d) {
        return _this.styleItems[d.id]['linkThickness'];
      });
    };

    return RelationsRadialNetworkBehavior;

  })(quadrigram.Models.RelationsBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ZoomableBehavior = (function(_super) {
    __extends(ZoomableBehavior, _super);

    function ZoomableBehavior() {
      this.zoomed = __bind(this.zoomed, this);
      this.zoomStep = __bind(this.zoomStep, this);
      this.clickZoomOut = __bind(this.clickZoomOut, this);
      this.clickZoomIn = __bind(this.clickZoomIn, this);
      this.executeAfterDidUpdateStage = __bind(this.executeAfterDidUpdateStage, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      this.enableZoom = __bind(this.enableZoom, this);
      this.initialize = __bind(this.initialize, this);
      _ref = ZoomableBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ZoomableBehavior.field = "zoom";

    ZoomableBehavior.behaviors = [];

    ZoomableBehavior.prototype.firstExec = true;

    ZoomableBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ZoomableBehavior.meta, ZoomableBehavior.behaviors);
      return output;
    };

    ZoomableBehavior.meta = {
      "name": "zoom",
      "outputs": {
        "zoom": {
          "default": "",
          "outputType": "geo",
          "label": "Zoom"
        },
        "center": {
          "default": "",
          "outputType": "geo",
          "label": "Center"
        }
      },
      "properties": {
        "zoomable": {
          "uiTipContent": "Defines whether the visualization should be zoomable and/or panable",
          "label": "Allow pan and zoom",
          "family": "select",
          "sortingWeight": "82",
          "hidden": true,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "true"
              }
            }
          }
        },
        "zoom": {
          "uiTipContent": "Defines the zoom level of the network",
          "label": "Zoom",
          "family": "geo",
          "hidden": false,
          "sortingWeight": "62",
          "formats": {
            "Number": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "1"
              }
            }
          }
        }
      }
    };

    ZoomableBehavior.prototype.initialize = function(params) {
      var controlContainer, self;
      self = this;
      this.zoom = d3.behavior.zoom().on("zoom", function(e) {
        return self.zoomed();
      });
      this.nozoom = d3.behavior.zoom().on("zoom", function(e) {
        return log("hndled nozoom");
      });
      this.zoom.center([this.visualizer.$el.width() / 2, this.visualizer.$el.height() / 2]);
      this.zoomLevel = 1;
      controlContainer = d3.select(this.visualizer.el).append("div").attr("class", "viz-control-container");
      this.control = controlContainer.append("div").attr("class", "control-zoom control-bar");
      this.control.append("div").attr("class", "control-zoom-in control-zoom-item").attr("title", "Zoom in").text("+").on("click", this.clickZoomIn);
      this.control.append("div").attr("class", "control-zoom-out control-zoom-item").attr("title", "Zoom out").text("-").on("click", this.clickZoomOut);
      return this.visualizer.$el.append("<div class='zoom-message'></div>");
    };

    ZoomableBehavior.prototype.enableZoom = function(value) {
      if (!this.layer) {
        this.layer = d3.select(this.visualizer.el).select(".zoomable-layer");
      }
      this.zoomActive = value;
      if (this.zoomActive && this.visualizer.model.get("zoomable") === "true") {
        this.layer.call(this.zoom);
        return this.zoomBkg.style("cursor", "move");
      } else {
        this.layer.on("onwheel.zoom", null).on("onmousewheel.zoom", null).on("mousewheel.zoom", null).on("wheel.zoom", null);
        return this.zoomBkg.style("cursor", "inherit");
      }
    };

    ZoomableBehavior.prototype.executeBeforeUpdateStage = function() {
      if (!this.layer) {
        this.layer = d3.select(this.visualizer.el).select(".zoomable-layer");
      }
      if (this.visualizer.model.get("zoomable") === "true") {
        this.layer.call(this.zoom);
        this.control.selectAll(".control-zoom-item").classed("hidden", false);
      } else {
        this.layer.call(this.nozoom);
        this.layer.on("mousedown.zoom", null);
        this.layer.on("mousemove.zoom", null);
        this.layer.on("dblclick.zoom", null);
        this.layer.on("touchstart.zoom", null);
        this.layer.on("wheel.zoom", null);
        this.layer.on("mousewheel.zoom", null);
        this.layer.on("MozMousePixelScroll.zoom", null);
        this.control.selectAll(".control-zoom-item").classed("hidden", true);
      }
      return this.layer.on("dblclick.zoom", null);
    };

    ZoomableBehavior.prototype.executeAfterDidUpdateStage = function() {
      var c, newC, t,
        _this = this;
      if ((this.visualizer.model.changed["zoom"] != null) || this.firstExec) {
        t = this.zoom.translate();
        c = [this.visualizer.$el.width() / 2, this.visualizer.$el.height() / 2];
        newC = [(c[0] - t[0]) / this.zoomLevel, (c[1] - t[1]) / this.zoomLevel];
        this.zoomLevel = this.visualizer.model.get("zoom");
        newC = [newC[0] * this.zoomLevel + t[0], newC[1] * this.zoomLevel + t[1]];
        newC = [t[0] + c[0] - newC[0], t[1] + c[1] - newC[1]];
        this.zoom.translate(newC);
        this.zoom.scale(this.zoomLevel);
        this.zoomed({
          animate: true
        });
        this.zoomActive = false;
        this.zoomBkg = d3.select(this.visualizer.el).select(".zoomable-layer");
        /*
        @zoomBkg.attr("data-ui-tip-id","zoom-cover")
        
        @zoomBkg.on("mouseenter",()=>
          if !@zoomActive
            @zoomBkg.classed("ui-tip-target",true)
          else
            @zoomBkg.classed("ui-tip-target",false)
        )
        */

        this.zoomBkg.on("click", function(e) {
          return _this.enableZoom(true);
        });
        this.zoomBkg.on("mouseleave", function() {
          return _this.enableZoom(false);
        });
      }
      if (this.visualizer.model.get("zoomable") !== "true") {
        this.visualizer.$el.find(".zoom-message").css("display", "none");
      } else {
        this.visualizer.$el.find(".zoom-message").css("display", "block");
      }
      this.firstExec = false;
      return this.enableZoom(false);
    };

    ZoomableBehavior.prototype.clickZoomIn = function(e) {
      return this.zoomStep("+");
    };

    ZoomableBehavior.prototype.clickZoomOut = function(e) {
      return this.zoomStep("-");
    };

    ZoomableBehavior.prototype.zoomStep = function(dir) {
      var c, newC, t;
      t = this.zoom.translate();
      c = [this.visualizer.$el.width() / 2, this.visualizer.$el.height() / 2];
      newC = [(c[0] - t[0]) / this.zoomLevel, (c[1] - t[1]) / this.zoomLevel];
      if (dir === "+") {
        this.zoomLevel = this.zoomLevel * 1.5;
      } else {
        this.zoomLevel = this.zoomLevel / 1.5;
      }
      newC = [newC[0] * this.zoomLevel + t[0], newC[1] * this.zoomLevel + t[1]];
      newC = [t[0] + c[0] - newC[0], t[1] + c[1] - newC[1]];
      this.zoom.translate(newC);
      this.zoom.scale(this.zoomLevel);
      return this.zoomed({
        animate: true
      });
    };

    ZoomableBehavior.prototype.zoomed = function(options) {
      if (options && options.animate) {
        this.zoomLevel = this.zoom.scale();
        return d3.select(this.visualizer.el).transition().duration(500).selectAll(".zoomable-target").attr("transform", "translate(" + this.zoom.translate() + ")scale(" + this.zoom.scale() + ")");
      } else {
        this.zoom.center([this.visualizer.$el.width() / 2, this.visualizer.$el.height() / 2]);
        this.zoomLevel = this.zoom.scale();
        return d3.select(this.visualizer.el).selectAll(".zoomable-target").attr("transform", "translate(" + this.zoom.translate() + ")scale(" + this.zoom.scale() + ")");
      }
    };

    return ZoomableBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TextStyleBehavior = (function(_super) {
    __extends(TextStyleBehavior, _super);

    function TextStyleBehavior() {
      this.updateStylabelTexts = __bind(this.updateStylabelTexts, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.executeAfterResize = __bind(this.executeAfterResize, this);
      this.executeAfterDidUpdateStage = __bind(this.executeAfterDidUpdateStage, this);
      this.updateFontStyleOptions = __bind(this.updateFontStyleOptions, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      this.addStylableTexts = __bind(this.addStylableTexts, this);
      this.initialize = __bind(this.initialize, this);
      _ref = TextStyleBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TextStyleBehavior.field = "style";

    TextStyleBehavior.behaviors = [];

    TextStyleBehavior.stage = "";

    TextStyleBehavior.prototype.initialize = function(params) {
      return this.root = d3.select(this.visualizer.el);
    };

    TextStyleBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TextStyleBehavior.meta, TextStyleBehavior.behaviors);
      return output;
    };

    TextStyleBehavior.meta = {
      "name": "TextStyle",
      "properties": {
        fontFamily: {
          label: "Font family",
          family: "textstyles",
          hidden: false,
          sortingWeight: "24",
          formats: {
            Font: {
              multiValues: {
                fontFamily: false,
                fontStyle: false
              },
              defaults: {
                fontFamily: "Oswald",
                fontStyle: "Regular"
              },
              options: {
                fontFamily: ['Oswald', 'Kreon', 'Roboto', 'Droid Sans', 'Lato', 'Titillium Web', 'Open Sans Condensed', 'Open Sans', 'Verdana', 'Ubuntu', 'Droid Serif', 'Roboto Slab', 'EB Garamond', 'Libre Baskerville', 'Merriweather', 'Georgia', 'Playfair Display', 'Playfair Display SC', 'Old Standard TT'],
                fontStyle: ["Regular", "Light", "Bold"]
              }
            },
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Roboto"
              },
              options: {
                value: ['Oswald', 'Kreon', 'Roboto', 'Droid Sans', 'Lato', 'Titillium Web', 'Open Sans Condensed', 'Open Sans', 'Verdana', 'Ubuntu', 'Droid Serif', 'Roboto Slab', 'EB Garamond', 'Libre Baskerville', 'Merriweather', 'Georgia', 'Playfair Display', 'Playfair Display SC', 'Old Standard TT']
              }
            }
          }
        },
        textSize: {
          label: "Font size",
          family: "textstyles",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Px: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "12px"
              }
            }
          }
        },
        textColor: {
          label: "Text color",
          family: "textstyles",
          hidden: false,
          sortingWeight: "26",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#444"
              }
            }
          }
        },
        textWeight: {
          label: "Text weight",
          family: "textstyles",
          hidden: true,
          sortingWeight: "27",
          deprecated: true,
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "normal"
              },
              options: {
                value: ["normal", "bold", "lighter"]
              }
            }
          }
        },
        textStyle: {
          label: "Text style",
          family: "textstyles",
          hidden: true,
          sortingWeight: "28",
          deprecated: true,
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "normal"
              },
              options: {
                value: ["normal", "italic"]
              }
            }
          }
        },
        textDecoration: {
          label: "Text decoration",
          family: "textstyles",
          hidden: true,
          sortingWeight: "29",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "none"
              },
              options: {
                value: ["none", "underline", "overline", "line-through"]
              }
            }
          }
        },
        textAlign: {
          label: "Text align",
          family: "textstyles",
          hidden: true,
          sortingWeight: "30",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "left"
              },
              options: {
                value: ["left", "center", "right"]
              }
            }
          }
        },
        vAlign: {
          label: "Vertical align",
          family: "textstyles",
          hidden: true,
          sortingWeight: "40",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "top"
              },
              options: {
                value: ["top", "middle", "bottom"]
              }
            }
          }
        }
      }
    };

    TextStyleBehavior.prototype.addStylableTexts = function(array) {
      if (!_.isArray(array)) {
        array = [array];
      }
      if (this.visualizer.stylableTexts != null) {
        this.visualizer.stylableTexts = [];
      }
      return this.visualizer.stylableTexts = this.visualizer.stylableTexts.concat(array);
    };

    TextStyleBehavior.prototype.executeBeforeUpdateStage = function() {
      this.updateFontStyleOptions();
      this.stylableTexts = this.visualizer.stylableTexts;
      return this.updateConfig();
    };

    TextStyleBehavior.prototype.updateFontStyleOptions = function() {
      var family, options, prop, s, slots, styles, _i, _len;
      if (this.visualizer.model.get("fontFamily").currentFormat === "Font") {
        if (this.visualizer.model.get("fontFamily") && this.currentFamily !== this.visualizer.model.get("fontFamily")[0]) {
          prop = this.visualizer.model.original.get("propertiesCollection").findWhere({
            "propId": "fontFamily"
          });
          if (prop == null) {
            prop = this.visualizer.model.original.prePropertiesCollection.findWhere({
              "propId": "fontFamily"
            });
          }
          if (prop != null) {
            slots = prop.getSlots();
            if (slots != null) {
              family = slots[0].getValue();
              if (family != null) {
                styles = quadrigram.router.managers.fontManager.getFontStyles(family);
                if (styles != null) {
                  options = [];
                  this.currentStyles = {};
                  this.currentFamily = family;
                  for (_i = 0, _len = styles.length; _i < _len; _i++) {
                    s = styles[_i];
                    options.push(s.styleName);
                    this.currentStyles[s.styleName] = {
                      "fontWeight": s.fontWeight,
                      "fontStyle": s.fontStyle
                    };
                  }
                  slots[1].options = options;
                  if (options.indexOf(this.visualizer.model.get("fontFamily")[1]) < 0) {
                    slots[1].getBlock().setData(options[0], {
                      silent: true
                    });
                    return slots[1].trigger("change");
                  } else {
                    return slots[1].trigger("change");
                  }
                }
              }
            }
          }
        }
      }
    };

    TextStyleBehavior.prototype.executeAfterDidUpdateStage = function() {
      this.updateFontStyleOptions();
      this.stylableTexts = this.visualizer.stylableTexts;
      return this.updateConfig();
    };

    TextStyleBehavior.prototype.executeAfterResize = function() {
      this.updateFontStyleOptions();
      this.stylableTexts = this.visualizer.stylableTexts;
      return this.updateConfig();
    };

    TextStyleBehavior.prototype.updateConfig = function() {
      return this.updateStylabelTexts();
    };

    TextStyleBehavior.prototype.updateStylabelTexts = function() {
      var $el, key, _i, _len, _ref1, _results;
      _ref1 = this.stylableTexts;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        key = _ref1[_i];
        if (typeof key === 'string') {
          $el = this.visualizer.$el.find(key);
        } else {
          $el = key;
        }
        if (this.visualizer.model.get("fontFamily").currentFormat === "Font") {
          $el.css("font-family", this.visualizer.model.get("fontFamily")[0]);
          if ((this.currentStyles != null) && (this.currentStyles[this.visualizer.model.get("fontFamily")[1]] != null)) {
            $el.css("font-style", this.currentStyles[this.visualizer.model.get("fontFamily")[1]].fontStyle);
            $el.css("font-weight", this.currentStyles[this.visualizer.model.get("fontFamily")[1]].fontWeight);
          }
        } else {
          $el.css("font-family", this.visualizer.model.get("fontFamily"));
          $el.css("font-weight", this.visualizer.model.get("textWeight"));
          $el.css("font-style", this.visualizer.model.get("textStyle"));
        }
        $el.css("font-size", this.visualizer.model.get("textSize"));
        $el.css("color", this.visualizer.model.get("textColor"));
        $el.css("text-align", this.visualizer.model.get("textAlign"));
        $el.css("text-decoration", this.visualizer.model.get("textDecoration"));
        $el.removeClass("valign-top");
        $el.removeClass("valign-middle");
        $el.removeClass("valign-bottom");
        _results.push($el.addClass("valign-" + this.visualizer.model.get("vAlign")));
      }
      return _results;
    };

    return TextStyleBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TextStyleSVGBehavior = (function(_super) {
    __extends(TextStyleSVGBehavior, _super);

    function TextStyleSVGBehavior() {
      this.updateStylabelTexts = __bind(this.updateStylabelTexts, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.executeAfterResize = __bind(this.executeAfterResize, this);
      this.executeAfterDidUpdateStage = __bind(this.executeAfterDidUpdateStage, this);
      this.updateFontStyleOptions = __bind(this.updateFontStyleOptions, this);
      this.executeBeforeUpdateStage = __bind(this.executeBeforeUpdateStage, this);
      this.addStylableTexts = __bind(this.addStylableTexts, this);
      this.initialize = __bind(this.initialize, this);
      _ref = TextStyleSVGBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TextStyleSVGBehavior.field = "style";

    TextStyleSVGBehavior.behaviors = [];

    TextStyleSVGBehavior.stage = "";

    TextStyleSVGBehavior.prototype.initialize = function(params) {
      return this.root = d3.select(this.visualizer.el);
    };

    TextStyleSVGBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TextStyleSVGBehavior.meta, TextStyleSVGBehavior.behaviors);
      return output;
    };

    TextStyleSVGBehavior.meta = {
      "name": "TextStyle",
      "properties": {
        fontFamily: {
          label: "Font family",
          family: "textstyles",
          hidden: false,
          sortingWeight: "24",
          formats: {
            Font: {
              multiValues: {
                fontFamily: false,
                fontStyle: false
              },
              defaults: {
                fontFamily: "Roboto",
                fontStyle: "Regular"
              },
              options: {
                fontFamily: ['Oswald', 'Kreon', 'Roboto', 'Droid Sans', 'Lato', 'Titillium Web', 'Open Sans Condensed', 'Open Sans', 'Verdana', 'Ubuntu', 'Droid Serif', 'Roboto Slab', 'EB Garamond', 'Libre Baskerville', 'Merriweather', 'Georgia', 'Playfair Display', 'Playfair Display SC', 'Old Standard TT'],
                fontStyle: ["Regular", "Light", "Bold"]
              }
            },
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Roboto"
              },
              options: {
                value: ['Oswald', 'Kreon', 'Roboto', 'Droid Sans', 'Lato', 'Titillium Web', 'Open Sans Condensed', 'Open Sans', 'Verdana', 'Ubuntu', 'Droid Serif', 'Roboto Slab', 'EB Garamond', 'Libre Baskerville', 'Merriweather', 'Georgia', 'Playfair Display', 'Playfair Display SC', 'Old Standard TT']
              }
            }
          }
        },
        textSize: {
          label: "Font size",
          family: "textstyles",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Px: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "10px"
              }
            }
          }
        },
        textColor: {
          label: "Text color",
          family: "textstyles",
          hidden: false,
          sortingWeight: "26",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#444"
              }
            }
          }
        },
        textWeight: {
          label: "Text weight",
          family: "textstyles",
          hidden: true,
          sortingWeight: "27",
          deprecated: true,
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "normal"
              },
              options: {
                value: ["normal", "bold", "lighter"]
              }
            }
          }
        },
        textStyle: {
          label: "Text style",
          family: "textstyles",
          hidden: true,
          sortingWeight: "28",
          deprecated: true,
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "normal"
              },
              options: {
                value: ["normal", "italic"]
              }
            }
          }
        },
        textDecoration: {
          label: "Text decoration",
          family: "textstyles",
          hidden: true,
          sortingWeight: "29",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "none"
              },
              options: {
                value: ["none", "underline", "overline", "line-through"]
              }
            }
          }
        }
      }
    };

    TextStyleSVGBehavior.prototype.addStylableTexts = function(array) {
      if (!_.isArray(array)) {
        array = [array];
      }
      if (this.visualizer.stylableTexts == null) {
        this.visualizer.stylableTexts = [];
      }
      return this.visualizer.stylableTexts = this.visualizer.stylableTexts.concat(array);
    };

    TextStyleSVGBehavior.prototype.executeBeforeUpdateStage = function() {
      this.updateFontStyleOptions();
      this.stylableTexts = this.visualizer.stylableTexts;
      return this.updateConfig();
    };

    TextStyleSVGBehavior.prototype.updateFontStyleOptions = function() {
      var family, options, prop, s, slots, styles, _i, _len;
      if (this.visualizer.model.get("fontFamily").currentFormat === "Font") {
        if (this.visualizer.model.get("fontFamily") && this.currentFamily !== this.visualizer.model.get("fontFamily")[0]) {
          prop = this.visualizer.model.original.get("propertiesCollection").findWhere({
            "propId": "fontFamily"
          });
          if (prop == null) {
            prop = this.visualizer.model.original.prePropertiesCollection.findWhere({
              "propId": "fontFamily"
            });
          }
          if (prop != null) {
            slots = prop.getSlots();
            if (slots != null) {
              family = slots[0].getValue();
              if (family != null) {
                styles = quadrigram.router.managers.fontManager.getFontStyles(family);
                if (styles != null) {
                  options = [];
                  this.currentStyles = {};
                  this.currentFamily = family;
                  for (_i = 0, _len = styles.length; _i < _len; _i++) {
                    s = styles[_i];
                    options.push(s.styleName);
                    this.currentStyles[s.styleName] = {
                      "fontWeight": s.fontWeight,
                      "fontStyle": s.fontStyle
                    };
                  }
                  slots[1].options = options;
                  if (options.indexOf(this.visualizer.model.get("fontFamily")[1]) < 0) {
                    slots[1].getBlock().setData(options[0], {
                      silent: true
                    });
                    return slots[1].trigger("change");
                  } else {
                    return slots[1].trigger("change");
                  }
                }
              }
            }
          }
        }
      }
    };

    TextStyleSVGBehavior.prototype.executeAfterDidUpdateStage = function() {
      this.updateFontStyleOptions();
      this.stylableTexts = this.visualizer.stylableTexts;
      return this.updateConfig();
    };

    TextStyleSVGBehavior.prototype.executeAfterResize = function() {
      this.updateFontStyleOptions();
      this.stylableTexts = this.visualizer.stylableTexts;
      return this.updateConfig();
    };

    TextStyleSVGBehavior.prototype.updateConfig = function() {
      return this.updateStylabelTexts();
    };

    TextStyleSVGBehavior.prototype.updateStylabelTexts = function() {
      var $el, key, _i, _len, _ref1, _results;
      _ref1 = this.stylableTexts;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        key = _ref1[_i];
        if (typeof key === 'string') {
          $el = this.visualizer.$el.find(key);
        } else {
          $el = key;
        }
        if (this.visualizer.model.get("fontFamily").currentFormat === "Font") {
          $el.css("font-family", this.visualizer.model.get("fontFamily")[0]);
          if ((this.currentStyles != null) && (this.currentStyles[this.visualizer.model.get("fontFamily")[1]] != null)) {
            $el.css("font-style", this.currentStyles[this.visualizer.model.get("fontFamily")[1]].fontStyle);
            $el.css("font-weight", this.currentStyles[this.visualizer.model.get("fontFamily")[1]].fontWeight);
          }
        } else {
          $el.css("font-family", this.visualizer.model.get("fontFamily"));
          $el.css("font-weight", this.visualizer.model.get("textWeight"));
          $el.css("font-style", this.visualizer.model.get("textStyle"));
        }
        $el.css("font-size", this.visualizer.model.get("textSize"));
        $el.css("fill", this.visualizer.model.get("textColor"));
        $el.css("text-align", this.visualizer.model.get("textAlign"));
        $el.css("text-decoration", this.visualizer.model.get("textDecoration"));
        $el.removeClass("valign-top");
        $el.removeClass("valign-middle");
        $el.removeClass("valign-bottom");
        _results.push($el.addClass("valign-" + this.visualizer.model.get("vAlign")));
      }
      return _results;
    };

    return TextStyleSVGBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ItemsBehavior = (function(_super) {
    __extends(ItemsBehavior, _super);

    function ItemsBehavior() {
      this.update = __bind(this.update, this);
      this.createStyleItemsByValues = __bind(this.createStyleItemsByValues, this);
      this.createStyleItemBySingleValue = __bind(this.createStyleItemBySingleValue, this);
      this.createStyleItemsById = __bind(this.createStyleItemsById, this);
      this.createStyleItemsByCategories = __bind(this.createStyleItemsByCategories, this);
      this.createStyleItemsFromSample = __bind(this.createStyleItemsFromSample, this);
      this.createStyleItems = __bind(this.createStyleItems, this);
      this.parseScale = __bind(this.parseScale, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.initialize = __bind(this.initialize, this);
      _ref = ItemsBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ItemsBehavior.field = "items";

    ItemsBehavior.behaviors = [];

    ItemsBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ItemsBehavior.meta, ItemsBehavior.behaviors);
      return output;
    };

    ItemsBehavior.meta = {
      "name": "items",
      "outputs": {
        "itemsColors": {
          "outputType": "styles",
          "default": [],
          "label": "Colors of items"
        },
        "catsColors": {
          "outputType": "styles",
          "default": [],
          "label": "Colors of categories"
        }
      },
      "properties": {
        "fillColors": {
          "label": "Fill color of each item",
          "uiTipContent": "Defines the color of each item",
          "family": "style",
          "sortingWeight": "21",
          "hidden": false,
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            },
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": "#989FCC"
                  }, {
                    "id": "2",
                    "value": "#8D91BC"
                  }, {
                    "id": "3",
                    "value": "#CFD4EC"
                  }, {
                    "id": "4",
                    "value": "#AEB5DE"
                  }, {
                    "id": "5",
                    "value": "#989FCC"
                  }
                ]
              }
            },
            "ColorsByCategories": {
              "multiValues": {
                "colors": true,
                "categories": true
              },
              "idSource": {
                "colors": "categories"
              },
              "defaults": {
                "defaultColor": "#AAAAAA"
              }
            },
            "ColorsByValues": {
              "multiValues": {
                "values": true,
                "colorscale": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "Item 1",
                    "value": "3"
                  }, {
                    "id": "Item 2",
                    "value": "1"
                  }, {
                    "id": "Item 3",
                    "value": "5"
                  }, {
                    "id": "Item 4",
                    "value": "7"
                  }, {
                    "id": "Item 5",
                    "value": "6"
                  }
                ],
                "colorscale": "linear-gradient(90deg, rgb(243,243,255),rgb(63 ,81 ,151)  100%)",
                "defaultColor": "#eee"
              }
            }
          }
        },
        "fillOpacities": {
          "uiTipContent": "Defines the transparency of each item",
          "label": "Fill opacity of each item",
          "family": "style",
          "sortingWeight": "22",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 100
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "lineColors": {
          "uiTipContent": "Defines the color of the outline for each item",
          "label": "Outline color of each item",
          "family": "style",
          "sortingWeight": "23",
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": "#63B4F5"
                  }, {
                    "id": "2",
                    "value": "#41A4F4"
                  }, {
                    "id": "3",
                    "value": "#1D87E4"
                  }, {
                    "id": "4",
                    "value": "#1464BF"
                  }, {
                    "id": "5",
                    "value": "#0C46A0"
                  }
                ]
              }
            },
            "ColorsByCategories": {
              "multiValues": {
                "colors": true,
                "categories": true
              },
              "idSource": {
                "colors": "categories"
              },
              "defaults": {
                "categories": [
                  {
                    "id": "1",
                    "value": "Category A"
                  }, {
                    "id": "2",
                    "value": "Category B"
                  }, {
                    "id": "3",
                    "value": "Category C"
                  }, {
                    "id": "4",
                    "value": "Category A"
                  }, {
                    "id": "5",
                    "value": "Category B"
                  }
                ],
                "defaultColor": "#AAAAAA"
              }
            },
            "ColorsByValues": {
              "multiValues": {
                "values": true,
                "colorscale": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": "1"
                  }, {
                    "id": "2",
                    "value": "2"
                  }, {
                    "id": "3",
                    "value": "3"
                  }, {
                    "id": "4",
                    "value": "4"
                  }, {
                    "id": "5",
                    "value": "5"
                  }
                ],
                "defaultColor": "#AAAAAA"
              }
            }
          }
        },
        "lineThickness": {
          "uiTipContent": "Defines the thickness of the outline for each item",
          "label": "Line thickness of each item",
          "family": "style",
          "sortingWeight": "24",
          "hidden": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "2px"
              }
            },
            "PxByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": 20
                  }, {
                    "id": "2",
                    "value": 30
                  }, {
                    "id": "3",
                    "value": 40
                  }, {
                    "id": "4",
                    "value": 50
                  }, {
                    "id": "5",
                    "value": 60
                  }
                ],
                "min": 10,
                "max": 10
              }
            }
          }
        },
        "lineOpacities": {
          "uiTipContent": "Defines the opacity of the outline for each item",
          "label": "Line opacity of each item",
          "family": "style",
          "sortingWeight": "25",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 100
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        }
      }
    };

    ItemsBehavior.prototype.defaultColors = ["#3B4D5F", "#3D88BA", "#91BDDD", "#29A089", "#9EC39C", "#F1CA2D", "#E58C3B", "#C14C3E", "#CF7570", "#9154A2"];

    ItemsBehavior.prototype.styleItems = {};

    ItemsBehavior.prototype.initialize = function(params) {
      return this.config = {};
    };

    ItemsBehavior.prototype.updateConfig = function(newConfig) {
      var currentFormat, field, mainColorDimension;
      for (field in newConfig) {
        this.config[field] = newConfig[field];
      }
      this.createStyleItems();
      mainColorDimension = "fillColors";
      if (this.visualizer.mainColorDimension) {
        mainColorDimension = this.visualizer.mainColorDimension;
      }
      this.visualizer.updateOutput("itemsColors", this.styleItemsToBlock(this.styleItems, mainColorDimension));
      currentFormat = this.visualizer.model.get(mainColorDimension).currentFormat;
      if (currentFormat === "ColorsByCategories") {
        this.visualizer.updateOutput("catsColors", this.visualizer.model.get(mainColorDimension)[1]);
      } else {
        this.visualizer.updateOutput("catsColors", []);
      }
      return this.update();
    };

    ItemsBehavior.prototype.parseScale = function(scaleSource) {
      var angle, breakpoints, colors, matched, output, part, parts, _i, _len;
      if (scaleSource.metadata != null) {
        scaleSource = scaleSource[0].value;
      }
      if (scaleSource.match) {
        
        var ptrn = / ?,?rgb/
        ;
        parts = scaleSource.split(ptrn);
        angle = parts[0].match(/(d+)deg/);
        parts.unshift();
        colors = [];
        breakpoints = [];
        for (_i = 0, _len = parts.length; _i < _len; _i++) {
          part = parts[_i];
          matched = part.match(/\(([^\)]+)\)(?:\s+)?(\d+)?%?,?/);
          if (matched) {
            colors.push("rgb(" + matched[1] + ")");
            breakpoints.push(matched[2] / 100 || 0);
          }
        }
      }
      output = {
        colors: colors,
        breakpoints: breakpoints
      };
      return output;
    };

    ItemsBehavior.prototype.createStyleItems = function() {
      var currentFormat, defaultColor, qScale, range, styleDimension, values, _i, _len, _ref1, _results,
        _this = this;
      this.styleItems = {};
      this.styleDimensions = [];
      _.each(this.visualizer.model.original.info().properties, function(property, key) {
        if (property.family === 'style' || property.proxyFamily === 'style') {
          return _this.styleDimensions.push(key);
        }
      });
      _ref1 = this.styleDimensions;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        styleDimension = _ref1[_i];
        currentFormat = this.visualizer.model.get(styleDimension);
        if (currentFormat != null) {
          currentFormat = currentFormat.currentFormat;
          switch (currentFormat) {
            case "Color":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(styleDimension), styleDimension));
              break;
            case "ColorsByCategories":
              _results.push(this.createStyleItemsByCategories(this.visualizer.model.get(styleDimension)[0], this.visualizer.model.get(styleDimension)[1], this.visualizer.model.get(styleDimension)[2], styleDimension));
              break;
            case "ColorsByValues":
              values = this.visualizer.model.get(styleDimension)[0];
              qScale = this.parseScale(this.visualizer.model.get(styleDimension)[1]);
              defaultColor = this.visualizer.model.get(styleDimension)[2];
              _results.push(this.createStyleItemsByValues(values, styleDimension, qScale.breakpoints, qScale.colors, defaultColor));
              break;
            case "Percentage":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(styleDimension), styleDimension));
              break;
            case "Number":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(styleDimension), styleDimension));
              break;
            case "Px":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(styleDimension), styleDimension));
              break;
            case "Options":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(styleDimension), styleDimension));
              break;
            case "OptionsByCategories":
              _results.push(this.createStyleItemsByCategories(this.visualizer.model.get(styleDimension)[0], this.visualizer.model.get(styleDimension)[1], this.visualizer.model.get(styleDimension)[2], styleDimension));
              break;
            case "PercentageByValues":
              values = this.visualizer.model.get(styleDimension)[0];
              range = [parseFloat(this.visualizer.model.get(styleDimension)[1]), parseFloat(this.visualizer.model.get(styleDimension)[2])];
              _results.push(this.createStyleItemsByValues(values, styleDimension, void 0, range));
              break;
            case "ByValues":
              values = this.visualizer.model.get(styleDimension)[0];
              range = [parseFloat(this.visualizer.model.get(styleDimension)[1]), parseFloat(this.visualizer.model.get(styleDimension)[2])];
              _results.push(this.createStyleItemsByValues(values, styleDimension, void 0, range));
              break;
            case "PxByValues":
              values = this.visualizer.model.get(styleDimension)[0];
              range = [parseFloat(this.visualizer.model.get(styleDimension)[1]), parseFloat(this.visualizer.model.get(styleDimension)[2])];
              _results.push(this.createStyleItemsByValues(values, styleDimension, void 0, range));
              break;
            case void 0:
              if (_.isString(this.visualizer.model.get(styleDimension)) && this.visualizer.model.get(styleDimension).indexOf("linear-gradient") !== -1) {
                qScale = this.parseScale(this.visualizer.model.get(styleDimension));
                _results.push(this.createStyleItemsFromSample(qScale.colors, styleDimension));
              } else {
                _results.push(this.createStyleItemBySingleValue(this.visualizer.model.get(styleDimension), styleDimension));
              }
              break;
            default:
              _results.push(void 0);
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    ItemsBehavior.prototype.createStyleItemsFromSample = function(sample, styleDimension) {
      var i, id, ids, scale, step, style, styles, weight, _i, _j, _k, _l, _len, _len1, _len2, _len3, _len4, _m, _ref1, _results;
      ids = this.config.ids;
      styles = {};
      if (sample.length > ids.length) {
        step = 1 / (ids.length - 1);
        for (i = _i = 0, _len = ids.length; _i < _len; i = ++_i) {
          id = ids[i];
          weight = step * i;
          styles[id] = sample[Math.round(weight * (sample.length - 1))];
        }
      }
      if (sample.length === ids.length) {
        for (i = _j = 0, _len1 = ids.length; _j < _len1; i = ++_j) {
          id = ids[i];
          styles[id] = sample[i];
        }
      }
      if (sample.length < ids.length) {
        if (sample.length < 4) {
          scale = d3.scale.linear().domain([0, ids.length - 1]).range(sample);
          for (i = _k = 0, _len2 = ids.length; _k < _len2; i = ++_k) {
            id = ids[i];
            styles[id] = scale(i);
          }
        } else {
          for (i = _l = 0, _len3 = ids.length; _l < _len3; i = ++_l) {
            id = ids[i];
            styles[id] = sample[i % sample.length];
          }
        }
      }
      _ref1 = this.config.ids;
      _results = [];
      for (_m = 0, _len4 = _ref1.length; _m < _len4; _m++) {
        id = _ref1[_m];
        if (styles[id]) {
          style = styles[id];
        } else {
          style = sample[0];
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][styleDimension] = style);
      }
      return _results;
    };

    ItemsBehavior.prototype.createStyleItemsByCategories = function(categories, styles, defaultStyle, styleDimension) {
      var categoriesCandidate, categoriesObject, getObjectFromQValue, id, style, styleCandidate, stylesObject, _i, _len, _ref1, _results,
        _this = this;
      getObjectFromQValue = function(blockList) {
        var object, objectSource, _i, _len;
        object = {};
        for (_i = 0, _len = blockList.length; _i < _len; _i++) {
          objectSource = blockList[_i];
          object[objectSource.id] = objectSource.value;
        }
        return object;
      };
      categoriesObject = getObjectFromQValue(categories);
      stylesObject = getObjectFromQValue(styles);
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        categoriesCandidate = categoriesObject[id];
        if (categoriesCandidate) {
          styleCandidate = stylesObject[categoriesCandidate];
        } else {
          styleCandidate = defaultStyle;
        }
        if (styleCandidate) {
          style = styleCandidate;
        } else {
          style = defaultStyle;
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][styleDimension] = style);
      }
      return _results;
    };

    ItemsBehavior.prototype.createStyleItemsById = function(stylesSource, styleDimension) {
      var arrayOfstyles, getStylesObject, id, itemWithoutstyleCount, style, styles, _i, _len, _ref1, _results,
        _this = this;
      getStylesObject = function(stylesSource) {
        var styleSource, styles, _i, _len;
        styles = {};
        for (_i = 0, _len = stylesSource.length; _i < _len; _i++) {
          styleSource = stylesSource[_i];
          styles[styleSource.id] = styleSource.value;
        }
        return styles;
      };
      styles = getStylesObject(stylesSource);
      arrayOfstyles = _.values(styles, styleDimension);
      itemWithoutstyleCount = 0;
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        if (styles[id]) {
          style = styles[id];
        } else {
          style = arrayOfstyles[itemWithoutstyleCount % arrayOfstyles.length];
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][styleDimension] = style);
      }
      return _results;
    };

    ItemsBehavior.prototype.createStyleItemBySingleValue = function(style, styleDimension) {
      var id, _i, _len, _ref1, _results;
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][styleDimension] = style);
      }
      return _results;
    };

    ItemsBehavior.prototype.createStyleItemsByValues = function(valuesSource, styleDimension, breakpoints, range, defaultValue) {
      var getValuesObject, id, scale, setScale, style, values, _i, _j, _len, _len1, _ref1, _ref2, _results, _results1,
        _this = this;
      setScale = function(values) {
        var breakpoint, realDomain, scale, valuesDomain, _i, _len;
        if (!breakpoints) {
          breakpoints = [0, 1];
        }
        valuesDomain = d3.extent(values, function(d) {
          return parseFloat(d.value);
        });
        realDomain = [];
        for (_i = 0, _len = breakpoints.length; _i < _len; _i++) {
          breakpoint = breakpoints[_i];
          realDomain.push(valuesDomain[0] + breakpoint * (valuesDomain[1] - valuesDomain[0]));
        }
        scale = d3.scale.linear().domain(realDomain).range(range);
        return scale;
      };
      getValuesObject = function(valuesSource, scale) {
        var valueSource, values, _i, _len;
        values = {};
        for (_i = 0, _len = valuesSource.length; _i < _len; _i++) {
          valueSource = valuesSource[_i];
          /*
          value = parseFloat(valueSource.value)
          if isNaN(value)
            color = "transparent"
          else
            color = scale(value)
          values[valueSource.id] = {originalValue:value,value:color}
          */

          values[valueSource.id] = {
            originalValue: parseFloat(valueSource.value),
            value: scale(parseFloat(valueSource.value))
          };
        }
        return values;
      };
      if ((defaultValue != null) && _.isArray(defaultValue)) {
        defaultValue = defaultValue[0].value;
      }
      if (_.isArray(valuesSource) && _.isArray(range)) {
        scale = setScale(valuesSource);
        values = getValuesObject(valuesSource, scale);
        _ref1 = this.config.ids;
        _results = [];
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          id = _ref1[_i];
          if (values[id]) {
            style = values[id];
          } else {
            style = {
              originalValue: void 0,
              value: defaultValue || scale.range()[0]
            };
          }
          if (!this.styleItems[id]) {
            this.styleItems[id] = {};
          }
          _results.push(this.styleItems[id][styleDimension] = style.value);
        }
        return _results;
      } else {
        if (_.isArray(range)) {
          style = range[0];
        } else {
          style = range;
        }
        _ref2 = this.config.ids;
        _results1 = [];
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          id = _ref2[_j];
          if (!this.styleItems[id]) {
            this.styleItems[id] = {};
          }
          _results1.push(this.styleItems[id][styleDimension] = style);
        }
        return _results1;
      }
    };

    ItemsBehavior.prototype.styleItemsToBlock = function(styleItems, property) {
      var item, itemId, result;
      result = [];
      for (itemId in styleItems) {
        item = styleItems[itemId];
        result.push({
          id: itemId,
          value: item[property]
        });
      }
      return result;
    };

    ItemsBehavior.prototype.update = function() {};

    return ItemsBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ItemsDOMBehavior = (function(_super) {
    __extends(ItemsDOMBehavior, _super);

    function ItemsDOMBehavior() {
      this.update = __bind(this.update, this);
      _ref = ItemsDOMBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ItemsDOMBehavior.prototype.update = function() {
      var items, self;
      self = this;
      items = d3.select(this.visualizer.el).selectAll(".item");
      /*
      items.selectAll(".item-child")
        .style("background-color", (d,i) ->
          color = self.styleItems[d.id]["fillColors"]
          # TODO: Validate none color
          colorRGB = d3.rgb(color)
          opacity = if color is 'none' || color is '' then 0 else self.styleItems[d.id]["fillOpacities"] / 100
          style = "rgba("+colorRGB.r+","+colorRGB.g+","+colorRGB.b+","+opacity+")"
          style
        )
        # reset border
        .style("border", "none")
        # sets height
        .style("height", (d,i) ->
          cellHeight = self.styleItems[d.id]['cellHeight']
          cellHeight = if cellHeight? then cellHeight else $(this).css('font-size')
          cellHeight
        )
        .style("box-shadow", "none")
      */

      items.selectAll(".item-child").style("background-color", function(d, i) {
        var color, colorRGB, opacity, style;
        color = self.styleItems[d.id]["fillColors"];
        colorRGB = d3.rgb(color);
        opacity = color === 'none' || color === '' ? 0 : self.styleItems[d.id]["fillOpacities"] / 100;
        style = "rgba(" + colorRGB.r + "," + colorRGB.g + "," + colorRGB.b + "," + opacity + ")";
        return style;
      }).style("border", "none").style("box-shadow", "none");
      return items.style("position", "relative").style("z-index", "0").style("border-width", function(d, i) {
        return self.styleItems[d.id]["lineThickness"];
      }).style("border-style", "solid").style("border-color", function(d, i) {
        var color, colorRGB, opacity, style;
        color = self.styleItems[d.id]["lineColors"];
        colorRGB = d3.rgb(color);
        opacity = color === "none" || color === "" ? 0 : self.styleItems[d.id]["lineOpacities"] / 100;
        style = "rgba(" + colorRGB.r + "," + colorRGB.g + "," + colorRGB.b + "," + opacity + ")";
        return style;
      }).style("padding", 0).style("margin", 0);
    };

    return ItemsDOMBehavior;

  })(quadrigram.Models.ItemsBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ItemsSVGBehavior = (function(_super) {
    __extends(ItemsSVGBehavior, _super);

    function ItemsSVGBehavior() {
      this.update = __bind(this.update, this);
      _ref = ItemsSVGBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ItemsSVGBehavior.prototype.update = function(options) {
      var items, self, size, transitionTime, transitionType;
      options || (options = {});
      self = this;
      items = d3.select(this.visualizer.el).selectAll(".item").filter(function(d) {
        return (d != null) && d.id !== "root_quadrigram_reserved_id";
      });
      items.each(function(d, i) {
        var item;
        item = d3.select(this);
        if (item.attr("fill") == null) {
          item.attr("fill", self.styleItems[d.id]["fillColors"]);
        }
        if (item.attr("fill-opacity") == null) {
          item.attr("fill-opacity", self.styleItems[d.id]["fillOpacities"] / 100);
        }
        if (item.attr("stroke") == null) {
          item.attr("stroke", self.styleItems[d.id]["lineColors"]);
        }
        if (item.attr("stroke-opacity") == null) {
          item.attr("stroke-opacity", self.styleItems[d.id]["lineOpacities"] / 100);
        }
        if (item.attr("stroke-width") == null) {
          return item.attr("stroke-width", self.styleItems[d.id]["lineThickness"]);
        }
      });
      size = items.size();
      if (size < 260 && this.visualizer.animationActive) {
        transitionType = this.visualizer.model.get("transition")[0];
        transitionTime = this.visualizer.model.get("transition")[1];
      } else {
        transitionType = "none";
        transitionTime = 0;
      }
      items.transition("fillTransition").duration(transitionTime).ease(transitionType).attr("fill", function(d, i) {
        return self.styleItems[d.id]["fillColors"];
      });
      items.transition("opacityTransition").duration(transitionTime).ease(transitionType).attr("fill-opacity", function(d, i) {
        return self.styleItems[d.id]["fillOpacities"] / 100;
      });
      items.style("pointer-events", function(d, i) {
        if (self.styleItems[d.id]["fillColors"] === "transparent" || self.styleItems[d.id]["fillOpacities"] === 0) {
          return "stroke";
        } else {
          return "all";
        }
      });
      items.transition("strokeTransition").duration(transitionTime).ease(transitionType).attr("stroke", function(d, i) {
        var strokeOpacity, strokeThickness;
        strokeOpacity = self.styleItems[d.id]["lineOpacities"];
        strokeThickness = self.styleItems[d.id]["lineThickness"];
        if (strokeOpacity === 0 || strokeThickness === 0) {
          return "none";
        }
        return self.styleItems[d.id]["lineColors"];
      });
      items.transition("strokeWidthTransition").duration(transitionTime).ease(transitionType).attr("stroke-width", function(d, i) {
        return self.styleItems[d.id]["lineThickness"];
      });
      return items.transition("strokeOpacityTransition").duration(transitionTime).ease(transitionType).attr("stroke-opacity", function(d, i) {
        return self.styleItems[d.id]["lineOpacities"] / 100;
      });
    };

    return ItemsSVGBehavior;

  })(quadrigram.Models.ItemsBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ItemsDOMwithSVGBehavior = (function(_super) {
    __extends(ItemsDOMwithSVGBehavior, _super);

    function ItemsDOMwithSVGBehavior() {
      this.update = __bind(this.update, this);
      _ref = ItemsDOMwithSVGBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ItemsDOMwithSVGBehavior.prototype.update = function() {
      var items, self;
      self = this;
      items = d3.select(this.visualizer.el).selectAll(".item");
      return items.selectAll(".item-child").attr("fill", function(d, i) {
        var color, colorRGB, opacity, style;
        color = self.styleItems[d.id]["fillColors"];
        colorRGB = d3.rgb(color);
        opacity = color === 'none' || color === '' ? 0 : self.styleItems[d.id]["fillOpacities"] / 100;
        style = "rgba(" + colorRGB.r + "," + colorRGB.g + "," + colorRGB.b + "," + opacity + ")";
        return style;
      });
    };

    return ItemsDOMwithSVGBehavior;

  })(quadrigram.Models.ItemsBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SecondItemsBehavior = (function(_super) {
    __extends(SecondItemsBehavior, _super);

    function SecondItemsBehavior() {
      this.setWeightScale = __bind(this.setWeightScale, this);
      this.createStyleItemsByValues = __bind(this.createStyleItemsByValues, this);
      this.createStyleItemBySingleValue = __bind(this.createStyleItemBySingleValue, this);
      this.createStyleItemsById = __bind(this.createStyleItemsById, this);
      this.createStyleItemsByCategories = __bind(this.createStyleItemsByCategories, this);
      this.createStyleItemsFromSample = __bind(this.createStyleItemsFromSample, this);
      this.createLinkItems = __bind(this.createLinkItems, this);
      this.parseScale = __bind(this.parseScale, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.initialize = __bind(this.initialize, this);
      this.executeAfterUpdateStage = __bind(this.executeAfterUpdateStage, this);
      _ref = SecondItemsBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SecondItemsBehavior.field = "seconditems";

    SecondItemsBehavior.behaviors = [];

    SecondItemsBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(SecondItemsBehavior.meta, SecondItemsBehavior.behaviors);
      return output;
    };

    SecondItemsBehavior.meta = {
      "name": "secondItems",
      "properties": {
        "fillColors2": {
          "label": "---Fill color of each item",
          "uiTipContent": "Defines the color of each item",
          "family": "style",
          "sortingWeight": "21",
          "hidden": false,
          "formats": {
            "ColorsByScale": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "linear-gradient(90deg, rgb(26,35,126),   rgb(13,113,146) 12.5%,  rgb(0,191,165)  25%,    rgb(127,204,109) 37.5%, rgb(253,216,53) 50%,     rgb(246,149,67) 62.5%,   rgb(239,83,80) 75%, rgb(187,48,80) 87.5%,    rgb(136,14,79) 100%)"
              }
            },
            "Color": {
              "idSource": {
                "value": "visualizer.idsItems2"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": "#989FCC"
                  }, {
                    "id": "2",
                    "value": "#8D91BC"
                  }, {
                    "id": "3",
                    "value": "#CFD4EC"
                  }, {
                    "id": "4",
                    "value": "#AEB5DE"
                  }, {
                    "id": "5",
                    "value": "#989FCC"
                  }
                ]
              }
            },
            "ColorsByCategories": {
              "multiValues": {
                "colors": true,
                "categories": true
              },
              "idSource": {
                "colors": "categories"
              },
              "defaults": {
                "defaultColor": "#AAAAAA"
              }
            },
            "ColorsByValues": {
              "multiValues": {
                "values": true,
                "colorscale": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": "1"
                  }, {
                    "id": "2",
                    "value": "2"
                  }, {
                    "id": "3",
                    "value": "3"
                  }, {
                    "id": "4",
                    "value": "4"
                  }, {
                    "id": "5",
                    "value": "5"
                  }
                ],
                "colorscale": "linear-gradient(90deg, rgb(243,243,255), rgb(63,81,151) 100%)"
              }
            }
          }
        },
        "fillOpacities2": {
          "uiTipContent": "Defines the transparency of each item",
          "label": "---Fill opacity of each item",
          "family": "style",
          "sortingWeight": "22",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 100
              },
              "idSource": {
                "value": "visualizer.idsItems2"
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        },
        "lineColors2": {
          "uiTipContent": "Defines the color of the outline for each item",
          "label": "---Outline color of each item",
          "family": "style",
          "sortingWeight": "23",
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "idSource": {
                "value": "visualizer.idsItems2"
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": "#63B4F5"
                  }, {
                    "id": "2",
                    "value": "#41A4F4"
                  }, {
                    "id": "3",
                    "value": "#1D87E4"
                  }, {
                    "id": "4",
                    "value": "#1464BF"
                  }, {
                    "id": "5",
                    "value": "#0C46A0"
                  }
                ]
              }
            },
            "ColorsByCategories": {
              "multiValues": {
                "colors": true,
                "categories": true
              },
              "idSource": {
                "colors": "categories"
              },
              "defaults": {
                "categories": [
                  {
                    "id": "1",
                    "value": "Category A"
                  }, {
                    "id": "2",
                    "value": "Category B"
                  }, {
                    "id": "3",
                    "value": "Category C"
                  }, {
                    "id": "4",
                    "value": "Category A"
                  }, {
                    "id": "5",
                    "value": "Category B"
                  }
                ],
                "defaultColor": "#AAAAAA"
              }
            },
            "ColorsByValues": {
              "multiValues": {
                "values": true,
                "colorscale": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": "1"
                  }, {
                    "id": "2",
                    "value": "2"
                  }, {
                    "id": "3",
                    "value": "3"
                  }, {
                    "id": "4",
                    "value": "4"
                  }, {
                    "id": "5",
                    "value": "5"
                  }
                ]
              },
              "defaultColor": "#AAAAAA"
            }
          }
        },
        "lineThickness2": {
          "uiTipContent": "Defines the thickness of the outline for each item",
          "label": "---Line thickness of each item",
          "family": "style",
          "sortingWeight": "24",
          "hidden": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "1px"
              },
              "idSource": {
                "value": "visualizer.idsItems2"
              }
            },
            "PxByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": [
                  {
                    "id": "1",
                    "value": 20
                  }, {
                    "id": "2",
                    "value": 30
                  }, {
                    "id": "3",
                    "value": 40
                  }, {
                    "id": "4",
                    "value": 50
                  }, {
                    "id": "5",
                    "value": 60
                  }
                ],
                "min": 10,
                "max": 10
              }
            }
          }
        },
        "lineOpacities2": {
          "uiTipContent": "Defines the opacity of the outline for each item",
          "label": "---Line opacity of each item",
          "family": "style",
          "sortingWeight": "25",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": 70
              },
              "idSource": {
                "value": "visualizer.idsItems2"
              }
            },
            "PercentageByValues": {
              "multiValues": {
                "values": true,
                "min": false,
                "max": false
              },
              "defaults": {
                "values": 0,
                "min": 100,
                "max": 100
              }
            }
          }
        }
      }
    };

    SecondItemsBehavior.prototype.executeAfterUpdateStage = function() {
      var ids, items, model, values;
      model = this.visualizer.model;
      items = this.visualizer.items2;
      values = this.visualizer.values2;
      ids = this.visualizer.idsItems2;
      this.changed = (this.visualizer.model.changed["lineColors2"] != null) || (this.visualizer.model.changed["lineOpacities2"] != null) || (this.visualizer.model.changed["lineThickness2"] != null) || this.visualizer.changedData || this.firstExec;
      if (this.changed) {
        this.updateConfig({
          itemsEnter: items,
          values: values,
          ids: ids,
          lineColors2: model.get("lineColors2"),
          lineOpacities2: model.get("lineOpacities2"),
          lineThickness2: model.get("lineThickness2")
        });
      }
      return this.firstExec = false;
    };

    SecondItemsBehavior.prototype.linkItems = {};

    SecondItemsBehavior.prototype.linkDimensions = ["lineColors2", "lineOpacities2", "lineThickness2"];

    SecondItemsBehavior.prototype.initialize = function(params) {
      return this.config = {};
    };

    SecondItemsBehavior.prototype.updateConfig = function(newConfig) {
      var field;
      for (field in newConfig) {
        this.config[field] = newConfig[field];
      }
      this.createLinkItems();
      return this.update();
    };

    SecondItemsBehavior.prototype.parseScale = function(scaleSource) {
      var angle, breakpoints, colors, matched, output, part, parts, _i, _len;
      if (scaleSource.match) {
        
        var ptrn = / ?,?rgb/
        ;
        parts = scaleSource.split(ptrn);
        angle = parts[0].match(/(d+)deg/);
        parts.unshift();
        colors = [];
        breakpoints = [];
        for (_i = 0, _len = parts.length; _i < _len; _i++) {
          part = parts[_i];
          matched = part.match(/\(([^\)]+)\) ?(\d+)?%?,?/);
          if (matched) {
            colors.push("rgb(" + matched[1] + ")");
            breakpoints.push(matched[2] / 100 || 0);
          }
        }
      }
      output = {
        colors: colors,
        breakpoints: breakpoints
      };
      return output;
    };

    SecondItemsBehavior.prototype.createLinkItems = function() {
      var currentFormat, linkDimension, qScale, range, values, _i, _len, _ref1, _results;
      this.styleItems = {};
      _ref1 = this.linkDimensions;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        linkDimension = _ref1[_i];
        currentFormat = this.visualizer.model.get(linkDimension);
        if (currentFormat != null) {
          currentFormat = currentFormat.currentFormat;
          switch (currentFormat) {
            case "Color":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "ColorsByCategories":
              _results.push(this.createStyleItemsByCategories(this.visualizer.model.get(linkDimension)[0], this.visualizer.model.get(linkDimension)[1], this.visualizer.model.get(linkDimension)[2], linkDimension));
              break;
            case "ColorsByValues":
              values = this.visualizer.model.get(linkDimension)[0];
              qScale = this.parseScale(this.visualizer.model.get(linkDimension)[1]);
              _results.push(this.createStyleItemsByValues(values, linkDimension, qScale.breakpoints, qScale.colors));
              break;
            case "Percentage":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "Number":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "Px":
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "PercentageByValues":
              values = this.visualizer.model.get(linkDimension)[0];
              range = [parseFloat(this.visualizer.model.get(linkDimension)[1]), parseFloat(this.visualizer.model.get(linkDimension)[2])];
              _results.push(this.createStyleItemsByValues(values, linkDimension, void 0, range));
              break;
            case "ByValues":
              values = this.visualizer.model.get(linkDimension)[0];
              range = [parseFloat(this.visualizer.model.get(linkDimension)[1]), parseFloat(this.visualizer.model.get(linkDimension)[2])];
              _results.push(this.createStyleItemsByValues(values, linkDimension, void 0, range));
              break;
            case "PxByValues":
              values = this.visualizer.model.get(linkDimension)[0];
              range = [parseFloat(this.visualizer.model.get(linkDimension)[1]), parseFloat(this.visualizer.model.get(linkDimension)[2])];
              _results.push(this.createStyleItemsById(this.visualizer.model.get(linkDimension), linkDimension));
              break;
            case "PxRange":
              values = this.visualizer.model.get(linkDimension)[0];
              range = [parseFloat(this.visualizer.model.get(linkDimension)[0]), parseFloat(this.visualizer.model.get(linkDimension)[1])];
              _results.push(this.createStyleItemsByValues(values, linkDimension, void 0, range));
              break;
            case void 0:
              if (_.isString(this.visualizer.model.get(linkDimension)) && this.visualizer.model.get(linkDimension).indexOf("linear-gradient") !== -1) {
                qScale = this.parseScale(this.visualizer.model.get(linkDimension));
                _results.push(this.createStyleItemsFromSample(qScale.colors, linkDimension));
              } else {
                _results.push(this.createStyleItemBySingleValue(this.visualizer.model.get(linkDimension), linkDimension));
              }
              break;
            default:
              _results.push(void 0);
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    SecondItemsBehavior.prototype.createStyleItemsFromSample = function(sample, linkDimension) {
      var i, id, ids, scale, step, style, styles, weight, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _results;
      ids = this.config.ids;
      styles = {};
      if (sample.length > ids.length) {
        step = 1 / (ids.length - 1);
        for (i = _i = 0, _len = ids.length; _i < _len; i = ++_i) {
          id = ids[i];
          weight = step * i;
          styles[id] = sample[Math.round(weight * (sample.length - 1))];
        }
      }
      if (sample.length === ids.length) {
        styles = sample;
      }
      if (sample.length < ids.length) {
        if (sample.length < 4) {
          scale = d3.scale.linear().domain([0, ids.length - 1]).range(sample);
          for (i = _j = 0, _len1 = ids.length; _j < _len1; i = ++_j) {
            id = ids[i];
            styles[id] = scale(i);
          }
        } else {
          for (i = _k = 0, _len2 = ids.length; _k < _len2; i = ++_k) {
            id = ids[i];
            styles[id] = sample[i % sample.length];
          }
        }
      }
      _ref1 = this.config.ids;
      _results = [];
      for (_l = 0, _len3 = _ref1.length; _l < _len3; _l++) {
        id = _ref1[_l];
        if (styles[id]) {
          style = styles[id];
        } else {
          style = sample[0];
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][linkDimension] = style);
      }
      return _results;
    };

    SecondItemsBehavior.prototype.createStyleItemsByCategories = function(categories, styles, defaultStyle, linkDimension) {
      var categoriesCandidate, categoriesObject, getObjectFromQValue, id, style, styleCandidate, stylesObject, _i, _len, _ref1, _results,
        _this = this;
      getObjectFromQValue = function(blockList) {
        var object, objectSource, _i, _len;
        object = {};
        for (_i = 0, _len = blockList.length; _i < _len; _i++) {
          objectSource = blockList[_i];
          object[objectSource.id] = objectSource.value;
        }
        return object;
      };
      categoriesObject = getObjectFromQValue(categories);
      stylesObject = getObjectFromQValue(styles);
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        categoriesCandidate = categoriesObject[id];
        if (categoriesCandidate) {
          styleCandidate = stylesObject[categoriesCandidate];
        } else {
          styleCandidate = defaultStyle;
        }
        if (styleCandidate) {
          style = styleCandidate;
        } else {
          style = defaultStyle;
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][linkDimension] = style);
      }
      return _results;
    };

    SecondItemsBehavior.prototype.createStyleItemsById = function(stylesSource, linkDimension) {
      var arrayOfstyles, getStylesObject, id, itemWithoutstyleCount, style, styles, _i, _len, _ref1, _results,
        _this = this;
      getStylesObject = function(stylesSource) {
        var styleSource, styles, _i, _len;
        styles = {};
        for (_i = 0, _len = stylesSource.length; _i < _len; _i++) {
          styleSource = stylesSource[_i];
          styles[styleSource.id] = styleSource.value;
        }
        return styles;
      };
      styles = getStylesObject(stylesSource);
      arrayOfstyles = _.values(styles, linkDimension);
      itemWithoutstyleCount = 0;
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        if (styles[id]) {
          style = styles[id];
        } else {
          style = arrayOfstyles[itemWithoutstyleCount % arrayOfstyles.length];
        }
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][linkDimension] = style);
      }
      return _results;
    };

    SecondItemsBehavior.prototype.createStyleItemBySingleValue = function(style, linkDimension) {
      var id, _i, _len, _ref1, _results;
      _ref1 = this.config.ids;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        id = _ref1[_i];
        if (!this.styleItems[id]) {
          this.styleItems[id] = {};
        }
        _results.push(this.styleItems[id][linkDimension] = style);
      }
      return _results;
    };

    SecondItemsBehavior.prototype.createStyleItemsByValues = function(valuesSource, linkDimension, breakpoints, range) {
      var getValuesObject, id, scale, setScale, style, values, _i, _j, _len, _len1, _ref1, _ref2, _results, _results1,
        _this = this;
      setScale = function(values) {
        var breakpoint, realDomain, scale, valuesDomain, _i, _len;
        if (!breakpoints) {
          breakpoints = [0, 1];
        }
        valuesDomain = d3.extent(values, function(d) {
          return parseFloat(d.value);
        });
        realDomain = [];
        for (_i = 0, _len = breakpoints.length; _i < _len; _i++) {
          breakpoint = breakpoints[_i];
          realDomain.push(valuesDomain[0] + breakpoint * (valuesDomain[1] - valuesDomain[0]));
        }
        scale = d3.scale.linear().domain(realDomain).range(range);
        return scale;
      };
      getValuesObject = function(valuesSource, scale) {
        var valueSource, values, _i, _len;
        values = {};
        for (_i = 0, _len = valuesSource.length; _i < _len; _i++) {
          valueSource = valuesSource[_i];
          values[valueSource.id] = {
            originalValue: parseFloat(valueSource.value),
            value: scale(parseFloat(valueSource.value))
          };
        }
        return values;
      };
      if (_.isArray(valuesSource) && _.isArray(range)) {
        scale = setScale(valuesSource);
        values = getValuesObject(valuesSource, scale);
        _ref1 = this.config.ids;
        _results = [];
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          id = _ref1[_i];
          if (values[id]) {
            style = values[id];
          } else {
            style = {
              originalValue: void 0,
              value: scale.range()[0]
            };
          }
          if (!this.styleItems[id]) {
            this.styleItems[id] = {};
          }
          _results.push(this.styleItems[id][linkDimension] = style.value);
        }
        return _results;
      } else {
        if (_.isArray(range)) {
          style = range[0];
        } else {
          style = range;
        }
        _ref2 = this.config.ids;
        _results1 = [];
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          id = _ref2[_j];
          if (!this.styleItems[id]) {
            this.styleItems[id] = {};
          }
          _results1.push(this.styleItems[id][linkDimension] = style);
        }
        return _results1;
      }
    };

    SecondItemsBehavior.prototype.setWeightScale = function() {
      var domain, format, input, range;
      input = this.visualizer.model.get("linkThickness");
      format = input.currentFormat;
      domain = this.visualizer.calculateNumberDomain(this.visualizer.weightRelations, 0, false);
      switch (format) {
        case "PxByValues":
          range = [input[1], input[2]];
          break;
        case "PxRange":
          range = [input[0], input[1]];
          break;
        default:
          range = [input, input];
      }
      return this.strokeWidthScale = d3.scale.linear().domain(domain).range(range);
    };

    return SecondItemsBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SecondItemsSVGBehavior = (function(_super) {
    __extends(SecondItemsSVGBehavior, _super);

    function SecondItemsSVGBehavior() {
      this.update = __bind(this.update, this);
      _ref = SecondItemsSVGBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SecondItemsSVGBehavior.prototype.update = function() {
      var secondItems, self, size, transitionTime, transitionType,
        _this = this;
      self = this;
      secondItems = d3.select(this.visualizer.el).selectAll(".second-item");
      secondItems.each(function(d, i) {
        var item;
        item = d3.select(this);
        if (item.attr("stroke") == null) {
          item.attr("stroke", self.styleItems[d.id]["lineColors2"]);
        }
        if (item.attr("stroke-opacity") == null) {
          return item.attr("stroke-opacity", self.styleItems[d.id]["lineOpacities2"] / 100);
        }
      });
      size = secondItems.size();
      if (size < 200 && this.visualizer.animationActive) {
        transitionType = this.visualizer.model.get("transition")[0];
        transitionTime = this.visualizer.model.get("transition")[1];
      } else {
        transitionType = "none";
        transitionTime = 0;
      }
      secondItems.transition("strokeTransition").duration(transitionTime).ease(transitionType).attr("stroke", function(d, i) {
        return self.styleItems[d.id]["lineColors2"];
      });
      secondItems.transition("strokeOpacityTransition").duration(transitionTime).ease(transitionType).attr("stroke-opacity", function(d, i) {
        return self.styleItems[d.id]["lineOpacities2"] / 100;
      });
      return secondItems.transition("strokeWidthTransition").duration(transitionTime).ease(transitionType).attr("stroke-width", function(d) {
        return self.styleItems[d.id]["lineThickness2"];
      });
    };

    return SecondItemsSVGBehavior;

  })(quadrigram.Models.SecondItemsBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SVGShapesBehavior = (function(_super) {
    __extends(SVGShapesBehavior, _super);

    function SVGShapesBehavior() {
      this.drawShape = __bind(this.drawShape, this);
      _ref = SVGShapesBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SVGShapesBehavior.field = "svgshapes";

    SVGShapesBehavior.behaviors = [];

    SVGShapesBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(SVGShapesBehavior.meta, SVGShapesBehavior.behaviors);
      return output;
    };

    SVGShapesBehavior.meta = {
      "name": "items",
      "outputs": {
        "itemsColors": {
          "outputType": "styles",
          "default": [],
          "label": "Colors of items"
        },
        "catsColors": {
          "outputType": "styles",
          "default": [],
          "label": "Colors of categories"
        }
      },
      "properties": {
        "shapeType": {
          "label": "Shape",
          "sortingWeight": "30",
          "family": "style",
          "hidden": true,
          "internal": false,
          "formats": {
            "Options": {
              "defaults": {
                "value": "Circle"
              },
              "multiValues": {
                "value": true
              },
              "options": {
                "value": ["Circle", "Square", "Triangle", "Diamond", "Line", "Cross"]
              }
            },
            "OptionsByCategories": {
              "defaults": {
                "defaultOption": "Circle"
              },
              "multiValues": {
                "categories": true,
                "catoptions": true,
                "defaultOption": false
              },
              "idSource": {
                "catoptions": "categories"
              },
              "options": {
                "catoptions": ["Circle", "Square", "Triangle", "Diamond", "Line", "Cross"],
                "defaultOption": ["Circle", "Square", "Triangle", "Diamond", "Line", "Cross"]
              }
            }
          }
        },
        "shapeSize": {
          "sortingWeight": "31",
          "label": "Size of the shapes",
          "family": "style",
          "hidden": true,
          "internal": false,
          "formats": {
            "Px": {
              "defaults": {
                "value": "2px"
              }
            }
          }
        }
      }
    };

    SVGShapesBehavior.prototype.drawShape = function(selection, shape, size) {
      var d, ld, path, s, transitionTime, transitionType;
      d = selection.datum();
      if (d != null) {
        d.shapeData || (d.shapeData = {});
        if (d.shapeData.shape !== shape || d.shapeData.size !== size) {
          d.shapeData.shape = shape;
          d.shapeData.size = size;
        } else {
          return;
        }
      }
      if (selection.selectAll("path")[0].length === 0) {
        path = selection.append("path");
      } else {
        path = selection.select("path");
      }
      if ((this.visualizer.model.get("transition") != null) && (path.attr("data-shape") === shape || (path.attr("data-shape") !== "Circle" && shape !== "Circle"))) {
        transitionType = this.visualizer.model.get("transition")[0];
        transitionTime = this.visualizer.model.get("transition")[1];
        path = path.transition(transitionType).duration(transitionTime);
      }
      s = size;
      ld = Math.max(1.5, s / 6);
      switch (shape) {
        case "Circle":
          path.attr("d", "M-" + s + ",0a" + s + "," + s + " 0 1,0 " + 2 * s + ",0a" + s + "," + s + " 0 1,0 -" + 2 * s + ",0z");
          break;
        case "Square":
          path.attr("d", "M-" + s + ",-" + s + "L" + s + ",-" + s + "L" + s + "," + s + "L-" + s + "," + s + "L-" + s + "-" + s + "z");
          break;
        case "Triangle":
          path.attr("d", "M-" + s + "," + s + "L" + 0 + ",-" + s + "L" + s + "," + s + "L-" + s + "," + s + "z");
          break;
        case "Diamond":
          path.attr("d", "M-" + s + ",0L0,-" + s + "L" + s + ",0L0," + s + "L-" + s + ",0z");
          break;
        case "Line":
          path.attr("d", "M-" + s + ",-" + ld + "L" + s + ",-" + ld + "L" + s + "," + ld + "L-" + s + "," + ld + "L-" + s + ",-" + ld + "z");
          break;
        case "Cross":
          path.attr("d", "M-" + s + ",-" + ld + "L-" + ld + ",-" + ld + "L-" + ld + ",-" + s + "L" + ld + ",-" + s + "L" + ld + ",-" + ld + "L" + s + ",-" + ld + "L" + s + "," + ld + "L" + ld + "," + ld + "L" + ld + "," + s + "L-" + ld + "," + s + "L-" + ld + "," + ld + "L-" + ld + "," + ld + "L-" + s + "," + ld + "L-" + s + ",-" + ld + "z");
      }
      return path.attr("data-shape", shape);
    };

    return SVGShapesBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SelectionBehavior = (function(_super) {
    __extends(SelectionBehavior, _super);

    function SelectionBehavior() {
      this.clearItemOnOver = __bind(this.clearItemOnOver, this);
      this.notifyItemOnOver = __bind(this.notifyItemOnOver, this);
      this.updateGraphicSelection = __bind(this.updateGraphicSelection, this);
      this.getSelectedValues = __bind(this.getSelectedValues, this);
      this.getSelectedValues_OLD = __bind(this.getSelectedValues_OLD, this);
      this.getSelectedIds = __bind(this.getSelectedIds, this);
      this.updateOutput = __bind(this.updateOutput, this);
      this.deselectItem = __bind(this.deselectItem, this);
      this.addIdByMultiSelection = __bind(this.addIdByMultiSelection, this);
      this.addIdBySingleSelection = __bind(this.addIdBySingleSelection, this);
      this.processIdOnSelection = __bind(this.processIdOnSelection, this);
      this.updateMultiSelection = __bind(this.updateMultiSelection, this);
      this.updateSingleSelection = __bind(this.updateSingleSelection, this);
      this.emptySelectionAndAlmostOneModeActived = __bind(this.emptySelectionAndAlmostOneModeActived, this);
      this.selectByIds = __bind(this.selectByIds, this);
      this.preprocessSelectedItems = __bind(this.preprocessSelectedItems, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.executeAfterUpdateStage = __bind(this.executeAfterUpdateStage, this);
      this.initialize = __bind(this.initialize, this);
      _ref = SelectionBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SelectionBehavior.field = "selection";

    SelectionBehavior.stage = "afterUpdate";

    SelectionBehavior.prototype.firstExec = true;

    SelectionBehavior.behaviors = ["quadrigram.Models.ItemsBehavior"];

    SelectionBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(SelectionBehavior.meta, SelectionBehavior.behaviors);
      return output;
    };

    SelectionBehavior.prototype.selectedItems = [];

    SelectionBehavior.meta = {
      "name": "selection",
      "outputs": {
        "selectedIndexes": {
          "outputType": "selection",
          "sortingWeight": "10",
          "default": [],
          "label": "Selected Ids"
        },
        "selectedValues": {
          "outputType": "selection",
          "sortingWeight": "11",
          "default": [],
          "label": "Selected Values"
        },
        "mouseOverItem": {
          "outputType": "OnOver",
          "default": [],
          "label": "Hovered item"
        },
        "selectedColor": {
          "outputType": "styles",
          "default": [],
          "label": "Colors of selection"
        }
      },
      "properties": {
        "forceSelection": {
          "uiTipContent": "Defines if this visualizer must always have at least one element selected. Useful when connecting visualizers.",
          "label": "This visualizer must have at least one element selected",
          "family": "select",
          "sortingWeight": "82",
          "hidden": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "false"
              }
            }
          }
        },
        "selectionMode": {
          "uiTipContent": "Defines if this visualizer can have multiple selection",
          "label": "Selection mode",
          "family": "select",
          "sortingWeight": "83",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "single selection"
              },
              "options": {
                "value": ["no selection", "single selection", "multiple selection"]
              }
            }
          }
        },
        "selectedItems": {
          "uiTipContent": "Defines which items should be selected. Manually input a default selection or insert the output of another visualizer to synchronize them. Click <a href='http://www.quadrigram.com/#tutorialId/connectVisualizers' target='_blank'>here</a> to learn more",
          "label": "Ids of the selected items",
          "family": "select",
          "sortingWeight": "81",
          "hidden": false,
          "formats": {
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            },
            "JustDrop": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": []
              }
            },
            "Number": {
              "hidden": true,
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": []
              }
            }
          }
        },
        "selectionFillColors": {
          "uiTipContent": "Defines the color of the selected items",
          "label": "Fill color of selected items",
          "family": "select",
          "sortingWeight": "84",
          "hidden": true,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#000000"
              }
            }
          }
        },
        "selectionFillOpacities": {
          "uiTipContent": "Defines the opacity of the selected items",
          "label": "Fill opacity of selected items",
          "family": "select",
          "sortingWeight": "85",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "100"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionLineColors": {
          "uiTipContent": "Defines the color of the outline for the selected items",
          "label": "Outline color of selected items",
          "family": "select",
          "sortingWeight": "86",
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#2861ff"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionLineThickness": {
          "uiTipContent": "Defines the thickness of the outline for the selected items",
          "label": "Line thickness of selected items",
          "family": "select",
          "sortingWeight": "87",
          "hidden": true,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "2px"
              }
            }
          }
        },
        "selectionLineOpacities": {
          "uiTipContent": "Defines the opacity of the outline for the selected items",
          "label": "Line opacity of selected items",
          "family": "select",
          "sortingWeight": "88",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "100"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionBold": {
          "uiTipContent": "Defines if selected items should be in bold",
          "label": "Selected element font weight",
          "family": "select",
          "sortingWeight": "84",
          "internal": true,
          "hidden": true,
          "formats": {
            "Boolean": {
              "defaults": {
                "value": "false"
              }
            }
          }
        }
      }
    };

    SelectionBehavior.prototype.initialize = function(params) {
      var selectionEvent;
      this.colorScale = d3.scale.ordinal();
      if (quadrigram.router.getDevice() !== "Desktop") {
        selectionEvent = "touchstart";
      } else {
        selectionEvent = "click";
      }
      return this.config = {
        selectionLineColors: "#000000",
        selectionEvent: selectionEvent,
        multiselection: false,
        forceSelection: false
      };
    };

    SelectionBehavior.prototype.executeAfterUpdateStage = function() {
      var ids, items, model, newSelection, values;
      model = this.visualizer.model;
      items = this.visualizer.items;
      values = this.visualizer.values;
      ids = this.visualizer.idsItems;
      if (!ids) {
        ids = this.visualizer.ids;
      }
      this.changedItems = (this.visualizer.model.changed["fillColors"] != null) || (this.visualizer.model.changed["fillOpacities"] != null) || (this.visualizer.model.changed["lineColors"] != null) || (this.visualizer.model.changed["lineThickness"] != null) || (this.visualizer.model.changed["lineOpacities"] != null) || (this.visualizer.model.changed["cellHeight"] != null) || (this.visualizer.model.changed["shapeType"] != null) || (this.visualizer.model.changed["shapeSize"] != null) || this.visualizer.changedData || this.firstExec;
      this.changedSelection = (this.visualizer.model.changed["selectionMode"] != null) || (this.visualizer.model.changed["selectedItems"] != null) || (this.visualizer.model.changed["selectionFillColors"] != null) || (this.visualizer.model.changed["selectionFillOpacities"] != null) || (this.visualizer.model.changed["selectionLineColors"] != null) || (this.visualizer.model.changed["selectionLineThickness"] != null) || (this.visualizer.model.changed["selectionLineOpacities"] != null) || (this.visualizer.model.changed["forceSelection"] != null) || this.visualizer.changedData || this.firstExec;
      this.changed = this.changedSelection || this.changedItems;
      if (!this.changedSelection) {
        newSelection = this.selectedItems;
      } else {
        newSelection = model.get("selectedItems");
      }
      if (this.changed) {
        return this.updateConfig({
          itemsEnter: items,
          values: values,
          ids: ids,
          fillColors: model.get("fillColors"),
          fillOpacities: model.get("fillOpacities"),
          lineColors: model.get("lineColors"),
          lineThickness: model.get("lineThickness"),
          lineOpacities: model.get("lineOpacities"),
          selectedItems: newSelection,
          selectionFillColors: model.get("selectionFillColors"),
          selectionFillOpacities: model.get("selectionFillOpacities"),
          selectionLineColors: model.get("selectionLineColors"),
          selectionLineThickness: model.get("selectionLineThickness"),
          selectionLineOpacities: model.get("selectionLineOpacities"),
          forceSelection: model.get("forceSelection") === "true",
          selectionMode: model.get("selectionMode"),
          selectionBold: model.get("selectionBold")
        });
      }
    };

    SelectionBehavior.prototype.updateConfig = function(newConfig) {
      var field, options, self;
      if (this.changedItems) {
        this.behaviors.items.updateConfig(newConfig);
      }
      for (field in newConfig) {
        this.config[field] = newConfig[field];
      }
      self = this;
      this.config.itemsEnter.on(this.config.selectionEvent, function(d, i) {
        return self.processIdOnSelection(d.id);
      });
      this.config.itemsEnter.on("mouseover", function(d, i) {
        return self.notifyItemOnOver(d);
      });
      this.config.itemsEnter.on("mouseout", function(d, i) {
        return self.clearItemOnOver();
      });
      options = {};
      if (!this.changedSelection) {
        options.preserve = true;
      }
      this.config.selectedItems = this.preprocessSelectedItems(this.config.selectedItems);
      if ((this.visualizer.model.changed["selectedItems"] != null) || (this.visualizer.model.changed["selectionMode"] != null) || (this.visualizer.model.changed["forceSelection"] != null) || this.visualizer.changedData || this.firstExec) {
        this.selectByIds(this.config.selectedItems);
      } else {
        this.updateGraphicSelection(options);
      }
      return this.firstExec = false;
    };

    SelectionBehavior.prototype.preprocessSelectedItems = function(source) {
      var candidateId, output, sourceItem, _i, _len;
      output = [];
      if (_.isArray(source)) {
        for (_i = 0, _len = source.length; _i < _len; _i++) {
          sourceItem = source[_i];
          if (sourceItem.value) {
            candidateId = sourceItem.value;
          } else {
            candidateId = sourceItem;
          }
          if (this.config.ids.indexOf(candidateId) !== -1) {
            output.push(candidateId);
          }
        }
      } else {
        if (!source || source === "") {
          output = [];
        } else {
          if (this.config.ids.indexOf(source) !== -1) {
            output = [source];
          } else {
            output = [];
          }
        }
      }
      return output;
    };

    SelectionBehavior.prototype.selectByIds = function(selectedIds) {
      var selectionMode, unionArray;
      if ((!selectedIds || selectedIds.length === 0 || selectedIds === "") && this.config.forceSelection) {
        this.emptySelectionAndAlmostOneModeActived();
      } else {
        unionArray = _.union(selectedIds, this.selectedItems);
        if ((unionArray.length === selectedIds.length) && (unionArray.length === this.selectedItems.length)) {
          return;
        }
        selectionMode = this.config.selectionMode;
        if (!selectionMode) {
          selectionMode = "single selection";
        }
        switch (selectionMode) {
          case "no selection":
            this.updateSingleSelection("");
            break;
          case "single selection":
            this.updateSingleSelection(selectedIds);
            break;
          case "multiple selection":
            this.updateMultiSelection(selectedIds);
            break;
          case "disabled":
            this.updateSingleSelection("");
            break;
          default:
            this.updateSingleSelection(selectedIds);
        }
      }
      this.updateGraphicSelection();
      return this.updateOutput();
    };

    SelectionBehavior.prototype.emptySelectionAndAlmostOneModeActived = function() {
      var visualizerIds;
      visualizerIds = this.config.ids;
      if (visualizerIds.length > 0) {
        return this.selectedItems = [visualizerIds[0]];
      }
    };

    SelectionBehavior.prototype.updateSingleSelection = function(selectedIds) {
      if (_.isArray(selectedIds)) {
        if (selectedIds.length > 1) {
          return this.selectedItems = [selectedIds[0]];
        } else {
          return this.selectedItems = selectedIds;
        }
      } else {
        if (selectedIds === "") {
          return this.selectedItems = [];
        } else {
          return this.selectedItems = [selectedIds];
        }
      }
    };

    SelectionBehavior.prototype.updateMultiSelection = function(selectedIds) {
      if (_.isArray(selectedIds)) {
        return this.selectedItems = selectedIds;
      } else {
        if (selectedIds === "") {
          return this.selectedItems = [];
        } else {
          return this.selectedItems = [selectedIds];
        }
      }
    };

    SelectionBehavior.prototype.processIdOnSelection = function(id) {
      var selectionMode;
      if (this.selectedItems.indexOf(id) >= 0) {
        this.deselectItem(id);
      } else {
        selectionMode = this.visualizer.model.get("selectionMode");
        if (!selectionMode) {
          selectionMode = "single selection";
        }
        switch (selectionMode) {
          case "no selection":
            break;
          case "single selection":
            this.addIdBySingleSelection(id);
            break;
          case "multiple selection":
            this.addIdByMultiSelection(id);
            break;
          case "disabled":
            this.addIdBySingleSelection("");
            break;
        }
      }
      this.updateOutput();
      return this.updateGraphicSelection();
    };

    SelectionBehavior.prototype.addIdBySingleSelection = function(id) {
      return this.selectedItems = [id];
    };

    SelectionBehavior.prototype.addIdByMultiSelection = function(id) {
      this.selectedItems.push(id);
      return log(this.selectedItems);
    };

    SelectionBehavior.prototype.deselectItem = function(id) {
      var index;
      index = this.selectedItems.indexOf(id);
      if (index === -1) {
        return;
      }
      if (this.selectedItems.length > 1) {
        return this.selectedItems.splice(index, 1);
      } else {
        if (!this.config.forceSelection) {
          return this.selectedItems = [];
        }
      }
    };

    SelectionBehavior.prototype.updateOutput = function() {
      var ids, itemId, selectedColors, selectedIds, styleItem, values, _i, _len, _ref1;
      this.trigger("selection:change");
      selectedIds = [];
      ids = this.getSelectedIds();
      values = this.getSelectedValues();
      this.visualizer.updateOutput("selectedIndexes", ids, ids.metadata);
      this.visualizer.updateOutput("selectedValues", values, values.metadata);
      selectedColors = [];
      _ref1 = this.selectedItems;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        itemId = _ref1[_i];
        styleItem = this.behaviors.items.styleItems[itemId];
        if (styleItem) {
          selectedColors.push({
            id: itemId,
            value: styleItem.fillColors
          });
        }
      }
      return this.visualizer.updateOutput("selectedColor", selectedColors);
    };

    SelectionBehavior.prototype.getSelectedIds = function() {
      var idEntry, output, _i, _len, _ref1;
      if (!_.isArray(this.selectedItems)) {
        return this.selectedItems;
      }
      if (this.selectedItems.length <= 1) {
        return this.selectedItems;
      }
      output = [];
      output.label = this.visualizer.values.label;
      output.metadata = this.visualizer.values.metadata;
      _ref1 = this.selectedItems;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        idEntry = _ref1[_i];
        output.push({
          id: idEntry,
          value: idEntry
        });
      }
      return output;
    };

    SelectionBehavior.prototype.getSelectedValues_OLD = function() {
      var dim, dimensions, idEntry, output, value, valueEntry, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _ref3;
      if (!_.isArray(this.selectedItems)) {
        return this.selectedItems;
      }
      if (this.selectedItems.length === 0) {
        return [];
      }
      output = [];
      output.label = this.visualizer.values.label;
      output.metadata = this.visualizer.values.metadata;
      _ref1 = this.selectedItems;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        idEntry = _ref1[_i];
        _ref2 = this.visualizer.values;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          valueEntry = _ref2[_j];
          if (valueEntry.id === idEntry) {
            if (valueEntry.dataDimensions) {
              dimensions = [];
              _ref3 = valueEntry.dataDimensions;
              for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
                dim = _ref3[_k];
                dimensions.push({
                  id: dim,
                  value: valueEntry[dim]
                });
              }
              value = new quadrigram.Models.DataBlockData(dimensions);
              value.metaData = {
                idLabel: "dimension",
                valueLabel: "id"
              };
              output.push({
                id: valueEntry.id,
                value: value
              });
            } else {
              if (_.isArray(valueEntry.value) && valueEntry.value.length > 1) {
                value = new quadrigram.Models.DataBlockData(valueEntry.value);
                value.metaData = {
                  idLabel: "id",
                  valueLabel: "value"
                };
              } else {
                value = valueEntry.value;
              }
              output.push({
                id: valueEntry.id,
                value: value
              });
            }
            break;
          }
        }
      }
      return output;
    };

    SelectionBehavior.prototype.getSelectedValues = function() {
      var dim, entries, idEntry, output, sampleEntry, value, valueEntry, _i, _j, _k, _l, _len, _len1, _len2, _len3, _len4, _m, _ref1, _ref2, _ref3, _ref4, _ref5;
      if (!_.isArray(this.selectedItems)) {
        return this.selectedItems;
      }
      if (this.selectedItems.length === 0 || (this.visualizer.values == null)) {
        return [];
      }
      output = [];
      output.label = "output";
      output.metadata = {};
      sampleEntry = this.visualizer.values[0];
      if (sampleEntry && sampleEntry.dataDimensions) {
        output.metadata.idLabel = "dimension";
        output.metadata.valueLabel = "id";
        _ref1 = sampleEntry.dataDimensions;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          dim = _ref1[_i];
          entries = [];
          _ref2 = this.selectedItems;
          for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
            idEntry = _ref2[_j];
            _ref3 = this.visualizer.values;
            for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
              valueEntry = _ref3[_k];
              if (valueEntry.id === idEntry) {
                entries.push({
                  id: valueEntry.id,
                  value: valueEntry[dim]
                });
              }
            }
          }
          value = new quadrigram.Models.DataBlockData(entries);
          value.set("label", "values of " + dim);
          value.metaData = {
            idLabel: "id",
            valueLabel: dim
          };
          output.push({
            id: dim,
            value: value
          });
        }
      } else {
        output.metadata.idLabel = "id";
        output.metadata.valueLabel = "value";
        _ref4 = this.selectedItems;
        for (_l = 0, _len3 = _ref4.length; _l < _len3; _l++) {
          idEntry = _ref4[_l];
          _ref5 = this.visualizer.values;
          for (_m = 0, _len4 = _ref5.length; _m < _len4; _m++) {
            valueEntry = _ref5[_m];
            if (valueEntry.id === idEntry) {
              if (_.isArray(valueEntry.value) && valueEntry.value.length > 1) {
                value = new quadrigram.Models.DataBlockData(valueEntry.value);
                value.set("label", "values of " + valueEntry.id);
                value.metaData = {
                  idLabel: "id",
                  valueLabel: "value"
                };
              } else {
                value = valueEntry.value;
              }
              output.push({
                id: valueEntry.id,
                value: value
              });
            }
          }
        }
      }
      return output;
    };

    SelectionBehavior.prototype.updateGraphicSelection = function() {};

    SelectionBehavior.prototype.notifyItemOnOver = function(item) {
      return this.visualizer.updateOutput("mouseOverItem", item.id);
    };

    SelectionBehavior.prototype.clearItemOnOver = function() {
      return this.visualizer.updateOutput("mouseOverItem", "");
    };

    return SelectionBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SelectionDOMBehavior = (function(_super) {
    __extends(SelectionDOMBehavior, _super);

    function SelectionDOMBehavior() {
      this.updateGraphicSelection = __bind(this.updateGraphicSelection, this);
      _ref = SelectionDOMBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SelectionDOMBehavior.behaviors = ["quadrigram.Models.ItemsDOMBehavior"];

    SelectionDOMBehavior.prototype.updateGraphicSelection = function() {
      var items, selectedItems, self;
      self = this;
      this.behaviors.items.updateConfig(this.config);
      items = d3.select(this.visualizer.el).selectAll(".item");
      items.classed("selected", function(d, i) {
        return self.selectedItems.indexOf(d.id) >= 0;
      });
      selectedItems = items.filter(".selected");
      selectedItems.style("z-index", "1");
      selectedItems.selectAll(".item-child").style("background-color", function(d, i) {
        var color, colorRGB, opacity, style;
        color = self.config.selectionFillColors;
        if (color === "@QDeactivatedWord") {
          color = $(this).css('background-color');
        }
        colorRGB = d3.rgb(color);
        opacity = color === 'none' || color === '' ? 0 : self.config.selectionFillOpacities / 100;
        style = "rgba(" + colorRGB.r + "," + colorRGB.g + "," + colorRGB.b + "," + opacity + ")";
        return style;
      }).style("box-shadow", function(d, i) {
        var color, colorRGB, opacity, rgba, thickness;
        color = self.config.selectionLineColors;
        if (color === "@QDeactivatedWord") {
          return "transparent";
        } else {
          colorRGB = d3.rgb(color);
          opacity = color === "none" || color === "" ? 0 : self.config.selectionLineOpacities / 100;
          thickness = self.config.selectionLineThickness;
          rgba = "rgba(" + colorRGB.r + "," + colorRGB.g + "," + colorRGB.b + "," + opacity + ")";
          return "inset 0px 0px 0px " + thickness + " " + rgba;
        }
      });
      return items;
    };

    return SelectionDOMBehavior;

  })(quadrigram.Models.SelectionBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SelectionSVGBehavior = (function(_super) {
    __extends(SelectionSVGBehavior, _super);

    function SelectionSVGBehavior() {
      this.updateGraphicSelection = __bind(this.updateGraphicSelection, this);
      _ref = SelectionSVGBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SelectionSVGBehavior.behaviors = ["quadrigram.Models.ItemsSVGBehavior"];

    SelectionSVGBehavior.prototype.updateGraphicSelection = function(options) {
      var items, nonSelectedItems, selectedItems, self;
      options || (options = {});
      self = this;
      items = d3.select(this.visualizer.el).selectAll(".item");
      items.classed("selected", function(d, i) {
        return self.selectedItems.indexOf(d.id) >= 0;
      });
      selectedItems = items.filter(".selected");
      if (!options.preserve) {
        nonSelectedItems = items.filter(":not(.selected)");
      }
      if (this.config.selectionFillColors !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("fillTransition").duration(0).attr("fill", this.config.selectionFillColors);
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("fill", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillColors"];
            }
          });
        }
      } else {
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("fill", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillColors"];
            }
          });
        }
        selectedItems.transition("fillTransition").attr("fill", function(d, i) {
          if (self.behaviors.items.styleItems[d.id]) {
            return self.behaviors.items.styleItems[d.id]["fillColors"];
          }
        });
      }
      if (this.config.selectionFillOpacities !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("opacityTransition").duration(0).attr("fill-opacity", this.config.selectionFillOpacities / 100);
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("fill-opacity", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillOpacities"] / 100;
            }
          });
        }
      } else {
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("fill-opacity", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillOpacities"] / 100;
            }
          });
        }
        selectedItems.transition("opacityTransition").attr("fill-opacity", function(d, i) {
          if (self.behaviors.items.styleItems[d.id]) {
            return self.behaviors.items.styleItems[d.id]["fillOpacities"] / 100;
          }
        });
      }
      if (this.config.selectionLineColors !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("strokeTransition").duration(0).attr("stroke", this.config.selectionLineColors);
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineColors"];
            }
          });
        }
      } else {
        selectedItems.attr("stroke", function(d, i) {
          if (self.behaviors.items.styleItems[d.id]) {
            return self.behaviors.items.styleItems[d.id]["lineColors"];
          }
        });
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineColors"];
            }
          });
        }
      }
      if (this.config.selectionLineThickness !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("strokeWidthTransition").duration(0).attr("stroke-width", function() {
          var strokeWidth;
          this.parentNode.appendChild(this);
          if (self.config.selectionLineThickness) {
            return self.config.selectionLineThickness;
          } else {
            strokeWidth = d3.select(this).attr("stroke-width");
            if (_.isNumber(+strokeWidth)) {
              strokeWidth = +strokeWidth + 2;
            } else {
              strokeWidth = 2;
            }
            return strokeWidth;
          }
        });
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke-width", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineThickness"];
            }
          });
        }
      } else {
        selectedItems.attr("stroke-width", function(d, i) {
          if (self.behaviors.items.styleItems[d.id]) {
            return self.behaviors.items.styleItems[d.id]["lineThickness"];
          }
        });
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke-width", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineThickness"];
            }
          });
        }
      }
      if (this.config.selectionLineOpacities !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("strokeOpacityTransition").duration(0).attr("stroke-opacity", this.config.selectionLineOpacities / 100);
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke-opacity", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineOpacities"] / 100;
            }
          });
        }
      } else {
        selectedItems.attr("stroke-opacity", function(d, i) {
          if (self.behaviors.items.styleItems[d.id]) {
            return self.behaviors.items.styleItems[d.id]["lineOpacities"] / 100;
          }
        });
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke-opacity", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineOpacities"] / 100;
            }
          });
        }
      }
      return selectedItems.style("z-index", 1000);
    };

    return SelectionSVGBehavior;

  })(quadrigram.Models.SelectionBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SelectionDOMwithSVGBehavior = (function(_super) {
    __extends(SelectionDOMwithSVGBehavior, _super);

    function SelectionDOMwithSVGBehavior() {
      this.updateGraphicSelection = __bind(this.updateGraphicSelection, this);
      _ref = SelectionDOMwithSVGBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SelectionDOMwithSVGBehavior.behaviors = ["quadrigram.Models.ItemsDOMwithSVGBehavior"];

    SelectionDOMwithSVGBehavior.prototype.updateGraphicSelection = function() {
      var items, nonSelectedItems, selectedItems, self;
      self = this;
      this.behaviors.items.updateConfig(this.config);
      items = d3.select(this.visualizer.el).selectAll(".item");
      items.classed("selected", function(d, i) {
        return self.selectedItems.indexOf(d.id) >= 0;
      });
      selectedItems = items.filter(".selected");
      nonSelectedItems = items.filter(":not(.selected)");
      selectedItems.style("z-index", "1");
      nonSelectedItems.selectAll(".item-child").attr("stroke", function(d, i) {
        return self.behaviors.items.styleItems[d.id]["lineColors"];
      }).attr("stroke-width", function() {
        return 0;
      });
      selectedItems.selectAll(".item-child").attr("stroke", function(d, i) {
        return self.config.selectionLineColors;
      }).attr("stroke-width", function() {
        return self.config.selectionLineThickness;
      });
      /*
      .style("fill", (d,i) ->
        color = self.config.selectionFillColors
      
        # if color is deactivated use the one that already have the background
        if color is "@QDeactivatedWord"
          color = $(@).css('background-color')
      
        colorRGB = d3.rgb(color)
        opacity = if color is 'none' || color is '' then 0 else self.config.selectionFillOpacities / 100
        style = "rgba("+colorRGB.r+","+colorRGB.g+","+colorRGB.b+","+opacity+")"
        style
      )
      */

      /*
      .style("stroke", (d,i)->
        color = self.config.selectionLineColors
        colorRGB = d3.rgb(color)
        opacity = if color is "none" || color is "" then 0 else self.config.selectionLineOpacities / 100
        thickness = self.config.selectionLineThickness
        rgba = "rgba("+colorRGB.r+","+colorRGB.g+","+colorRGB.b+","+opacity+")"
        return "inset 0px 0px 0px "+thickness+" "+rgba
      )
      */

      return items;
    };

    return SelectionDOMwithSVGBehavior;

  })(quadrigram.Models.SelectionBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SelectionNetworkBehavior = (function(_super) {
    __extends(SelectionNetworkBehavior, _super);

    function SelectionNetworkBehavior() {
      this.updateOutput = __bind(this.updateOutput, this);
      this.updateGraphicSelection = __bind(this.updateGraphicSelection, this);
      this.updateGraphicSelection_OLD = __bind(this.updateGraphicSelection_OLD, this);
      _ref = SelectionNetworkBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SelectionNetworkBehavior.behaviors = ["quadrigram.Models.ItemsSVGBehavior"];

    SelectionNetworkBehavior.field = "selectionNetwork";

    SelectionNetworkBehavior.info = function() {
      var meta, output;
      meta = JSON.parse(JSON.stringify(SelectionNetworkBehavior.meta));
      SelectionNetworkBehavior.meta = output = quadrigram.Models.VisualizerModel.mergeInfo(_.deepObjectExtend(meta, SelectionNetworkBehavior.extendedMeta), SelectionNetworkBehavior.behaviors);
      return output;
    };

    SelectionNetworkBehavior.extendedMeta = {
      "properties": {
        "selectRelationsMode": {
          "uiTipContent": "Defines what is shown when a node is selected",
          "label": "Highlight neigthbours",
          "family": "select",
          "sortingWeight": "83",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Highlight relatated"
              },
              "options": {
                "value": ["Highlight relatated", "No highlight"]
              }
            }
          }
        }
      },
      "outputs": {
        "relatedNodes": {
          "outputType": "selection",
          "default": [],
          "label": "Nodes related to selection"
        }
      }
    };

    /*
    executeAfterUpdateStage:() =>
      super()
      @on("selection:change",@updateOutput)
    */


    SelectionNetworkBehavior.prototype.updateGraphicSelection_OLD = function() {
      var nodesItems, relsItems, self;
      self = this;
      this.behaviors.items.updateConfig(this.config);
      this.visualizer.behaviors.relations.updateConfig(this.visualizer.behaviors.relations.config);
      nodesItems = d3.select(this.visualizer.el).selectAll(".item");
      relsItems = d3.select(this.visualizer.el).selectAll(".link");
      nodesItems.classed("selected", function(d, i) {
        return self.selectedItems.indexOf(d.id) >= 0;
      });
      if (self.highlightedItems != null) {
        nodesItems.classed("highlighted", function(d, i) {
          return self.highlightedItems.indexOf(d.id) >= 0;
        });
      }
      if (self.highlightedRels != null) {
        relsItems.classed("highlighted", function(d, i) {
          return self.highlightedRels.indexOf(d.id) >= 0;
        });
      }
      if (this.config.selectionFillColors !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        nodesItems.filter(".selected").attr("fill", this.config.selectionFillColors);
      }
      if (this.config.selectionFillOpacities !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        nodesItems.filter(".selected").attr("fill-opacity", this.config.selectionFillOpacities / 100);
      }
      if (this.config.selectionLineColors !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        nodesItems.filter(".selected").attr("stroke", this.config.selectionLineColors);
      }
      if (this.config.selectionLineThickness !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        nodesItems.filter(".selected").attr("stroke-width", function() {
          var strokeWidth;
          this.parentNode.appendChild(this);
          if (self.config.selectionLineThickness) {
            return self.config.selectionLineThickness;
          } else {
            strokeWidth = d3.select(this).attr("stroke-width");
            if (_.isNumber(+strokeWidth)) {
              strokeWidth = +strokeWidth + 2;
            } else {
              strokeWidth = 2;
            }
            return strokeWidth;
          }
        });
      }
      if (this.config.selectionLineOpacities !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        nodesItems.filter(".selected").attr("stroke-opacity", this.config.selectionLineOpacities);
      }
      nodesItems.filter(".selected").style("z-index", 1000);
      if ((self.highlightedRels != null) && self.highlightedRels.length > 0 || ((self.highlightedItems != null) && self.highlightedItems.length > 0)) {
        relsItems.attr("stroke-opacity", "0.2").style("z-index", 0);
        relsItems.filter(".selected,.highlighted").attr("stroke-opacity", "1").style("z-index", 1000);
        nodesItems.attr("fill-opacity", "0.4").style("z-index", 0);
        return nodesItems.filter(".selected,.highlighted").attr("fill-opacity", "1").style("z-index", 1000);
      } else {

      }
    };

    SelectionNetworkBehavior.prototype.updateGraphicSelection = function(options) {
      var nodesItems, nonSelectedNodes, nonSelectedRels, relsItems, selectedNodes, selectedRels, self;
      options || (options = {});
      self = this;
      nodesItems = d3.select(this.visualizer.el).selectAll(".item");
      relsItems = d3.select(this.visualizer.el).selectAll(".link");
      nodesItems.classed("selected", function(d, i) {
        return self.selectedItems.indexOf(d.id) >= 0;
      });
      if (self.highlightedItems != null) {
        nodesItems.classed("highlighted", function(d, i) {
          return self.highlightedItems.indexOf(d.id) >= 0;
        });
      }
      if (self.highlightedRels != null) {
        relsItems.classed("highlighted", function(d, i) {
          return self.highlightedRels.indexOf(d.id) >= 0;
        });
      }
      selectedNodes = nodesItems.filter(".selected");
      if (!options.preserve) {
        nonSelectedNodes = nodesItems.filter(":not(.selected)");
      }
      selectedRels = relsItems.filter(".selected");
      if (!options.preserve) {
        nonSelectedRels = relsItems.filter(":not(.selected)");
      }
      if (this.config.selectionFillColors !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedNodes.transition("fillTransition").duration(0).attr("fill", this.config.selectionFillColors);
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("fill", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillColors"];
            }
          });
        }
      } else {
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("fill", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillColors"];
            }
          });
        }
        selectedNodes.transition("fillTransition").attr("fill", function(d, i) {
          if (self.behaviors.items.styleItems[d.id]) {
            return self.behaviors.items.styleItems[d.id]["fillColors"];
          }
        });
      }
      if (this.config.selectionFillOpacities !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedNodes.transition("opacityTransition").duration(0).attr("fill-opacity", this.config.selectionFillOpacities / 100);
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("fill-opacity", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillOpacities"] / 100;
            }
          });
        }
      } else {
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("fill-opacity", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillOpacities"] / 100;
            }
          });
        }
        selectedNodes.transition("opacityTransition").attr("fill-opacity", function(d, i) {
          if (self.behaviors.items.styleItems[d.id]) {
            return self.behaviors.items.styleItems[d.id]["fillOpacities"] / 100;
          }
        });
      }
      if (this.config.selectionLineColors !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedNodes.transition("strokeTransition").duration(0).attr("stroke", this.config.selectionLineColors);
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("stroke", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineColors"];
            }
          });
        }
      } else {
        selectedNodes.attr("stroke", function(d, i) {
          if (self.behaviors.items.styleItems[d.id]) {
            return self.behaviors.items.styleItems[d.id]["lineColors"];
          }
        });
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("stroke", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineColors"];
            }
          });
        }
      }
      if (this.config.selectionLineThickness !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedNodes.transition("strokeWidthTransition").duration(0).attr("stroke-width", function() {
          var strokeWidth;
          this.parentNode.appendChild(this);
          if (self.config.selectionLineThickness) {
            return self.config.selectionLineThickness;
          } else {
            strokeWidth = d3.select(this).attr("stroke-width");
            if (_.isNumber(+strokeWidth)) {
              strokeWidth = +strokeWidth + 2;
            } else {
              strokeWidth = 2;
            }
            return strokeWidth;
          }
        });
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("stroke-width", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineThickness"];
            }
          });
        }
      }
      if (this.config.selectionLineOpacities !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedNodes.transition("strokeOpacityTransition").duration(0).attr("stroke-opacity", this.config.selectionLineOpacities / 100);
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("stroke-opacity", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["lineOpacities"] / 100;
            }
          });
        }
      }
      if (((self.highlightedRels != null) && self.highlightedRels.length > 0) || ((self.highlightedItems != null) && self.highlightedItems.length > 0)) {
        relsItems.attr("stroke-opacity", "0.2").style("z-index", 0);
        relsItems.filter(".selected,.highlighted").attr("stroke-opacity", "1").style("z-index", 1000);
        nodesItems.attr("fill-opacity", "0.4").style("z-index", 0);
        return nodesItems.filter(".selected,.highlighted").attr("fill-opacity", "1").style("z-index", 1000);
      } else {
        if (nonSelectedNodes != null) {
          nonSelectedNodes.attr("fill-opacity", function(d, i) {
            if (self.behaviors.items.styleItems[d.id]) {
              return self.behaviors.items.styleItems[d.id]["fillOpacities"] / 100;
            }
          });
        }
        if (nonSelectedRels != null) {
          return nonSelectedRels.attr("stroke-opacity", function(d, i) {
            if (self.visualizer.behaviors.relations.styleItems[d.id]) {
              return self.visualizer.behaviors.relations.styleItems[d.id]["linkOpacities"] / 100;
            }
          });
        }
      }
    };

    SelectionNetworkBehavior.prototype.updateOutput = function() {
      var itemId, node, rel, relatedNodes, relatedRelations, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _ref2;
      SelectionNetworkBehavior.__super__.updateOutput.call(this);
      relatedNodes = [];
      relatedRelations = [];
      this.highlightedItems = [];
      this.highlightedRels = [];
      _ref1 = this.selectedItems;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        itemId = _ref1[_i];
        _ref2 = this.visualizer.networkObject.relations;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          rel = _ref2[_j];
          if (rel.source.id === itemId) {
            relatedRelations.push(rel.id);
            relatedNodes.push(rel.target.id);
          } else if (rel.target.id === itemId) {
            relatedRelations.push(rel.id);
            relatedNodes.push(rel.source.id);
          }
        }
        if (this.visualizer.model.get("selectRelationsMode") === "Highlight relatated") {
          log("should highlight ", relatedNodes);
          for (_k = 0, _len2 = relatedNodes.length; _k < _len2; _k++) {
            node = relatedNodes[_k];
            if (this.highlightedItems.indexOf(node) < 0) {
              this.highlightedItems.push(node);
            }
          }
          for (_l = 0, _len3 = relatedRelations.length; _l < _len3; _l++) {
            rel = relatedRelations[_l];
            if (this.highlightedRels.indexOf(rel) < 0) {
              this.highlightedRels.push(rel);
            }
          }
        } else {
          log("do nothing as selecion behav already selected it...");
        }
        /*
        else if @visualizer.model.get("selectRelationsMode") == "Highlight selected"
          log "should highlight ",relatedNodes
          for node in relatedNodes
            if @highlightedItems.indexOf(node)<0
              @highlightedItems.push(node)
        */

      }
      return this.visualizer.updateOutput("relatedNodes", relatedNodes);
    };

    return SelectionNetworkBehavior;

  }).call(this, quadrigram.Models.SelectionBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SelectionRadialNetworkBehavior = (function(_super) {
    __extends(SelectionRadialNetworkBehavior, _super);

    function SelectionRadialNetworkBehavior() {
      this.resetSelection = __bind(this.resetSelection, this);
      this.updateOutput = __bind(this.updateOutput, this);
      this.getSelectedItems = __bind(this.getSelectedItems, this);
      this.clearItemOnOver = __bind(this.clearItemOnOver, this);
      this.notifyItemOnOver = __bind(this.notifyItemOnOver, this);
      this.selectNode = __bind(this.selectNode, this);
      this.updateGraphicSelection = __bind(this.updateGraphicSelection, this);
      _ref = SelectionRadialNetworkBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SelectionRadialNetworkBehavior.behaviors = ['quadrigram.Models.ItemsSVGBehavior'];

    SelectionRadialNetworkBehavior.field = 'selectionRadialNetwork';

    SelectionRadialNetworkBehavior.isNodeSelected = false;

    SelectionRadialNetworkBehavior.info = function() {
      var meta, output;
      meta = JSON.parse(JSON.stringify(SelectionRadialNetworkBehavior.meta));
      SelectionRadialNetworkBehavior.meta = output = quadrigram.Models.VisualizerModel.mergeInfo(_.deepObjectExtend(meta, SelectionRadialNetworkBehavior.extendedMeta), SelectionRadialNetworkBehavior.behaviors);
      return output;
    };

    SelectionRadialNetworkBehavior.extendedMeta = {
      'properties': {
        'selectionFillColors': {
          'internal': true
        },
        'selectionFillOpacities': {
          'internal': true
        },
        'selectionLineColors': {
          'internal': true
        },
        'selectionLineThickness': {
          'internal': true
        },
        'selectionLineOpacities': {
          'internal': true
        },
        'selectionBold': {
          'internal': true
        }
      }
    };

    SelectionRadialNetworkBehavior.prototype.updateGraphicSelection = function() {
      var index, nodeID, _i, _len, _ref1;
      this.resetSelection();
      _ref1 = this.getSelectedItems();
      for (index = _i = 0, _len = _ref1.length; _i < _len; index = ++_i) {
        nodeID = _ref1[index];
        nodeID = _.isObject(nodeID) ? nodeID.id : nodeID;
        this.selectNode(this.visualizer.nodesMap[nodeID], index > 0);
      }
      if (this.getSelectedItems().length > 0) {
        return this.isNodeSelected = true;
      } else {
        return this.isNodeSelected = false;
      }
    };

    SelectionRadialNetworkBehavior.prototype.selectNode = function(nodeSelected, multiSelection) {
      if (!multiSelection) {
        this.visualizer.items.style('opacity', 0.2);
        this.visualizer.linksItems.style('opacity', 0.2);
      }
      this.visualizer.linksItems.filter(function(d) {
        if (d.source === nodeSelected) {
          d.target.highlight = true;
        }
        if (d.target === nodeSelected) {
          d.source.highlight = true;
        }
        return d.target === nodeSelected || d.source === nodeSelected;
      }).style('opacity', 1);
      return this.visualizer.items.filter(function(d) {
        return d === nodeSelected || d.highlight;
      }).style('opacity', 1);
    };

    SelectionRadialNetworkBehavior.prototype.notifyItemOnOver = function(nodeSelected) {
      if (!this.isNodeSelected) {
        this.selectNode(nodeSelected);
      }
      return SelectionRadialNetworkBehavior.__super__.notifyItemOnOver.call(this, nodeSelected);
    };

    SelectionRadialNetworkBehavior.prototype.clearItemOnOver = function() {
      if (!this.isNodeSelected) {
        this.resetSelection();
      }
      return SelectionRadialNetworkBehavior.__super__.clearItemOnOver.call(this);
    };

    SelectionRadialNetworkBehavior.prototype.getSelectedItems = function() {
      if (_.isArray(this.selectedItems)) {
        return this.selectedItems;
      } else {
        return [this.selectedItems];
      }
    };

    SelectionRadialNetworkBehavior.prototype.updateOutput = function() {
      var itemId, node, rel, relatedNodes, relatedRelations, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1, _ref2;
      SelectionRadialNetworkBehavior.__super__.updateOutput.call(this);
      relatedNodes = [];
      relatedRelations = [];
      this.highlightedItems = [];
      this.highlightedRels = [];
      _ref1 = this.getSelectedItems();
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        itemId = _ref1[_i];
        _ref2 = this.visualizer.networkObject.links;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          rel = _ref2[_j];
          if (rel.source.id === itemId) {
            relatedRelations.push(rel.id);
            relatedNodes.push(rel.target.id);
          } else if (rel.target.id === itemId) {
            relatedRelations.push(rel.id);
            relatedNodes.push(rel.source.id);
          }
        }
        if (this.visualizer.model.get('selectRelationsMode') === 'Highlight relatated') {
          for (_k = 0, _len2 = relatedNodes.length; _k < _len2; _k++) {
            node = relatedNodes[_k];
            if (this.highlightedItems.indexOf(node) < 0) {
              this.highlightedItems.push(node);
            }
          }
          for (_l = 0, _len3 = relatedRelations.length; _l < _len3; _l++) {
            rel = relatedRelations[_l];
            if (this.highlightedRels.indexOf(rel) < 0) {
              this.highlightedRels.push(rel);
            }
          }
        }
      }
      return this.visualizer.updateOutput('relatedNodes', relatedNodes);
    };

    SelectionRadialNetworkBehavior.prototype.resetSelection = function() {
      this.visualizer.items.each(function(d) {
        return d.highlight = false;
      }).style('opacity', 1);
      return this.visualizer.linksItems.style('opacity', 1);
    };

    return SelectionRadialNetworkBehavior;

  }).call(this, quadrigram.Models.SelectionBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SecondSelectionBehavior = (function(_super) {
    __extends(SecondSelectionBehavior, _super);

    function SecondSelectionBehavior() {
      this.clearItemOnOver = __bind(this.clearItemOnOver, this);
      this.notifyItemOnOver = __bind(this.notifyItemOnOver, this);
      this.updateGraphicSelection = __bind(this.updateGraphicSelection, this);
      this.getSelectedValues = __bind(this.getSelectedValues, this);
      this.getSelectedValues_OLD = __bind(this.getSelectedValues_OLD, this);
      this.getSelectedIds = __bind(this.getSelectedIds, this);
      this.updateOutput = __bind(this.updateOutput, this);
      this.deselectItem = __bind(this.deselectItem, this);
      this.addIdByMultiSelection = __bind(this.addIdByMultiSelection, this);
      this.addIdBySingleSelection = __bind(this.addIdBySingleSelection, this);
      this.processIdOnSelection = __bind(this.processIdOnSelection, this);
      this.updateMultiSelection = __bind(this.updateMultiSelection, this);
      this.updateSingleSelection = __bind(this.updateSingleSelection, this);
      this.emptySelectionAndAlmostOneModeActived = __bind(this.emptySelectionAndAlmostOneModeActived, this);
      this.selectByIds = __bind(this.selectByIds, this);
      this.preprocessSelectedItems = __bind(this.preprocessSelectedItems, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.executeAfterUpdateStage = __bind(this.executeAfterUpdateStage, this);
      this.initialize = __bind(this.initialize, this);
      _ref = SecondSelectionBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SecondSelectionBehavior.field = "secondselection";

    SecondSelectionBehavior.stage = "afterUpdate";

    SecondSelectionBehavior.prototype.firstExec = true;

    SecondSelectionBehavior.behaviors = ["quadrigram.Models.SecondItemsBehavior"];

    SecondSelectionBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(SecondSelectionBehavior.meta, SecondSelectionBehavior.behaviors);
      return output;
    };

    SecondSelectionBehavior.prototype.selectedItems = [];

    SecondSelectionBehavior.meta = {
      "name": "selection",
      "outputs": {
        "selectedIndexes2": {
          "outputType": "selection",
          "default": [],
          "label": "--Selected Ids"
        },
        "selectedValues2": {
          "outputType": "selection",
          "default": [],
          "label": "--Selected Values"
        },
        "mouseOverItem2": {
          "outputType": "OnOver",
          "default": [],
          "label": "--Hovered item"
        },
        "selectedColor2": {
          "outputType": "styles",
          "default": [],
          "label": "--Colors of selection"
        }
      },
      "properties": {
        "forceSelection2": {
          "uiTipContent": "Defines if this visualizer must always have at least one element selected. Useful when connecting visualizers.",
          "label": "--This visualizer must have at least one element selected",
          "family": "select",
          "sortingWeight": "82",
          "hidden": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "true"
              }
            }
          }
        },
        "selectionMode2": {
          "uiTipContent": "Defines if this visualizer can have multiple selection",
          "label": "--Selection mode",
          "family": "select",
          "sortingWeight": "83",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "single selection"
              },
              "options": {
                "value": ["single selection", "multiple selection"]
              }
            }
          }
        },
        "selectedItems2": {
          "uiTipContent": "Defines which items should be selected. Manually input a default selection or insert the output of another visualizer to synchronize them. Click <a href='http://www.quadrigram.com/#tutorialId/connectVisualizers' target='_blank'>here</a> to learn more",
          "label": "--Ids of the selected items",
          "family": "select",
          "sortingWeight": "81",
          "hidden": false,
          "formats": {
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            },
            "JustDrop": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": []
              }
            },
            "Number": {
              "hidden": true,
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": []
              }
            }
          }
        },
        "selectionFillColors2": {
          "uiTipContent": "Defines the color of the selected items",
          "label": "--Fill color of selected items",
          "family": "select",
          "sortingWeight": "84",
          "hidden": true,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#000000"
              }
            }
          }
        },
        "selectionFillOpacities2": {
          "uiTipContent": "Defines the opacity of the selected items",
          "label": "--Fill opacity of selected items",
          "family": "select",
          "sortingWeight": "85",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "100"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionLineColors2": {
          "uiTipContent": "Defines the color of the outline for the selected items",
          "label": "--Outline color of selected items",
          "family": "select",
          "sortingWeight": "86",
          "hidden": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#2861ff"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionLineThickness2": {
          "uiTipContent": "Defines the thickness of the outline for the selected items",
          "label": "--Line thickness of selected items",
          "family": "select",
          "sortingWeight": "87",
          "hidden": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "2px"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionLineOpacities2": {
          "uiTipContent": "Defines the opacity of the outline for the selected items",
          "label": "--Line opacity of selected items",
          "family": "select",
          "sortingWeight": "88",
          "hidden": true,
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "100"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        },
        "selectionBold2": {
          "uiTipContent": "Defines if selected items should be in bold",
          "label": "--Selected element font weight",
          "family": "select",
          "sortingWeight": "84",
          "internal": true,
          "hidden": true,
          "formats": {
            "Boolean": {
              "defaults": {
                "value": "false"
              }
            }
          }
        }
      }
    };

    SecondSelectionBehavior.prototype.initialize = function(params) {
      this.colorScale = d3.scale.ordinal();
      return this.config = {
        selectionLineColors: "#000000",
        selectionEvent: "click",
        multiselection: false,
        forceSelection: false
      };
    };

    SecondSelectionBehavior.prototype.executeAfterUpdateStage = function() {
      var ids, items, model, values;
      model = this.visualizer.model;
      items = this.visualizer.items2;
      values = this.visualizer.values2;
      ids = this.visualizer.idsItems2;
      if (!ids) {
        ids = this.visualizer.ids;
      }
      this.changedItems = (this.visualizer.model.changed["fillColors2"] != null) || (this.visualizer.model.changed["fillOpacities2"] != null) || (this.visualizer.model.changed["lineColors2"] != null) || (this.visualizer.model.changed["lineThickness2"] != null) || (this.visualizer.model.changed["lineOpacities2"] != null) || this.visualizer.changedData || this.firstExec;
      this.changedSelection = (this.visualizer.model.changed["selectedItems2"] != null) || (this.visualizer.model.changed["selectionFillColors2"] != null) || (this.visualizer.model.changed["selectionFillOpacities2"] != null) || (this.visualizer.model.changed["selectionLineColors2"] != null) || (this.visualizer.model.changed["selectionLineThickness2"] != null) || (this.visualizer.model.changed["selectionLineOpacities2"] != null) || (this.visualizer.model.changed["forceSelection2"] != null) || this.visualizer.changedData || this.firstExec;
      this.changed = this.changedSelection || this.changedItems;
      if (this.changed) {
        return this.updateConfig({
          itemsEnter: items,
          values: values,
          ids: ids,
          fillColors: model.get("fillColors2"),
          fillOpacities: model.get("fillOpacities2"),
          lineColors: model.get("lineColors2"),
          lineThickness: model.get("lineThickness2"),
          lineOpacities: model.get("lineOpacities2"),
          selectedItems: model.get("selectedItems2"),
          selectionFillColors: model.get("selectionFillColors2"),
          selectionFillOpacities: model.get("selectionFillOpacities2"),
          selectionLineColors: model.get("selectionLineColors2"),
          selectionLineThickness: model.get("selectionLineThickness2"),
          selectionLineOpacities: model.get("selectionLineOpacities2"),
          forceSelection: model.get("forceSelection2") === "true",
          selectionMode: model.get("selectionMode2"),
          selectionBold: model.get("selectionBold2")
        });
      }
    };

    SecondSelectionBehavior.prototype.updateConfig = function(newConfig) {
      var field, options, self;
      if (this.changedItems) {
        this.behaviors.seconditems.updateConfig(newConfig);
      }
      for (field in newConfig) {
        this.config[field] = newConfig[field];
      }
      self = this;
      this.config.itemsEnter.on(this.config.selectionEvent, function(d, i) {
        return self.processIdOnSelection(d.id);
      });
      this.config.itemsEnter.on("mouseover", function(d, i) {
        return self.notifyItemOnOver(d);
      });
      this.config.itemsEnter.on("mouseout", function(d, i) {
        return self.clearItemOnOver();
      });
      options = {};
      if (!this.changedSelection) {
        options.preserve = true;
      }
      this.updateGraphicSelection(options);
      this.config.selectedItems = this.preprocessSelectedItems(this.config.selectedItems);
      if ((this.visualizer.model.changed["selectedItems2"] != null) || (this.visualizer.model.changed["forceSelection2"] != null) || this.visualizer.changedData || this.firstExec) {
        this.selectByIds(this.config.selectedItems);
      }
      return this.firstExec = false;
    };

    SecondSelectionBehavior.prototype.preprocessSelectedItems = function(source) {
      var candidateId, output, sourceItem, _i, _len;
      output = [];
      if (_.isArray(source)) {
        for (_i = 0, _len = source.length; _i < _len; _i++) {
          sourceItem = source[_i];
          if (sourceItem.value) {
            candidateId = sourceItem.value;
          } else {
            candidateId = sourceItem;
          }
          if (this.config.ids.indexOf(candidateId) !== -1) {
            output.push(candidateId);
          }
        }
      } else {
        if (!source || source === "") {
          output = [];
        } else {
          if (this.config.ids.indexOf(source) !== -1) {
            output = [source];
          } else {
            output = [];
          }
        }
      }
      return output;
    };

    SecondSelectionBehavior.prototype.selectByIds = function(selectedIds) {
      var selectionMode, unionArray;
      if ((!selectedIds || selectedIds.length === 0 || selectedIds === "") && this.config.forceSelection) {
        this.emptySelectionAndAlmostOneModeActived();
      } else {
        unionArray = _.union(selectedIds, this.selectedItems);
        if ((unionArray.length === selectedIds.length) && (unionArray.length === this.selectedItems.length)) {
          return;
        }
        selectionMode = this.config.selectionMode;
        if (!selectionMode) {
          selectionMode = "single selection";
        }
        switch (selectionMode) {
          case "single selection":
            this.updateSingleSelection(selectedIds);
            break;
          case "multiple selection":
            this.updateMultiSelection(selectedIds);
            break;
          default:
            this.updateSingleSelection(selectedIds);
        }
      }
      this.updateGraphicSelection();
      return this.updateOutput();
    };

    SecondSelectionBehavior.prototype.emptySelectionAndAlmostOneModeActived = function() {
      var visualizerIds;
      visualizerIds = this.config.ids;
      if (visualizerIds.length > 0) {
        return this.selectedItems = [visualizerIds[0]];
      }
    };

    SecondSelectionBehavior.prototype.updateSingleSelection = function(selectedIds) {
      if (_.isArray(selectedIds)) {
        if (selectedIds.length > 1) {
          return this.selectedItems = [selectedIds[0]];
        } else {
          return this.selectedItems = selectedIds;
        }
      } else {
        if (selectedIds === "") {
          return this.selectedItems = [];
        } else {
          return this.selectedItems = [selectedIds];
        }
      }
    };

    SecondSelectionBehavior.prototype.updateMultiSelection = function(selectedIds) {
      if (_.isArray(selectedIds)) {
        return this.selectedItems = selectedIds;
      } else {
        if (selectedIds === "") {
          return this.selectedItems = [];
        } else {
          return this.selectedItems = [selectedIds];
        }
      }
    };

    SecondSelectionBehavior.prototype.processIdOnSelection = function(id) {
      var selectionMode;
      if (this.selectedItems.indexOf(id) >= 0) {
        this.deselectItem(id);
      } else {
        selectionMode = this.visualizer.model.get("selectionMode2");
        if (!selectionMode) {
          selectionMode = "single selection";
        }
        switch (selectionMode) {
          case "single selection":
            this.addIdBySingleSelection(id);
            break;
          case "multiple selection":
            this.addIdByMultiSelection(id);
        }
      }
      this.updateOutput();
      return this.updateGraphicSelection();
    };

    SecondSelectionBehavior.prototype.addIdBySingleSelection = function(id) {
      return this.selectedItems = [id];
    };

    SecondSelectionBehavior.prototype.addIdByMultiSelection = function(id) {
      this.selectedItems.push(id);
      return log(this.selectedItems);
    };

    SecondSelectionBehavior.prototype.deselectItem = function(id) {
      var index;
      index = this.selectedItems.indexOf(id);
      if (index === -1) {
        return;
      }
      if (this.selectedItems.length > 1) {
        return this.selectedItems.splice(index, 1);
      } else {
        if (!this.config.forceSelection) {
          return this.selectedItems = [];
        }
      }
    };

    SecondSelectionBehavior.prototype.updateOutput = function() {
      var ids, itemId, selectedColors, selectedIds, styleItem, values, _i, _len, _ref1;
      this.trigger("selection:change");
      selectedIds = [];
      ids = this.getSelectedIds();
      values = this.getSelectedValues();
      this.visualizer.updateOutput("selectedIndexes2", ids, ids.metadata);
      this.visualizer.updateOutput("selectedValues2", values, values.metadata);
      selectedColors = [];
      _ref1 = this.selectedItems;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        itemId = _ref1[_i];
        styleItem = this.behaviors.seconditems.styleItems[itemId];
        if (styleItem) {
          selectedColors.push({
            id: itemId,
            value: styleItem.fillColors
          });
        }
      }
      return this.visualizer.updateOutput("selectedColor2", selectedColors);
    };

    SecondSelectionBehavior.prototype.getSelectedIds = function() {
      var idEntry, output, _i, _len, _ref1;
      if (!_.isArray(this.selectedItems)) {
        return this.selectedItems;
      }
      if (this.selectedItems.length <= 1) {
        return this.selectedItems;
      }
      output = [];
      output.label = this.visualizer.values.label;
      output.metadata = this.visualizer.values.metadata;
      _ref1 = this.selectedItems;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        idEntry = _ref1[_i];
        output.push({
          id: idEntry,
          value: idEntry
        });
      }
      return output;
    };

    SecondSelectionBehavior.prototype.getSelectedValues_OLD = function() {
      var dim, dimensions, idEntry, output, value, valueEntry, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _ref3;
      if (!_.isArray(this.selectedItems)) {
        return this.selectedItems;
      }
      if (this.selectedItems.length === 0) {
        return [];
      }
      output = [];
      output.label = this.visualizer.values.label;
      output.metadata = this.visualizer.values.metadata;
      _ref1 = this.selectedItems;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        idEntry = _ref1[_i];
        _ref2 = this.visualizer.values;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          valueEntry = _ref2[_j];
          if (valueEntry.id === idEntry) {
            if (valueEntry.dataDimensions) {
              dimensions = [];
              _ref3 = valueEntry.dataDimensions;
              for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
                dim = _ref3[_k];
                dimensions.push({
                  id: dim,
                  value: valueEntry[dim]
                });
              }
              value = new quadrigram.Models.DataBlockData(dimensions);
              value.metaData = {
                idLabel: "dimension",
                valueLabel: "id"
              };
              output.push({
                id: valueEntry.id,
                value: value
              });
            } else {
              if (_.isArray(valueEntry.value) && valueEntry.value.length > 1) {
                value = new quadrigram.Models.DataBlockData(valueEntry.value);
                value.metaData = {
                  idLabel: "id",
                  valueLabel: "value"
                };
              } else {
                value = valueEntry.value;
              }
              output.push({
                id: valueEntry.id,
                value: value
              });
            }
            break;
          }
        }
      }
      return output;
    };

    SecondSelectionBehavior.prototype.getSelectedValues = function() {
      var dim, entries, idEntry, output, sampleEntry, value, valueEntry, _i, _j, _k, _l, _len, _len1, _len2, _len3, _len4, _m, _ref1, _ref2, _ref3, _ref4, _ref5;
      if (!_.isArray(this.selectedItems)) {
        return this.selectedItems;
      }
      if (this.selectedItems.length === 0) {
        return [];
      }
      output = [];
      output.label = "output";
      output.metadata = {};
      sampleEntry = this.visualizer.values[0];
      if (sampleEntry && sampleEntry.dataDimensions) {
        output.metadata.idLabel = "dimension";
        output.metadata.valueLabel = "id";
        _ref1 = sampleEntry.dataDimensions;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          dim = _ref1[_i];
          entries = [];
          _ref2 = this.selectedItems;
          for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
            idEntry = _ref2[_j];
            _ref3 = this.visualizer.values;
            for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
              valueEntry = _ref3[_k];
              if (valueEntry.id === idEntry) {
                entries.push({
                  id: valueEntry.id,
                  value: valueEntry[dim]
                });
              }
            }
          }
          value = new quadrigram.Models.DataBlockData(entries);
          value.set("label", "values of " + dim);
          value.metaData = {
            idLabel: "id",
            valueLabel: dim
          };
          output.push({
            id: dim,
            value: value
          });
        }
      } else {
        output.metadata.idLabel = "id";
        output.metadata.valueLabel = "value";
        _ref4 = this.selectedItems;
        for (_l = 0, _len3 = _ref4.length; _l < _len3; _l++) {
          idEntry = _ref4[_l];
          _ref5 = this.visualizer.values;
          for (_m = 0, _len4 = _ref5.length; _m < _len4; _m++) {
            valueEntry = _ref5[_m];
            if (valueEntry.id === idEntry) {
              if (_.isArray(valueEntry.value) && valueEntry.value.length > 1) {
                value = new quadrigram.Models.DataBlockData(valueEntry.value);
                value.set("label", "values of " + valueEntry.id);
                value.metaData = {
                  idLabel: "id",
                  valueLabel: "value"
                };
              } else {
                value = valueEntry.value;
              }
              output.push({
                id: valueEntry.id,
                value: value
              });
            }
          }
        }
      }
      return output;
    };

    SecondSelectionBehavior.prototype.updateGraphicSelection = function() {};

    SecondSelectionBehavior.prototype.notifyItemOnOver = function(item) {
      return this.visualizer.updateOutput("mouseOverItem", item.id);
    };

    SecondSelectionBehavior.prototype.clearItemOnOver = function() {
      return this.visualizer.updateOutput("mouseOverItem", "");
    };

    return SecondSelectionBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SecondSelectionSVGBehavior = (function(_super) {
    __extends(SecondSelectionSVGBehavior, _super);

    function SecondSelectionSVGBehavior() {
      this.updateGraphicSelection = __bind(this.updateGraphicSelection, this);
      _ref = SecondSelectionSVGBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SecondSelectionSVGBehavior.behaviors = ["quadrigram.Models.SecondItemsSVGBehavior"];

    SecondSelectionSVGBehavior.prototype.updateGraphicSelection = function(options) {
      var items, nonSelectedItems, selectedItems, self;
      options || (options = {});
      self = this;
      items = d3.select(this.visualizer.el).selectAll(".second-item");
      items.classed("selected", function(d, i) {
        return self.selectedItems.indexOf(d.id) >= 0;
      });
      selectedItems = items.filter(".selected");
      if (!options.preserve) {
        nonSelectedItems = items.filter(":not(.selected)");
      }
      if (this.config.selectionFillColors !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("fillTransition").duration(0).attr("fill", this.config.selectionFillColors);
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("fill", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["fillColors2"];
            }
          });
        }
      } else {
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("fill", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["fillColors2"];
            }
          });
        }
        selectedItems.attr("fill", function(d, i) {
          if (self.behaviors.seconditems.styleItems[d.id]) {
            return self.behaviors.seconditems.styleItems[d.id]["fillColors2"];
          }
        });
      }
      if (this.config.selectionFillOpacities !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("opacityTransition").duration(0).attr("fill-opacity", this.config.selectionFillOpacities / 100);
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("fill-opacity", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["fillOpacities2"] / 100;
            }
          });
        }
      } else {
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("fill-opacity", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["fillOpacities2"] / 100;
            }
          });
        }
        selectedItems.attr("fill-opacity", function(d, i) {
          if (self.behaviors.seconditems.styleItems[d.id]) {
            return self.behaviors.seconditems.styleItems[d.id]["fillOpacities2"] / 100;
          }
        });
      }
      if (this.config.selectionLineColors !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("strokeTransition").duration(0).attr("stroke", this.config.selectionLineColors);
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["lineColors2"];
            }
          });
        }
      } else {
        selectedItems.attr("stroke", function(d, i) {
          if (self.behaviors.seconditems.styleItems[d.id]) {
            return self.behaviors.seconditems.styleItems[d.id]["lineColors2"];
          }
        });
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["lineColors2"];
            }
          });
        }
      }
      if (this.config.selectionLineThickness !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("strokeWidthTransition").duration(0).attr("stroke-width", function() {
          var strokeWidth;
          this.parentNode.appendChild(this);
          if (self.config.selectionLineThickness) {
            return self.config.selectionLineThickness;
          } else {
            strokeWidth = d3.select(this).attr("stroke-width");
            if (_.isNumber(+strokeWidth)) {
              strokeWidth = +strokeWidth + 2;
            } else {
              strokeWidth = 2;
            }
            return strokeWidth;
          }
        });
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke-width", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["lineThickness2"];
            }
          });
        }
      }
      if (this.config.selectionLineOpacities !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        selectedItems.transition("strokeOpacityTransition").duration(0).attr("stroke-opacity", this.config.selectionLineOpacities / 100);
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke-opacity", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["lineOpacities2"] / 100;
            }
          });
        }
      } else {
        selectedItems.attr("stroke-opacity", function(d, i) {
          if (self.behaviors.seconditems.styleItems[d.id]) {
            return self.behaviors.seconditems.styleItems[d.id]["lineOpacities2"] / 100;
          }
        });
        if (nonSelectedItems != null) {
          nonSelectedItems.attr("stroke-opacity", function(d, i) {
            if (self.behaviors.seconditems.styleItems[d.id]) {
              return self.behaviors.seconditems.styleItems[d.id]["lineOpacities2"] / 100;
            }
          });
        }
      }
      return selectedItems.style("z-index", 1000);
    };

    return SecondSelectionSVGBehavior;

  })(quadrigram.Models.SecondSelectionBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.DataControllerBehavior = (function(_super) {
    __extends(DataControllerBehavior, _super);

    function DataControllerBehavior() {
      this.setStructures = __bind(this.setStructures, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.setEmptyStructures = __bind(this.setEmptyStructures, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      this.hideMessage = __bind(this.hideMessage, this);
      this.notify = __bind(this.notify, this);
      this.checkWrongDataCondition = __bind(this.checkWrongDataCondition, this);
      this._generalChecking = __bind(this._generalChecking, this);
      this.executeStructureStage = __bind(this.executeStructureStage, this);
      _ref = DataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataControllerBehavior.behaviors = [];

    DataControllerBehavior.prototype.firstExec = true;

    DataControllerBehavior.field = "dataController";

    DataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(DataControllerBehavior.meta, DataControllerBehavior.behaviors);
      return output;
    };

    DataControllerBehavior.meta = {};

    DataControllerBehavior.prototype.executeStructureStage = function() {
      this.readyForUpdate = this._generalChecking();
      if (!this.readyForUpdate) {
        this.setEmptyStructures();
        return;
      }
      this.readyForUpdate = this.behaviorChecking();
      if (!this.readyForUpdate) {
        this.setEmptyStructures();
        return;
      }
      this.visualizer.changedData = this.checkDataChanged() || this.firstExec || !this.visualizer.values;
      if (this.visualizer.changedData) {
        this.setStructures();
        this.firstExec = false;
      }
      if (this.checkWrongDataCondition()) {
        this.setEmptyStructures();
        this.notify("Error", "Wrong kind of data for this visualizer");
        return this.visualizer.model.original.trigger("wrongData", this.visualizer.model.changed);
      }
    };

    DataControllerBehavior.prototype._generalChecking = function() {
      if (this.visualizer.model.get("fetchState") === "ready") {
        this.hideMessage();
      } else {
        this.notify("EmptyData");
        this.setEmptyStructures();
        return false;
      }
      return true;
    };

    DataControllerBehavior.prototype.checkWrongDataCondition = function() {
      return this.visualizer.values && this.visualizer.values.length === 0 && this.visualizer.model.get("data").length > 0;
    };

    DataControllerBehavior.prototype.notify = function(message, messageBody) {
      return this.visualizer.trigger("vizMessage", message, messageBody);
    };

    DataControllerBehavior.prototype.hideMessage = function() {
      return this.visualizer.trigger("vizMessage", "hide");
    };

    DataControllerBehavior.prototype.behaviorChecking = function() {};

    DataControllerBehavior.prototype.setEmptyStructures = function() {
      this.visualizer.values = void 0;
      return this.visualizer.ids = void 0;
    };

    DataControllerBehavior.prototype.checkDataChanged = function() {};

    DataControllerBehavior.prototype.setStructures = function() {};

    return DataControllerBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.OneDimDataControllerBehavior = (function(_super) {
    __extends(OneDimDataControllerBehavior, _super);

    function OneDimDataControllerBehavior() {
      this.setStructures = __bind(this.setStructures, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = OneDimDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    OneDimDataControllerBehavior.behaviors = [];

    OneDimDataControllerBehavior.field = "dataController";

    OneDimDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(OneDimDataControllerBehavior.meta, OneDimDataControllerBehavior.behaviors);
      return output;
    };

    OneDimDataControllerBehavior.meta = {
      "properties": {
        "sortByValue": {
          "uiTipContent": "Determines whether the items should be sorted by value",
          "label": "Sort by value",
          "family": "data",
          "sortingWeight": "2",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Do not sort"
              },
              "options": {
                "value": ["Do not sort", "Descending", "Ascending"]
              }
            }
          }
        }
      }
    };

    OneDimDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("data") || this.visualizer.model.get("data") === null || this.visualizer.model.get("data").length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        return false;
      }
      return true;
    };

    OneDimDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["data"] != null) || (this.visualizer.model.changed["sortByValue"] != null);
    };

    OneDimDataControllerBehavior.prototype.setStructures = function() {
      var label, metadata, self,
        _this = this;
      this.visualizer.values = this.visualizer.model.get("data");
      label = this.visualizer.values.label;
      metadata = this.visualizer.values.metadata;
      if (!_.isArray(this.visualizer.values)) {
        this.visualizer.values = [
          {
            id: "value",
            value: this.visualizer.values
          }
        ];
      }
      if (_.isArray(this.visualizer.values[0].value)) {
        this.visualizer.values = this.visualizer.values[0].value;
      }
      if (!_.isNaN(parseFloat(this.visualizer.values))) {
        this.visualizer.values = [
          {
            id: 0,
            value: parseFloat(this.visualizer.values)
          }
        ];
      }
      if (this.visualizer.values instanceof quadrigram.Models.DataBlockData) {
        this.visualizer.values = this.visualizer.values.data;
      }
      this.visualizer.values = this.visualizer.values.filter(function(d) {
        var candidate;
        candidate = parseFloat(d.value);
        return !_.isNaN(candidate);
      });
      if (this.visualizer.model.get("sortByValue") !== "Do not sort") {
        this.visualizer.values.sort(function(a, b) {
          return b.value - a.value;
        });
        if (this.visualizer.model.get("sortByValue") === "Ascending") {
          this.visualizer.values.reverse();
        }
      }
      this.visualizer.values.label = label;
      this.visualizer.values.metadata = metadata;
      self = this;
      _.each(this.visualizer.values, function(d, i) {
        d.metadata = {};
        d.metadata["value"] = {};
        d.metadata["value"].label = self.visualizer.values.label;
        d.metadata["value"].metadata = self.visualizer.values.metadata;
        return d.metadata.dataDimensions = ["value"];
      });
      return this.visualizer.ids = _.map(this.visualizer.values, function(d, i) {
        return d.id;
      });
    };

    return OneDimDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RegionsDataControllerBehavior = (function(_super) {
    __extends(RegionsDataControllerBehavior, _super);

    function RegionsDataControllerBehavior() {
      this.setStructures = __bind(this.setStructures, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this._addSvg = __bind(this._addSvg, this);
      this.loadSVG = __bind(this.loadSVG, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = RegionsDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RegionsDataControllerBehavior.behaviors = [];

    RegionsDataControllerBehavior.field = "dataController";

    RegionsDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(RegionsDataControllerBehavior.meta, RegionsDataControllerBehavior.behaviors);
      return output;
    };

    RegionsDataControllerBehavior.meta = {};

    RegionsDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("data") || this.visualizer.model.get("data") === null || this.visualizer.model.get("data").length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        return false;
      }
      return true;
    };

    RegionsDataControllerBehavior.prototype.loadSVG = function(callback) {
      /*MAL PORQUE SI SE DISPARA DOS VECES se pisan...*/

      var filename, imgURL, index, rid, value,
        _this = this;
      if (!this.svgAdded || this.visualizer.model.changed["data"]) {
        this.itemsSource = [];
        this.notify("EmptyData");
        this.svgAdded = false;
        if (this.visualizer.model.get("data").currentFormat === "ImageUrl") {
          rid = this.visualizer.model.get("data")[0][0].value;
          return quadrigram.router.managers.serverManager.getImageUrl(rid, function(resultUrl) {
            return _this._addSvg("http://cors.io/?u=" + resultUrl, callback);
          });
        } else {
          value = this.visualizer.model.get("data")[0].value;
          index = this.visualizer.model.original.getProperty("data").propDef.formats.Options.options.value.indexOf(value);
          filename = this.visualizer.model.original.getProperty("data").propDef.formats.Options.options.filename[index];
          imgURL = './images/choropleth/' + filename;
          return this._addSvg(imgURL, callback);
        }
      } else {
        return callback();
      }
    };

    RegionsDataControllerBehavior.prototype._addSvg = function(imgURL, callback) {
      var _this = this;
      $.ajaxSetup({
        xhrFields: {
          withCredentials: false
        }
      });
      if (this.req != null) {
        this.req.abort();
      }
      this.req = jQuery.get(imgURL, (function(data) {
        var $svg, self;
        $svg = $(data).find("svg").children("g");
        self = _this;
        _this.visualizer.$svgData = $('<g></g>');
        $svg.each(function() {
          var id, name;
          id = $(this).attr("id");
          if (id != null) {
            $(this).attr("class", "item");
            self.visualizer.$svgData.append($(this));
            name = id;
            if ($(this).find("path").attr("data-name") != null) {
              name = $(this).find("path").attr("data-name");
            } else if ($(this).attr("data-name") != null) {
              name = $(this).attr("data-name");
            }
            return self.itemsSource.push({
              id: id,
              value: null,
              name: name
            });
          }
        });
        _this.visualizer.svgDrawn = false;
        callback();
        _this.svgAdded = true;
        return _this.notify("hide");
      }), 'xml');
      return $.ajaxSetup({
        xhrFields: {
          withCredentials: true
        }
      });
    };

    RegionsDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["data"] != null) || (this.visualizer.model.changed["fillColors"] != null) || !this.svgAdded;
    };

    RegionsDataControllerBehavior.prototype.setStructures = function() {
      var label, metaSource, metadata, self,
        _this = this;
      this.visualizer.values = this.itemsSource;
      metaSource = this.visualizer.model.get("fillColors")[0];
      label = metaSource.label;
      metadata = metaSource.metadata;
      if (!_.isArray(this.visualizer.values)) {
        this.visualizer.values = [
          {
            id: "value",
            value: this.visualizer.values
          }
        ];
      }
      if (_.isArray(this.visualizer.values[0].value)) {
        this.visualizer.values = this.visualizer.values[0].value;
      }
      this.visualizer.values.label = label;
      this.visualizer.values.metadata = metadata;
      self = this;
      _.each(this.visualizer.values, function(d, i) {
        d.metadata = {};
        d.metadata["value"] = {};
        d.metadata["value"].label = self.visualizer.values.label;
        d.metadata["value"].metadata = self.visualizer.values.metadata;
        return d.metadata.dataDimensions = ["value"];
      });
      return this.visualizer.ids = _.map(this.visualizer.values, function(d, i) {
        return d.id;
      });
    };

    return RegionsDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TextListDataControllerBehavior = (function(_super) {
    __extends(TextListDataControllerBehavior, _super);

    function TextListDataControllerBehavior() {
      this.setStructures = __bind(this.setStructures, this);
      this.checkWrongDataCondition = __bind(this.checkWrongDataCondition, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = TextListDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TextListDataControllerBehavior.behaviors = [];

    TextListDataControllerBehavior.field = "dataController";

    TextListDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TextListDataControllerBehavior.meta, TextListDataControllerBehavior.behaviors);
      return output;
    };

    TextListDataControllerBehavior.meta = {
      properties: {
        removeReps: {
          uiTipContent: "Determines if items with the same value should be omitted",
          label: "Remove repetitions",
          family: "data",
          sortingWeight: "99",
          hidden: true,
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        }
      }
    };

    TextListDataControllerBehavior.prototype.behaviorChecking = function() {
      /*
      if !@visualizer.model.get("data")? || @visualizer.model.get("data") == null || @visualizer.model.get("data").length == 0
        @notify("EmptyData")
        return false
      */

      return true;
    };

    TextListDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["data"] != null) || (this.visualizer.model.changed["removeReps"] != null);
    };

    TextListDataControllerBehavior.prototype.checkWrongDataCondition = function() {
      return false;
    };

    TextListDataControllerBehavior.prototype.setStructures = function() {
      var self,
        _this = this;
      this.visualizer.values = this.visualizer.model.get("data");
      if (!this.visualizer.values) {
        this.visualizer.values = "";
      }
      if (!_.isArray(this.visualizer.values)) {
        this.visualizer.values = [
          {
            id: "value",
            value: this.visualizer.values
          }
        ];
      }
      if (this.visualizer.values[0] == null) {
        this.visualizer.values = [
          {
            id: "",
            value: ""
          }
        ];
      }
      if (_.isArray(this.visualizer.values[0].value)) {
        this.visualizer.values = this.visualizer.values[0].value;
      }
      if (!_.isArray(this.visualizer.values)) {
        this.visualizer.values = [
          {
            id: 0,
            value: this.visualizer.values
          }
        ];
      }
      if (this.visualizer.values instanceof quadrigram.Models.DataBlockData) {
        this.visualizer.values = this.visualizer.values.data;
      }
      self = this;
      if (this.visualizer.model.get("removeReps") === "true") {
        this.visualizer.values = _.uniq(this.visualizer.values, false, function(a) {
          return a.value;
        });
      }
      _.each(this.visualizer.values, function(d, i) {
        d.metadata = {};
        d.metadata["value"] = {};
        d.metadata["value"].label = self.visualizer.values.label;
        d.metadata["value"].metadata = self.visualizer.values.metadata;
        return d.metadata.dataDimensions = ["value"];
      });
      return this.visualizer.ids = _.map(this.visualizer.values, function(d, i) {
        return d.id;
      });
    };

    return TextListDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TwoDimDataControllerBehavior = (function(_super) {
    __extends(TwoDimDataControllerBehavior, _super);

    function TwoDimDataControllerBehavior() {
      this.cleanData = __bind(this.cleanData, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      this.removeEmptyPoints = __bind(this.removeEmptyPoints, this);
      this.sortIds = __bind(this.sortIds, this);
      this.setDimension = __bind(this.setDimension, this);
      this.setStructures = __bind(this.setStructures, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = TwoDimDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TwoDimDataControllerBehavior.behaviors = [];

    TwoDimDataControllerBehavior.field = "dataController";

    TwoDimDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TwoDimDataControllerBehavior.meta, TwoDimDataControllerBehavior.behaviors);
      return output;
    };

    TwoDimDataControllerBehavior.meta = {
      "properties": {
        "dimensionAsItems": {
          "uiTipContent": "Determines if each item (line) is a row or a column of the input table",
          "label": "Data table orientation",
          "family": "data",
          "sortingWeight": "5",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Columns"
              },
              "options": {
                "value": ["Rows", "Columns"]
              }
            }
          }
        },
        "dataGaps": {
          "uiTipContent": "Determines if the lines should connect all points or should show gaps when data is not defined",
          "label": "Gaps for missing data",
          "family": "data",
          "sortingWeight": "6",
          "hidden": true,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "false"
              }
            }
          }
        }
      }
    };

    TwoDimDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("data") || this.visualizer.model.get("data") === null || this.visualizer.model.get("data").length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        return false;
      }
      return true;
    };

    TwoDimDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["data"] != null) || (this.visualizer.model.changed["dimensionAsItems"] != null) || (this.visualizer.model.changed["dataGaps"] != null);
    };

    TwoDimDataControllerBehavior.prototype.setStructures = function() {
      var itemSource, itemSourceIds, originalData, self, _i, _j, _len, _len1, _ref1, _ref2,
        _this = this;
      originalData = this.visualizer.model.get("data");
      this.visualizer.values = this.setDimension(this.cleanData(originalData), this.visualizer.model.get("dimensionAsItems"));
      this.visualizer.ids = [];
      this.visualizer.idsItems = [];
      self = this;
      _ref1 = this.visualizer.values;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        itemSource = _ref1[_i];
        itemSource.metadata = {
          dataDimensions: ["value"],
          value: {
            metadata: this.visualizer.values.metadata,
            label: this.visualizer.values.label
          }
        };
        this.visualizer.idsItems.push(itemSource.id);
        _.each(itemSource.value, function(d, i) {
          if (_.isObject(d)) {
            d.label = self.visualizer.values.label;
            return d.metadata = self.visualizer.values.metadata;
          }
        });
      }
      _ref2 = this.visualizer.values;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        itemSource = _ref2[_j];
        itemSourceIds = _.map(itemSource.value, function(d, i) {
          return d.id;
        });
        this.visualizer.ids = _.union(this.visualizer.ids, itemSourceIds);
      }
      if (this.visualizer.model.get("dataGaps") === "false") {
        this.visualizer.values = this.removeEmptyPoints(this.visualizer.values);
      }
      if (!this.visualizer.values || this.visualizer.values.length === 0) {
        this.notify("EmptyData");
      }
    };

    TwoDimDataControllerBehavior.prototype.setDimension = function(values, dimension) {
      var dimObject, item, item1, item2, output, _i, _j, _len, _len1, _ref1;
      if (dimension === "Columns") {
        return values;
      }
      output = [];
      output.label = values.label;
      output.metadata = values.metadata;
      dimObject = {};
      for (_i = 0, _len = values.length; _i < _len; _i++) {
        item1 = values[_i];
        if (_.isArray(item1.value)) {
          _ref1 = item1.value;
          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
            item2 = _ref1[_j];
            if (!dimObject[item2.id]) {
              dimObject[item2.id] = [];
            }
            dimObject[item2.id].push({
              id: item1.id,
              value: item2.value
            });
          }
        }
      }
      for (item in dimObject) {
        output.push({
          id: item,
          value: dimObject[item]
        });
      }
      return output;
    };

    /*
    sortValues:(values) =>
      for valueEntry in values
        mnt = moment(valueEntry.value[0].id,"DD-MM-YYYY")
        if mnt.isValid() && (valueEntry.value[0].id.toString().indexOf("-") != -1 || valueEntry.value[0].id.toString().indexOf("/") != -1)
          valueEntry.value = _.sortBy(valueEntry.value,(d) ->
              mnt = moment(d.id,"DD-MM-YYYY")
              mnt._d.getTime()
            )
        else
          candidateNumber = parseFloat(valueEntry.value[0].id)
          if !_.isNaN(candidateNumber)
            valueEntry.value = _.sortBy(valueEntry.value,(d) ->
              candidateNumber = parseFloat(d.id)
              candidateNumber
            )
      values
    */


    TwoDimDataControllerBehavior.prototype.sortIds = function(ids) {
      var candidateNumber, mnt, output;
      mnt = moment(ids[0], "DD-MM-YYYY");
      if (mnt.isValid() && (ids[0].toString().indexOf("-") !== -1 || ids[0].toString().indexOf("/") !== -1)) {
        output = _.sortBy(ids, function(d) {
          mnt = moment(d, "DD-MM-YYYY");
          return mnt._d.getTime();
        });
        return output;
      } else {
        candidateNumber = parseFloat(ids[0]);
        if (!_.isNaN(candidateNumber)) {
          output = _.sortBy(ids, function(d) {
            candidateNumber = parseFloat(d);
            return candidateNumber;
          });
          return output;
        } else {
          return ids;
        }
      }
    };

    TwoDimDataControllerBehavior.prototype.removeEmptyPoints = function(output) {
      var list, _i, _len;
      for (_i = 0, _len = output.length; _i < _len; _i++) {
        list = output[_i];
        if (_.isArray(list.value)) {
          list.value = list.value.filter(function(item) {
            return item.value;
          });
        }
      }
      return output;
    };

    TwoDimDataControllerBehavior.prototype.getXDomainValues = function() {
      return this.visualizer.ids;
    };

    /*
    getXDomainValues:()=>
      values = []
      valuesOb = {}
      for row in @visualizer.values
        for v in row.value
          if !valuesOb[v.id]?
            valuesOb[v.id]=true
            values.push(v.id)
      return values
    */


    /*
    getAllIds:(output,fill)=>
      idsObject = {}
      for line in output
        for point in line.value
          if !idsObject[point.id]?
            idsObject[point.id] = true
    
      idsArray = Object.keys(idsObject).map((key)->
        return key
      )
    
      @sortIds(idsArray)
    
      ##HACERLO poniendo el x-axis a "linear"???
      #pero habria que convertir los ids a "numeros" para que los axis/scales lo entiendan....
      #
      if fill
        mnt  = moment(idsArray[0],"DD-MM-YYYY")
        if mnt.isValid() && (idsArray[0].toString().indexOf("-") != -1 || idsArray[0].toString().indexOf("/") != -1)
          fillType = "date"
          fillUnit = "days"
          dateFormat = "DD-MM-YYYY"
        else
          fillType = "number"
          fillUnit = Number(idsArray[1])-Number(idsArray[0])
          for i in [1..idsArray.length-1]
            fillUnit = Math.min(fillUnit,idsArray[i]-idsArray[i-1])
          fillUnit = parseFloat(fillUnit.toPrecision(3))
        if fillType == "date"
          get_val = (string)->
            moment(string,dateFormat)
          get_betwen = (last,first)->
            last.diff(first,fillUnit)
          to_string = (val)->
            val.format(dateFormat)
          get_next = (val)->
            val.clone().add(fillUnit,1)
        else if fillType == "number"
          get_val = (string)->
            Number(string)
          get_betwen = (last,first)->
            (last-first)/fillUnit
          to_string = (val)->
            String(val)
          get_next = (val)->
            parseFloat((val+fillUnit).toPrecision(3))
    
        filledIds = []
        nextValue = get_val(idsArray[0])
        lastValue = get_val(idsArray[idsArray.length-1])
        count = get_betwen(lastValue,nextValue)
        filledIds.push(to_string(nextValue))
        for i in [0..count-1]
          nextValue = get_next(nextValue)
          filledIds.push(to_string(nextValue))
    
        
        idsArray = filledIds
      
      return idsArray
    */


    /*
    fillValues:(output)=>
      idsArray = @getAllIds(output,false)
      for id,index in idsArray
        for line in output
          if !line.value[index]? || line.value[index].id != id
            line.value.splice(index, 0, {id:id,value:NaN});
      output
    */


    TwoDimDataControllerBehavior.prototype.cleanData = function(data) {
      var d, i, isArray, newData, output, v, _i, _j, _len, _len1;
      output = [];
      output.label = data.label;
      output.metadata = data.metadata;
      if (!_.isNaN(parseFloat(data))) {
        data = [
          {
            id: 0,
            value: data
          }
        ];
        data.metadata = {};
      }
      isArray = false;
      for (_i = 0, _len = data.length; _i < _len; _i++) {
        d = data[_i];
        if (_.isArray(d.value)) {
          isArray = true;
        }
      }
      if (!isArray) {
        if (this.visualizer.model.get("dimensionAsItems") === "Columns") {
          data = [
            {
              id: data.metadata.valueLabel,
              value: data
            }
          ];
        } else {
          newData = [];
          for (i = _j = 0, _len1 = data.length; _j < _len1; i = ++_j) {
            v = data[i];
            newData.push({
              id: v.id,
              value: [
                {
                  id: data.metadata.valueLabel,
                  value: v.value
                }
              ]
            });
          }
          data = newData;
        }
      }
      return data;
    };

    /*
    cleanData:(data) =>
      output = []
      output.label = data.label
      output.metadata = data.metadata
    
      #"copiado" del onDimDataConroller, SE PIERDEN LOS METADADOS CUANDO SOLO HAY UN DATO...
      if !_.isNaN(parseFloat(data))
        data = [{id:0,value:data}]
        data.metadata = {}
    
      #Check if data are a single list or more than one
      #LA_CAIXA: antes miraba solo el data[0] pero si el primero era single y los otros eran array lo "engaaban"....
      isArray = false
      for d in data
        if _.isArray(d.value)
          isArray = true
      #if !_.isArray(data[0].value)
      if !isArray
        #In case that it is receiving a single list, the behavior wrap the list in a one level more wrapper
        if @visualizer.model.get("dimensionAsItems") == "Columns"
          data = [{id:data.metadata.valueLabel,value:data}]
        ##LA_CAIXA: creo que debe ser asi, para que funcione bien con los modos de dimensionAsItems
        else
          newData = []
          for v,i in data
            newData.push {id:v.id,value:[{id:data.metadata.valueLabel,value:v.value}]}
          
          data = newData
        
      outputList = []
      for candidateList in data
        outputList = []
        ##MAL, los que solo tienen uno, no se meten, y si los intentamos meter, no tenemos el id...
        #LA_CAIXA: Creo que si los metadata llegan bien se puede hacer!
        for candidateItem in candidateList.value
          if !isNaN(+(candidateItem.value))
            outputList.push(candidateItem)
        #NO tiene sentido forzar un sort SIEMPRE, deberia tratarse "bien" cuando son linealizables!!
        #outputList = _.sortBy(outputList,(item) ->
        #    item.id
        #)
        if outputList.length > 0
          output.push({id:candidateList.id,value:outputList})
    
      
     
      output
    */


    return TwoDimDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TwoPlusOneDimDataControllerBehavior = (function(_super) {
    __extends(TwoPlusOneDimDataControllerBehavior, _super);

    function TwoPlusOneDimDataControllerBehavior() {
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      this.cleanData = __bind(this.cleanData, this);
      this.sortIds = __bind(this.sortIds, this);
      this.sortValues = __bind(this.sortValues, this);
      this.setDimension = __bind(this.setDimension, this);
      this.setStructures = __bind(this.setStructures, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = TwoPlusOneDimDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TwoPlusOneDimDataControllerBehavior.behaviors = [];

    TwoPlusOneDimDataControllerBehavior.field = "dataController";

    TwoPlusOneDimDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TwoPlusOneDimDataControllerBehavior.meta, TwoPlusOneDimDataControllerBehavior.behaviors);
      return output;
    };

    TwoPlusOneDimDataControllerBehavior.meta = {
      "properties": {
        "dimensionAsItems": {
          "uiTipContent": "Determines if items (lines) are the rows or the columns of the input table",
          "label": "Data table orientation",
          "family": "data",
          "sortingWeight": "5",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Columns"
              },
              "options": {
                "value": ["Rows", "Columns"]
              }
            }
          }
        }
      }
    };

    TwoPlusOneDimDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("data2") || this.visualizer.model.get("data2") === null || this.visualizer.model.get("data2").length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        return false;
      }
      return true;
    };

    TwoPlusOneDimDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["data2"] != null) || (this.visualizer.model.changed["data1"] != null) || (this.visualizer.model.changed["dimensionAsItems"] != null);
    };

    TwoPlusOneDimDataControllerBehavior.prototype.setStructures = function() {
      var itemSource, itemSourceIds, label, metadata, originalData, self, _i, _j, _len, _len1, _ref1, _ref2,
        _this = this;
      originalData = this.visualizer.model.get("data2");
      this.visualizer.values2 = this.setDimension(this.cleanData(originalData), this.visualizer.model.get("dimensionAsItems"));
      this.visualizer.ids2 = [];
      this.visualizer.idsItems2 = [];
      self = this;
      /*OLD
      for itemSource in @visualizer.values2
        itemSource.metadata = {dataDimensions:["value"],value:{metadata:@visualizer.values2.metadata,label:@visualizer.values2.label}}
        @visualizer.idsItems2.push itemSource.id
      
        _.each itemSource.value, (d,i) =>
          d.label     =  self.visualizer.values2.label
          d.metadata  =  self.visualizer.values2.metadata
      
      
      @sortValues(@visualizer.values2)
      
      for itemSource in @visualizer.values2
        itemSourceIds = _.map itemSource.value, (d, i)=>
          return d.id
        @visualizer.ids2 = @sortIds(_.union(@visualizer.ids2,itemSourceIds))
      */

      _ref1 = this.visualizer.values2;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        itemSource = _ref1[_i];
        itemSource.metadata = {
          dataDimensions: ["value"],
          value: {
            metadata: this.visualizer.values2.metadata,
            label: this.visualizer.values2.label
          }
        };
        this.visualizer.idsItems2.push(itemSource.id);
        _.each(itemSource.value, function(d, i) {
          d.label = self.visualizer.values2.label;
          return d.metadata = self.visualizer.values2.metadata;
        });
      }
      this.sortValues(this.visualizer.values2);
      _ref2 = this.visualizer.values2;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        itemSource = _ref2[_j];
        itemSourceIds = _.map(itemSource.value, function(d, i) {
          return d.id;
        });
        this.visualizer.ids2 = this.sortIds(_.union(this.visualizer.ids2, itemSourceIds));
      }
      /*
      if !@visualizer.values || @visualizer.values.length == 0
        @notify("EmptyData")
        return
      */

      this.visualizer.model.original.idsItems2 = this.visualizer.idsItems2;
      this.visualizer.values1 = this.visualizer.model.get("data1");
      label = this.visualizer.values1.label;
      metadata = this.visualizer.values1.metadata;
      if (!_.isArray(this.visualizer.values1)) {
        this.visualizer.values1 = [
          {
            id: "value",
            value: this.visualizer.values1
          }
        ];
      }
      if (_.isArray(this.visualizer.values1[0].value)) {
        this.visualizer.values1 = this.visualizer.values1[0].value;
      }
      if (!_.isNaN(parseFloat(this.visualizer.values1))) {
        this.visualizer.values1 = [
          {
            id: 0,
            value: parseFloat(this.visualizer.values1)
          }
        ];
      }
      if (this.visualizer.values1 instanceof quadrigram.Models.DataBlockData) {
        this.visualizer.values1 = this.visualizer.values1.data;
      }
      this.visualizer.values1 = this.visualizer.values1.filter(function(d) {
        var candidate;
        candidate = parseFloat(d.value);
        return !_.isNaN(candidate);
      });
      this.visualizer.values1.label = label;
      this.visualizer.values1.metadata = metadata;
      self = this;
      _.each(this.visualizer.values1, function(d, i) {
        d.metadata = {};
        d.metadata["value"] = {};
        d.metadata["value"].label = self.visualizer.values1.label;
        d.metadata["value"].metadata = self.visualizer.values1.metadata;
        return d.metadata.dataDimensions = ["value"];
      });
      this.visualizer.ids1 = _.map(this.visualizer.values1, function(d, i) {
        return d.id;
      });
      this.visualizer.values = this.visualizer.values1.concat(this.visualizer.values2);
      this.visualizer.ids = this.visualizer.ids1.concat(this.visualizer.ids2);
      if (!this.visualizer.values2 || this.visualizer.values2.length === 0 || !this.visualizer.values1 || this.visualizer.values1.length === 0) {
        this.notify("EmptyData");
      }
    };

    TwoPlusOneDimDataControllerBehavior.prototype.setDimension = function(values, dimension) {
      var dimObject, item, item1, item2, output, _i, _j, _len, _len1, _ref1;
      if (dimension === "Columns") {
        return values;
      }
      output = [];
      output.label = values.label;
      output.metadata = values.metadata;
      dimObject = {};
      for (_i = 0, _len = values.length; _i < _len; _i++) {
        item1 = values[_i];
        if (_.isArray(item1.value)) {
          _ref1 = item1.value;
          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
            item2 = _ref1[_j];
            if (!dimObject[item2.id]) {
              dimObject[item2.id] = [];
            }
            dimObject[item2.id].push({
              id: item1.id,
              value: item2.value
            });
          }
        }
      }
      for (item in dimObject) {
        output.push({
          id: item,
          value: dimObject[item]
        });
      }
      return output;
    };

    TwoPlusOneDimDataControllerBehavior.prototype.sortValues = function(values) {
      return values;
      /*
      for valueEntry in values
        mnt = moment(valueEntry.value[0].id,"DD-MM-YYYY")
        if mnt.isValid() && (valueEntry.value[0].id.toString().indexOf("-") != -1 || valueEntry.value[0].id.toString().indexOf("/") != -1)
          valueEntry.value = _.sortBy(valueEntry.value,(d) ->
              mnt = moment(d.id,"DD-MM-YYYY")
              mnt._d.getTime()
            )
        else
          candidateNumber = parseFloat(valueEntry.value[0].id)
          if !_.isNaN(candidateNumber)
            valueEntry.value = _.sortBy(valueEntry.value,(d) ->
              candidateNumber = parseFloat(d.id)
              candidateNumber
            )
      values
      */

    };

    TwoPlusOneDimDataControllerBehavior.prototype.sortIds = function(ids) {
      return ids;
      /*
      mnt  = moment(ids[0],"DD-MM-YYYY")
      if mnt.isValid() && (ids[0].toString().indexOf("-") != -1 || ids[0].toString().indexOf("/") != -1)
        output = _.sortBy(ids,(d) ->
            mnt = moment(d,"DD-MM-YYYY")
            mnt._d.getTime()
          )
        return output
      else
        candidateNumber = parseFloat(ids[0])
        if !_.isNaN(candidateNumber)
          output = _.sortBy(ids,(d) ->
            candidateNumber = parseFloat(d)
            candidateNumber
          )
          return output
        else
          return ids
      */

    };

    TwoPlusOneDimDataControllerBehavior.prototype.cleanData = function(data) {
      var candidateItem, candidateList, d, i, isArray, newData, output, outputList, v, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref1;
      output = [];
      output.label = data.label;
      output.metadata = data.metadata;
      isArray = false;
      for (_i = 0, _len = data.length; _i < _len; _i++) {
        d = data[_i];
        if (_.isArray(d.value)) {
          isArray = true;
        }
      }
      if (!isArray) {
        if (this.visualizer.model.get("dimensionAsItems") === "Columns") {
          data = [
            {
              id: data.metadata.valueLabel,
              value: data
            }
          ];
        } else {
          newData = [];
          for (i = _j = 0, _len1 = data.length; _j < _len1; i = ++_j) {
            v = data[i];
            newData.push({
              id: v.id,
              value: [
                {
                  id: data.metadata.valueLabel,
                  value: v.value
                }
              ]
            });
          }
          data = newData;
        }
      }
      outputList = [];
      for (_k = 0, _len2 = data.length; _k < _len2; _k++) {
        candidateList = data[_k];
        outputList = [];
        _ref1 = candidateList.value;
        for (_l = 0, _len3 = _ref1.length; _l < _len3; _l++) {
          candidateItem = _ref1[_l];
          if (!isNaN(+candidateItem.value)) {
            outputList.push(candidateItem);
          }
        }
        outputList = _.sortBy(outputList, function(item) {
          return item.id;
        });
        if (outputList.length > 0) {
          output.push({
            id: candidateList.id,
            value: outputList
          });
        }
      }
      return output;
    };

    TwoPlusOneDimDataControllerBehavior.prototype.getXDomainValues = function() {
      var row, v, values, valuesOb, _i, _j, _len, _len1, _ref1, _ref2;
      values = [];
      valuesOb = {};
      _ref1 = this.visualizer.values;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        row = _ref1[_i];
        if (!_.isArray(row.value)) {
          values.push(row.id);
        } else {
          _ref2 = row.value;
          for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
            v = _ref2[_j];
            if (!valuesOb[v.id]) {
              valuesOb[v.id] = true;
              values.push(v.id);
            }
          }
        }
      }
      return values;
    };

    return TwoPlusOneDimDataControllerBehavior;

  }).call(this, quadrigram.Models.TwoDimDataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PlacesDataControllerBehavior = (function(_super) {
    __extends(PlacesDataControllerBehavior, _super);

    function PlacesDataControllerBehavior() {
      this.cleanData = __bind(this.cleanData, this);
      this.updateCoordinatesObject = __bind(this.updateCoordinatesObject, this);
      this.createLatLngObjects = __bind(this.createLatLngObjects, this);
      this.createLatLngObjectsFromUTMData = __bind(this.createLatLngObjectsFromUTMData, this);
      this.checkWrongDataCondition = __bind(this.checkWrongDataCondition, this);
      this.setStructures = __bind(this.setStructures, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.setEmptyStructures = __bind(this.setEmptyStructures, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = PlacesDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PlacesDataControllerBehavior.behaviors = [];

    PlacesDataControllerBehavior.stage = "structure";

    PlacesDataControllerBehavior.field = "dataController";

    PlacesDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(PlacesDataControllerBehavior.meta, PlacesDataControllerBehavior.behaviors);
      return output;
    };

    PlacesDataControllerBehavior.meta = {};

    PlacesDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("places")[0] || this.visualizer.model.get("places")[0] === null || this.visualizer.model.get("places")[0].length === 0 || !this.visualizer.model.get("places")[1] || this.visualizer.model.get("places")[1] === null || this.visualizer.model.get("places")[1].length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        return false;
      }
      return true;
    };

    PlacesDataControllerBehavior.prototype.setEmptyStructures = function() {
      this.visualizer.coordinates = void 0;
      this.visualizer.values = void 0;
      return this.visualizer.ids = void 0;
    };

    PlacesDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["values"] != null) || (this.visualizer.model.changed["labels"] != null) || (this.visualizer.model.changed["places"] != null);
    };

    PlacesDataControllerBehavior.prototype.setStructures = function() {
      var valuesLabel, valuesMeta,
        _this = this;
      this.visualizer.values = [];
      this.coordinatesObject = {};
      if (this.visualizer.model.get("places").currentFormat === "PlaceUTM") {
        this.sourcePlacesUTMX = this.cleanData(this.visualizer.model.get("places")[0]);
        this.sourcePlacesUTMY = this.cleanData(this.visualizer.model.get("places")[1]);
        this.sourcePlacesZone = this.visualizer.model.get("places")[2];
        this.updateCoordinatesObject("utmx", this.sourcePlacesUTMX);
        this.updateCoordinatesObject("utmy", this.sourcePlacesUTMY);
        this.updateCoordinatesObject("utmzone", this.sourcePlacesZone);
        if (this.visualizer.model.get("values").currentFormat === "PxByValues" || this.visualizer.model.get("values").currentFormat === "ByValues" || this.visualizer.model.get("values").currentFormat === "IntensitiesByValues" || this.visualizer.model.get("values").currentFormat === "PxByValuesAndDomain") {
          this.updateCoordinatesObject("value", this.visualizer.model.get("values")[0]);
        } else {
          this.updateCoordinatesObject("value", this.visualizer.model.get("values"));
        }
        this.createLatLngObjectsFromUTMData();
      } else {
        this.sourcePlacesLat = this.cleanData(this.visualizer.model.get("places")[0]);
        this.sourcePlacesLon = this.cleanData(this.visualizer.model.get("places")[1]);
        this.updateCoordinatesObject("lat", this.sourcePlacesLat);
        this.updateCoordinatesObject("lon", this.sourcePlacesLon);
      }
      if (this.visualizer.model.get("values").currentFormat === "PxByValues" || this.visualizer.model.get("values").currentFormat === "ByValues" || this.visualizer.model.get("values").currentFormat === "IntensitiesByValues" || this.visualizer.model.get("values").currentFormat === "PxByValuesAndDomain") {
        this.updateCoordinatesObject("value", this.visualizer.model.get("values")[0]);
      } else {
        this.updateCoordinatesObject("value", this.visualizer.model.get("values"));
      }
      this.createLatLngObjects();
      this.visualizer.coordinates = _.values(this.coordinatesObject);
      this.visualizer.ids = _.keys(this.coordinatesObject);
      this.visualizer.values = this.visualizer.coordinates;
      if (this.visualizer.model.get("values")[0] != null) {
        valuesLabel = this.visualizer.model.get("values")[0].label;
      } else {
        valuesLabel = this.visualizer.model.get("values").label;
      }
      if (!valuesLabel) {
        valuesLabel = "Value";
      }
      valuesMeta = this.visualizer.model.get("values").metadata;
      return _.each(this.visualizer.values, function(d, i) {
        d.metadata = {};
        d.metadata["value"] = {};
        d.metadata["value"].label = valuesLabel;
        d.metadata["value"].metadata = valuesMeta;
        return d.metadata.dataDimensions = ["value"];
      });
    };

    PlacesDataControllerBehavior.prototype.checkWrongDataCondition = function() {
      if (this.visualizer.model.get("places").currentFormat === "PlaceUTM") {
        return (this.sourcePlacesUTMX.length === 0 && this.visualizer.model.get("places")[0] && this.visualizer.model.get("places")[0].length > 0) || (this.sourcePlacesUTMY.length === 0 && this.visualizer.model.get("places")[1] && this.visualizer.model.get("places")[1].length > 0);
      } else {
        return ((this.sourcePlacesLat !== void 0 && this.sourcePlacesLat.length === 0) && this.visualizer.model.get("places")[0] && this.visualizer.model.get("places")[0].length > 0) || ((this.sourcePlacesLon !== void 0 && this.sourcePlacesLon.length === 0) && this.visualizer.model.get("places")[1] && this.visualizer.model.get("places")[1].length > 0);
      }
    };

    PlacesDataControllerBehavior.prototype.createLatLngObjectsFromUTMData = function() {
      var coordTempDeg, coordTempUTM, coordinate, coordinateKey, _ref1, _results;
      _ref1 = this.coordinatesObject;
      _results = [];
      for (coordinateKey in _ref1) {
        coordinate = _ref1[coordinateKey];
        coordTempUTM = new UTMConv.UTMCoords(parseFloat(coordinate.utmzone), parseFloat(coordinate.utmx), parseFloat(coordinate.utmy));
        coordTempDeg = coordTempUTM.to_deg();
        coordinate.lat = parseFloat(coordTempDeg.latd);
        coordinate.lon = parseFloat(coordTempDeg.lngd);
        if (coordinate.lat && _.isNumber(coordinate.lat) && !_.isNaN(coordinate.lat) && coordinate.lon && _.isNumber(coordinate.lon) && !_.isNaN(coordinate.lon)) {
          _results.push(coordinate.LatLng = new L.LatLng(coordinate.lat, coordinate.lon));
        } else {
          _results.push(delete this.coordinatesObject[coordinate.id]);
        }
      }
      return _results;
    };

    PlacesDataControllerBehavior.prototype.createLatLngObjects = function() {
      var coordinate, coordinateKey, _ref1, _results;
      _ref1 = this.coordinatesObject;
      _results = [];
      for (coordinateKey in _ref1) {
        coordinate = _ref1[coordinateKey];
        coordinate.lat = parseFloat(coordinate.lat);
        coordinate.lon = parseFloat(coordinate.lon);
        if (coordinate.lat && _.isNumber(coordinate.lat) && !_.isNaN(coordinate.lat) && coordinate.lon && _.isNumber(coordinate.lon) && !_.isNaN(coordinate.lon)) {
          _results.push(coordinate.LatLng = new L.LatLng(coordinate.lat, coordinate.lon));
        } else {
          _results.push(delete this.coordinatesObject[coordinate.id]);
        }
      }
      return _results;
    };

    PlacesDataControllerBehavior.prototype.updateCoordinatesObject = function(field, data) {
      var coordinateObject, coordinateObjectKey, entry, _i, _len, _ref1, _results, _results1;
      if (_.isArray(data)) {
        _results = [];
        for (_i = 0, _len = data.length; _i < _len; _i++) {
          entry = data[_i];
          if (!this.coordinatesObject[entry.id]) {
            this.coordinatesObject[entry.id] = {
              id: entry.id,
              dataDimensions: ["value"]
            };
          }
          _results.push(this.coordinatesObject[entry.id][field] = entry.value);
        }
        return _results;
      } else {
        _ref1 = this.coordinatesObject;
        _results1 = [];
        for (coordinateObjectKey in _ref1) {
          coordinateObject = _ref1[coordinateObjectKey];
          coordinateObject[field] = data;
          _results1.push(coordinateObject["dataDimensions"] = ["value"]);
        }
        return _results1;
      }
    };

    PlacesDataControllerBehavior.prototype.cleanData = function(list) {
      var candidate, cleanValue, listEntry, outputList, _i, _len;
      if (_.isString(list)) {
        return [
          {
            id: "Place",
            value: parseFloat(list.replace(/\,/g, ''))
          }
        ];
      }
      outputList = [];
      outputList.label = list.label;
      outputList.metadata = list.metadata;
      for (_i = 0, _len = list.length; _i < _len; _i++) {
        listEntry = list[_i];
        candidate = {
          id: listEntry.id,
          value: listEntry.value
        };
        cleanValue = candidate.value;
        if (cleanValue != null) {
          if (!_.isNumber(cleanValue)) {
            cleanValue = parseFloat(cleanValue.replace(/\,/g, ''));
          }
          if (!isNaN(cleanValue)) {
            candidate.value = cleanValue;
            outputList.push(candidate);
          }
        }
      }
      return outputList;
    };

    return PlacesDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ScatterDataControllerBehavior = (function(_super) {
    __extends(ScatterDataControllerBehavior, _super);

    function ScatterDataControllerBehavior() {
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      this.cleanData = __bind(this.cleanData, this);
      this.setScatterDim = __bind(this.setScatterDim, this);
      this.updateScatterValuesObject = __bind(this.updateScatterValuesObject, this);
      this.cleanScatterValuesObject = __bind(this.cleanScatterValuesObject, this);
      this.setStructures = __bind(this.setStructures, this);
      this.checkWrongDataCondition = __bind(this.checkWrongDataCondition, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = ScatterDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ScatterDataControllerBehavior.behaviors = [];

    ScatterDataControllerBehavior.stage = "structure";

    ScatterDataControllerBehavior.field = "dataController";

    ScatterDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ScatterDataControllerBehavior.meta, ScatterDataControllerBehavior.behaviors);
      return output;
    };

    ScatterDataControllerBehavior.meta = {};

    ScatterDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("dataXAxis") || !this.visualizer.model.get("dataXAxis") === null || this.visualizer.model.get("dataXAxis").length === 0 || !this.visualizer.model.get("dataYAxis") || !this.visualizer.model.get("datayAxis") === null || this.visualizer.model.get("dataYAxis").length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        this.setEmptyStructures();
        return false;
      }
      return true;
    };

    ScatterDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["dataXAxis"] != null) || (this.visualizer.model.changed["dataYAxis"] != null) || (this.visualizer.model.changed["dataRadius"] != null);
    };

    ScatterDataControllerBehavior.prototype.checkWrongDataCondition = function() {
      return (this.visualizer.xValues.length === 0 && this.visualizer.model.get("dataXAxis") && this.visualizer.model.get("dataXAxis").length > 0) || (this.visualizer.yValues.length === 0 && this.visualizer.model.get("dataYAxis") && this.visualizer.model.get("dataYAxis").length > 0);
    };

    ScatterDataControllerBehavior.prototype.setStructures = function() {
      var radiusInput,
        _this = this;
      this.visualizer.xValues = this.cleanData(this.visualizer.model.get("dataXAxis"));
      this.visualizer.yValues = this.cleanData(this.visualizer.model.get("dataYAxis"));
      radiusInput = this.visualizer.model.get("dataRadius");
      radiusInput = radiusInput[0];
      this.visualizer.radiusValues = this.cleanData(radiusInput);
      this.scatterValuesObject = {};
      this.updateScatterValuesObject("xValue", this.visualizer.xValues);
      this.updateScatterValuesObject("yValue", this.visualizer.yValues);
      this.updateScatterValuesObject("radiusValue", this.visualizer.radiusValues);
      this.setScatterDim("xDim", this.visualizer.xValues.label);
      this.setScatterDim("yDim", this.visualizer.yValues.label);
      this.setScatterDim("radiusDim", this.visualizer.radiusValues.label);
      this.originalValuesNum = Object.keys(this.scatterValuesObject).length;
      this.cleanScatterValuesObject();
      this.visualizer.values = _.values(this.scatterValuesObject);
      _.each(this.visualizer.values, function(d, i) {
        d.metadata = {};
        d.metadata["xValue"] = {};
        d.metadata["xValue"].label = _this.visualizer.xValues.label;
        d.metadata["xValue"].metadata = _this.visualizer.xValues.metadata;
        d.metadata["yValue"] = {};
        d.metadata["yValue"].label = _this.visualizer.yValues.label;
        d.metadata["yValue"].metadata = _this.visualizer.yValues.metadata;
        d.metadata["radiusValue"] = {};
        d.metadata["radiusValue"].label = _this.visualizer.radiusValues.label;
        d.metadata["radiusValue"].metadata = _this.visualizer.radiusValues.metadata;
        return d.metadata.dataDimensions = ["xValue", "yValue", "radiusValue"];
      });
      return this.visualizer.ids = _.keys(this.scatterValuesObject);
    };

    ScatterDataControllerBehavior.prototype.cleanScatterValuesObject = function() {
      var key, scatterValue, _ref1, _results;
      _ref1 = this.scatterValuesObject;
      _results = [];
      for (key in _ref1) {
        scatterValue = _ref1[key];
        if ((scatterValue.xValue == null) || (scatterValue.yValue == null)) {
          _results.push(delete this.scatterValuesObject[key]);
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    ScatterDataControllerBehavior.prototype.updateScatterValuesObject = function(field, list) {
      var entry, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = list.length; _i < _len; _i++) {
        entry = list[_i];
        if (_.isNaN(parseFloat(entry.value))) {
          continue;
        }
        if (!this.scatterValuesObject[entry.id]) {
          this.scatterValuesObject[entry.id] = {
            id: entry.id,
            dataDimensions: ["xValue", "yValue", "radiusValue"]
          };
        }
        _results.push(this.scatterValuesObject[entry.id][field] = entry.value);
      }
      return _results;
    };

    ScatterDataControllerBehavior.prototype.setScatterDim = function(dim, value) {
      var key, scatterValue, _ref1, _results;
      _ref1 = this.scatterValuesObject;
      _results = [];
      for (key in _ref1) {
        scatterValue = _ref1[key];
        _results.push(scatterValue[dim] = value);
      }
      return _results;
    };

    ScatterDataControllerBehavior.prototype.cleanData = function(list) {
      var candidate, cleanValue, outputList, _i, _len;
      if (_.isString(list)) {
        return [
          {
            id: "0",
            value: parseFloat(list.replace(/\,/g, ''))
          }
        ];
      }
      outputList = [];
      outputList.label = list.label;
      outputList.metadata = list.metadata;
      for (_i = 0, _len = list.length; _i < _len; _i++) {
        candidate = list[_i];
        cleanValue = candidate.value;
        if (cleanValue != null) {
          if (!_.isNumber(cleanValue)) {
            cleanValue = parseFloat(cleanValue.replace(/\,/g, ''));
          }
          if (!isNaN(cleanValue)) {
            candidate.value = cleanValue;
            outputList.push(candidate);
          }
        }
      }
      return outputList;
    };

    ScatterDataControllerBehavior.prototype.getXDomainValues = function() {
      var key, v, values, _ref1;
      values = [];
      _ref1 = this.scatterValuesObject;
      for (key in _ref1) {
        v = _ref1[key];
        values.push(v.xValue);
      }
      return values;
    };

    ScatterDataControllerBehavior.prototype.getYDomainValues = function() {
      var key, v, values, _ref1;
      values = [];
      _ref1 = this.scatterValuesObject;
      for (key in _ref1) {
        v = _ref1[key];
        values.push(v.yValue);
      }
      return values;
    };

    return ScatterDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.NetworkDataControllerBehavior = (function(_super) {
    __extends(NetworkDataControllerBehavior, _super);

    function NetworkDataControllerBehavior() {
      this.updateValuesOnObject = __bind(this.updateValuesOnObject, this);
      this.setIndexesOfNodesOnRels = __bind(this.setIndexesOfNodesOnRels, this);
      this.setWeights = __bind(this.setWeights, this);
      this.setWeightsOfRelations = __bind(this.setWeightsOfRelations, this);
      this.setWeightsOfNodes = __bind(this.setWeightsOfNodes, this);
      this.cleanNodesSource = __bind(this.cleanNodesSource, this);
      this.setStructures = __bind(this.setStructures, this);
      this.checkWrongDataCondition = __bind(this.checkWrongDataCondition, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = NetworkDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    NetworkDataControllerBehavior.behaviors = [];

    NetworkDataControllerBehavior.stage = "structure";

    NetworkDataControllerBehavior.field = "dataController";

    NetworkDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(NetworkDataControllerBehavior.meta, NetworkDataControllerBehavior.behaviors);
      return output;
    };

    NetworkDataControllerBehavior.meta = {};

    NetworkDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("network") || !this.visualizer.model.get("network") === null || this.visualizer.model.get("network").length === 0 || !this.visualizer.model.get("network")[0] || !this.visualizer.model.get("network")[0] === null || this.visualizer.model.get("network")[0].length === 0 || !this.visualizer.model.get("network")[1] || !this.visualizer.model.get("network")[1] === null || this.visualizer.model.get("network")[1].length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        this.setEmptyStructures();
        return false;
      }
      return true;
    };

    NetworkDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["network"] != null) || (this.visualizer.model.changed["values"] != null) || (this.visualizer.model.changed["linkThickness"] != null);
    };

    NetworkDataControllerBehavior.prototype.checkWrongDataCondition = function() {
      return this.visualizer.networkObject.nodes.length === 0 && this.visualizer.model.get("nodes") && this.visualizer.model.get("nodes").length > 0;
    };

    NetworkDataControllerBehavior.prototype.setStructures = function() {
      var nodesArray, nodesCol, relationsArray, relationsCol, _i, _j, _len, _len1, _ref1, _ref2;
      this.visualizer.nodesSource = this.cleanNodesSource(this.visualizer.model.get("network")[0]);
      this.visualizer.relationsSource = this.visualizer.model.get("network")[1];
      this.nodesObject = {};
      _ref1 = this.visualizer.nodesSource;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        nodesCol = _ref1[_i];
        this.updateValuesOnObject(this.nodesObject, nodesCol.id, nodesCol.value, "value");
      }
      this.setWeightsOfNodes();
      nodesArray = _.values(this.nodesObject);
      this.relationsObject = {};
      _ref2 = this.visualizer.relationsSource;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        relationsCol = _ref2[_j];
        this.updateValuesOnObject(this.relationsObject, relationsCol.id, relationsCol.value, "relationValue");
      }
      this.setWeightsOfRelations();
      this.setIndexesOfNodesOnRels(this.relationsObject, nodesArray);
      relationsArray = _.values(this.relationsObject);
      this.visualizer.networkObject = {
        nodes: nodesArray,
        relations: relationsArray
      };
      this.visualizer.ids = _.keys(this.nodesObject);
      this.visualizer.idsRelations = _.keys(this.relationsObject);
      this.visualizer.values = nodesArray;
      this.visualizer.relationsValues = relationsArray;
      this.visualizer.radiusValues = _.map(nodesArray, function(d) {
        return {
          id: d.id,
          value: d.value
        };
      });
      this.visualizer.model.original.idsRelations = this.visualizer.idsRelations;
      return this.visualizer.weightRelations = _.map(relationsArray, function(d) {
        return {
          id: d.id,
          value: d.value
        };
      });
    };

    NetworkDataControllerBehavior.prototype.cleanNodesSource = function(source) {
      if (_.isArray(source[0].value)) {
        return source;
      } else {
        return [
          {
            id: "name",
            value: source
          }
        ];
      }
    };

    NetworkDataControllerBehavior.prototype.setWeightsOfNodes = function() {
      var externalWeights;
      if (_.isArray(this.visualizer.model.get("values")) && this.visualizer.model.get("values").currentFormat === "PxByValues") {
        if ((this.visualizer.model.get("values")[0][0] != null) && _.isArray(this.visualizer.model.get("values")[0][0].value)) {
          externalWeights = this.visualizer.model.get("values")[0][0].value;
        } else {
          externalWeights = this.visualizer.model.get("values")[0];
        }
      }
      return this.setWeights(this.nodesObject, externalWeights, "value");
    };

    NetworkDataControllerBehavior.prototype.setWeightsOfRelations = function() {
      var externalWeightsRelations;
      if (_.isArray(this.visualizer.model.get("linkThickness")) && this.visualizer.model.get("linkThickness").currentFormat === "PxByValues") {
        if ((this.visualizer.model.get("linkThickness")[0][0] != null) && _.isArray(this.visualizer.model.get("linkThickness")[0][0].value)) {
          externalWeightsRelations = this.visualizer.model.get("linkThickness")[0][0].value;
        } else {
          externalWeightsRelations = this.visualizer.model.get("linkThickness")[0];
        }
      }
      return this.setWeights(this.relationsObject, externalWeightsRelations, "relationValue");
    };

    NetworkDataControllerBehavior.prototype.setWeights = function(sourceObject, externalWeights, propertyName) {
      var externalWeightEntry, objectInfo, objectInfoKey, _i, _len, _results;
      if (externalWeights) {
        for (_i = 0, _len = externalWeights.length; _i < _len; _i++) {
          externalWeightEntry = externalWeights[_i];
          objectInfo = sourceObject[externalWeightEntry.id];
          if (objectInfo != null) {
            objectInfo.externalWeight = externalWeightEntry.value;
          }
        }
      }
      _results = [];
      for (objectInfoKey in sourceObject) {
        objectInfo = sourceObject[objectInfoKey];
        objectInfo.value = 0;
        if (objectInfo.Weight || objectInfo.weight) {
          objectInfo.value = parseFloat(objectInfo.Weight || objectInfo.weight);
          objectInfo.metadata[propertyName].label = "Weight";
        }
        if (objectInfo.externalWeight) {
          objectInfo.metadata[propertyName].label = externalWeights.label;
          objectInfo.value = parseFloat(objectInfo.externalWeight);
        }
        _results.push(objectInfo[propertyName] = objectInfo.value);
      }
      return _results;
    };

    NetworkDataControllerBehavior.prototype.setIndexesOfNodesOnRels = function(relations, nodes) {
      var idNodesDict, index, nodeEntry, relationEntry, relationKey, _i, _j, _len, _len1, _ref1, _results;
      idNodesDict = {};
      for (index = _i = 0, _len = nodes.length; _i < _len; index = ++_i) {
        nodeEntry = nodes[index];
        idNodesDict[nodeEntry.id] = index;
      }
      for (relationKey in relations) {
        relationEntry = relations[relationKey];
        relationEntry.source = idNodesDict[relationEntry.Origin];
        relationEntry.target = idNodesDict[relationEntry.Destination];
        if (relationEntry.target == null) {
          log(relationEntry.target);
        }
      }
      _ref1 = _.keys(relations);
      _results = [];
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        relationKey = _ref1[_j];
        relationEntry = relations[relationKey];
        if ((relationEntry.source == null) || (relationEntry.target == null)) {
          _results.push(delete relations[relationKey]);
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    NetworkDataControllerBehavior.prototype.updateValuesOnObject = function(object, field, list, propertyName) {
      var entry, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = list.length; _i < _len; _i++) {
        entry = list[_i];
        if (!object[entry.id]) {
          object[entry.id] = {
            id: entry.id,
            value: 0,
            dataDimensions: [propertyName],
            metadata: {
              "dataDimensions": [propertyName]
            }
          };
          object[entry.id].metadata[propertyName] = {
            "label": "value"
          };
        }
        _results.push(object[entry.id][field] = entry.value);
      }
      return _results;
    };

    return NetworkDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RadialNetworkDataControllerBehavior = (function(_super) {
    __extends(RadialNetworkDataControllerBehavior, _super);

    function RadialNetworkDataControllerBehavior() {
      this.updateValuesOnObject = __bind(this.updateValuesOnObject, this);
      this.setWeights = __bind(this.setWeights, this);
      this.setWeightsOfRelations = __bind(this.setWeightsOfRelations, this);
      this.setWeightsOfNodes = __bind(this.setWeightsOfNodes, this);
      this.createNodes = __bind(this.createNodes, this);
      this.nodesAndLinksGeneration = __bind(this.nodesAndLinksGeneration, this);
      this.createLinks = __bind(this.createLinks, this);
      this.createNodeHierarchy = __bind(this.createNodeHierarchy, this);
      this.setStructures = __bind(this.setStructures, this);
      this.checkWrongDataCondition = __bind(this.checkWrongDataCondition, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = RadialNetworkDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RadialNetworkDataControllerBehavior.behaviors = [];

    RadialNetworkDataControllerBehavior.stage = "structure";

    RadialNetworkDataControllerBehavior.field = "dataController";

    RadialNetworkDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(RadialNetworkDataControllerBehavior.meta, RadialNetworkDataControllerBehavior.behaviors);
      return output;
    };

    RadialNetworkDataControllerBehavior.meta = {};

    RadialNetworkDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("network") || !this.visualizer.model.get("network") === null || this.visualizer.model.get("network").length === 0 || !this.visualizer.model.get("network")[0] || !this.visualizer.model.get("network")[0] === null || this.visualizer.model.get("network")[0].length === 0 || !this.visualizer.model.get("network")[1] || !this.visualizer.model.get("network")[1] === null || this.visualizer.model.get("network")[1].length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        this.setEmptyStructures();
        return false;
      }
      return true;
    };

    RadialNetworkDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["network"] != null) || (this.visualizer.model.changed["values"] != null) || (this.visualizer.model.changed["nodeLabels"] != null);
    };

    RadialNetworkDataControllerBehavior.prototype.checkWrongDataCondition = function() {
      return (this.visualizer.nodes != null) && this.visualizer.nodes.length === 0 && this.visualizer.model.get("nodes") && this.visualizer.model.get("nodes").length > 0;
    };

    RadialNetworkDataControllerBehavior.prototype.setStructures = function() {
      return this.nodesAndLinksGeneration();
    };

    RadialNetworkDataControllerBehavior.prototype.createNodeHierarchy = function(nodesSource) {
      var find, map,
        _this = this;
      map = {};
      find = function(id, data) {
        i;
        var i, node;
        node = map[id];
        if (!node) {
          node = map[id] = data || {
            id: id,
            children: []
          };
          if ((id != null) && id.length) {
            node.parent = find(id.substring(0, i = id.lastIndexOf(".")));
            node.parent.children.push(node);
            node.key = id.substring(i + 1);
          }
          node.dataDimensions = ['value'];
          node.metadata = {
            'dataDimensions': node.dataDimensions
          };
          node.metadata['value'] = {
            'label': 'Valor'
          };
        }
        return node;
      };
      JSON.parse(JSON.stringify(nodesSource)).forEach(function(d) {
        return find(d.id, d);
      });
      return map[''];
    };

    RadialNetworkDataControllerBehavior.prototype.createLinks = function(linksSource) {
      var destinations, filtered, origins, result,
        _this = this;
      origins = (linksSource[2].id != null) && _.isObject(linksSource[2].value) ? linksSource[2].value : [];
      destinations = (linksSource[3].id != null) && _.isObject(linksSource[3].value) ? linksSource[3].value : [];
      result = _.map(origins, function(origin, i) {
        return {
          source: _this.visualizer.nodesMap[origin.value],
          target: _this.visualizer.nodesMap[destinations[i].value],
          id: origin.id,
          metadata: {}
        };
      });
      filtered = _.filter(result, function(node, i) {
        return (node.source != null) && (node.target != null);
      });
      return filtered;
    };

    /*
    createLinks_BACKUP: (linksSource) =>
    
      origins = if linksSource[2].id? && _.isObject(linksSource[2].value) then linksSource[2].value else []
      destinations = if linksSource[3].id? && _.isObject(linksSource[3].value) then linksSource[3].value else []
    
      return _.map(
                _.filter(origins, (origin, i) =>
    
                  return origin.value? && destinations[i].value? && @visualizer.nodesMap[origin.value]? && @visualizer.nodesMap[destinations[i].value]? 
    
                ), (origin, i) =>
    
                  return {
                    source: @visualizer.nodesMap[origin.value],
                    target: @visualizer.nodesMap[destinations[i].value]
                    id: origin.id
                    metadata: {}
                  }
              )
    */


    RadialNetworkDataControllerBehavior.prototype.nodesAndLinksGeneration = function() {
      var linksdict, rel, relationsCol, _i, _j, _len, _len1, _ref1, _ref2;
      this.visualizer.nodesSource = this.createNodes(this.visualizer.model.get("network")[0]);
      this.visualizer.linksSource = this.visualizer.model.get("network")[1];
      this.visualizer.networkObject = {};
      this.visualizer.networkObject['nodes'] = this.createNodeHierarchy(this.visualizer.nodesSource);
      this.visualizer.nodesMap = _.object(_.map(this.visualizer.networkObject.nodes.children, function(node) {
        return [node.id, node];
      }));
      this.bundle = d3.layout.bundle();
      this.visualizer.networkObject['links'] = this.createLinks(this.visualizer.linksSource);
      this.visualizer.networkObject['bundleLinks'] = _.each(this.bundle(this.visualizer.networkObject.links), function(link) {
        if (link[2] != null) {
          return link.id = link[0].id + '->' + link[2].id;
        } else {
          return link.id = link[0].id + '->' + link[0].id;
        }
      });
      this.visualizer.idsRelations = _.map(this.visualizer.networkObject['bundleLinks'], function(d) {
        return d.id;
      });
      this.visualizer.values = this.visualizer.networkObject.nodes;
      this.visualizer.ids = _.map(this.visualizer.networkObject.nodes.children, function(node) {
        return node.id;
      });
      linksdict = {};
      _ref1 = this.visualizer.networkObject.links;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        rel = _ref1[_i];
        linksdict[rel.id] = rel;
      }
      _ref2 = this.visualizer.linksSource;
      for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
        relationsCol = _ref2[_j];
        this.updateValuesOnObject(linksdict, relationsCol.id, relationsCol.value, "relationValue");
      }
      this.visualizer.model.original.idsRelations = this.visualizer.idsRelations;
      this.setWeightsOfNodes();
      return this.setWeightsOfRelations();
    };

    RadialNetworkDataControllerBehavior.prototype.createNodes = function(source) {
      var nodes,
        _this = this;
      if (_.isArray(source[0].value)) {
        nodes = JSON.parse(JSON.stringify(source[0].value));
      } else {
        nodes = JSON.parse(JSON.stringify(source));
      }
      if (_.isArray(this.visualizer.model.get('values'))) {
        _.each(nodes, function(node) {
          var item;
          item = _.findWhere(_this.visualizer.model.get('values'), {
            id: node.id
          });
          if (item != null) {
            return node.value = item.value;
          } else {
            return node.value = '-';
          }
        });
      } else {
        _.each(nodes, function(node) {
          return node.value = _this.visualizer.model.get('values');
        });
      }
      if (_.isArray(this.visualizer.model.get('nodeLabels'))) {
        _.each(nodes, function(node) {
          var item;
          item = _.findWhere(_this.visualizer.model.get('nodeLabels'), {
            id: node.id
          });
          if (item != null) {
            return node.label = item.value;
          } else {
            return node.label = null;
          }
        });
      } else {
        _.each(nodes, function(node) {
          return node.label = _this.visualizer.model.get('nodeLabels');
        });
      }
      return nodes;
    };

    RadialNetworkDataControllerBehavior.prototype.setWeightsOfNodes = function() {
      var externalWeights, node, nodesdict, _i, _len, _ref1;
      if (_.isArray(this.visualizer.model.get("values"))) {
        if ((this.visualizer.model.get("values")[0] != null) && _.isArray(this.visualizer.model.get("values")[0].value)) {
          externalWeights = this.visualizer.model.get("values")[0].value;
        } else {
          externalWeights = this.visualizer.model.get("values");
        }
      }
      nodesdict = {};
      _ref1 = this.visualizer.networkObject.nodes;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        node = _ref1[_i];
        nodesdict[node.id] = node;
      }
      return this.setWeights(nodesdict, externalWeights, "value");
    };

    RadialNetworkDataControllerBehavior.prototype.setWeightsOfRelations = function() {
      var externalWeightsRelations, linksdict, rel, _i, _len, _ref1;
      if (_.isArray(this.visualizer.model.get("linkThickness")) && this.visualizer.model.get("linkThickness").currentFormat === "PxByValues") {
        if ((this.visualizer.model.get("linkThickness")[0][0] != null) && _.isArray(this.visualizer.model.get("linkThickness")[0][0].value)) {
          externalWeightsRelations = this.visualizer.model.get("linkThickness")[0][0].value;
        } else {
          externalWeightsRelations = this.visualizer.model.get("linkThickness")[0];
        }
      }
      linksdict = {};
      _ref1 = this.visualizer.networkObject.links;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        rel = _ref1[_i];
        linksdict[rel.id] = rel;
      }
      return this.setWeights(linksdict, externalWeightsRelations, "relationValue");
    };

    RadialNetworkDataControllerBehavior.prototype.setWeights = function(sourceObject, externalWeights, propertyName) {
      var externalWeightEntry, objectInfo, objectInfoKey, _i, _len, _results;
      if (externalWeights) {
        for (_i = 0, _len = externalWeights.length; _i < _len; _i++) {
          externalWeightEntry = externalWeights[_i];
          objectInfo = sourceObject[externalWeightEntry.id];
          if (objectInfo != null) {
            objectInfo.externalWeight = externalWeightEntry.value;
          }
        }
      }
      _results = [];
      for (objectInfoKey in sourceObject) {
        objectInfo = sourceObject[objectInfoKey];
        objectInfo.value = null;
        if (objectInfo.Weight || objectInfo.weight) {
          objectInfo.value = parseFloat(objectInfo.Weight || objectInfo.weight);
          objectInfo.metadata[propertyName].label = "Weight";
        }
        if (objectInfo.externalWeight) {
          objectInfo.metadata[propertyName].label = externalWeights.label;
          objectInfo.value = parseFloat(objectInfo.externalWeight);
        }
        _results.push(objectInfo[propertyName] = objectInfo.value);
      }
      return _results;
    };

    RadialNetworkDataControllerBehavior.prototype.updateValuesOnObject = function(object, field, list, propertyName) {
      var entry, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = list.length; _i < _len; _i++) {
        entry = list[_i];
        if (!object[entry.id]) {
          object[entry.id] = {
            id: entry.id,
            value: 0,
            dataDimensions: [propertyName],
            metadata: {
              "dataDimensions": [propertyName]
            }
          };
        }
        object[entry.id].metadata[propertyName] = {
          "label": "value"
        };
        _results.push(object[entry.id][field] = entry.value);
      }
      return _results;
    };

    return RadialNetworkDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.MatrixDataControllerBehavior = (function(_super) {
    __extends(MatrixDataControllerBehavior, _super);

    function MatrixDataControllerBehavior() {
      this.setDimension = __bind(this.setDimension, this);
      this.setStructures = __bind(this.setStructures, this);
      this.checkDataChanged = __bind(this.checkDataChanged, this);
      this.behaviorChecking = __bind(this.behaviorChecking, this);
      _ref = MatrixDataControllerBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    MatrixDataControllerBehavior.behaviors = [];

    MatrixDataControllerBehavior.field = "dataController";

    MatrixDataControllerBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(MatrixDataControllerBehavior.meta, MatrixDataControllerBehavior.behaviors);
      return output;
    };

    MatrixDataControllerBehavior.meta = {
      "properties": {
        "dimensionAsItems": {
          "uiTipContent": "Determines if each item (line) is a row or a column of the input table",
          "label": "Data table orientation",
          "family": "data",
          "sortingWeight": "5",
          "hidden": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Columns"
              },
              "options": {
                "value": ["Rows", "Columns"]
              }
            }
          }
        }
      }
    };

    MatrixDataControllerBehavior.prototype.behaviorChecking = function() {
      if (!this.visualizer.model.get("data") || this.visualizer.model.get("data") === null || this.visualizer.model.get("data").length === 0) {
        if (this.visualizer.model.get("fetchState") === "ready") {
          this.notify("InvalidData");
        } else {
          this.notify("EmptyData");
        }
        return false;
      }
      return true;
    };

    MatrixDataControllerBehavior.prototype.checkDataChanged = function() {
      return (this.visualizer.model.changed["data"] != null) || (this.visualizer.model.changed["dimensionAsItems"] != null);
    };

    MatrixDataControllerBehavior.prototype.setStructures = function() {
      var self,
        _this = this;
      this.visualizer.values = this.setDimension(this.visualizer.model.get("data"), this.visualizer.model.get("dimensionAsItems"));
      this.visualizer.ids = [];
      this.visualizer.idsItems = [];
      self = this;
      if (!this.visualizer.values || this.visualizer.values.length === 0) {
        this.notify("EmptyData");
        return;
      }
      _.each(this.visualizer.values, function(da, i) {
        return _.each(da.value, function(d, i) {
          d.metadata = {};
          d.metadata["value"] = {};
          d.metadata["value"].label = self.visualizer.values.label;
          d.metadata["value"].metadata = self.visualizer.values.metadata;
          return d.metadata.dataDimensions = ["value"];
        });
      });
      return this.visualizer.ids = _.map(this.visualizer.values, function(d, i) {
        return d.id;
      });
    };

    MatrixDataControllerBehavior.prototype.setDimension = function(values, dimension) {
      var dimObject, item, item1, item2, output, _i, _j, _len, _len1, _ref1;
      if (dimension === "Columns") {
        return values;
      }
      output = [];
      output.label = values.label;
      output.metadata = values.metadata;
      dimObject = {};
      for (_i = 0, _len = values.length; _i < _len; _i++) {
        item1 = values[_i];
        if (_.isArray(item1.value)) {
          _ref1 = item1.value;
          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
            item2 = _ref1[_j];
            if (!dimObject[item2.id]) {
              dimObject[item2.id] = [];
            }
            dimObject[item2.id].push({
              id: item1.id,
              value: item2.value
            });
          }
        }
      }
      for (item in dimObject) {
        output.push({
          id: item,
          value: dimObject[item]
        });
      }
      return output;
    };

    return MatrixDataControllerBehavior;

  }).call(this, quadrigram.Models.DataControllerBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TooltipBehavior = (function(_super) {
    __extends(TooltipBehavior, _super);

    function TooltipBehavior() {
      this.getFontFamily = __bind(this.getFontFamily, this);
      this.injectStyles = __bind(this.injectStyles, this);
      this.afterBodyFunction = __bind(this.afterBodyFunction, this);
      this.bodyFunction = __bind(this.bodyFunction, this);
      this.titleFunction = __bind(this.titleFunction, this);
      this.getTooltipSettings = __bind(this.getTooltipSettings, this);
      this.scaleQTip = __bind(this.scaleQTip, this);
      this.startQTip = __bind(this.startQTip, this);
      this.createTooltipInfoObjects = __bind(this.createTooltipInfoObjects, this);
      this.updateConfig = __bind(this.updateConfig, this);
      this.updateToolTip = __bind(this.updateToolTip, this);
      this.executeAfterUpdateStage = __bind(this.executeAfterUpdateStage, this);
      this.defaultSettingsChanged = __bind(this.defaultSettingsChanged, this);
      this.initialize = __bind(this.initialize, this);
      _ref = TooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TooltipBehavior.field = "tooltip";

    TooltipBehavior.meta = {
      "properties": {
        "tooltipActive": {
          "uiTipContent": "Determines whether to show tooltips or not",
          "role": "visibility",
          "label": "Use tooltips",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "68",
          "multivalue": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": true
              }
            }
          }
        },
        "tooltipType": {
          "uiTipContent": "Determines when the tooltip will be shown",
          "role": "unkown",
          "label": "Tooltip type",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "69",
          "multivalue": false,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Delayed"
              },
              "options": {
                "value": ["Instant", "Delayed", "After selection"]
              }
            }
          }
        },
        "tooltipTitle": {
          "uiTipContent": "Defines the title of the tooltip for each item. By default it will take the identifiers from the main Data property",
          "role": "title",
          "label": "Tooltip titles",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "70",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Title"
              }
            }
          }
        },
        "tooltipValue": {
          "uiTipContent": "Defines the content of the tooltip for each item. By default it will take the values from the main Data property",
          "role": "value",
          "target": "value",
          "label": "Tooltip values",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "PrefixSufix": {
              "multiValues": {
                "prefix": false,
                "sufix": false
              },
              "defaults": {
                "label": "",
                "prefix": "",
                "sufix": ""
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipDescription": {
          "uiTipContent": "Defines an additional description for each tooltip (max. 140 characters)",
          "role": "description",
          "label": "Tooltip descriptions",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Description"
              }
            }
          }
        },
        "tooltipImage": {
          "uiTipContent": "Defines an image to be shown in each tooltip",
          "role": "image",
          "label": "Tooltip Image urls",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": true
              }
            },
            "ImageUrl": {
              "label": "Image",
              "multiValues": {
                "value": true,
                "scale": false,
                "repeat": false
              },
              "defaults": {
                "value": "",
                "scale": "cover",
                "repeat": "false"
              },
              "options": {
                "scale": ["contain", "cover", "stretch", "preserve"]
              }
            },
            "Text": {
              "deprecated": true,
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipStyle": {
          "uiTipContent": "Defines the style of the tooltips",
          "label": "Tooltip styles",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "70",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "default"
              },
              "options": {
                "value": quadrigram.Managers.ToolTipManager.listStyles()
              }
            }
          }
        }
      }
    };

    TooltipBehavior.behaviors = [];

    TooltipBehavior.stage = "afterUpdate";

    TooltipBehavior.internalTooltipSettings = void 0;

    TooltipBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TooltipBehavior.meta, TooltipBehavior.behaviors);
      return output;
    };

    TooltipBehavior.prototype.tooltipEffect = true;

    TooltipBehavior.prototype.tooltipEvent = "mouseover click";

    TooltipBehavior.prototype.templateBody = JST['app/scripts/templates/visualizers/tooltipBody.hbs'];

    TooltipBehavior.prototype.templateTitle = JST['app/scripts/templates/visualizers/tooltipTitle.hbs'];

    TooltipBehavior.prototype.searchField = ".item";

    TooltipBehavior.prototype.baseObjects = "values";

    TooltipBehavior.prototype.initialize = function(visualizer) {
      if (quadrigram.router.getDevice() !== "Desktop") {
        this.tooltipEvent = "touchstart";
        this.tooltipEffect = false;
      }
      $('.tooltip-layer').tooltip();
      quadrigram.router.dataModels.currentProject.on("change:tooltip-settings", this.defaultSettingsChanged);
      return this.config = {
        followMouse: false,
        bodyFields: [
          {
            field: "value",
            label: {
              objectField: "label",
              "default": "value"
            }
          }
        ]
      };
    };

    TooltipBehavior.prototype.defaultSettingsChanged = function() {
      return this.updateToolTip();
    };

    TooltipBehavior.prototype.executeAfterUpdateStage = function() {
      if (this.visualizer.changedData || this.checkOwnPropertyChanged()) {
        return this.updateToolTip();
      }
    };

    TooltipBehavior.prototype.updateToolTip = function() {
      var bodyFields, vizModel;
      if (!this.visualizer) {
        return;
      }
      vizModel = this.visualizer.model;
      bodyFields = this.visualizer.bodyFields ? this.visualizer.bodyFields : this.config.bodyFields;
      return this.updateConfig({
        itemsEnter: this.visualizer.itemsEnter,
        itemsExit: this.visualizer.itemsExit,
        followMouse: this.visualizer.followMouse,
        bodyFields: bodyFields,
        tooltipTitle: vizModel.get("tooltipTitle"),
        tooltipValue: vizModel.get("tooltipValue"),
        tooltipDescription: vizModel.get("tooltipDescription"),
        tooltipImage: vizModel.get("tooltipImage"),
        tooltipStyle: vizModel.get("tooltipStyle"),
        tooltipActive: vizModel.get("tooltipActive"),
        tooltipType: vizModel.get("tooltipType")
      });
    };

    TooltipBehavior.prototype.updateConfig = function(newConfig) {
      var field, tooltipActive;
      this.visualizer.$el.find('.qtip').remove();
      for (field in newConfig) {
        this.config[field] = newConfig[field];
      }
      if (this.config.tooltipStyle === quadrigram.Models.VisualizerModel.DEACTIVATED) {
        this.internalTooltipSettings = void 0;
      } else {
        this.internalTooltipSettings = quadrigram.router.appViews.projectView.toolTipManager.getStyle(this.config.tooltipStyle);
      }
      this.createTooltipInfoObjects();
      tooltipActive = this.config["tooltipActive"] !== "false";
      this.visualizer.$el.find(this.searchField).off(this.tooltipEvent, this.startQTip);
      if (tooltipActive) {
        return this.visualizer.$el.find(this.searchField).on(this.tooltipEvent, this.startQTip);
      } else {
        this.visualizer.$el.find(this.searchField).off(this.tooltipEvent, this.startQTip);
        return $(".qtip-visualizer").remove();
      }
    };

    TooltipBehavior.prototype.createTooltipInfoObjects = function() {
      var blockEntry, dataDimension, dimension, dimensionBlock, dimensionKey, dimensions, itemValue, label, prefix, setImageData, sufix, tooltipObject, tooltipObjectKey, uniqueRepeat, uniqueScale, value, _i, _j, _len, _len1, _ref1, _ref2, _results,
        _this = this;
      this.tooltipObjects = {};
      dimensions = this.visualizer.model.original.info().properties;
      _ref1 = this.visualizer[this.baseObjects];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        itemValue = _ref1[_i];
        this.tooltipObjects[itemValue.id] = {};
        if (itemValue.name) {
          this.tooltipObjects[itemValue.id].title = itemValue.name;
        } else {
          this.tooltipObjects[itemValue.id].title = itemValue.id;
        }
        this.tooltipObjects[itemValue.id].metadata = itemValue.metadata;
        this.tooltipObjects[itemValue.id].dataDimensions = {};
        _ref2 = itemValue.metadata.dataDimensions;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          dataDimension = _ref2[_j];
          this.tooltipObjects[itemValue.id].dataDimensions[dataDimension] = itemValue[dataDimension];
        }
      }
      _results = [];
      for (dimensionKey in dimensions) {
        dimension = dimensions[dimensionKey];
        if (!dimension.role || dimension.family !== "tooltip") {
          continue;
        }
        dimensionBlock = this.visualizer.model.get(dimensionKey);
        if (dimensionBlock.currentFormat === "PrefixSufix") {
          _results.push((function() {
            var _ref3, _results1;
            _ref3 = this.tooltipObjects;
            _results1 = [];
            for (tooltipObjectKey in _ref3) {
              tooltipObject = _ref3[tooltipObjectKey];
              if (tooltipObject.metadata[dimension.target] != null) {
                label = dimensionBlock[0];
                if (label === "") {
                  label = tooltipObject.metadata[dimension.target].label + ": ";
                }
                prefix = dimensionBlock[1];
                if (prefix === "") {
                  prefix = void 0;
                }
                sufix = dimensionBlock[2];
                if (prefix === "") {
                  sufix = void 0;
                }
                if (tooltipObject.dataDimensions[dimension.target] != null) {
                  value = (Math.round(100 * parseFloat(tooltipObject.dataDimensions[dimension.target])) / 100).toString();
                } else {
                  value = void 0;
                }
                if (!tooltipObject[dimension.role]) {
                  tooltipObject[dimension.role] = [];
                }
                _results1.push(tooltipObject[dimension.role].push({
                  label: label,
                  prefix: prefix,
                  value: value,
                  sufix: sufix
                }));
              } else {
                _results1.push(void 0);
              }
            }
            return _results1;
          }).call(this));
        } else if (dimensionBlock.currentFormat === "ImageUrl") {
          setImageData = function(tooltipObject, imageRID, imageScale, imageRepeat) {
            tooltipObject["imagecss"] = _this.calculateImageCSS(imageScale, imageRepeat);
            return quadrigram.router.managers.serverManager.getImageUrl(imageRID, function(resultUrl) {
              var pic;
              tooltipObject["image"] = resultUrl;
              pic = new Image();
              return pic.src = resultUrl;
            });
          };
          uniqueScale = _.isArray(dimensionBlock[1]) ? dimensionBlock[1][0].value : dimensionBlock[1];
          uniqueRepeat = _.isArray(dimensionBlock[2]) ? dimensionBlock[2][0].value : dimensionBlock[2];
          if (_.isArray(dimensionBlock[0])) {
            _results.push((function() {
              var _k, _len2, _ref3, _results1;
              _ref3 = dimensionBlock[0];
              _results1 = [];
              for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
                blockEntry = _ref3[_k];
                tooltipObject = this.tooltipObjects[blockEntry.id];
                if (tooltipObject != null) {
                  _results1.push(setImageData(tooltipObject, blockEntry.value, uniqueScale, uniqueRepeat));
                } else {
                  _results1.push(void 0);
                }
              }
              return _results1;
            }).call(this));
          } else {
            _results.push((function() {
              var _ref3, _results1;
              _ref3 = this.tooltipObjects;
              _results1 = [];
              for (tooltipObjectKey in _ref3) {
                tooltipObject = _ref3[tooltipObjectKey];
                _results1.push(setImageData(tooltipObject, dimensionBlock[0], uniqueScale, uniqueRepeat));
              }
              return _results1;
            }).call(this));
          }
        } else {
          if (_.isArray(dimensionBlock)) {
            _results.push((function() {
              var _k, _len2, _results1;
              _results1 = [];
              for (_k = 0, _len2 = dimensionBlock.length; _k < _len2; _k++) {
                blockEntry = dimensionBlock[_k];
                tooltipObject = this.tooltipObjects[blockEntry.id];
                if (!tooltipObject) {
                  continue;
                }
                if (dimension.role === "value") {
                  if (!tooltipObject[dimension.role]) {
                    tooltipObject[dimension.role] = [];
                  }
                  _results1.push(tooltipObject[dimension.role].push({
                    dim: dimensionKey,
                    value: blockEntry.value
                  }));
                } else {
                  _results1.push(tooltipObject[dimension.role] = blockEntry.value);
                }
              }
              return _results1;
            }).call(this));
          } else {
            if (dimensionBlock === "@QDeactivatedWord") {
              continue;
            }
            _results.push((function() {
              var _ref3, _results1;
              _ref3 = this.tooltipObjects;
              _results1 = [];
              for (tooltipObjectKey in _ref3) {
                tooltipObject = _ref3[tooltipObjectKey];
                if (dimension.role === "value") {
                  if (!tooltipObject[dimension.role]) {
                    tooltipObject[dimension.role] = [];
                  }
                  _results1.push(tooltipObject[dimension.role].push({
                    dim: dimensionKey,
                    value: dimensionBlock
                  }));
                } else {
                  _results1.push(tooltipObject[dimension.role] = dimensionBlock);
                }
              }
              return _results1;
            }).call(this));
          }
        }
      }
      return _results;
    };

    TooltipBehavior.prototype.calculateImageCSS = function(size, repeat) {
      var css;
      css = {};
      switch (size) {
        case "cover":
          css["background-size"] = "cover";
          break;
        case "contain":
          css["background-size"] = "contain";
          break;
        case "stretch":
          css["background-size"] = "100% 100%";
          break;
        case "preserve":
          css["background-size"] = "auto";
      }
      switch (repeat) {
        case "true":
          css["background-repeat"] = "repeat";
          break;
        case "false":
          css["background-repeat"] = "no-repeat";
      }
      css["background-position"] = "center center";
      return "; background-size:" + css["background-size"] + "; background-repeat:" + css["background-repeat"] + "; background-position: center center";
    };

    TooltipBehavior.prototype.startQTip = function(e) {
      var tooltipOptions;
      this.visualizer.$el.find(e.currentTarget).off(this.tooltipEvent, this.startQTip);
      tooltipOptions = this.tooltipOptions(this.config);
      return this.visualizer.$el.find(e.currentTarget).qtip(tooltipOptions, e);
      /*
      _.defer(()=>
        @visualizer.$el.find(e.target).trigger(@tooltipEvent.split(" ")[0])
      )
      */

    };

    TooltipBehavior.prototype.tooltipOptions = function(vizConfig, externalTooltipSettings) {
      var containerDOM, followMouse, output, requireSelected, self, tooltipDelay, tooltipSettings,
        _this = this;
      if (externalTooltipSettings) {
        tooltipSettings = externalTooltipSettings;
        this.internalTooltipSettings = externalTooltipSettings;
      } else {
        tooltipSettings = this.getTooltipSettings();
      }
      followMouse = vizConfig.followMouse;
      tooltipDelay = vizConfig.tooltipType === "Delayed" ? 400 : 0;
      requireSelected = vizConfig.tooltipType === "After selection" ? true : false;
      if (this.visualizer) {
        containerDOM = this.visualizer.el;
      } else {
        containerDOM = "";
      }
      self = this;
      if (followMouse == null) {
        followMouse = false;
      }
      followMouse = true;
      output = {
        content: {
          data: tooltipSettings,
          text: function(event, api) {
            var body, itemDOM;
            itemDOM = this.first()[0];
            body = self.bodyFunction(itemDOM, event, api);
            self.afterBodyFunction(itemDOM, event, api);
            return body;
          },
          title: function(event, api) {
            var itemDOM;
            itemDOM = this.first()[0];
            return self.titleFunction(itemDOM, event, api);
          }
        },
        position: {
          my: 'bottom center',
          at: 'top center',
          viewport: $("body"),
          container: containerDOM,
          target: function() {
            var itemDOM;
            itemDOM = this.first()[0];
            return $(itemDOM);
          },
          adjust: {
            y: -5
          }
        },
        style: {
          classes: tooltipSettings.classes
        },
        hide: {
          effect: this.tooltipEffect
        },
        show: {
          event: this.tooltipEvent,
          delay: tooltipDelay,
          solo: true,
          ready: true
        },
        events: {
          show: function(event, api) {
            var baseValue, correctedValue;
            if (requireSelected && !d3.select(api.target[0]).classed("selected")) {
              event.preventDefault();
            }
            tooltipSettings = _this.getTooltipSettings();
            if (tooltipSettings.roundedCorner && parseFloat(tooltipSettings.roundedCorner.replace("px", "")) > 0) {
              baseValue = (parseFloat(tooltipSettings.roundedCorner.replace("px", ""))) + "px";
              correctedValue = (parseFloat(tooltipSettings.roundedCorner.replace("px", "")) + 2) + "px";
              d3.select(event.target).style("-moz-border-radius", correctedValue).style("-webkit-border-radius", correctedValue).style("border-radius", correctedValue);
              d3.select(event.target).select(".tooltip-title-image").style("-moz-border-radius", baseValue + " " + baseValue + " 0  0").style("-webkit-border-radius", baseValue + " " + baseValue + " 0  0").style("border-radius", baseValue + " " + baseValue + " 0  0");
              d3.select(event.target).select(".qtip-titlebar").style("-moz-border-radius", baseValue + " " + baseValue + " 0  0").style("-webkit-border-radius", baseValue + " " + baseValue + " 0  0").style("border-radius", baseValue + " " + baseValue + " 0  0");
              d3.select(event.target).select(".qtip-content").style("-moz-border-radius", "0  0 " + baseValue + " " + baseValue).style("-webkit-border-radius", "0  0 " + baseValue + " " + baseValue).style("border-radius", "0  0 " + baseValue + " " + baseValue);
            }
            if (tooltipSettings.border) {
              if (tooltipSettings.border.width !== "0px" && tooltipSettings.border.color !== "none") {
                d3.select(event.target).style("border-color", tooltipSettings.border.color).style("border-width", tooltipSettings.border.width);
              } else {
                d3.select(event.target).style("border", "none");
              }
            }
            if (tooltipSettings.body.description && tooltipSettings.body.description.backgroundColor) {
              d3.select(event.target).style("color", tooltipSettings.body.description.backgroundColor);
            } else {
              if (tooltipSettings.body.value && tooltipSettings.body.value.backgroundColor) {
                d3.select(event.target).style("color", tooltipSettings.body.value.backgroundColor);
              }
            }
            return _this.scaleQTip(event, api);
          }
        }
      };
      if (followMouse) {
        output.position.target = "mouse";
        output.position.adjust = {
          mouse: true,
          y: -5,
          x: 0
        };
      }
      return output;
    };

    TooltipBehavior.prototype.scaleQTip = function(event, api) {
      /*
      if quadrigram.router.getDevice() != "Desktop"
        actualSize = api.tooltip.width()*quadrigram.router.dataModels.currentProject.viewPortScale
        if actualSize<220
          tooltipScale = 220/actualSize
        else
          tooltipScale = 1
        api.tooltip.css("transform-origin", "bottom center")
        api.tooltip.css("transform","scale("+tooltipScale+")")
      */

    };

    TooltipBehavior.prototype.getTooltipSettings = function() {
      if (this.internalTooltipSettings) {
        return this.internalTooltipSettings;
      }
      return JSON.parse(JSON.stringify(quadrigram.router.dataModels.currentProject.get("tooltip-settings")));
    };

    TooltipBehavior.prototype.titleFunction = function(itemDOM, event, api) {
      var object, output, titleFontFamilyStyle, tooltipData, tooltipObject, tooltipSettings;
      tooltipSettings = this.getTooltipSettings();
      object = d3.select(itemDOM).datum();
      tooltipObject = this.tooltipObjects[object.id];
      if (tooltipSettings.mainBackgroundColor) {
        tooltipSettings.title.backgroundColor = tooltipSettings.mainBackgroundColor;
        delete tooltipSettings.mainBackgroundColor;
      }
      if (tooltipSettings.mainTextColor) {
        tooltipSettings.title.textColor = tooltipSettings.textColor;
        delete tooltipSettings.mainBackgroundColor;
      }
      tooltipData = _.extend(tooltipObject, {
        fontSize: tooltipSettings.title.fontSize,
        titleStyle: {
          backgroundColor: tooltipSettings.title.backgroundColor,
          textColor: tooltipSettings.title.textColor
        },
        lineHeight: tooltipSettings.title.lineHeight,
        fontFamily: tooltipSettings.fontFamily,
        mainTextColor: tooltipSettings.mainTextColor
      });
      titleFontFamilyStyle = this.getFontFamily(tooltipSettings.fontFamily, tooltipSettings.title.fontStyle);
      tooltipData.fontStyle = titleFontFamilyStyle.fontStyle;
      tooltipData.fontWeight = titleFontFamilyStyle.fontWeight;
      output = this.templateTitle(tooltipData);
      return output;
    };

    TooltipBehavior.prototype.bodyFunction = function(itemDOM, event, api) {
      var object, output, tooltipData, tooltipObject, tooltipSettings;
      tooltipSettings = this.getTooltipSettings();
      object = d3.select(itemDOM).datum();
      tooltipObject = _.clone(this.tooltipObjects[object.id]);
      if (tooltipObject.description && tooltipObject.description.length > 250) {
        tooltipObject.description = tooltipObject.description.substr(0, 246) + "...";
      }
      tooltipData = this.injectStyles(tooltipObject);
      output = this.templateBody(tooltipData);
      return output;
    };

    TooltipBehavior.prototype.afterBodyFunction = function(itemDOM, event, api) {
      var object, tooltipObject, tooltipSettings;
      tooltipSettings = this.getTooltipSettings();
      object = d3.select(itemDOM).datum();
      tooltipObject = _.clone(this.tooltipObjects[object.id]);
      if (tooltipObject.description) {
        d3.select(api.tooltip[0]).style("background-color", tooltipSettings.body.description.backgroundColor);
        return d3.select(api.tooltip[0]).classed("no-desc", false);
      } else {
        d3.select(api.tooltip[0]).style("background-color", tooltipSettings.body.value.backgroundColor);
        return d3.select(api.tooltip[0]).classed("no-desc", true);
      }
    };

    TooltipBehavior.prototype.injectStyles = function(tooltipObject) {
      var descriptionFontFamilyStyle, labelFontFamilyStyle, tooltipData, tooltipSettings, valueFontFamilyStyle;
      tooltipSettings = this.getTooltipSettings();
      tooltipData = _.extend(tooltipObject, {
        style: _.extend(tooltipSettings.body, {
          fontFamily: tooltipSettings.fontFamily,
          mainBackgroundColor: tooltipSettings.mainBackgroundColor,
          mainTextColor: tooltipSettings.mainTextColor
        })
      });
      descriptionFontFamilyStyle = this.getFontFamily(tooltipSettings.fontFamily, tooltipSettings.body.description.fontStyle);
      tooltipData.style.description.fontStyle = descriptionFontFamilyStyle.fontStyle;
      tooltipData.style.description.fontWeight = descriptionFontFamilyStyle.fontWeight;
      valueFontFamilyStyle = this.getFontFamily(tooltipSettings.fontFamily, tooltipSettings.body.value.fontStyle);
      tooltipData.style.value.fontStyle = valueFontFamilyStyle.fontStyle;
      tooltipData.style.value.fontWeight = valueFontFamilyStyle.fontWeight;
      labelFontFamilyStyle = this.getFontFamily(tooltipSettings.fontFamily, tooltipSettings.body.label.fontStyle);
      tooltipData.style.label.fontStyle = labelFontFamilyStyle.fontStyle;
      tooltipData.style.label.fontWeight = labelFontFamilyStyle.fontWeight;
      if ((tooltipSettings.separatorColor == null) || tooltipSettings.separatorColor === "none") {
        tooltipData.style.separatorColor = "transparent";
      } else {
        tooltipData.style.separatorColor = tooltipSettings.separatorColor;
      }
      return tooltipData;
    };

    TooltipBehavior.prototype.getFontFamily = function(familyName, familyStyle) {
      var fontFamilyStyles, output;
      fontFamilyStyles = quadrigram.router.managers.fontManager.getFontStyles(familyName);
      output = _.findWhere(fontFamilyStyles, {
        styleName: familyStyle
      });
      if (!output) {
        output = fontFamilyStyles[0];
      }
      return output;
    };

    TooltipBehavior.prototype.calculateCSS = function(size, repeat) {
      var css;
      css = {};
      switch (size) {
        case "cover":
          css["background-size"] = "cover";
          break;
        case "contain":
          css["background-size"] = "contain";
          break;
        case "stretch":
          css["background-size"] = "100% 100%";
          break;
        case "preserve":
          css["background-size"] = "auto";
      }
      switch (repeat) {
        case "true":
          css["background-repeat"] = "repeat";
          break;
        case "false":
          css["background-repeat"] = "no-repeat";
      }
      css["background-position"] = "center center";
      return css;
    };

    return TooltipBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SecondTooltipBehavior = (function(_super) {
    __extends(SecondTooltipBehavior, _super);

    function SecondTooltipBehavior() {
      this.updateToolTip = __bind(this.updateToolTip, this);
      _ref = SecondTooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SecondTooltipBehavior.field = "secondtooltip";

    SecondTooltipBehavior.behaviors = [];

    SecondTooltipBehavior.meta = {
      "properties": {
        "tooltipActive2": {
          "uiTipContent": "Determines whether to show tooltips or not",
          "role": "visibility",
          "label": "--Use tooltips",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "69",
          "multivalue": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": true
              }
            }
          }
        },
        "tooltipTitle2": {
          "uiTipContent": "Defines the title of the tooltip for each item. By default it will take the identifiers from the main Data property",
          "role": "title2",
          "label": "--Tooltip titles",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "70",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Title"
              }
            }
          }
        },
        "tooltipValue2": {
          "uiTipContent": "Defines the content of the tooltip for each item. By default it will take the values from the main Data property",
          "role": "value2",
          "target": "value",
          "label": "--Tooltip values",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "PrefixSufix": {
              "multiValues": {
                "prefix": false,
                "sufix": false
              },
              "defaults": {
                "label": "",
                "prefix": "",
                "sufix": ""
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipDescription2": {
          "uiTipContent": "Defines an additional description for each tooltip (max. 140 characters)",
          "role": "description2",
          "label": "--Tooltip descriptions",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Description"
              }
            }
          }
        },
        "tooltipImage2": {
          "uiTipContent": "Defines an image to be shown in each tooltip",
          "role": "image2",
          "label": "--Tooltip Image urls",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": true
              }
            },
            "Text": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipStyle2": {
          "uiTipContent": "Defines the style of the tooltips",
          "label": "--Tooltip styles",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "70",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "default"
              },
              "options": {
                "value": quadrigram.Managers.ToolTipManager.listStyles()
              }
            }
          }
        }
      }
    };

    SecondTooltipBehavior.stage = "afterUpdate";

    SecondTooltipBehavior.internalTooltipSettings = void 0;

    SecondTooltipBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(SecondTooltipBehavior.meta, SecondTooltipBehavior.behaviors);
      return output;
    };

    SecondTooltipBehavior.prototype.tooltipEvent = "mouseover";

    SecondTooltipBehavior.prototype.templateBody = JST['app/scripts/templates/visualizers/tooltipBody2.hbs'];

    SecondTooltipBehavior.prototype.templateTitle = JST['app/scripts/templates/visualizers/tooltipTitle2.hbs'];

    SecondTooltipBehavior.prototype.searchField = ".second-item";

    SecondTooltipBehavior.prototype.baseObjects = "values2";

    SecondTooltipBehavior.prototype.updateToolTip = function() {
      var bodyFields, vizModel;
      if (!this.visualizer) {
        return;
      }
      vizModel = this.visualizer.model;
      bodyFields = this.visualizer.bodyFields ? this.visualizer.bodyFields : this.config.bodyFields;
      return this.updateConfig({
        itemsEnter: this.visualizer.itemsEnter2,
        itemsExit: this.visualizer.itemsExit2,
        followMouse: this.visualizer.followMouse2,
        bodyFields: bodyFields,
        tooltipTitle: vizModel.get("tooltipTitle2"),
        tooltipValue: vizModel.get("tooltipValue2"),
        tooltipDescription: vizModel.get("tooltipDescription2"),
        tooltipImage: vizModel.get("tooltipImage2"),
        tooltipStyle: vizModel.get("tooltipStyle2"),
        tooltipActive: vizModel.get("tooltipActive2"),
        tooltipType: vizModel.get("tooltipType")
      });
    };

    return SecondTooltipBehavior;

  }).call(this, quadrigram.Models.TooltipBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TwoDimTooltipBehavior = (function(_super) {
    __extends(TwoDimTooltipBehavior, _super);

    function TwoDimTooltipBehavior() {
      this.dynamicBodyFunction = __bind(this.dynamicBodyFunction, this);
      this.bodyFunction = __bind(this.bodyFunction, this);
      _ref = TwoDimTooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TwoDimTooltipBehavior.prototype.bodyFunction = function(itemDOM, event, api) {
      var self;
      self = this;
      if ($(itemDOM).data("dynamicHandler") != null) {
        $(itemDOM).off("mousemove", $(itemDOM).data("dynamicHandler"));
      }
      $(itemDOM).data("dynamicHandler", function(e) {
        var content, id, object, tooltipBehavior, valueOnX, values, visualizer, x, _base,
          _this = this;
        (_base = self.visualizer.behaviors.axis.xScale).findDomainItemFromRangeValue || (_base.findDomainItemFromRangeValue = self.findDomainItemFromRangeValue);
        visualizer = self.visualizer;
        tooltipBehavior = self;
        x = e.offsetX;
        id = visualizer.behaviors.axis.xScale.findDomainItemFromRangeValue(x, visualizer.behaviors.axis.xAxisRestrains.left);
        object = d3.select(this).datum();
        values = object.value;
        valueOnX = _.findWhere(values, {
          id: String(id)
        });
        content = tooltipBehavior.dynamicBodyFunction(object, valueOnX);
        return _.defer(function() {
          var y;
          api.set('content.text', content);
          if (self.visualizer.followMouse === false) {
            x = self.visualizer.behaviors.axis.xScale(valueOnX.id) + self.visualizer.$el.offset().left + self.visualizer.behaviors.axis.xAxisRestrains.left;
            y = self.visualizer.behaviors.axis.yScale(valueOnX.value) + self.visualizer.$el.offset().top + self.visualizer.behaviors.axis.size.margin.top;
            api.set('position.target', [x, y]);
            return api.reposition(null, false);
          } else {
            return api.reposition(e);
          }
        });
      });
      $(itemDOM).on("mousemove", $(itemDOM).data("dynamicHandler"));
      /*
      $(itemDOM).mousemove({visualizer:@visualizer,behavior:@},(e) ->
        self.visualizer.behaviors.axis.xScale.findDomainItemFromRangeValue ||= self.findDomainItemFromRangeValue
        visualizer  = e.data.visualizer
        tooltipBehavior = e.data.behavior
        # log "afterShow::",e
        x           = e.offsetX
        id          = visualizer.behaviors.axis.xScale.findDomainItemFromRangeValue(x,visualizer.behaviors.axis.calculateYAxisArea())
        object      = d3.select(@).datum()
        values      = object.value
        valueOnX    = _.findWhere(values,{id:id})
        content     = tooltipBehavior.dynamicBodyFunction(object,valueOnX)
        api.set('content.text',content)
      )
      */

      $(itemDOM).trigger(api.mouse);
      return "";
    };

    TwoDimTooltipBehavior.prototype.findDomainItemFromRangeValue_OLD = function(xPos, margin) {
      var candidate, distance, i, id, index, minDistance, _i, _len, _ref1;
      index = -1;
      minDistance = Infinity;
      _ref1 = this.range();
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        candidate = _ref1[i];
        distance = Math.abs(candidate - xPos + margin);
        if (distance < minDistance) {
          minDistance = distance;
          index = i;
        }
      }
      id = void 0;
      if (index !== -1) {
        id = this.domain()[index];
      }
      return id;
    };

    TwoDimTooltipBehavior.prototype.findDomainItemFromRangeValue = function(xPos, margin) {
      var candidate, distance, i, id, index, minDistance, _i, _len, _ref1;
      index = -1;
      minDistance = Infinity;
      _ref1 = this.domainValues;
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        candidate = _ref1[i];
        distance = Math.abs(this(candidate) - xPos + margin);
        if (distance < minDistance) {
          minDistance = distance;
          index = i;
        }
      }
      id = void 0;
      if (index !== -1) {
        id = this.domainValues[index];
      }
      return id;
    };

    TwoDimTooltipBehavior.prototype.dynamicBodyFunction = function(object, valueOnX) {
      var output, tooltipData, tooltipObject, tooltipSettings;
      tooltipSettings = this.getTooltipSettings();
      tooltipObject = _.clone(this.tooltipObjects[object.id]);
      if (tooltipObject.description && tooltipObject.description.length > 140) {
        tooltipObject.description = tooltipObject.description.substr(0, 136) + "...";
      }
      if (valueOnX) {
        tooltipObject.item = valueOnX.id;
        tooltipObject.value[0].value = Math.round(100 * parseFloat(valueOnX.value)) / 100;
      }
      /*
      tooltipData = _.extend( tooltipObject,
          style:_.extend(tooltipSettings.body,{fontFamily:tooltipSettings.fontFamily})
        )
      */

      tooltipData = this.injectStyles(tooltipObject);
      output = this.templateBody(tooltipData);
      return output;
    };

    return TwoDimTooltipBehavior;

  })(quadrigram.Models.TooltipBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SecondTwoDimTooltipBehavior = (function(_super) {
    __extends(SecondTwoDimTooltipBehavior, _super);

    function SecondTwoDimTooltipBehavior() {
      this.dynamicBodyFunction = __bind(this.dynamicBodyFunction, this);
      this.bodyFunction = __bind(this.bodyFunction, this);
      _ref = SecondTwoDimTooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    /*
    bodyFunction: (itemDOM,event,api) =>
      self = @    
      $(itemDOM).mousemove({visualizer:@visualizer,behavior:@},(e) ->
        self.visualizer.behaviors.axis.xScale.findDomainItemFromRangeValue ||= self.findDomainItemFromRangeValue
        visualizer  = e.data.visualizer
        tooltipBehavior = e.data.behavior
        # log "afterShow::",e
        x           = e.offsetX
        id          = visualizer.behaviors.axis.xScale.findDomainItemFromRangeValue(x,visualizer.behaviors.axis.calculateYAxisArea())
        object      = d3.select(@).datum()
        values      = object.value
        valueOnX    = _.findWhere(values,{id:id})
        content     = tooltipBehavior.dynamicBodyFunction(object,valueOnX)
        api.set('content.text',content)
      )
      $(itemDOM).trigger("mousemove")
      return ""
    */


    SecondTwoDimTooltipBehavior.prototype.bodyFunction = function(itemDOM, event, api) {
      var self;
      self = this;
      if ($(itemDOM).data("dynamicHandler") != null) {
        $(itemDOM).off("mousemove", $(itemDOM).data("dynamicHandler"));
      }
      $(itemDOM).data("dynamicHandler", function(e) {
        var content, id, object, tooltipBehavior, valueOnX, values, visualizer, x, _base,
          _this = this;
        (_base = self.visualizer.behaviors.axis.xScale).findDomainItemFromRangeValue || (_base.findDomainItemFromRangeValue = self.findDomainItemFromRangeValue);
        visualizer = self.visualizer;
        tooltipBehavior = self;
        x = e.offsetX;
        id = visualizer.behaviors.axis.xScale.findDomainItemFromRangeValue(x, visualizer.behaviors.axis.xAxisRestrains.left);
        object = d3.select(this).datum();
        values = object.value;
        valueOnX = _.findWhere(values, {
          id: String(id)
        });
        content = tooltipBehavior.dynamicBodyFunction(object, valueOnX);
        return _.defer(function() {
          api.set('content.text', content);
          return api.reposition(e);
        });
      });
      $(itemDOM).on("mousemove", $(itemDOM).data("dynamicHandler"));
      /*
      $(itemDOM).mousemove({visualizer:@visualizer,behavior:@},(e) ->
        self.visualizer.behaviors.axis.xScale.findDomainItemFromRangeValue ||= self.findDomainItemFromRangeValue
        visualizer  = e.data.visualizer
        tooltipBehavior = e.data.behavior
        # log "afterShow::",e
        x           = e.offsetX
        id          = visualizer.behaviors.axis.xScale.findDomainItemFromRangeValue(x,visualizer.behaviors.axis.calculateYAxisArea())
        object      = d3.select(@).datum()
        values      = object.value
        valueOnX    = _.findWhere(values,{id:id})
        content     = tooltipBehavior.dynamicBodyFunction(object,valueOnX)
        api.set('content.text',content)
      )
      */

      $(itemDOM).trigger(api.mouse);
      return "";
    };

    SecondTwoDimTooltipBehavior.prototype.findDomainItemFromRangeValue_OLD = function(xPos, margin) {
      var candidate, distance, i, id, index, minDistance, _i, _len, _ref1;
      index = -1;
      minDistance = Infinity;
      _ref1 = this.range();
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        candidate = _ref1[i];
        distance = Math.abs(candidate - xPos + margin);
        if (distance < minDistance) {
          minDistance = distance;
          index = i;
        }
      }
      id = void 0;
      if (index !== -1) {
        id = this.domain()[index];
      }
      return id;
    };

    SecondTwoDimTooltipBehavior.prototype.findDomainItemFromRangeValue = function(xPos, margin) {
      var candidate, distance, i, id, index, minDistance, _i, _len, _ref1;
      index = -1;
      minDistance = Infinity;
      _ref1 = this.domainValues;
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        candidate = _ref1[i];
        distance = Math.abs(this(candidate) - xPos + margin);
        if (distance < minDistance) {
          minDistance = distance;
          index = i;
        }
      }
      id = void 0;
      if (index !== -1) {
        id = this.domainValues[index];
      }
      return id;
    };

    SecondTwoDimTooltipBehavior.prototype.dynamicBodyFunction = function(object, valueOnX) {
      var output, tooltipData, tooltipObject, tooltipSettings;
      tooltipSettings = this.getTooltipSettings();
      tooltipObject = _.clone(this.tooltipObjects[object.id]);
      if (tooltipObject.description2 && tooltipObject.description2.length > 140) {
        tooltipObject.description2 = tooltipObject.description2.substr(0, 136) + "...";
      }
      if (valueOnX) {
        tooltipObject.item = valueOnX.id;
        tooltipObject.value2[0].value = Math.round(100 * parseFloat(valueOnX.value)) / 100;
      }
      /*
      tooltipData = _.extend( tooltipObject,
          style:_.extend(tooltipSettings.body,{fontFamily:tooltipSettings.fontFamily})
        )
      */

      tooltipData = this.injectStyles(tooltipObject);
      output = this.templateBody(tooltipData);
      return output;
    };

    return SecondTwoDimTooltipBehavior;

  })(quadrigram.Models.SecondTooltipBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.StackedTooltipBehavior = (function(_super) {
    __extends(StackedTooltipBehavior, _super);

    function StackedTooltipBehavior() {
      this.dynamicBodyFunction = __bind(this.dynamicBodyFunction, this);
      this.bodyFunction = __bind(this.bodyFunction, this);
      this.bodyFunction_OLD = __bind(this.bodyFunction_OLD, this);
      _ref = StackedTooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    StackedTooltipBehavior.prototype.bodyFunction_OLD = function(itemDOM, event, api) {
      var mainObject, output, tooltipData, tooltipObject, tooltipSettings, valueOnX;
      tooltipSettings = this.getTooltipSettings();
      mainObject = d3.select(itemDOM).datum();
      valueOnX = d3.select(event.target).datum();
      tooltipObject = _.clone(this.tooltipObjects[mainObject.id]);
      if (tooltipObject.description && tooltipObject.description.length > 140) {
        tooltipObject.description = tooltipObject.description.substr(0, 136) + "...";
      }
      tooltipObject.item = valueOnX.id;
      tooltipObject.value[0].value = Math.round(100 * parseFloat(valueOnX.value)) / 100;
      tooltipData = _.extend(tooltipObject, {
        style: _.extend(tooltipSettings.body, {
          fontFamily: tooltipSettings.fontFamily
        })
      });
      output = this.templateBody(tooltipData);
      return output;
    };

    StackedTooltipBehavior.prototype.bodyFunction = function(itemDOM, event, api) {
      var self;
      self = this;
      if ($(itemDOM).data("dynamicHandler") != null) {
        $(itemDOM).off("mousemove", $(itemDOM).data("dynamicHandler"));
      }
      $(itemDOM).data("dynamicHandler", function(e) {
        var content,
          _this = this;
        content = self.dynamicBodyFunction(itemDOM, e, api);
        return _.defer(function() {
          api.set('content.text', content);
          return api.reposition(e);
        });
      });
      $(itemDOM).on("mousemove", $(itemDOM).data("dynamicHandler"));
      $(itemDOM).trigger(api.mouse);
      return "";
    };

    StackedTooltipBehavior.prototype.dynamicBodyFunction = function(itemDOM, event, api) {
      var mainObject, output, tooltipData, tooltipObject, tooltipSettings, valueOnX;
      tooltipSettings = this.getTooltipSettings();
      mainObject = d3.select(itemDOM).datum();
      valueOnX = d3.select(event.target).datum();
      tooltipObject = _.clone(this.tooltipObjects[mainObject.id]);
      if (tooltipObject.description && tooltipObject.description.length > 140) {
        tooltipObject.description = tooltipObject.description.substr(0, 136) + "...";
      }
      tooltipObject.item = valueOnX.id;
      tooltipObject.value[0].value = Math.round(100 * parseFloat(valueOnX.value)) / 100;
      /*
      tooltipData = _.extend( tooltipObject,
          style:_.extend(tooltipSettings.body,{fontFamily:tooltipSettings.fontFamily})
        )
      */

      tooltipData = this.injectStyles(tooltipObject);
      output = this.templateBody(tooltipData);
      return output;
    };

    return StackedTooltipBehavior;

  })(quadrigram.Models.TooltipBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.NetworkTooltipBehavior = (function(_super) {
    __extends(NetworkTooltipBehavior, _super);

    function NetworkTooltipBehavior() {
      this.updateToolTip = __bind(this.updateToolTip, this);
      this.executeAfterUpdateStage = __bind(this.executeAfterUpdateStage, this);
      this.initialize = __bind(this.initialize, this);
      _ref = NetworkTooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    NetworkTooltipBehavior.field = "tooltip";

    NetworkTooltipBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(NetworkTooltipBehavior.meta, NetworkTooltipBehavior.behaviors);
      return output;
    };

    NetworkTooltipBehavior.behaviors = [];

    NetworkTooltipBehavior.meta = {
      "properties": {
        "tooltipActiveNodes": {
          "uiTipContent": "Tooltip nodes are shown or not",
          "role": "visibility",
          "label": "Show tooltips of nodes",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "68",
          "multivalue": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": true
              }
            }
          }
        },
        "tooltipTypeNodes": {
          "uiTipContent": "Determines when the tooltip will be shown",
          "role": "unkown",
          "label": "Tooltip type of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "69",
          "multivalue": false,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Delayed"
              },
              "options": {
                "value": ["Instant", "Delayed", "After selection"]
              }
            }
          }
        },
        "tooltipTitleNodes": {
          "uiTipContent": "Defines the title of the tooltip for each node. By default it will take the identifiers from the main Data property",
          "role": "title",
          "label": "Tooltip Title of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "70",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Title"
              }
            }
          }
        },
        "tooltipValueNodes": {
          "uiTipContent": "Defines the content of the tooltip for each node. By default it will take the values from the main Data property",
          "role": "value",
          "target": "value",
          "label": "Tooltip Value of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "71",
          "multivalue": false,
          "formats": {
            "PrefixSufix": {
              "multiValues": {
                "prefix": false,
                "sufix": false
              },
              "defaults": {
                "label": "",
                "prefix": "",
                "sufix": ""
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipDescriptionNodes": {
          "uiTipContent": "Defines an additional description for each tooltip (max. 140 characters)",
          "role": "description",
          "label": "Tooltip Description of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Description"
              }
            }
          }
        },
        "tooltipImageNodes": {
          "uiTipContent": "Defines an image to be shown in each tooltip",
          "role": "image",
          "label": "Tooltip Image urls of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "73",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": true
              }
            },
            "ImageUrl": {
              "label": "Image",
              "multiValues": {
                "value": true,
                "scale": false,
                "repeat": false
              },
              "defaults": {
                "value": "",
                "scale": "cover",
                "repeat": "false"
              },
              "options": {
                "scale": ["contain", "cover", "stretch", "preserve"]
              }
            },
            "Text": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipStyleNodes": {
          "uiTipContent": "Defines style of the tooltips of nodes for this visualizer.",
          "label": "Tooltip Style of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "74",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "default"
              },
              "options": {
                "value": quadrigram.Managers.ToolTipManager.listStyles()
              }
            }
          }
        },
        "tooltipActiveRelations": {
          "uiTipContent": "Tooltip relations are shown or not",
          "role": "visibility",
          "label": "Show tooltips of relations",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "75",
          "multivalue": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "false"
              }
            }
          }
        },
        "tooltipTypeRelations": {
          "uiTipContent": "Determines when the tooltip will be shown",
          "role": "unkown",
          "label": "Tooltip type of relations",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "75.5",
          "multivalue": false,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Delayed"
              },
              "options": {
                "value": ["Instant", "Delayed", "After selection"]
              }
            }
          }
        },
        "tooltipTitleRelations": {
          "uiTipContent": "Defines the title of the tooltip for each relation. By default it will take the identifiers from the main Data property",
          "role": "title",
          "label": "Tooltip Title of relations",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "76",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "idSource": {
                "value": "visualizer.idsRelations"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Title"
              }
            }
          }
        },
        "tooltipValueRelations": {
          "uiTipContent": "Defines the content of the tooltip for each relation. By default it will take the values from the main Data property",
          "role": "value",
          "target": "relationValue",
          "label": "Tooltip Value of relations",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "77",
          "multivalue": false,
          "formats": {
            "PrefixSufix": {
              "multiValues": {
                "prefix": false,
                "sufix": false
              },
              "defaults": {
                "label": "",
                "prefix": "",
                "sufix": ""
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "idSource": {
                "value": "visualizer.idsRelations"
              },
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipDescriptionRelations": {
          "uiTipContent": "Defines an additional description for each tooltip (max. 140 characters)",
          "role": "description",
          "label": "Tooltip Description of relations",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "78",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Description"
              }
            }
          }
        },
        "tooltipImageRelations": {
          "uiTipContent": "Defines an image to be shown in each tooltip",
          "role": "image",
          "label": "Tooltip Image url of relations",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "79",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": true
              }
            },
            "ImageUrl": {
              "label": "Image",
              "multiValues": {
                "value": true,
                "scale": false,
                "repeat": false
              },
              "defaults": {
                "value": "",
                "scale": "cover",
                "repeat": "false"
              },
              "options": {
                "scale": ["contain", "cover", "stretch", "preserve"]
              }
            },
            "Text": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipStyleRelations": {
          "uiTipContent": "Defines style of the tooltips for this visualizer.",
          "label": "Tooltip Style of relations",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "80",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "default"
              },
              "options": {
                "value": quadrigram.Managers.ToolTipManager.listStyles()
              }
            }
          }
        }
      }
    };

    NetworkTooltipBehavior.prototype.initialize = function(visualizer) {
      $('.tooltip-layer').tooltip();
      this.nodesTooltip = new quadrigram.Models.TooltipBehavior(this.visualizer, []);
      this.relationsTooltip = new quadrigram.Models.TooltipBehavior(this.visualizer, []);
      this.relationsTooltip.searchField = ".link";
      return this.relationsTooltip.baseObjects = "relationsValues";
    };

    NetworkTooltipBehavior.prototype.executeAfterUpdateStage = function() {
      if (this.visualizer.changedData || this.visualizer.model.changed["tooltipActiveNodes"] || this.visualizer.model.changed["tooltipTitleNodes"] || this.visualizer.model.changed["tooltipValueNodes"] || this.visualizer.model.changed["tooltipDescriptionNodes"] || this.visualizer.model.changed["tooltipImageNodes"] || this.visualizer.model.changed["tooltipStyleNodes"] || this.visualizer.changedData || this.visualizer.model.changed["tooltipActiveRelations"] || this.visualizer.model.changed["tooltipTitleRelations"] || this.visualizer.model.changed["tooltipValueRelations"] || this.visualizer.model.changed["tooltipDescriptionRelations"] || this.visualizer.model.changed["tooltipImageRelations"] || this.visualizer.model.changed["tooltipStyleRelations"] || this.visualizer.model.changed["tooltipTypeNodes"] || this.visualizer.model.changed["tooltipTypeRelations"]) {
        return this.updateToolTip();
      }
    };

    NetworkTooltipBehavior.prototype.updateToolTip = function() {
      var nodesFollowMouse, vizModel;
      vizModel = this.visualizer.model;
      nodesFollowMouse = false;
      if (quadrigram.router.getDevice() !== "Desktop") {
        nodesFollowMouse = true;
      }
      this.nodesTooltip.updateConfig({
        followMouse: nodesFollowMouse,
        tooltipTitle: vizModel.get("tooltipTitleNodes"),
        tooltipValue: vizModel.get("tooltipValueNodes"),
        tooltipDescription: vizModel.get("tooltipDescriptionNodes"),
        tooltipImage: vizModel.get("tooltipImageNodes"),
        tooltipStyle: vizModel.get("tooltipStyleNodes"),
        tooltipActive: vizModel.get("tooltipActiveNodes"),
        tooltipType: vizModel.get("tooltipTypeNodes")
      });
      return this.relationsTooltip.updateConfig({
        followMouse: true,
        tooltipTitle: vizModel.get("tooltipTitleRelations"),
        tooltipValue: vizModel.get("tooltipValueRelations"),
        tooltipDescription: vizModel.get("tooltipDescriptionRelations"),
        tooltipImage: vizModel.get("tooltipImageRelations"),
        tooltipStyle: vizModel.get("tooltipStyleRelations"),
        tooltipActive: vizModel.get("tooltipActiveRelations"),
        tooltipType: vizModel.get("tooltipTypeRelations")
      });
    };

    return NetworkTooltipBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RadialNetworkTooltipBehavior = (function(_super) {
    __extends(RadialNetworkTooltipBehavior, _super);

    function RadialNetworkTooltipBehavior() {
      this.updateToolTip = __bind(this.updateToolTip, this);
      this.executeAfterUpdateStage = __bind(this.executeAfterUpdateStage, this);
      this.initialize = __bind(this.initialize, this);
      _ref = RadialNetworkTooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RadialNetworkTooltipBehavior.field = 'tooltip';

    RadialNetworkTooltipBehavior.behaviors = [];

    RadialNetworkTooltipBehavior.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(RadialNetworkTooltipBehavior.meta, RadialNetworkTooltipBehavior.behaviors);
      return output;
    };

    RadialNetworkTooltipBehavior.meta = {
      "properties": {
        "tooltipActiveNodes": {
          "uiTipContent": "Tooltip's nodes are shown or not",
          "role": "visibility",
          "label": "Show tooltips of nodes",
          "family": "tooltip",
          "hidden": false,
          "sortingWeight": "68",
          "multivalue": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": true
              }
            }
          }
        },
        "tooltipTypeNodes": {
          "uiTipContent": "Determines when the tooltip will be shown",
          "role": "unkown",
          "label": "Tooltip type of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "69",
          "multivalue": false,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "Delayed"
              },
              "options": {
                "value": ["Instant", "Delayed", "After selection"]
              }
            }
          }
        },
        "tooltipTitleNodes": {
          "uiTipContent": "Defines the title of the tooltip for each node. By default it will take the identifiers from the main Data property",
          "role": "title",
          "label": "Tooltip's Title of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "70",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Title"
              }
            }
          }
        },
        "tooltipValueNodes": {
          "uiTipContent": "Defines the content of the tooltip for each node. By default it will take the values from the main Data property",
          "role": "value",
          "target": "value",
          "label": "Tooltip's Value of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "71",
          "multivalue": false,
          "formats": {
            "PrefixSufix": {
              "multiValues": {
                "prefix": false,
                "sufix": false
              },
              "defaults": {
                "label": "",
                "prefix": "",
                "sufix": ""
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipDescriptionNodes": {
          "uiTipContent": "Defines an additional description for each tooltip (max. 140 characters)",
          "role": "description",
          "label": "Tooltip's Description of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "72",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Tooltip Description"
              }
            }
          }
        },
        "tooltipImageNodes": {
          "uiTipContent": "Defines an image to be shown in each tooltip",
          "role": "image",
          "label": "Tooltip's Image url of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "73",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": true
              }
            },
            "Text": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "tooltipStyleNodes": {
          "uiTipContent": "Defines style of the tooltips of nodes for this visualizer.",
          "label": "Tooltip's Style of nodes",
          "family": "tooltip",
          "hidden": true,
          "sortingWeight": "74",
          "multivalue": false,
          "formats": {
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            },
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "default"
              },
              "options": {
                "value": quadrigram.Managers.ToolTipManager.listStyles()
              }
            }
          }
        }
      }
    };

    RadialNetworkTooltipBehavior.prototype.initialize = function(visualizer) {
      $('.tooltip-layer').tooltip();
      this.nodesTooltip = new quadrigram.Models.TooltipBehavior(this.visualizer, []);
      this.nodesTooltip.searchField = '.node';
      return this.nodesTooltip.baseObjects = 'values';
    };

    RadialNetworkTooltipBehavior.prototype.executeAfterUpdateStage = function() {
      if (this.visualizer.changedData || this.visualizer.model.changed['tooltipActiveNodes'] || this.visualizer.model.changed['tooltipTitleNodes'] || this.visualizer.model.changed['tooltipValueNodes'] || this.visualizer.model.changed['tooltipDescriptionNodes'] || this.visualizer.model.changed['tooltipImageNodes'] || this.visualizer.model.changed['tooltipStyleNodes'] || this.visualizer.changedData || this.visualizer.model.changed['tooltipActiveRelations'] || this.visualizer.model.changed['tooltipTitleRelations'] || this.visualizer.model.changed['tooltipValueRelations'] || this.visualizer.model.changed['tooltipDescriptionRelations'] || this.visualizer.model.changed['tooltipImageRelations'] || this.visualizer.model.changed['tooltipStyleRelations'] || this.visualizer.model.changed['tooltipTypeNodes'] || this.visualizer.model.changed['tooltipTypeRelations']) {
        return this.updateToolTip();
      }
    };

    RadialNetworkTooltipBehavior.prototype.updateToolTip = function() {
      return this.nodesTooltip.updateConfig({
        followMouse: true,
        tooltipTitle: this.visualizer.model.get('tooltipTitleNodes'),
        tooltipValue: this.visualizer.model.get('tooltipValueNodes'),
        tooltipDescription: this.visualizer.model.get('tooltipDescriptionNodes'),
        tooltipImage: this.visualizer.model.get('tooltipImageNodes'),
        tooltipStyle: this.visualizer.model.get('tooltipStyleNodes'),
        tooltipActive: this.visualizer.model.get('tooltipActiveNodes'),
        tooltipType: this.visualizer.model.get('tooltipTypeNodes')
      });
    };

    return RadialNetworkTooltipBehavior;

  }).call(this, quadrigram.Models.Behavior);

}).call(this);

(function() {
  'use-strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.MapTooltipBehavior = (function(_super) {
    __extends(MapTooltipBehavior, _super);

    function MapTooltipBehavior() {
      this.hideTooltips = __bind(this.hideTooltips, this);
      this.initialize = __bind(this.initialize, this);
      _ref = MapTooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    MapTooltipBehavior.prototype.initialize = function(visualizer) {
      MapTooltipBehavior.__super__.initialize.call(this, visualizer);
      if (quadrigram.router.getDevice() !== "Desktop") {
        return this.tooltipEvent = "touchstart";
      }
    };

    MapTooltipBehavior.prototype.tooltipOptions = function(vizConfig, externalTooltipSettings) {
      var bodyFunction, containerDOM, followMouse, output, titleFunction,
        _this = this;
      output = MapTooltipBehavior.__super__.tooltipOptions.call(this, vizConfig, externalTooltipSettings);
      followMouse = vizConfig.followMouse;
      titleFunction = vizConfig.titleFunction;
      bodyFunction = vizConfig.bodyFunction;
      if (quadrigram.router.getDevice() !== "Desktop") {
        if (this.tooltipContainer) {
          containerDOM = $(this.tooltipContainer[0][0]);
          output.position.container = containerDOM;
        }
        output.events.show = function(event, api) {
          event.stopPropagation();
          _this.hideTooltips();
          $('html').on('touchstart', _this.hideTooltips);
          return _.delay(function() {
            d3.select(event.originalEvent.target).datum(function(d, i) {
              _this.ttipLeftPos = _this.visualizer.behaviors.map.map.latLngToLayerPoint(d.LatLng).x;
              _this.ttipTopPos = _this.visualizer.behaviors.map.map.latLngToLayerPoint(d.LatLng).y;
              return d;
            });
            _this.ttipLeftPos -= $(event.target).outerWidth() / 2;
            _this.ttipTopPos -= $(event.target).outerHeight();
            return $(event.currentTarget).css({
              "left": _this.ttipLeftPos + "px",
              "top": _this.ttipTopPos + "px"
            });
          }, 0);
        };
      }
      return output;
    };

    MapTooltipBehavior.prototype.hideTooltips = function() {
      return $(this.visualizer.behaviors.map.map._panes.popupPane).find(".qtip").each(function(index, value) {
        return $(this).hide();
      });
    };

    return MapTooltipBehavior;

  })(quadrigram.Models.TooltipBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RadarTooltipBehavior = (function(_super) {
    __extends(RadarTooltipBehavior, _super);

    function RadarTooltipBehavior() {
      this.dynamicBodyFunction = __bind(this.dynamicBodyFunction, this);
      this.bodyFunction = __bind(this.bodyFunction, this);
      _ref = RadarTooltipBehavior.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RadarTooltipBehavior.prototype.bodyFunction = function(itemDOM, event, api) {
      /*basura, no?
      @axis = []
      d3.select(@visualizer.el).selectAll(".item").datum().axes.forEach((axe) =>
          @axis.push axe.id
        )
      */

      var self;
      self = this;
      if ($(itemDOM).data("dynamicHandler") != null) {
        $(itemDOM).off("mousemove", $(itemDOM).data("dynamicHandler"));
      }
      $(itemDOM).data("dynamicHandler", function(e) {
        var content, id, object, tooltipBehavior, valueOnX, values, visHeight, visWidth, x, y, _base,
          _this = this;
        visWidth = self.visualizer.$el.width();
        visHeight = self.visualizer.$el.height() - 20;
        (_base = self.visualizer).findDomainItemFromRadar || (_base.findDomainItemFromRadar = self.findDomainItemFromRadar);
        tooltipBehavior = self;
        x = visWidth / 2 - e.offsetX;
        y = visHeight / 2 - e.offsetY;
        id = self.visualizer.findDomainItemFromRadar(x, y, self.visualizer.dimensions);
        object = d3.select(this).datum();
        values = object.value;
        valueOnX = _.findWhere(values, {
          id: id
        });
        content = tooltipBehavior.dynamicBodyFunction(object, valueOnX);
        return _.defer(function() {
          api.set('content.text', content);
          return api.reposition(e);
        });
      });
      $(itemDOM).on("mousemove", $(itemDOM).data("dynamicHandler"));
      $(itemDOM).trigger(api.mouse);
      return "";
    };

    RadarTooltipBehavior.prototype.findDomainItemFromRadar = function(xPos, yPos, axis) {
      var angle, angleStep, id, position;
      angleStep = Math.PI * 2 / axis.length;
      angle = Math.atan2(-yPos, -xPos) + Math.PI / 2;
      angle = angle + angleStep / 2;
      if (angle < 0) {
        angle += Math.PI * 2;
      }
      position = Math.floor(angle / angleStep);
      id = axis[position];
      log("atanAngle ", angle, position);
      return id;
    };

    RadarTooltipBehavior.prototype.dynamicBodyFunction = function(object, valueOnX) {
      var output, tooltipData, tooltipObject, tooltipSettings;
      tooltipSettings = this.getTooltipSettings();
      tooltipObject = _.clone(this.tooltipObjects[object.id]);
      if (tooltipObject.description && tooltipObject.description.length > 140) {
        tooltipObject.description = tooltipObject.description.substr(0, 136) + "...";
      }
      if (valueOnX) {
        tooltipObject.item = valueOnX.id;
        tooltipObject.value[0].value = Math.round(100 * parseFloat(valueOnX.value)) / 100;
      }
      /*
      tooltipData = _.extend( tooltipObject,
          style:_.extend(tooltipSettings.body,{fontFamily:tooltipSettings.fontFamily})
        )
      */

      tooltipData = this.injectStyles(tooltipObject);
      output = this.templateBody(tooltipData);
      return output;
    };

    return RadarTooltipBehavior;

  })(quadrigram.Models.TooltipBehavior);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.TreeMapView = (function(_super) {
    __extends(TreeMapView, _super);

    function TreeMapView() {
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.visualizerDidResize = __bind(this.visualizerDidResize, this);
      this.overflowLabels = __bind(this.overflowLabels, this);
      this.isOverflowed = __bind(this.isOverflowed, this);
      this.updateLabels = __bind(this.updateLabels, this);
      this.updateShapes = __bind(this.updateShapes, this);
      this.executeBasicD3Binding = __bind(this.executeBasicD3Binding, this);
      this.stepDataInterpolationAnimation = __bind(this.stepDataInterpolationAnimation, this);
      this.updateItems = __bind(this.updateItems, this);
      this.createTree = __bind(this.createTree, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = TreeMapView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TreeMapView.prototype.template = JST['app/scripts/templates/visualizers/treemap.hbs'];

    TreeMapView.prototype.followMouse = true;

    TreeMapView.prototype.stylableTexts = [".treemap-label"];

    TreeMapView.prototype.originalValues = {};

    TreeMapView.prototype.viewDidRender = function() {
      this.labelsLayer = d3.select(this.$el[0]).append("div").attr("class", "labels-layer");
      return this.firstRender = true;
    };

    TreeMapView.prototype.visualizerWillUpdateItems = function() {
      var item, _i, _len, _ref1, _results;
      this.treeValues = JSON.parse(JSON.stringify(this.values));
      _ref1 = this.treeValues;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        item = _ref1[_i];
        item.value = Math.abs(parseFloat(item.value));
        if (this.originalValues[item.id]) {
          item.originalValue = this.originalValues[item.id];
        } else {
          item.originalValue = 0;
        }
        _results.push(item.finalValue = item.value);
      }
      return _results;
    };

    TreeMapView.prototype.createTree = function() {
      var mode, ratio, tree, treemap,
        _this = this;
      tree = {};
      tree.id = "root_quadrigram_reserved_id";
      tree.children = this.treeValues;
      if (this.model.get("squareness") === "Rectangles") {
        ratio = +this.behaviors.svg.size.width / this.behaviors.svg.size.height;
        mode = "squarify";
      } else if (this.model.get("squareness") === "Columns") {
        ratio = 1;
        mode = "slice";
      } else {
        ratio = 1;
        mode = "dice";
      }
      treemap = d3.layout.treemap().size([this.behaviors.svg.size.width, this.behaviors.svg.size.height]).sticky(true).round(false).ratio(ratio).mode(mode).sort(function(a, b) {
        if (_this.model.get("sortByValue") === "Ascending") {
          return b.value - a.value;
        } else {
          return a.value - b.value;
        }
      });
      return this.treemapValues = treemap(tree);
    };

    TreeMapView.prototype.updateItems = function() {
      var size, updateD3Object;
      size = this.values.length;
      if (!this.firstRender && size < 200 && this.animationActive) {
        this.transitionMode = this.model.get("transitionMode");
        if (this.transitionMode === "Geometric") {
          this.transitionType = this.model.get("transition")[0];
          this.transitionTime = this.model.get("transition")[1];
          this.createTree();
          this.executeBasicD3Binding();
          updateD3Object = this.items.select(".rectangle").transition().duration(this.transitionTime).ease(this.transitionType);
          this.updateShapes(updateD3Object);
          this.updateLabels(this.labelItems.transition().duration(this.transitionTime).ease(this.transitionType));
        } else {
          this.transitionType = this.model.get("transition")[0];
          this.transitionTime = this.model.get("transition")[1];
          this.animationStartStamp = new Date();
          this.stepDataInterpolationAnimation();
        }
      } else {
        this.transitionType = "noTransition";
        this.transitionTime = 0;
        this.createTree();
        this.executeBasicD3Binding();
        updateD3Object = this.items.select(".rectangle");
        this.updateShapes(updateD3Object);
        this.updateLabels(this.labelItems);
      }
      return this.firstRender = false;
    };

    TreeMapView.prototype.stepDataInterpolationAnimation = function() {
      var currentStamp, differenceMillisec, ratio, treeNode, _i, _j, _len, _len1, _ref1, _ref2, _results;
      currentStamp = new Date();
      differenceMillisec = currentStamp.getTime() - this.animationStartStamp.getTime();
      ratio = Math.min(Math.max(differenceMillisec / this.transitionTime, 0), 1);
      /*
      log "________________________________________________________________________"
      log "TreeMapView::stepDataInterpolationAnimation -> currentStamp",currentStamp
      log "TreeMapView::stepDataInterpolationAnimation -> differenceMillisec",differenceMillisec
      log "TreeMapView::stepDataInterpolationAnimation -> differenceMillisec",ratio
      */

      _ref1 = this.treeValues;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        treeNode = _ref1[_i];
        treeNode.value = d3.interpolate(treeNode.originalValue, treeNode.finalValue)(ratio);
      }
      this.createTree();
      this.executeBasicD3Binding();
      this.updateShapes(this.items.select(".rectangle"));
      this.updateLabels(this.labelItems);
      if (differenceMillisec < this.transitionTime) {
        return _.delay(this.stepDataInterpolationAnimation, 20);
      } else {
        _ref2 = this.treemapValues;
        _results = [];
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          treeNode = _ref2[_j];
          _results.push(this.originalValues[treeNode.id] = treeNode.value = treeNode.finalValue);
        }
        return _results;
      }
    };

    TreeMapView.prototype.executeBasicD3Binding = function() {
      this.items = this.behaviors.svg.root.selectAll(".item").data(this.treemapValues, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("rect").attr("class", "rectangle");
      this.items.exit().remove();
      this.items.each(function(d, i) {
        if (d.id === "root_quadrigram_reserved_id") {
          return d3.select(this).style("display", "none");
        }
      });
      this.labelItems = this.labelsLayer.selectAll(".label-item").data(this.treemapValues, function(d, i) {
        return d.id;
      });
      this.labelItemsEnter = this.labelItems.enter().append("div").attr("class", "label-item");
      this.labelItemsEnter.append("span").attr("class", "treemap-label");
      this.labelItems.exit().remove();
      return this.labelItems.each(function(d, i) {
        if (d.id === "root_quadrigram_reserved_id") {
          return d3.select(this).style("visibility", "hidden");
        }
      });
    };

    TreeMapView.prototype.updateShapes = function(d3target) {
      var marginItems, roundedCorners;
      marginItems = parseInt(this.model.get("marginItems").replace("px", ""));
      roundedCorners = parseInt(this.model.get("roundedCorners").replace("px", ""));
      return d3target.attr("x", function(d, i) {
        return d.x + marginItems / 2;
      }).attr("width", function(d, i) {
        return Math.max(0, d.dx - marginItems);
      }).attr("y", function(d, i) {
        return d.y + marginItems / 2;
      }).attr("height", function(d, i) {
        return Math.max(0, d.dy - marginItems);
      }).attr("rx", function(d, i) {
        return roundedCorners;
      }).attr("ry", function(d, i) {
        return roundedCorners;
      });
    };

    TreeMapView.prototype.updateLabels = function(d3target) {
      var marginItems, roundedCorners;
      if (this.model.get("textMode") === "Hidden") {
        d3target.style("display", "none");
        return;
      } else {
        d3target.style("display", "block");
      }
      marginItems = parseInt(this.model.get("marginItems").replace("px", ""));
      roundedCorners = parseInt(this.model.get("roundedCorners").replace("px", ""));
      d3target.style("left", function(d, i) {
        return (d.x + marginItems / 2) + "px";
      }).style("width", function(d, i) {
        return Math.floor(d.dx - marginItems) + "px";
      }).style("top", function(d, i) {
        return (d.y + marginItems / 2) + "px";
      }).style("height", function(d, i) {
        return Math.floor(d.dy - marginItems) + "px";
      });
      d3target.select("span").text(function(d, i) {
        return d.id;
      });
      return this.overflowLabels();
    };

    TreeMapView.prototype.isOverflowed = function(element) {
      return element.scrollHeight > element.clientHeight || element.scrollWidth > element.clientWidth;
    };

    TreeMapView.prototype.overflowLabels = function() {
      return this.labelItems.style("opacity", function(d, i) {
        if (this.scrollHeight > this.clientHeight || this.scrollWidth > this.clientWidth) {
          return 0;
        }
        return 1;
      });
    };

    TreeMapView.prototype.visualizerDidResize = function() {
      return this.visualizerDidUpdateItems();
    };

    TreeMapView.prototype.visualizerDidUpdateItems = function() {
      return this.overflowLabels();
      /*
      if @model.get("textMode")=="Fit"
        @labelItems.select("span")
          .style "font-size","25px"
      */

    };

    /*
    wrapText:(textSelection,x,y,width,height,resize)=>
      margin = 10
      textNode = textSelection[0][0]
      textNode.setAttribute("transform", "scale("+1+") translate("+0+","+0+")");
      bb = textNode.getBoundingClientRect();
      widthTransform = (width-2*margin) / bb.width;
      heightTransform = (height-2*margin) / bb.height;
      value = if widthTransform < heightTransform then widthTransform else heightTransform;
      tx = ((x+margin)/value)
      #NO TIENE NINGuN SENTIDO ESTE +10 
      ty = (((y+margin)/value))+10
      
      if !resize
        tx = tx*value
        ty = (ty-10)*value + 10
        value = 1
        if bb.width+10 > width
          textSelection.style("display","none")
        else
          textSelection.style("display","block")
    
      textNode.setAttribute("transform", "scale("+value+") translate("+tx+","+ty+")");
      return bb.height*value
    */


    return TreeMapView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PointsInAMapView = (function(_super) {
    __extends(PointsInAMapView, _super);

    function PointsInAMapView() {
      this.drawElementsOnCanvas = __bind(this.drawElementsOnCanvas, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.updateItems_OLD = __bind(this.updateItems_OLD, this);
      this.onDragChange = __bind(this.onDragChange, this);
      this.onZoomChange = __bind(this.onZoomChange, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      _ref = PointsInAMapView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PointsInAMapView.prototype.template = JST['app/scripts/templates/visualizers/pointsInAMap.hbs'];

    PointsInAMapView.prototype.firstExec = true;

    PointsInAMapView.prototype.followMouse = true;

    PointsInAMapView.prototype.visualizerWillUpdateItems = function() {
      var maxValue, minValue, radiusRange;
      this.behaviors.map.divMap.style("display", "inherit");
      this.behaviors.map.map.invalidateSize();
      this.behaviors.tooltip.tooltipContainer = this.behaviors.map.divMap.select(".leaflet-popup-pane");
      this.behaviors.map.map.on("zoomanim", this.onZoomChange);
      this.behaviors.map.map.on("drag", this.onDragChange);
      if (this.model.get("values").currentFormat === "PxByValuesAndDomain") {
        minValue = this.model.get("values")[1];
        if ((minValue == null) || minValue === "") {
          minValue = d3.min(this.coordinates, function(d) {
            return Math.abs(d.value);
          });
        }
        maxValue = this.model.get("values")[2];
        if ((maxValue == null) || maxValue === "") {
          maxValue = d3.max(this.coordinates, function(d) {
            return Math.abs(d.value);
          });
        }
        radiusRange = [this.model.get("values")[3], this.model.get("values")[4]];
      } else {
        minValue = d3.min(this.coordinates, function(d) {
          return Math.abs(d.value);
        });
        maxValue = d3.max(this.coordinates, function(d) {
          return Math.abs(d.value);
        });
        radiusRange = [this.model.get("values")[1], this.model.get("values")[2]];
      }
      return this.behaviors.circles.updateRadiusScale([minValue, maxValue], radiusRange);
    };

    PointsInAMapView.prototype.onZoomChange = function() {
      return this.behaviors.tooltip.hideTooltips();
    };

    PointsInAMapView.prototype.onDragChange = function() {
      return this.behaviors.tooltip.hideTooltips();
    };

    PointsInAMapView.prototype.updateItems_OLD = function() {
      var self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      this.items = this.behaviors.map.svg.selectAll(".item").data(this.coordinates, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsExit = this.items.exit();
      this.itemsEnter.append("circle").attr("class", "marker");
      this.itemsExit.remove();
      this.behaviors.map.update();
      size = this.ids.length;
      if (size < 700 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.items.select(".marker").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.items.select(".marker");
      }
      self = this;
      return updateD3Object.attr("cx", 0).attr("cy", 0).attr("r", function(d) {
        return Math.max(0, _this.behaviors.circles.getRadiusFromValue(Math.abs(d.value)));
      });
    };

    PointsInAMapView.prototype.updateItems = function() {
      this.items = this.behaviors.map.svg.selectAll(".item").data(this.coordinates, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsExit = this.items.exit();
      this.itemsEnter.append("g").attr("class", "marker");
      this.itemsExit.remove();
      return this.behaviors.map.update();
      /*
      size = @ids.length
      if size < 700 && @animationActive
        transitionType = @model.get("transition")[0]
        transitionTime = @model.get("transition")[1]
        updateD3Object = @items.select(".marker").transition().duration(transitionTime).ease(transitionType)
      else
        updateD3Object = @items.select(".marker")
      
      self = this
      
      updateD3Object
        .attr("cx",0)
        .attr("cy",0)
        .attr("r",(d) =>
          Math.max(0,@behaviors.circles.getRadiusFromValue(Math.abs(d.value)))
        )
      */

    };

    /*
    visualizerDidUpdateItems:() =>
      if @model.changed["places"]? || @firstExec
        @firstExec = false
        @behaviors.map.centerView()
    */


    PointsInAMapView.prototype.visualizerDidUpdateItems = function() {
      var self;
      if ((this.model.changed["places"] != null) || this.firstExec) {
        this.firstExec = false;
        if (this.model.get("zoom") === "" && this.model.get("center") === "") {
          this.behaviors.map.centerView();
        } else {
          /*
          if @model.get("frame")!=""
            @behaviors.map.goToFrame(@visualizer.model.get("frame"))
          */

          if (this.model.get("zoom") !== "" || this.model.get("center") !== "") {
            this.behaviors.map.goToMapView(this.model.get("center"), this.model.get("zoom"));
          }
        }
      }
      this.behaviors.map.enableZoom(false);
      self = this;
      return this.items.select(".marker").each(function(d) {
        var shape, size;
        shape = self.behaviors.selection.behaviors.items.styleItems[d.id].shapeType;
        size = self.behaviors.circles.getRadiusFromValue(d.value);
        if (_.isNaN(size)) {
          size = 0;
        }
        if (size < 0) {
          size = 0;
        }
        return self.behaviors.svgshapes.drawShape(d3.select(this), shape, size);
      });
    };

    PointsInAMapView.prototype.drawElementsOnCanvas = function(ctx, onLoad) {
      var im, svgSource, url,
        _this = this;
      svgSource = svgUtils.getSVGWithStyles($(this.behaviors.map.map._container).find("svg")[0]);
      svgSource.setAttribute("font-family", "'Roboto',sans-serif");
      svgSource.setAttribute("style", "background-color:rgba(0,0,0,0)");
      url = svgUtils.svgToImageUrl(svgSource);
      im = new Image();
      im.onload = function() {
        var vbox;
        vbox = svgSource.getAttribute("viewBox").split(" ");
        ctx.drawImage(im, vbox[0], vbox[1], vbox[2], vbox[3]);
        return onLoad();
      };
      return im.src = url;
    };

    return PointsInAMapView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.HeatMapView = (function(_super) {
    __extends(HeatMapView, _super);

    function HeatMapView() {
      this.drawElementsOnCanvas = __bind(this.drawElementsOnCanvas, this);
      this.draw = __bind(this.draw, this);
      this.updateDrawing = __bind(this.updateDrawing, this);
      this.resetAnimation = __bind(this.resetAnimation, this);
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = HeatMapView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    HeatMapView.prototype.template = JST['app/scripts/templates/visualizers/pointsInAMap.hbs'];

    HeatMapView.prototype.firstExec = true;

    HeatMapView.prototype.followMouse = true;

    HeatMapView.prototype.viewDidRender = function() {
      return this.heat = L.heatLayer([]).addTo(this.behaviors.map.map);
    };

    HeatMapView.prototype.visualizerWillUpdateItems = function() {
      this.behaviors.map.divMap.style("display", "inherit");
      return this.behaviors.map.map.invalidateSize();
    };

    HeatMapView.prototype.visualizerDidUpdateItems = function() {
      if ((this.model.changed["places"] != null) || this.firstExec) {
        this.firstExec = false;
        if (this.model.get("zoom") === "" && this.model.get("center") === "") {
          return this.behaviors.map.centerView();
        } else {
          /*
          if @model.get("frame")!=""
            @behaviors.map.goToFrame(@visualizer.model.get("frame"))
          */

          if (this.model.get("zoom") !== "" || this.model.get("center") !== "") {
            return this.behaviors.map.goToMapView(this.model.get("center"), this.model.get("zoom"));
          }
        }
      }
    };

    HeatMapView.prototype.updateItems = function() {
      var coor, finalPointsPresent, id, maxRange, maxValue, minRange, minValue, preVal, val, _i, _len, _ref1;
      if (this.model.get("values").currentFormat === "ByValues") {
        minValue = Number(this.model.get("values")[1]);
        maxValue = Number(this.model.get("values")[2]);
      } else {
        minValue = d3.min(this.coordinates, function(d) {
          return Number(d.value);
        });
        maxValue = d3.max(this.coordinates, function(d) {
          return Number(d.value);
        });
      }
      if (!this.pointsObject) {
        this.pointsObject = {};
      }
      minRange = 0;
      maxRange = 1;
      finalPointsPresent = {};
      _ref1 = this.coordinates;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        coor = _ref1[_i];
        if (coor.value != null) {
          preVal = Number(coor.value);
          if (maxValue === minValue) {
            val = 1;
          } else {
            val = (preVal - minValue) / (maxValue - minValue);
            val = minRange + val * maxRange / (maxRange - minRange);
          }
        } else {
          val = minRange;
        }
        if (this.pointsObject[coor.id] == null) {
          finalPointsPresent[coor.id] = true;
          this.pointsObject[coor.id] = {};
          this.pointsObject[coor.id].previous = [coor.LatLng.lat, coor.LatLng.lng, 0];
          this.pointsObject[coor.id].current = [coor.LatLng.lat, coor.LatLng.lng, val];
          this.pointsObject[coor.id].next = [coor.LatLng.lat, coor.LatLng.lng, val];
        } else {
          finalPointsPresent[coor.id] = true;
          this.pointsObject[coor.id].previous = _.clone(this.pointsObject[coor.id].current);
          this.pointsObject[coor.id].next = [coor.LatLng.lat, coor.LatLng.lng, val];
        }
      }
      for (id in this.pointsObject) {
        if (finalPointsPresent[id] == null) {
          this.pointsObject[id].previous = _.clone(this.pointsObject[id].current);
          this.pointsObject[id].next = _.clone(this.pointsObject[id].current);
          this.pointsObject[id].next[2] = 0;
          this.pointsObject[id].kill = true;
        }
      }
      this.resetAnimation();
      return this.behaviors.map.update();
    };

    HeatMapView.prototype.resetAnimation = function() {
      this.totalDuration = Number(this.model.get("transition")[1]);
      this.startTime = (new Date()).getTime();
      return this.updateDrawing();
    };

    /*
    setTargetPoints:(latlngs)=>
      @totalDuration = 500
    
      @previousLatLngs = @latlngs
      if !@previousLatLngs?
        @previousLatLngs=latlngs
    
      @targetLatLngs = latlngs
      @startTime = (new Date()).getTime()
      setTimeout(@updateDrawing,100)
    
    updateDrawing:()=>
      @latlngs = []
      currentTime = (new Date()).getTime()
    
      if currentTime-@startTime < @totalDuration
        
        for p,i in @previousLatLngs
          middlePoint = []
          for k in [0..2]
            timeFactor = (currentTime-@startTime)/@totalDuration
            ##VERY WRONG!!! no tiene sentido el mathsabs...
            middlePoint[k] = Math.abs(p[k]+(@targetLatLngs[i][k]-p[k])*timeFactor)
          @latlngs.push(middlePoint)
        
        @draw()
        setTimeout(@updateDrawing,100)
      else
        @latlngs = @targetLatLngs
        @draw()
    */


    HeatMapView.prototype.updateDrawing = function() {
      var currentTime, k, key, p, timeFactor, _i, _ref1, _ref2;
      currentTime = (new Date()).getTime();
      if (currentTime - this.startTime < this.totalDuration) {
        timeFactor = (currentTime - this.startTime) / this.totalDuration;
        _ref1 = this.pointsObject;
        for (key in _ref1) {
          p = _ref1[key];
          for (k = _i = 0; _i <= 2; k = ++_i) {
            p.current[k] = d3.interpolate(p.previous[k], p.next[k])(timeFactor);
          }
        }
        this.draw();
        return setTimeout(this.updateDrawing, 50);
      } else {
        _ref2 = this.pointsObject;
        for (key in _ref2) {
          p = _ref2[key];
          p.current = p.next;
          if (p.kill === true) {
            delete this.pointsObject[key];
          }
        }
        return this.draw();
      }
    };

    HeatMapView.prototype.draw = function() {
      var gradientObject, heatOptions, key, l, latlngs, p, parsedGradient, stop, _i, _len, _ref1, _ref2;
      latlngs = [];
      _ref1 = this.pointsObject;
      for (key in _ref1) {
        p = _ref1[key];
        latlngs.push(p.current);
      }
      this.heat.setLatLngs(latlngs);
      heatOptions = {};
      gradientObject = {};
      parsedGradient = GradientParser.parse(this.model.get("gradient"));
      _ref2 = parsedGradient[0].colorStops;
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        stop = _ref2[_i];
        if (!stop.length) {
          l = 0;
        } else {
          l = stop.length.value / 100;
        }
        gradientObject[l] = "rgb(" + stop.value[0] + "," + stop.value[1] + "," + stop.value[2] + ")";
      }
      heatOptions.resolution = 0.3;
      heatOptions.gradient = gradientObject;
      heatOptions.radiusFactor = (100 * (1 + Number(this.model.get("radius")))) / 100;
      heatOptions.opacityFactor = Number(this.model.get("grouping")) / 100;
      return this.heat.setOptions(heatOptions);
    };

    HeatMapView.prototype.drawElementsOnCanvas = function(ctx, onLoad) {
      var canvasTransform, subCtx, svgSource, vbox;
      subCtx = this.heat._canvas.getContext('2d');
      svgSource = svgUtils.getSVGWithStyles($(this.behaviors.map.map._container).find("svg")[0]);
      vbox = svgSource.getAttribute("viewBox").split(" ");
      canvasTransform = this.behaviors.map.map._mapPane._leaflet_pos;
      subCtx.transform(0.3, 0, 0, 0.3, 0, 0);
      ctx.drawImage(this.heat._canvas, -canvasTransform.x, -canvasTransform.y, +this.heat._canvas.style.width.replace("px", ""), +this.heat._canvas.style.height.replace("px", ""));
      return onLoad();
      /*
      im = new Image();
      im.crossOrigin = '';
      im.onload = ()=>
        ctx.drawImage(im, $(original).css("left").replace("px",""), $(original).css("top").replace("px",""), $(original).css("width").replace("px",""),$(original).css("height").replace("px",""));
        onLoad()
      im.src =  original.getAttribute("src");
      */

    };

    return HeatMapView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ExportOptions = (function(_super) {
    __extends(ExportOptions, _super);

    function ExportOptions() {
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ExportOptions.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExportOptions.prototype.template = JST['app/scripts/templates/UI/dialogs/exportOptions.hbs'];

    ExportOptions.prototype.title = "Publish project";

    ExportOptions.prototype.width = 600;

    ExportOptions.prototype.height = 400;

    /*
    events:
      "click .web-option": "clickOnWebOption"
      "click .embed-option": "clickOnEmbedOption"
      "click .zip-option": "clickOnZipOption"
    */


    ExportOptions.prototype.viewWillRender = function() {
      return this.buttons = {};
    };

    ExportOptions.prototype.viewDidRender = function() {
      this.$el.find('.export-a').attr("href", function() {
        return quadrigram.router.managers.serverManager.getExportUrl($(this).attr("data-type"));
        /*
        switch $(this).attr("data-type")
          when "web" then url = quadrigram.webUrl+'publish-website/'+quadrigram.router.dataModels.currentProject.get("id")
          when "embed" then url = quadrigram.webUrl+'publish-embed/'+quadrigram.router.dataModels.currentProject.get("id")
          when "zip" then url = quadrigram.webUrl+'publish-download/'+quadrigram.router.dataModels.currentProject.get("id")
        */

      });
      return this.$el.find(".export-a").on("click", function() {
        quadrigram.milestoneTracker.trackMilestone("publish", "any");
        return quadrigram.achievementTracker.trackDirectAction("publish");
      });
    };

    ExportOptions.prototype.remove = function() {
      ExportOptions.__super__.remove.call(this);
      return localStorage.removeItem('optimizedData');
    };

    /*
    clickOnWebOption:()=>
      window.location.href = "http://dev.bestiario.org/quadrigram/web/#publish-website/"+@currentProcessId;
    
    clickOnEmbedOption:()=>
      window.location.href = "http://dev.bestiario.org/quadrigram/web/#publish-embed/"+@currentProcessId;
    
    clickOnZipOption:()=>
      window.location.href = "http://dev.bestiario.org/quadrigram/web/#publish-download/"+@currentProcessId;
    */


    /*DEPRECATED!!!!
    
    width: 500
    height: 500
    mode:"#publish"
    
    ERROR_EXPORT_MESSAGE: "Error requesting export"
    ERROR_DOWNLOAD_MESSAGE: "Error requesting file"
    
    
    viewWillRender:()=>
      #si lo ponemos arriba no podemos referirnos al @...
      @buttons=
        {
          "Ok": ()=>
            @requestExport()
        }
    
    
    viewDidRender:()=>
      self = @
      @$el.find('.tab a').click( (e) ->
        e.preventDefault()
        self.mode = $(@).attr("href")
        $(this).tab('show')
      )
    
      @$el.find(".base-url").html("www.quadrigram.com/hosting/user/")
      @$el.find(".key-path").val(quadrigram.router.dataModels.currentProject.get("pname"))
      externalGroups = $.grep( quadrigram.router.dataModels.currentProject.get("blockGroupsCollection").models,(e)->
        return e instanceof quadrigram.Models.ExternalBlockGroupModel
      )
      @sourcesList = new Backbone.Collection externalGroups
      # log "showing resources",@sourcesList
      @$el.find(".list-container").addClass('file-list')
      resListView = new quadrigram.Views.ExportResourceCollection collection:@sourcesList, el:@$el.find(".list-container")
      resListView.render()
    
    requestExport:()=>
      ##TODO: unhardcode all options...
      @$el.parent().find("button:eq(1)").html("Ok")
    
      @$el.parent().find("button:eq(1)").attr("disabled","disabled")
      # log "gathering export options",quadrigram.router.dataModels.currentProject
      options = {}
      options.projectName = quadrigram.router.dataModels.currentProject.get("pname")
      options.projectId = quadrigram.router.dataModels.currentProject.get("id")
      #TODO: this variable must be set from mode selector
      options.publish = @mode == "#publish"
      options.keyPath = @$el.find(".key-path").val()
      options.password = @$el.find(".pswd").val()
      if options.password == ""
        options.password = null
      options.providerName = "google"
      options.loggingLevel = 1
      options.resourceList = []
      for file in @sourcesList.models
        resource = {}
        resource.id = file.get("rid")
        ##WRONG: Very fake "google..."
        resource.providerName = "google"
        #if file.get("exportMode") then resource.exportMode = 0 else resource.exportMode = 1
        resource.exportMode = 0
        options.resourceList.push(resource)
    
      # log "will send ",options
      @setProgress({status: 99})
      quadrigram.router.managers.serverManager.requestExport(options,@requestCallback)
    
      @$el.find(".progress-bar").css('background-color', '#2861ff')
    
    requestCallback:(data, textStatus, jqXHR)=>
      # log "request callback",data
      if data.code? and data.code != 200
        @$el.parent().find("button:eq(1)").removeAttr("disabled")
        @$el.find(".progress-message").html(@ERROR_EXPORT_MESSAGE)
        @$el.parent().find("button:eq(1)").html("Retry")
      else
        @setupListener(data.body.id)
        @setProgress(data)
    
    ##TODO: MUST remove listener
    setupListener:(processId)=>
      # log "should setup timer to url",processId
      @currentProcessId = processId
      @$el.find(".progress-message").html("Requesting build...")
    
      if @intervalTrigger
        window.clearInterval(@intervalTrigger)
      @intervalTrigger = window.setInterval(@requestStatus, 700);
    
    removeListener:()=>
      window.clearInterval(@intervalTrigger);
    
    requestStatus:()=>
      # log "requesting status"
      statusUrl = quadrigram.baseUrl + "rs/export/"+@currentProcessId+"/status"
      $.ajax(
            url: statusUrl,
            type: 'GET'
            success: @handleStatusResponse
            error: @handleStatusError
          )
    ##TODO: must read the appropiate values from response
    ##TODO: must handle errors!!
    handleStatusResponse:(response)=>
      if response.code != 200
        return @handleStatusError(response)
      if response.body.status >=0
        @setProgress(response.body)
        if response.body.status == 6
          @removeListener()
          @requestDownload()
        if response.body.status == 7
          @removeListener()
          @requestPublication()
      else
        @handleStatusError(response)
    
    handleStatusError:(response)=>
      # log "received error"
      if response.code == 200
        @$el.find(".progress-message").html("There was an error: "+response.body.data)
      else
        @$el.find(".progress-message").html("There was an error: "+response.error)
      #@$el.parent().find("button:eq(1)").html("Retry")
      #@$el.parent().find("button:eq(1)").removeAttr("disabled")
      #@removeListener()
      #@setBarColor(-1)
    
    
    setProgress:(response)=>
      switch response.status
        when 99 then message = "Saving space..."
        when 0 then message = "Requesting build..."
        when 1 then message = "Gathering sources..."
        when 2 then message = "Starting build..."
        when 3 then message = "Compiling..."
        when 4 then message = "Zipping..."
        when 5 then message = "Zipping..."
        when 6 then message = "Download started"
        when 7 then message = "Publication finished"
        else message = "Unknown status"
      @$el.find(".progress-message").html(message)
    
      #@updateBar(response.status)
      #@setBarColor(response.status)
    
    setBarColor:(value)=>
      switch value
        when -1 then color = "#f00"
        when 6 then color = "#0f0"
        else message = "#2861ff"
      @$el.find(".progress-bar").css('background-color', color)
    updateBar:(value)=>
      percentsArray = [0,5,10,30,80,90,100,100]
    
      percent = percentsArray[value]
      # log "setting progress",value,@previousBarValue,percent
      if value == @previousBarValue
        percent = Math.min(percentsArray[value+1], @previousPercent + Math.random()*2)
      # log "setting result ",percent
    
      @$el.find(".progress-bar").css('width', percent+'%')
    
      @previousPercent = percent
      @previousBarValue = value
    
    
    requestPublication:() =>
      quadrigram.router.managers.serverManager.requestPublication(@currentProcessId, @callbackRequestPublication)
    
    callbackRequestPublication:(data) =>
      if data.code != 200
        quadrigram.router.appViews.loaderView.trigger("loaderErrorMessage","Project successfully published, but there is an error getting publication data")
        setTimeout(()=>
          quadrigram.router.appViews.loaderView.hide()
        ,3000)
        @close()
        #TODO send user to publications list
      else
        window.open(data.body.url,'_blank')
    
    requestDownload:()=>
      downloadUrl = quadrigram.baseUrl + "rs/export/"+@currentProcessId+"/result"
      $.fileDownload(
        downloadUrl,
        {
          failCallback: @failDownloadHandler
        }
      )
    
    failDownloadHandler:()=>
      @$el.parent().find("button:eq(1)").removeAttr("disabled")
      @$el.find(".progress-message").html(@ERROR_DOWNLOAD_MESSAGE)
      @$el.find(".progress-bar").css('width', 97+'%')
      #@setBarColor(-1)
      @$el.parent().find("button:eq(1)").html("Retry")
      #TODO offer to user direct download
    */


    return ExportOptions;

  })(quadrigram.Views.Dialog);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.StackedBarChartView = (function(_super) {
    __extends(StackedBarChartView, _super);

    function StackedBarChartView() {
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.createStackFunction = __bind(this.createStackFunction, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      this.setAxisDirection = __bind(this.setAxisDirection, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      this.fillStackValues = __bind(this.fillStackValues, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      _ref = StackedBarChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    StackedBarChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    StackedBarChartView.prototype.xAxisType = "bands";

    StackedBarChartView.prototype.yAxisType = "linear";

    StackedBarChartView.prototype.yAxisPadding = true;

    StackedBarChartView.prototype.xAxisPadding = true;

    StackedBarChartView.prototype.accumulate = true;

    StackedBarChartView.prototype.followMouse = true;

    StackedBarChartView.prototype.chartType = "stackedbarchart";

    StackedBarChartView.prototype.setIdsAndValues = function() {
      this.model.original._ids = this.idsItems;
      this.values = this.fillStackValues(this.values);
      return this.model.original._values = this.values;
    };

    StackedBarChartView.prototype.fillStackValues = function(values) {
      var i, maxLength, v, _i, _j, _k, _len, _len1, _ref1;
      if (values != null) {
        maxLength = 0;
        for (_i = 0, _len = values.length; _i < _len; _i++) {
          v = values[_i];
          maxLength = Math.max(v.value.length, maxLength);
        }
        for (_j = 0, _len1 = values.length; _j < _len1; _j++) {
          v = values[_j];
          if (v.value.length < maxLength) {
            for (i = _k = 0, _ref1 = maxLength - v.value.length - 1; 0 <= _ref1 ? _k <= _ref1 : _k >= _ref1; i = 0 <= _ref1 ? ++_k : --_k) {
              v.value.push({
                id: "null",
                value: 0,
                value0: 0
              });
            }
          }
        }
      }
      return values;
    };

    StackedBarChartView.prototype.getXDomainValues = function() {
      if (this.xAxisType === "bands") {
        return this.ids;
      } else {
        return this.calculateNumberDomain(this.values, true, "value");
      }
    };

    StackedBarChartView.prototype.getYDomainValues = function() {
      if (this.xAxisType === "bands") {
        return this.calculateNumberDomain(this.values, true, "value");
      } else {
        return this.ids;
      }
    };

    StackedBarChartView.prototype.setAxisDirection = function() {
      var axeIds;
      axeIds = this.model.get("IdsOnAxis");
      if (!axeIds) {
        axeIds = "Vertical";
      }
      if (axeIds === "Vertical") {
        this.yAxisType = "linear";
        return this.xAxisType = "bands";
      } else {
        this.yAxisType = "bands";
        return this.xAxisType = "linear";
      }
    };

    StackedBarChartView.prototype.checkAxisChanged = function() {
      return (this.model.changed["IdsOnAxis"] != null) || (this.model.changed["gapBetweenBars"] != null) || (this.model.changed["dimensionAsItems"] != null);
    };

    StackedBarChartView.prototype.createStackFunction = function() {
      var negBase, posBase;
      negBase = [];
      posBase = [];
      return this.stack = d3.layout.stack().values(function(d) {
        return d.value;
      }).y(function(d) {
        return parseFloat(d.value) || 0;
      }).out(function(d, y0, y) {
        y0 = 0;
        d.value = parseFloat(d.value) || 0;
        if (d.value < 0) {
          if (negBase[d.id] != null) {
            negBase[d.id] += d.value;
            y0 = negBase[d.id] - d.value;
            y = y0 + d.value;
          } else {
            negBase[d.id] = d.value;
            y0 = 0;
            y = d.value;
          }
        } else if (d.value > 0) {
          if (posBase[d.id] != null) {
            y0 = posBase[d.id];
            y = posBase[d.id] + d.value;
          }
          if (posBase[d.id] == null) {
            posBase[d.id] = 0;
          }
          posBase[d.id] += d.value;
        }
        if (isNaN(y0) || y0 === "") {
          y0 = 0;
        }
        if (isNaN(y) || y === "") {
          y = 0;
        }
        /*
          y0 is the start Y point of the bar
          y is the end Y point of the bar
        */

        return d.value0 = y0;
      });
    };

    StackedBarChartView.prototype.visualizerWillExecBehaviors1 = function() {
      this.createStackFunction();
      this.values = this.stack(this.values);
      return this.dimensions = ["value"];
    };

    StackedBarChartView.prototype.updateItems = function() {
      var self;
      self = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        if (self.values.length === 1 && self.__LastValuesLength === 1) {
          return "__onlyOne__";
        } else {
          return d.id;
        }
      });
      this.__LastValuesLength = this.values.length;
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.items.exit().remove();
      self = this;
      return this.items.each(function(itemData, itemIndex) {
        var rects, rectsEnter, size, transitionTime, transitionType, updateD3Object,
          _this = this;
        rects = d3.select(this).selectAll(".bar").data(itemData.value, function(d, i) {
          return d.id;
        });
        rectsEnter = rects.enter().append("rect").attr("class", "bar");
        rects.exit().remove();
        size = self.ids.length * self.idsItems.length;
        if (size < 1000 && self.animationActive) {
          transitionType = self.model.get("transition")[0];
          transitionTime = self.model.get("transition")[1];
          updateD3Object = rects.transition().duration(transitionTime).ease(transitionType);
        } else {
          updateD3Object = rects;
        }
        if (self.xAxisType === "bands") {
          return updateD3Object.attr("x", function(d, i) {
            return self.behaviors.axis.xScale(d.id);
          }).attr("width", self.behaviors.axis.xScale.rangeBand()).attr("y", function(d) {
            var barHeight, base, y;
            y = 0;
            base = d.value0;
            barHeight = Math.abs(self.behaviors.axis.yScale(d.value) - self.behaviors.axis.yScale(0));
            if (d.value < 0) {
              y = self.behaviors.axis.yScale(base);
            } else {
              y = self.behaviors.axis.yScale(base) - barHeight;
            }
            return Math.ceil(y);
          }).attr("height", function(d) {
            var firstPos, lastPos, result;
            result = Math.abs(self.behaviors.axis.yScale(d.value) - self.behaviors.axis.yScale(Math.max(0, self.behaviors.axis.yScale.domain()[0])));
            result = Math.ceil(result);
            if (d.value < 0) {
              result = Math.abs(self.behaviors.axis.yScale(d.value) - self.behaviors.axis.yScale(Math.max(0, self.behaviors.axis.yScale.domain()[0])));
              return result = Math.ceil(result);
            } else {
              firstPos = self.behaviors.axis.yScale(d.value0);
              lastPos = self.behaviors.axis.yScale(d.value0 + d.value);
              return result = Math.ceil(firstPos - lastPos);
            }
          });
        } else {
          return updateD3Object.attr("x", function(d, i) {
            var barWidth, base, basePos, x, y;
            y = 0;
            base = d.value0;
            if (d.value < 0) {
              basePos = self.behaviors.axis.xScale(base);
              barWidth = Math.abs(self.behaviors.axis.xScale(d.value) - self.behaviors.axis.xScale(Math.max(0, self.behaviors.axis.xScale.domain()[0])));
              x = Math.max(self.behaviors.axis.xScale(base) - barWidth, 0);
            } else {
              x = Math.max(self.behaviors.axis.xScale(base), self.behaviors.axis.xScale(self.behaviors.axis.xScale.domain()[0]));
            }
            return Math.ceil(x);
          }).attr("width", function(d) {
            var barWidth, basePos, correction, limitPos, result, resultCorrection;
            if (d.value < 0) {
              result = Math.abs(self.behaviors.axis.xScale(d.value) - self.behaviors.axis.xScale(Math.max(0, self.behaviors.axis.xScale.domain()[0])));
              basePos = self.behaviors.axis.xScale(d.value0);
              barWidth = Math.abs(self.behaviors.axis.xScale(d.value) - self.behaviors.axis.xScale(0));
              resultCorrection = Math.abs(Math.min(basePos - barWidth, 0));
              return result = Math.max(0, Math.ceil(result - resultCorrection));
            } else {
              barWidth = Math.abs(self.behaviors.axis.xScale(d.value) - self.behaviors.axis.xScale(0));
              basePos = self.behaviors.axis.xScale(d.value0);
              limitPos = self.behaviors.axis.xScale(Math.max(0, self.behaviors.axis.xScale.domain()[0]));
              correction = Math.max(0, limitPos - basePos);
              return result = Math.max(0, Math.ceil(barWidth - correction));
            }
          }).attr("y", function(d) {
            return self.behaviors.axis.yScale(d.id);
          }).attr("height", self.behaviors.axis.yScale.rangeBand());
        }
      });
    };

    return StackedBarChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.GroupedBarChartView = (function(_super) {
    __extends(GroupedBarChartView, _super);

    function GroupedBarChartView() {
      this.updateItems = __bind(this.updateItems, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      this.setAxisDirection = __bind(this.setAxisDirection, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      this.setIdsAndValues = __bind(this.setIdsAndValues, this);
      _ref = GroupedBarChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    GroupedBarChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    GroupedBarChartView.prototype.xAxisType = "bands";

    GroupedBarChartView.prototype.yAxisType = "linear";

    GroupedBarChartView.prototype.yAxisPadding = true;

    GroupedBarChartView.prototype.xAxisPadding = true;

    GroupedBarChartView.prototype.accumulate = false;

    GroupedBarChartView.prototype.followMouse = true;

    GroupedBarChartView.prototype.chartType = "groupedbarchart";

    GroupedBarChartView.prototype.setIdsAndValues = function() {
      this.model.original._ids = this.idsItems;
      return this.model.original._values = this.values;
    };

    GroupedBarChartView.prototype.getXDomainValues = function() {
      if (this.xAxisType === "bands") {
        return this.ids;
      } else {
        return this.calculateNumberDomain(this.values, false, "value");
      }
    };

    GroupedBarChartView.prototype.getYDomainValues = function() {
      if (this.xAxisType === "bands") {
        return this.calculateNumberDomain(this.values, false, "value");
      } else {
        return this.ids;
      }
    };

    GroupedBarChartView.prototype.visualizerWillExecBehaviors1 = function() {
      return this.dimensions = ["value"];
    };

    GroupedBarChartView.prototype.setAxisDirection = function() {
      var axeIds;
      axeIds = this.model.get("IdsOnAxis");
      if (!axeIds) {
        axeIds = "Vertical";
      }
      if (axeIds === "Vertical") {
        this.yAxisType = "linear";
        return this.xAxisType = "bands";
      } else {
        this.yAxisType = "bands";
        return this.xAxisType = "linear";
      }
    };

    GroupedBarChartView.prototype.checkAxisChanged = function() {
      return (this.model.changed["IdsOnAxis"] != null) || (this.model.changed["gapBetweenBars"] != null) || (this.model.changed["dimensionAsItems"] != null);
    };

    GroupedBarChartView.prototype.updateItems = function() {
      var self;
      self = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        if (self.values.length === 1 && self.__LastValuesLength === 1) {
          return "__onlyOne__";
        } else {
          return d.id;
        }
      });
      this.__LastValuesLength = this.values.length;
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.items.exit().remove();
      self = this;
      return this.items.each(function(itemData, itemIndex) {
        var rects, rectsEnter, size, transitionTime, transitionType, updateD3Object,
          _this = this;
        rects = d3.select(this).selectAll(".bar").data(itemData.value, function(d, i) {
          return d.id;
        });
        rectsEnter = rects.enter().append("rect").attr("class", "bar");
        rects.exit().remove();
        size = self.ids.length * self.idsItems.length;
        if (size < 1000 && self.animationActive) {
          transitionType = self.model.get("transition")[0];
          transitionTime = self.model.get("transition")[1];
          updateD3Object = rects.transition().duration(transitionTime).ease(transitionType);
        } else {
          updateD3Object = rects;
        }
        if (self.xAxisType === "bands") {
          return updateD3Object.attr("x", function(d, i) {
            var groupItems, itemBandWidth, itemWidth;
            groupItems = self.idsItems.length;
            itemBandWidth = self.behaviors.axis.xScale.rangeBand();
            itemWidth = itemBandWidth / groupItems;
            return self.behaviors.axis.xScale(d.id) + (itemIndex * itemWidth);
          }).attr("width", function(d) {
            var groupItems, itemBandWidth;
            groupItems = self.idsItems.length;
            itemBandWidth = self.behaviors.axis.xScale.rangeBand();
            return itemBandWidth / groupItems;
          }).attr("y", function(d) {
            var barHeight;
            barHeight = Math.abs(self.behaviors.axis.yScale(0) - self.behaviors.axis.yScale(d.value));
            if (d.value < 0) {
              return self.behaviors.axis.yScale(d.value) - barHeight;
            } else {
              return self.behaviors.axis.yScale(d.value);
            }
          }).attr("height", function(d) {
            var barHeight;
            barHeight = Math.abs(self.behaviors.axis.yScale(d.value) - self.behaviors.axis.yScale(0));
            return Math.ceil(barHeight);
          });
        } else {
          return updateD3Object.attr("x", function(d, i) {
            var barWidth;
            barWidth = Math.abs(self.behaviors.axis.xScale(d.value) - self.behaviors.axis.xScale(0));
            if (d.value < 0) {
              return self.behaviors.axis.xScale(0) - barWidth;
            } else {
              return self.behaviors.axis.xScale(0);
            }
          }).attr("width", function(d) {
            var barWidth;
            barWidth = Math.abs(self.behaviors.axis.xScale(d.value) - self.behaviors.axis.xScale(0));
            return Math.ceil(barWidth);
          }).attr("y", function(d) {
            var groupItems, itemBandHeight, itemHeight;
            groupItems = self.idsItems.length;
            itemBandHeight = self.behaviors.axis.yScale.rangeBand();
            itemHeight = itemBandHeight / groupItems;
            return self.behaviors.axis.yScale(d.id) + (itemIndex * itemHeight);
          }).attr("height", function(d) {
            var groupItems, itemBandHeight;
            groupItems = self.idsItems.length;
            itemBandHeight = self.behaviors.axis.yScale.rangeBand();
            return itemBandHeight / groupItems;
          });
        }
      });
    };

    return GroupedBarChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.CustomBlockCollectionView = (function(_super) {
    __extends(CustomBlockCollectionView, _super);

    function CustomBlockCollectionView() {
      this.elementViewDidRemove = __bind(this.elementViewDidRemove, this);
      this.elementViewDidRender = __bind(this.elementViewDidRender, this);
      this.elementAdded = __bind(this.elementAdded, this);
      this.renderSelectedBlock = __bind(this.renderSelectedBlock, this);
      this.updateSelectedView = __bind(this.updateSelectedView, this);
      this.selectElementView = __bind(this.selectElementView, this);
      this.viewDidRemove = __bind(this.viewDidRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = CustomBlockCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    CustomBlockCollectionView.prototype.template = JST['app/scripts/templates/blocks/customBlockCollection.hbs'];

    CustomBlockCollectionView.prototype.modelView = quadrigram.Views.CustomBlockCollectionElementView;

    CustomBlockCollectionView.prototype.bindModelViews = false;

    CustomBlockCollectionView.prototype.elementEvents = {
      "select": "selectElementView"
    };

    CustomBlockCollectionView.prototype.viewDidRender = function() {
      if (this.collection.models.length > 0) {
        return this.renderSelectedBlock(this.collection.models[0]);
      }
    };

    CustomBlockCollectionView.prototype.viewDidRemove = function() {};

    CustomBlockCollectionView.prototype.selectElementView = function(view) {
      this.updateSelectedView(view);
      return this.renderSelectedBlock(view.model);
    };

    CustomBlockCollectionView.prototype.updateSelectedView = function(view) {
      this.$el.find(".dropdown-menu").find(".list-item").removeClass("selected");
      return view.$el.find(".list-item").addClass("selected");
    };

    CustomBlockCollectionView.prototype.renderSelectedBlock = function(model) {
      var selectedBlockView;
      this.$el.closest(".block-inspector-content").find(".selected-block-container").empty();
      selectedBlockView = new quadrigram.Views.DataBlockSourceView({
        model: model,
        binding: false
      });
      selectedBlockView.render();
      this.$el.closest(".block-inspector-content").find(".selected-block-container").append(selectedBlockView.$el);
      return this.trigger("block-selected", model);
    };

    CustomBlockCollectionView.prototype.elementAdded = function(model, i) {
      var view;
      view = CustomBlockCollectionView.__super__.elementAdded.call(this, model, i);
      return this.$el.find(".dropdown-menu").append(view.$el);
    };

    CustomBlockCollectionView.prototype.elementViewDidRender = function(view) {
      var _this = this;
      return _.defer(function() {
        return _this.selectElementView(view);
      });
    };

    CustomBlockCollectionView.prototype.elementViewDidRemove = function(view) {
      return this.selectElementView(this.modelViews[this.collection.models[0].cid]);
    };

    return CustomBlockCollectionView;

  })(Backbone.CollectionView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PieChartView = (function(_super) {
    __extends(PieChartView, _super);

    function PieChartView() {
      this.updateItems = __bind(this.updateItems, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.createPieChartFunction = __bind(this.createPieChartFunction, this);
      this.createArcFunction = __bind(this.createArcFunction, this);
      _ref = PieChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PieChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    PieChartView.prototype.createArcFunction = function() {
      return this.arcFunction = d3.svg.arc();
    };

    PieChartView.prototype.createPieChartFunction = function() {
      return this.pieFunction = d3.layout.pie().value(function(d) {
        return d.value;
      }).sort(d3.descending);
    };

    PieChartView.prototype.visualizerWillUpdateItems = function() {
      var radius;
      if (this.pieFunction == null) {
        this.createPieChartFunction();
      }
      if (this.arcFunction == null) {
        this.createArcFunction();
      }
      radius = Math.max((Math.min(this.behaviors.svg.size.height, this.behaviors.svg.size.width) - 40) / 2, 25);
      return this.arcFunction.innerRadius(0).outerRadius(radius);
    };

    PieChartView.prototype.updateItems = function() {
      var pieValues;
      pieValues = this.pieFunction(this.values);
      pieValues.forEach(function(d, i) {
        d.value = d.data.value;
        return d.id = d.data.id;
      });
      this.items = this.behaviors.svg.root.selectAll(".item").data(pieValues, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g");
      this.itemsEnter.append("path").attr("class", "arc");
      this.items.exit().remove();
      this.items.attr("class", "item").attr("transform", "translate(" + this.behaviors.svg.size.width / 2 + "," + this.behaviors.svg.size.height / 2 + ")");
      return this.items.select(".arc").attr("d", this.arcFunction);
    };

    PieChartView.prototype.tooltipTitle = function(event, QTip) {
      var object;
      object = d3.select(this[0]).datum();
      if (object.name != null) {
        return object.name;
      } else {
        return object.id;
      }
    };

    return PieChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ExportResourceItem = (function(_super) {
    __extends(ExportResourceItem, _super);

    function ExportResourceItem() {
      this.triggerChange = __bind(this.triggerChange, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = ExportResourceItem.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExportResourceItem.prototype.template = JST['app/scripts/templates/UI/dialogs/exportResourceItem.hbs'];

    ExportResourceItem.prototype.className = "list-item";

    ExportResourceItem.prototype.events = {
      "change .include-checkbox": "triggerChange"
    };

    ExportResourceItem.prototype.viewDidRender = function() {
      log("ExportResourceItem:viewDidRender", this.templateData, this.model);
      if (this.model.get("exportMode") === 1) {
        return this.$el.find(".include-checkbox").prop('checked', true);
      } else {
        return this.$el.find(".include-checkbox").prop('checked', false);
      }
    };

    ExportResourceItem.prototype.triggerChange = function() {
      log("triggering selection");
      return this.trigger("change", this);
    };

    return ExportResourceItem;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ExportResourceCollection = (function(_super) {
    __extends(ExportResourceCollection, _super);

    function ExportResourceCollection() {
      this._handleCehckboxChange = __bind(this._handleCehckboxChange, this);
      _ref = ExportResourceCollection.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ExportResourceCollection.prototype.modelView = quadrigram.Views.ExportResourceItem;

    ExportResourceCollection.prototype.elementEvents = {
      "change": "_handleCehckboxChange",
      "delete": "_clickOnDeleteItem"
    };

    ExportResourceCollection.prototype._handleCehckboxChange = function(itemView) {
      log(itemView.$el.find(".include-checkbox").is(':checked'), itemView.model.get("rid"));
      if (itemView.$el.find(".include-checkbox").is(':checked')) {
        return itemView.model.set("exportMode", 1, {
          silent: true
        });
      } else {
        return itemView.model.set("exportMode", 0, {
          silent: true
        });
      }
      /*WRONG
      @resourcesConfig = []
      for vid of @modelViews
        res = {}
        res.id = @modelViews[vid].model.get("rid")
        if @modelViews[vid].$el.find(".include-checkbox").is(':checked')
          res.exportMode = 1
        else
          res.exportMode = 0
        @resourcesConfig.push(res)
      */

    };

    return ExportResourceCollection;

  })(quadrigram.Views.LoadableCollectionView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ScatterPlotView = (function(_super) {
    __extends(ScatterPlotView, _super);

    function ScatterPlotView() {
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.updateItems_OLD = __bind(this.updateItems_OLD, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.visualizerWillExecBehaviors1 = __bind(this.visualizerWillExecBehaviors1, this);
      this.getYDomainValues = __bind(this.getYDomainValues, this);
      this.getXDomainValues = __bind(this.getXDomainValues, this);
      this.checkAxisChanged = __bind(this.checkAxisChanged, this);
      _ref = ScatterPlotView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ScatterPlotView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    ScatterPlotView.prototype.xAxisType = "linear";

    ScatterPlotView.prototype.xAxisField = "xValue";

    ScatterPlotView.prototype.yAxisType = "linear";

    ScatterPlotView.prototype.yAxisField = "yValue";

    ScatterPlotView.prototype.xAxisPadding = true;

    ScatterPlotView.prototype.yAxisPadding = true;

    ScatterPlotView.prototype.bodyFields = [
      {
        field: "xValue",
        label: {
          objectField: "xDim",
          "default": "x"
        }
      }, {
        field: "yValue",
        label: {
          objectField: "yDim",
          "default": "y"
        }
      }, {
        field: "radiusValue",
        label: {
          objectField: "radiusDim",
          "default": "z"
        }
      }
    ];

    ScatterPlotView.prototype.extraAmplitudeDomain = 0.20;

    ScatterPlotView.prototype.followMouse = false;

    ScatterPlotView.prototype.radiusDim = "dataRadius";

    ScatterPlotView.prototype.checkAxisChanged = function() {
      return (this.model.changed["dataXAxis"] != null) || (this.model.changed["dataYAxis"] != null);
    };

    ScatterPlotView.prototype.getXDomainValues = function() {
      return this.behaviors.dataController.getXDomainValues();
    };

    ScatterPlotView.prototype.getYDomainValues = function() {
      return this.behaviors.dataController.getYDomainValues();
    };

    ScatterPlotView.prototype.visualizerWillExecBehaviors1 = function() {
      return this.dimensions = ["value"];
    };

    ScatterPlotView.prototype.visualizerWillUpdateItems = function() {
      var radiusDomain, radiusRange;
      if (this.model.get("dataRadius").currentFormat === "PxByValuesAndDomain") {
        radiusDomain = this.calculateNumberDomain(this.radiusValues, 0, false);
        if ((this.model.get("dataRadius")[1] != null) && this.model.get("dataRadius")[1] !== "") {
          radiusDomain[0] = this.model.get("dataRadius")[1];
        }
        if ((this.model.get("dataRadius")[2] != null) && this.model.get("dataRadius")[2] !== "") {
          radiusDomain[1] = this.model.get("dataRadius")[2];
        }
        radiusRange = [this.model.get("dataRadius")[3], this.model.get("dataRadius")[4]];
      } else {
        radiusDomain = this.calculateNumberDomain(this.radiusValues, false, "value");
        radiusRange = [this.model.get("dataRadius")[1], this.model.get("dataRadius")[2]];
      }
      return this.behaviors.circles.updateRadiusScale(radiusDomain, radiusRange);
    };

    ScatterPlotView.prototype.updateItems_OLD = function() {
      var self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("circle").attr("class", "dot");
      this.items.exit().remove();
      self = this;
      size = this.items.size();
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.items.select(".dot").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.items.select(".dot");
      }
      return updateD3Object.attr("r", function(d, i) {
        var value;
        value = _this.behaviors.circles.getRadiusFromValue(d.radiusValue);
        if (_.isNaN(value)) {
          value = 0;
        }
        if (value < 0) {
          value = 0;
        }
        return value;
      }).attr("cx", function(d, i) {
        var value;
        return value = self.behaviors.axis.xScale(d.xValue);
      }).attr("cy", function(d, i) {
        var value;
        return value = self.behaviors.axis.yScale(d.yValue);
      }).each(function(d, i) {
        var limitX, limitY, valueX, valueY;
        valueX = self.behaviors.axis.xScale(d.xValue);
        limitX = 0;
        valueY = self.behaviors.axis.yScale(d.yValue);
        limitY = self.behaviors.axis.yScale(self.behaviors.axis.yScale.domain()[0]);
        if (valueX < limitX || valueY > limitY) {
          return d3.select(this).style("display", "none");
        } else {
          return d3.select(this).style("display", "");
        }
      });
    };

    ScatterPlotView.prototype.updateItems = function() {
      var self, size, transitionTime, transitionType, updateD3Object,
        _this = this;
      self = this;
      this.items = this.behaviors.axis.graph.selectAll(".item").data(this.values, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("g").attr("class", "item");
      this.itemsEnter.append("g").attr("class", "dot");
      this.itemsEnter.select(".dot").attr("transform", function(d) {
        var x, y;
        x = self.behaviors.axis.xScale(d.xValue);
        if (!isNaN(d.yValue)) {
          y = self.behaviors.axis.yScale(d.yValue);
        } else {
          y = 0;
        }
        return "translate(" + x + "," + y + ")";
      });
      this.items.exit().remove();
      size = this.items.size();
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3Object = this.items.select(".dot").transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3Object = this.items.select(".dot");
      }
      updateD3Object.attr("transform", function(d) {
        var x, y;
        x = self.behaviors.axis.xScale(d.xValue);
        if (!isNaN(d.yValue)) {
          y = self.behaviors.axis.yScale(d.yValue);
        } else {
          y = 0;
        }
        return "translate(" + x + "," + y + ")";
      });
      return updateD3Object.each(function(d, i) {
        var limitX, limitY, valueX, valueY;
        valueX = self.behaviors.axis.xScale(d.xValue);
        limitX = 0;
        valueY = self.behaviors.axis.yScale(d.yValue);
        limitY = self.behaviors.axis.yScale(self.behaviors.axis.yScale.domain()[0]);
        if (valueX < limitX || valueY > limitY) {
          return d3.select(this).style("display", "none");
        } else {
          return d3.select(this).style("display", "");
        }
      });
    };

    ScatterPlotView.prototype.visualizerDidUpdateItems = function() {
      var self;
      self = this;
      return this.items.select(".dot").each(function(d) {
        var shape, size;
        shape = self.behaviors.selection.behaviors.items.styleItems[d.id].shapeType;
        size = self.behaviors.circles.getRadiusFromValue(d.radiusValue);
        if (_.isNaN(size)) {
          size = 0;
        }
        if (size < 0) {
          size = 0;
        }
        return self.behaviors.svgshapes.drawShape(d3.select(this), shape, size);
      });
    };

    return ScatterPlotView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.TableView = (function(_super) {
    __extends(TableView, _super);

    function TableView() {
      this.getBuildData = __bind(this.getBuildData, this);
      this.rebuildData = __bind(this.rebuildData, this);
      this.unescapeForHot = __bind(this.unescapeForHot, this);
      this.escapeForHot = __bind(this.escapeForHot, this);
      this.tableFromModel = __bind(this.tableFromModel, this);
      this.rowFromModel = __bind(this.rowFromModel, this);
      this.listFromModel = __bind(this.listFromModel, this);
      this.flatDataFromModel = __bind(this.flatDataFromModel, this);
      this.setMode = __bind(this.setMode, this);
      this.handleTypeChange = __bind(this.handleTypeChange, this);
      this.handleSheetChange = __bind(this.handleSheetChange, this);
      this.addBlockIfNeeded = __bind(this.addBlockIfNeeded, this);
      this.findInvalidDatesInCol = __bind(this.findInvalidDatesInCol, this);
      this.headerPostRenderer = __bind(this.headerPostRenderer, this);
      this.renderHot = __bind(this.renderHot, this);
      this.renderNoDataYet = __bind(this.renderNoDataYet, this);
      this.renderNoData = __bind(this.renderNoData, this);
      this.renderSingleValue = __bind(this.renderSingleValue, this);
      this.hideIndexesWarning = __bind(this.hideIndexesWarning, this);
      this.hideAggregateWarning = __bind(this.hideAggregateWarning, this);
      this.clickOnLearnMore = __bind(this.clickOnLearnMore, this);
      this.showIndexesWarning = __bind(this.showIndexesWarning, this);
      this.showAggregateWarning = __bind(this.showAggregateWarning, this);
      this.showBadTableWarning = __bind(this.showBadTableWarning, this);
      this.showInvalidDataWarning = __bind(this.showInvalidDataWarning, this);
      this.setModeToggler = __bind(this.setModeToggler, this);
      this.renderContent = __bind(this.renderContent, this);
      this.setDynamic = __bind(this.setDynamic, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.renderDataTypeOptions = __bind(this.renderDataTypeOptions, this);
      this.renderFileTypeOptions = __bind(this.renderFileTypeOptions, this);
      this.hanldeChangeBlockStructure = __bind(this.hanldeChangeBlockStructure, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = TableView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TableView.prototype.template = JST['app/scripts/templates/UI/dialogs/BlockPreview/tableView.hbs'];

    TableView.prototype.modeTogglerTemplate = JST['app/scripts/templates/UI/dialogs/BlockPreview/viewModeTogglerTemplate.hbs'];

    TableView.prototype.dynamicCheckboxTemplate = JST['app/scripts/templates/UI/dialogs/BlockPreview/dynamicCheckboxTemplate.hbs'];

    TableView.prototype.noDataTempate = JST['app/scripts/templates/UI/dialogs/BlockPreview/noDataTemplate.hbs'];

    TableView.prototype.noDataYetTempate = JST['app/scripts/templates/UI/dialogs/BlockPreview/noDataYetTemplate.hbs'];

    TableView.prototype.processingTemplate = JST['app/scripts/templates/UI/dialogs/BlockPreview/processingTemplate.hbs'];

    TableView.prototype.singleValueTemplate = JST['app/scripts/templates/UI/dialogs/BlockPreview/singleValueTemplate.hbs'];

    TableView.prototype.warningBadDataTemplate = JST['app/scripts/templates/UI/dialogs/BlockPreview/warningBadDataTemplate.hbs'];

    TableView.prototype.warningInvalidDataTemplate = JST['app/scripts/templates/UI/dialogs/BlockPreview/warningInvalidDataTemplate.hbs'];

    TableView.prototype.warningAggregateTemplate = JST['app/scripts/templates/UI/dialogs/BlockPreview/warningAggregateTemplate.hbs'];

    TableView.prototype.warningIndexesTemplate = JST['app/scripts/templates/UI/dialogs/BlockPreview/warningIndexesTemplate.hbs'];

    TableView.prototype.className = 'table-view';

    TableView.prototype.events = {};

    TableView.prototype.viewWillRender = function() {
      return this.templateData.isBuilder = this.isBuilder;
    };

    TableView.prototype.viewDidRender = function() {
      if (!this.isBuilder) {
        this.$el.closest(".ui-dialog ").find(".ui-dialog-titlebar").append(this.modeTogglerTemplate());
        this.$el.find(".checkbox-container").addClass("hidden");
      } else {
        this.$el.find(".checkbox-container").addClass("hidden");
        /*
        if @model.get("blockGroup").get("spreadsheet")? and @model.get("blockGroup").get("spreadsheet") == 1
          #Deactivate functionality until there is a solution for spreadsheet linking
          @$el.find(".checkbox-container").addClass("hidden")
          
          #@$el.find(".checkbox-container").append(@dynamicCheckboxTemplate())
          #@$el.find(".checkbox-container").find(".dyanimc-checkbox").on("change",@setDynamic)
          #if@model.get("blockGroup").get("isDynamic")
          #  @$el.find(".checkbox-container").find(".dyanimc-checkbox").attr( "checked","checked" )
        else
          @$el.find(".checkbox-container").addClass("hidden")
        */

      }
      if (this.model) {
        if ((this.model.get("metaData") != null) && (this.model.get("metaData").viewMode != null)) {
          this.setMode(this.model.get("metaData").viewMode);
        }
        if (this.isBuilder) {
          this.renderFileTypeOptions();
          if (!this.parentGroup.invalidData) {
            this.renderDataTypeOptions();
          } else {
            this.$el.find(".data-type-options-container").empty();
          }
        } else {
          this.$el.closest(".ui-dialog").find("li.view-mode-item").on("click", this.handleTypeChange);
        }
        if (this.isBuilder) {
          this.parentGroup.on("change-block-structure", this.hanldeChangeBlockStructure);
        } else {
          this.model.on("change:fetchState", this.renderContent);
        }
      }
      return this.renderContent();
    };

    TableView.prototype.hanldeChangeBlockStructure = function() {
      this.renderFileTypeOptions();
      if (!this.parentGroup.invalidData) {
        this.renderDataTypeOptions();
      } else {
        this.$el.find(".data-type-options-container").empty();
      }
      return this.renderContent();
    };

    TableView.prototype.renderFileTypeOptions = function() {
      var fileTypeOptionsView;
      this.$el.find(".file-type-options-container").empty();
      if ((this.model.get("blockGroup").get("currentSheet") != null) && (this.model.get("blockGroup").sheetOptions != null) && this.model.get("blockGroup").sheetOptions.length > 1) {
        log("sheet options = ", this.model.get("blockGroup").sheetOptions);
        fileTypeOptionsView = new quadrigram.Views.fileTypeOptions({
          model: this.model,
          binding: false
        });
        fileTypeOptionsView.parentGroup = this.parentGroup;
        fileTypeOptionsView.render();
        this.$el.find(".file-type-options-container").append(fileTypeOptionsView.$el);
        return fileTypeOptionsView.on("change-sheet", this.handleSheetChange);
      } else {

      }
    };

    TableView.prototype.renderDataTypeOptions = function() {
      var dataTypeOptionsView;
      this.$el.find(".data-type-options-container").empty();
      dataTypeOptionsView = new quadrigram.Views.dataTypeOptions({
        model: this.model,
        binding: false
      });
      dataTypeOptionsView.parentGroup = this.parentGroup;
      dataTypeOptionsView.render();
      this.$el.find(".data-type-options-container").append(dataTypeOptionsView.$el);
      dataTypeOptionsView.on("change:option", this.rebuildData);
      return this.dataTypeOptionsView = dataTypeOptionsView;
    };

    TableView.prototype.viewWillRemove = function() {
      if (this.isBuilder) {
        this.parentGroup.off("change-block-structure", this.hanldeChangeBlockStructure);
        this.parentGroup.off("change:fetchState", this.renderContent);
        this.$el.find(".refresh-resource-btn").off("click", this.refreshTableData);
      } else {
        this.model.off("change:fetchState", this.renderContent);
      }
      this.$el.find(".view-type-toggle .type-btn a").off("click");
      if (this.hot) {
        this.hot.destroy();
        return this.hot = null;
      }
    };

    TableView.prototype.setDynamic = function(e) {
      return this.model.get("blockGroup").set("isDynamic", $(e.target).is(":checked"));
    };

    TableView.prototype.renderContent = function() {
      if (this.hot) {
        this.hot.destroy();
        this.hot = null;
      }
      this.$el.find(".hot-container").empty();
      this.$el.closest(".ui-dialog").find(".view-mode-toggle").addClass("hidden");
      if (this.isBuilder && this.parentGroup.invalidData) {
        this.renderNoData();
        return this.showInvalidDataWarning();
      } else if (BlockUtils.isEmpty(this.model)) {
        if (this.model.get("fetchState") === "ready") {
          return this.renderNoData();
        } else {
          return this.renderNoDataYet();
        }
      } else if (this.model.get("data") && this.model.get("data").length === 1 && !BlockUtils.isBlockOrData(this.model.get("data")[0].value)) {
        return this.renderSingleValue(this.model.get("data")[0]);
      } else if (this.model.get("data") && this.model.get("data").length > 0) {
        if (this.isBuilder && Number(this.model.get("blockGroup").get("consistency")) < 0) {
          if (!this.model.dismissedBadData) {
            this.showBadTableWarning(this.model.get("blockGroup").get("consistency"));
          }
        }
        this.$el.closest(".ui-dialog").find(".view-mode-toggle").removeClass("hidden");
        this.renderHot();
        return this.setModeToggler();
      }
    };

    TableView.prototype.setModeToggler = function() {
      var depth;
      depth = this.depth;
      if (depth < 2) {
        this.$el.closest(".ui-dialog").find(".view-mode-toggle .view-mode-item[value='table']").addClass("hidden");
      } else {
        this.$el.closest(".ui-dialog").find(".view-mode-toggle .view-mode-item[value='table']").removeClass("hidden");
      }
      if ((this.model.get("metaData") != null) && (this.model.get("metaData").viewMode != null)) {
        if (this.model.get("metaData").viewMode === "list") {
          if (this.model.get("metaData").viewDirection != null) {
            this.setMode(this.model.get("metaData").viewDirection);
          } else {
            this.setMode("col");
          }
        } else {
          this.setMode("table");
        }
      } else {
        if (depth === 1) {
          this.setMode("col");
        } else {
          this.setMode("table");
        }
      }
      return this.$el.closest(".ui-dialog").find(".view-mode-toggle").removeClass("hidden");
    };

    TableView.prototype.showInvalidDataWarning = function() {
      var _this = this;
      this.$el.find(".warning-container").empty();
      this.$el.find(".warning-container").removeClass("hidden");
      this.$el.find(".warning-container").css("height", "");
      this.$el.find(".warning-container").append(this.warningInvalidDataTemplate({
        "reason": "Something very bad happened..."
      }));
      return this.$el.find(".learn-more-link").on("click", function() {
        return _this.clickOnLearnMore("dataTables");
      });
    };

    TableView.prototype.showBadTableWarning = function(value) {
      var reason,
        _this = this;
      this.$el.find(".warning-container").empty();
      this.$el.find(".warning-container").removeClass("hidden");
      this.$el.find(".warning-container").css("height", "");
      switch (value) {
        case -4:
          reason = "Some headers are empty";
          break;
        case -3:
          reason = "Some headers are duplicated";
          break;
        case -2:
          reason = "A lot of empty cells";
          break;
        case -1:
          reason = "A lot of empty cells";
          break;
        default:
          reason = "unknown reason";
      }
      this.$el.find(".warning-container").append(this.warningBadDataTemplate({
        "reason": reason
      }));
      this.$el.find(".dismiss-btn").on("click", function() {
        _this.model.dismissedBadData = true;
        return _this.$el.find(".warning-container").css("height", "0px");
      });
      return this.$el.find(".learn-more-link").on("click", function() {
        return _this.clickOnLearnMore("dataTables");
      });
    };

    TableView.prototype.showAggregateWarning = function(idKey) {
      var _this = this;
      this.$el.find(".warning-container").empty();
      this.$el.find(".warning-container").removeClass("hidden");
      this.$el.find(".warning-container").css("height", "");
      this.$el.find(".warning-container").append(this.warningAggregateTemplate({
        "idKey": idKey
      }));
      return this.$el.find(".dismiss-btn").on("click", function() {
        _this.model.dismissedAggregate = true;
        return _this.$el.find(".warning-container").css("height", "0px");
      });
    };

    TableView.prototype.showIndexesWarning = function(firstKey) {
      var _this = this;
      this.$el.find(".warning-container").empty();
      this.$el.find(".warning-container").removeClass("hidden");
      this.$el.find(".warning-container").css("height", "");
      this.$el.find(".warning-container").append(this.warningIndexesTemplate({
        "firstKey": firstKey
      }));
      this.$el.find(".dismiss-btn").on("click", function() {
        _this.model.dismissedIndexes = true;
        return _this.$el.find(".warning-container").css("height", "0px");
      });
      return this.$el.find(".learn-more-link").on("click", function() {
        return _this.clickOnLearnMore("indexes");
      });
    };

    TableView.prototype.clickOnLearnMore = function(topic) {
      return window.open(quadrigram.webUrl + "help/#content/" + topic, "_blank");
    };

    TableView.prototype.hideAggregateWarning = function() {
      return this.$el.find(".warning-container").css("height", "0px");
    };

    TableView.prototype.hideIndexesWarning = function() {
      return this.$el.find(".warning-container").css("height", "0px");
    };

    TableView.prototype.renderSingleValue = function(qvalue) {
      this.$el.find(".no-data-yet-table").remove();
      return this.$el.find(".hot-container").append(this.singleValueTemplate(qvalue));
    };

    TableView.prototype.renderNoData = function() {
      this.$el.find(".no-data-yet-table").remove();
      return this.$el.find(".hot-container").append(this.noDataTempate());
    };

    TableView.prototype.renderNoDataYet = function() {
      return this.$el.append(this.noDataYetTempate());
    };

    TableView.prototype.renderHot = function() {
      var columnsArray, fullData, h, styleParent, _i, _len, _ref1;
      this.$el.find(".no-data-yet-table").remove();
      fullData = this.flatDataFromModel();
      columnsArray = [];
      _ref1 = fullData.headerData;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        h = _ref1[_i];
        columnsArray.push({
          data: h
        });
      }
      if (fullData.headerData.indexOf("__Index__") >= 0) {
        fullData.headerData[fullData.headerData.indexOf("__Index__")] = "Index";
      }
      if (!this.hot) {
        styleParent = $("<div id='hot-style-container'> </di>");
        this.$el.find(".hot-container").append(styleParent);
        styleParent.css({
          "width": "100%"
        });
        styleParent.css({
          "height": "100%"
        });
        styleParent.css({
          "overflow": "auto"
        });
        this.hot = new Handsontable(styleParent[0], {
          data: fullData.contentData,
          colWidths: 150,
          rowHeights: 40,
          colHeaders: fullData.headerData,
          fixedColumnsLeft: 1,
          afterGetColHeader: this.headerPostRenderer,
          afterRenderer: this.addBlockIfNeeded,
          wordWrap: false,
          multiSelect: false,
          fragmentSelection: true,
          columns: columnsArray,
          manualColumnResize: true,
          cells: function(row, col, prop) {
            return {
              readOnly: true
            };
          }
        });
      } else {
        this.$el.find(".hot-container").append($(this.hot.container).parent());
        this.hot.updateSettings({
          colHeaders: fullData.headerData,
          columns: columnsArray
        });
        this.hot.loadData(fullData.contentData);
      }
      this.$el.find(".hot-container").prepend("<div class='white-header'></div>");
      this.$el.find(".hot-container").prepend("<div class='white-first'></div>");
      if (this.isBuilder) {
        this.$el.find(".white-header").addClass("big-header");
        this.$el.find(".hot-container").addClass("is-builder");
      } else {
        this.$el.find(".builer-options-container").addClass("hidden");
        this.$el.find(".white-header").addClass("small-header");
        this.$el.find(".hot-container").addClass("not-is-builder");
      }
      /*
      if @isBuilder
        if @$el.find(".table-viewer-header-id-selector").length == 0
          idSelector = $("<div class='table-viewer-header-id-selector table-viewer-cell'><select class='id-selector' name='id-selector'></select></div>")
      
          for key in @parentGroup.keys
            idSelector.find("select").append($("<option value='"+key+"'>"+key+"</option>"))
          idSelector.find("select").append($("<option value='__Index__'> Index </option>"))
          idSelector.find("select").val(@parentGroup.get("buildData").idKey)
      
          @$el.find(".id-selector-container").append(idSelector)
          idSelector.find("select").selectmenu({
              width:100
              change:@changeIdKey
            })
      
      #WRONG: esto tiene que ir dentro del dataTableOptions!!!! (vigilar con posibles referencias a ...-id-selector )
      */

      if (this.isBuilder) {
        if (this.parentGroup.hasIdRepetition[this.parentGroup.get("buildData").idKey]) {
          if (!this.model.dismissedAggregate) {
            this.showAggregateWarning(this.parentGroup.get("buildData").idKey);
          }
        } else {
          this.hideAggregateWarning();
        }
        if (this.parentGroup.get("buildData").idKey === "__Index__") {
          if (!this.model.dismissedIndexes) {
            this.showIndexesWarning(this.parentGroup.get("buildData").blocks[0].id);
          }
        } else {
          this.hideIndexesWarning();
        }
      }
      if (this.lastScrolls != null) {
        this.$el.find("#hot-style-container").scrollTop(this.lastScrolls.top);
        return this.$el.find("#hot-style-container").scrollLeft(this.lastScrolls.left);
      }
    };

    TableView.prototype.getqvvalue = function(attr) {
      return function(row) {
        return row[attr];
      };
    };

    TableView.prototype.headerPostRenderer = function(col, TH) {
      var aggregator, array, showDateWarning;
      $(TH).find(".colHeader").html(this.unescapeForHot($(TH).find(".colHeader").html()));
      if (this.isBuilder) {
        $(TH).addClass("big-header");
        $(TH).addClass("hot-builder-header");
        if (col === 0 && $(TH).closest(".ht_clone_corner").length > 0) {
          $(TH).append("<div class='table-preview-corner-aggregation'>Identifiers</div>");
        } else if ($(TH).closest(".ht_clone_top").length > 0) {
          if (this.parentGroup.hasIdRepetition[this.parentGroup.get("buildData").idKey] && $(TH).find(".aggregator").length <= 0) {
            aggregator = $("<div class='table-viewer-header-aggregator table-viewer-cell'><select data-col='" + (col - 1) + "' class='aggregator'>            <option value='add'>Aggreggate adding</option>            <option value='count'>Aggreggate counting</option>            <option value='mean'>Mean value</option>            <option value='min'>Minimum value</option>            <option value='max'>Maximum value</option>            <option value='first'>First value only</option>            <option value='last'>Last value only</option>            <option value='ignore'>Ignore this column</option>            </select></div>");
            if (_.findWhere(this.parentGroup.get("buildData").blocks, {
              "id": this.unescapeForHot(this.sortedKeys[col - 1])
            }) != null) {
              aggregator.find("select").val(_.findWhere(this.parentGroup.get("buildData").blocks, {
                "id": this.unescapeForHot(this.sortedKeys[col - 1])
              }).value);
            }
            $(TH).append(aggregator);
            aggregator.find("select").selectmenu({
              width: 125,
              change: this.rebuildData
            });
          }
        }
        if (col === 0) {
          array = this.model.get("data")[0].value.data.map(function(qv) {
            return qv.id;
          });
        } else {
          array = _.find(this.model.get("data"), {
            id: this.unescapeForHot(this.sortedKeys[col - 1])
          }).value.data.map(function(qv) {
            return qv.value;
          });
        }
        if (this.findInvalidDatesInCol(array)) {
          showDateWarning = true;
        }
        if (showDateWarning) {
          $(TH).append("<div class='table-preview-date-warning'>*date format should be DD/MM/YYYY</div>");
        }
      } else {
        $(TH).addClass("small-header");
      }
      return TH;
    };

    TableView.prototype.findInvalidDatesInCol = function(list) {
      var result, value, _i, _len;
      result = false;
      for (_i = 0, _len = list.length; _i < _len; _i++) {
        value = list[_i];
        result = result || BlockUtils.checkIsDate(value, quadrigram.router.dataModels.currentProject.timeFormat) === "invalid";
      }
      return result;
    };

    TableView.prototype.addBlockIfNeeded = function(TD, row, col, prop, value, cellProperties) {
      var block, fakeModel;
      if ((value != null) && (value.get != null) && $(TD).children().length <= 0) {
        if (value.get("data").length > 0) {
          fakeModel = new Backbone.Model({
            label: value.get("label")
          });
          block = new quadrigram.Views.DataBlockStatic({
            model: value.getBackboneModel()
          });
          block.render();
          $(TD).html("");
          return $(TD).append(block.$el);
        } else {
          return $(TD).html(value.get("data")[0].value);
        }
      }
    };

    TableView.prototype.handleSheetChange = function(sheetName) {
      this.$el.find(".hot-container").append(this.processingTemplate());
      return this.parentGroup.set("currentSheet", sheetName);
      /*
      @parentGroup.buildFromRawData(()=>
        setTimeout( ()=>
          @renderDataTypeOptions()
          @renderContent()
          ##Only used for viewModeHandleChange (<- searchit)
          @model.get("blockGroup").trigger("change-block-structure")
        ,2000)
      )
      */

    };

    /*
    handleDataTypeChange:(e)=>
      selectEl = @$el.find(".data-type-selector select")[0]
      #@currentDataType = selectEl.options[selectEl.selectedIndex].value
      @parentGroup.get("buildData").dataType = selectEl.options[selectEl.selectedIndex].value
      #if @currentDataType == "network"
      #  @model.get("parentGroup").get("buildData").networkFormat =  
    
      @renderDataTypeOptions()
    */


    TableView.prototype.handleTypeChange = function(e) {
      var mode;
      this.$el.find(".hot-container").append(this.processingTemplate());
      mode = $(e.currentTarget).attr("value");
      this.setMode(mode);
      if (mode === "row" || mode === "col") {
        this.model.get("metaData").viewMode = "list";
        this.model.get("metaData").viewDirection = mode;
      } else {
        this.model.get("metaData").viewMode = "table";
        this.model.get("metaData").viewDirection = "row";
      }
      this.renderContent();
      return this.model.get("blockGroup").trigger("change-block-structure");
    };

    TableView.prototype.setMode = function(mode) {
      this.$el.closest(".ui-dialog").find(".selected-instance").removeClass("col-icon");
      this.$el.closest(".ui-dialog").find(".selected-instance").removeClass("row-icon");
      this.$el.closest(".ui-dialog").find(".selected-instance").removeClass("table-icon");
      return this.$el.closest(".ui-dialog").find(".selected-instance").addClass(mode + "-icon");
    };

    TableView.prototype.flatDataFromModel = function() {
      var currentViewMode, depth, flatData;
      this.depth = BlockUtils.getBlockDepth(this.model);
      depth = this.depth;
      if ((this.model.get("metaData") != null) && (this.model.get("metaData").viewMode != null)) {
        currentViewMode = this.model.get("metaData").viewMode;
      } else {
        if (depth === 1) {
          currentViewMode = "list";
        } else if (depth === 2) {
          currentViewMode = "table";
        } else if (depth === 3) {
          currentViewMode = "table";
        } else {
          currentViewMode = "table";
        }
      }
      switch (currentViewMode) {
        case "list":
          if ((this.model.get("metaData") == null) || (this.model.get("metaData").viewDirection == null) || this.model.get("metaData").viewDirection === "col") {
            return flatData = this.listFromModel(this.model);
          } else {
            return flatData = this.rowFromModel(this.model);
          }
          break;
        case "table":
          if ((this.model.get("metaData") == null) || (this.model.get("metaData").viewDirection == null) || this.model.get("metaData").viewDirection === "row") {
            return flatData = this.tableFromModel(this.model);
          } else {
            return flatData = this.listFromModel(this.model);
          }
      }
    };

    TableView.prototype.listFromModel = function(model) {
      var b, headerData, i, j, qv, tableData, _i, _j, _len, _len1, _ref1, _ref2;
      tableData = [];
      headerData = [];
      this.sortedKeys = [];
      _ref1 = model.get("data");
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        b = _ref1[i];
        this.sortedKeys.push(this.escapeForHot(b.id));
      }
      if (model.get("metaData")) {
        headerData.push(this.escapeForHot(model.get("metaData").idLabel));
        headerData.push(this.escapeForHot(model.get("metaData").valueLabel));
      } else {
        headerData.push("-");
        headerData.push("value");
      }
      _ref2 = model.get("data");
      for (j = _j = 0, _len1 = _ref2.length; _j < _len1; j = ++_j) {
        qv = _ref2[j];
        if (tableData[j] == null) {
          tableData[j] = {};
          tableData[j][headerData[0]] = qv.id;
        }
        tableData[j][headerData[1]] = qv.value;
      }
      return {
        "contentData": tableData,
        "headerData": headerData
      };
    };

    TableView.prototype.rowFromModel = function(model) {
      var b, headerData, i, j, qv, tableData, _i, _j, _len, _len1, _ref1, _ref2;
      tableData = [];
      headerData = [];
      this.sortedKeys = [];
      _ref1 = model.get("data");
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        b = _ref1[i];
        this.sortedKeys.push(this.escapeForHot(b.id));
      }
      /*
      if model.get("metaData")
        headerData.push(@escapeForHot(model.get("metaData").idLabel))
        headerData.push(@escapeForHot(model.get("metaData").valueLabel))
      else
        headerData.push("-")
        headerData.push("value")
      */

      headerData.push("Row");
      _ref2 = model.get("data");
      for (j = _j = 0, _len1 = _ref2.length; _j < _len1; j = ++_j) {
        qv = _ref2[j];
        headerData.push(this.escapeForHot(qv.id));
        if (tableData[0] == null) {
          tableData[0] = {};
          tableData[0][headerData[0]] = model.get("metaData").valueLabel;
        }
        tableData[0][headerData[headerData.length - 1]] = qv.value;
      }
      return {
        "contentData": tableData,
        "headerData": headerData
      };
    };

    TableView.prototype.tableFromModel = function(model) {
      var b, col, depth, headerData, i, idsDict, idx, j, qv, tableData, _i, _j, _k, _len, _len1, _len2, _ref1, _ref2, _ref3;
      if (model.get("data").length === 0) {
        return;
      }
      tableData = [];
      headerData = [];
      depth = this.depth;
      this.sortedKeys = [];
      _ref1 = model.get("data");
      for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
        b = _ref1[i];
        this.sortedKeys.push(this.escapeForHot(b.id));
      }
      headerData = this.sortedKeys.slice();
      if (model.get("data")[0].value.get && model.get("data")[0].value.get("metaData")) {
        headerData.unshift(this.escapeForHot(model.get("data")[0].value.get("metaData").idLabel));
      } else {
        headerData.unshift("-");
      }
      /*
      if depth == 3
        allids = BlockUtils.getIdsAtLevel(model,1)
      else if depth == 2
        allids = BlockUtils.getIdsAtLevel(model,0)
      else
        allids = new quadrigram.Models.DataBlockData
        allids.set("data",[{"id":model.get("metaData").valueLabel,"value":"nada"}])
      */

      idsDict = {};
      _ref2 = model.get("data");
      for (i = _j = 0, _len1 = _ref2.length; _j < _len1; i = ++_j) {
        col = _ref2[i];
        if (col.value.data != null) {
          _ref3 = col.value.data;
          for (j = _k = 0, _len2 = _ref3.length; _k < _len2; j = ++_k) {
            qv = _ref3[j];
            if (idsDict[qv.id] == null) {
              tableData.push({});
              idx = tableData.length - 1;
              tableData[idx][this.escapeForHot(model.get("data")[0].value.get("metaData").idLabel)] = qv.id;
              idsDict[qv.id] = idx;
            } else {
              idx = idsDict[qv.id];
            }
            /*
            if !tableData[j]?
              tableData[j] = {}
              tableData[j][@escapeForHot(model.get("data")[0].value.get("metaData").idLabel)]=qv.id
            */

            tableData[idx][this.escapeForHot(col.id)] = qv.value;
          }
        } else {
          qv = col;
          if (tableData[0] == null) {
            tableData[0] = {};
            tableData[0]["-"] = model.get("metaData").valueLabel;
          }
          tableData[0][col.id] = col.value;
        }
      }
      return {
        "contentData": tableData,
        "headerData": headerData
      };
    };

    TableView.prototype.escapeForHot = function(value) {
      return String(value).replace(/\./g, "%2E");
    };

    TableView.prototype.unescapeForHot = function(value) {
      return String(value).replace(/%2E/g, ".");
    };

    TableView.prototype.rebuildData = function(options) {
      var _this = this;
      this.$el.find(".hot-container").append(this.processingTemplate());
      this.lastScrolls = {
        top: this.$el.find("#hot-style-container").scrollTop(),
        left: this.$el.find("#hot-style-container").scrollLeft()
      };
      quadrigram.tracker.sendEvent({
        event_type: 202,
        event_subtype: 1
      });
      return setTimeout(function() {
        return _this.parentGroup.updateBuildData(_this.getBuildData());
      }, 40);
    };

    TableView.prototype.getBuildData = function() {
      var aggEl, bkey, buildData, i, _i, _len, _ref1;
      buildData = {};
      buildData.dataType = this.dataTypeOptionsView.currentDataType;
      if (buildData.dataType === "dataTable") {
        buildData.idKey = this.dataTypeOptionsView.currentOptions.getIdKey();
        buildData.blocks = [];
        _ref1 = this.sortedKeys;
        for (i = _i = 0, _len = _ref1.length; _i < _len; i = ++_i) {
          bkey = _ref1[i];
          aggEl = this.$el.find('.ht_clone_top .aggregator[data-col="' + i + '"]')[0];
          if (aggEl != null) {
            buildData.blocks.push({
              id: this.unescapeForHot(bkey),
              value: aggEl.options[aggEl.selectedIndex].value
            });
          }
        }
      } else if (buildData.dataType === "network") {
        buildData.networkFormat = Object.keys(this.parentGroup.dataTypeOptions.network)[0];
      }
      return buildData;
    };

    return TableView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.LoaderView = (function(_super) {
    __extends(LoaderView, _super);

    function LoaderView() {
      this.hide = __bind(this.hide, this);
      this.getLoaderMessage = __bind(this.getLoaderMessage, this);
      this.showMessage = __bind(this.showMessage, this);
      this.showCurrentMessage = __bind(this.showCurrentMessage, this);
      this.handleLoader = __bind(this.handleLoader, this);
      this.resetStack = __bind(this.resetStack, this);
      this.unregisterProcess = __bind(this.unregisterProcess, this);
      this.registerProcess = __bind(this.registerProcess, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      this.init = __bind(this.init, this);
      _ref = LoaderView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LoaderView.prototype.template = JST['app/scripts/templates/UI/loader/loader.hbs'];

    LoaderView.prototype.MESSAGE1 = "Detected error from Google Drive: cannot get selected resource";

    LoaderView.prototype.MESSAGE2 = "Sorry, you cannot use this application because your administrator has disabled 3rd party Google Drive apps. Please ask your administrator to allow Google Drive apps by opening the Google Apps control panel and navigating to Settings -> Drive and Docs then verifying that Allow user sto install Google Drive apps is enabled.";

    LoaderView.prototype.MESSAGE3 = "Loading project...";

    LoaderView.prototype.MESSAGE4 = "Sorry, the project could not be loaded.";

    LoaderView.prototype.MESSAGE5 = "";

    LoaderView.prototype.MESSAGE6 = "";

    LoaderView.prototype.MESSAGE7 = "";

    LoaderView.prototype.init = function(object) {
      this.on("loaderMessage", this.handleLoader);
      return this.resetStack();
    };

    LoaderView.prototype.viewWillRender = function() {};

    LoaderView.prototype.viewDidRender = function() {
      $("#pre-loader-container").remove();
      return this.$el.find(".loader-message").html("Loading Quadrigram...");
    };

    LoaderView.prototype.viewWillRemove = function() {
      return this.off();
    };

    LoaderView.prototype.registerProcess = function(data) {
      return this.priorityStack[data.priority || 0].unshift(data);
    };

    LoaderView.prototype.unregisterProcess = function(data) {
      var d, idx, prio;
      prio = data.priority || 0;
      if (data.id != null) {
        d = _.find(this.priorityStack[prio], function(el) {
          return el.id === data.id;
        });
        idx = this.priorityStack[prio].indexOf(d);
        return this.priorityStack[prio].splice(idx, 1);
      } else {
        d = _.find(this.priorityStack[prio], function(el) {
          return el["class"] === data["class"];
        });
        idx = this.priorityStack[prio].indexOf(d);
        return this.priorityStack[prio].splice(idx, 1);
      }
    };

    LoaderView.prototype.resetStack = function() {
      this.priorityStack = [];
      this.priorityStack[0] = [];
      this.priorityStack[1] = [];
      return this.priorityStack[2] = [];
    };

    LoaderView.prototype.handleLoader = function(data) {
      if (data.mode == null) {
        data.mode = 0;
      }
      if (data.mode === 0) {
        this.registerProcess(data);
      } else if (data.mode === 1) {
        this.unregisterProcess(data);
      } else if (data.mode === 2) {
        this.resetStack();
      }
      return this.showCurrentMessage();
    };

    LoaderView.prototype.showCurrentMessage = function() {
      if (this.priorityStack[2].length > 0) {
        return this.showMessage(this.priorityStack[2][0]);
      } else if (this.priorityStack[1].length > 0) {
        return this.showMessage(this.priorityStack[1][0]);
      } else if (this.priorityStack[0].length > 0) {
        return this.showMessage(this.priorityStack[0][0]);
      } else {
        return this.hide();
      }
    };

    LoaderView.prototype.showMessage = function(data) {
      var loaderClass, message,
        _this = this;
      if ((data.message == null) || data.message <= 0 || window.quadrigram.environment === "exported") {
        message = "Quadrigram";
      } else {
        message = this.getLoaderMessage(data.message);
      }
      if ((data.timeout != null) && data.timeout > 0) {
        setTimeout(function() {
          _this.unregisterProcess({
            id: data.id,
            priority: data.priority
          });
          return _this.showCurrentMessage();
        }, data.timeout);
      }
      if (data.type == null) {
        data.type = 0;
      }
      switch (data.type) {
        case 0:
          loaderClass = "";
          break;
        case 1:
          loaderClass = "loader-error-message";
          break;
        case 2:
          loaderClass = "loader-fatal-error-message";
          break;
        default:
          loaderClass = "";
      }
      if (data.priority == null) {
        data.priority = 0;
      }
      this.$el.find(".loader-message").remove();
      this.$el.html(this.template());
      this.$el.find(".loader-message").html(message);
      this.$el.find(".loader-message").removeClass("loader-error-message");
      this.$el.find(".loader-message").removeClass("loader-fatal-error-message");
      this.$el.find(".loader-message").addClass(loaderClass);
      return this.$el.show();
    };

    LoaderView.prototype.getLoaderMessage = function(message) {
      if (isNaN(message)) {
        return message;
      }
      switch (message) {
        case 1:
          return this.MESSAGE1;
        case 2:
          return this.MESSAGE2;
        case 3:
          return this.MESSAGE3;
        case 4:
          return this.MESSAGE4;
        case 5:
          return this.MESSAGE5;
        case 6:
          return this.MESSAGE6;
        case 7:
          return this.MESSAGE7;
        default:
          return "Quadrigram";
      }
    };

    LoaderView.prototype.hide = function() {
      return this.$el.hide();
      /*
      viewport = document.querySelector("meta[name=viewport]");
      viewport.setAttribute('content', 'initial-scale='+0.35);
      */

    };

    return LoaderView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PreFunctionBlockModel = (function(_super) {
    __extends(PreFunctionBlockModel, _super);

    function PreFunctionBlockModel() {
      this.activate = __bind(this.activate, this);
      this.initialize = __bind(this.initialize, this);
      _ref = PreFunctionBlockModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PreFunctionBlockModel.prototype.data = [];

    PreFunctionBlockModel.prototype.metaData = [];

    PreFunctionBlockModel.prototype.functionData = {};

    PreFunctionBlockModel.prototype.initialize = function() {
      return this.set("fetchState", "ready", {
        silent: true
      });
    };

    PreFunctionBlockModel.prototype.activate = function() {
      var newBlock;
      this.get("blockGroup").preBlocks.splice(this.get("blockGroup").preBlocks.indexOf(this), 1);
      newBlock = new quadrigram.Models.FunctionBlockModel();
      newBlock.set({
        "blockGroup": this.get("blockGroup"),
        "jsonKey": this.get("jsonKey"),
        "label": this.get("label"),
        "role": this.get("role"),
        "order": this.get("order"),
        "origin": this.get("origin"),
        "fetchState": "processing"
      }, {
        silent: true
      });
      newBlock.setOperation(this.get("operation"), false);
      newBlock.get("operator").setExpressionValues(this.get("options"));
      this.trigger("replace-model", newBlock);
      this.off();
      return newBlock;
    };

    return PreFunctionBlockModel;

  })(Backbone.Model);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockStatic = (function(_super) {
    __extends(DataBlockStatic, _super);

    function DataBlockStatic() {
      this.loopAnimation = __bind(this.loopAnimation, this);
      _ref = DataBlockStatic.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockStatic.prototype.template = JST['app/scripts/templates/blocks/dataBlock.hbs'];

    DataBlockStatic.prototype.className = 'data-block data-block-static';

    DataBlockStatic.prototype.loopAnimation = function() {};

    return DataBlockStatic;

  })(quadrigram.Views.DataBlockView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.LayoutSettings = (function(_super) {
    __extends(LayoutSettings, _super);

    function LayoutSettings() {
      this.collapseProperty = __bind(this.collapseProperty, this);
      this.updateLayoutProperties = __bind(this.updateLayoutProperties, this);
      this.updateBkgProperties = __bind(this.updateBkgProperties, this);
      this.updateProperties = __bind(this.updateProperties, this);
      this.showFormatProperties = __bind(this.showFormatProperties, this);
      this.showAsTab = __bind(this.showAsTab, this);
      this.changePreset = __bind(this.changePreset, this);
      this.handleChange = __bind(this.handleChange, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = LayoutSettings.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LayoutSettings.prototype.template = JST['app/scripts/templates/UI/dialogs/layoutSettingsTab.hbs'];

    LayoutSettings.prototype.events = {
      "click .collapsable-toggle": "collapseProperty"
    };

    LayoutSettings.prototype.viewWillRender = function() {
      return this.templateData.presets = LayoutUtils.presets;
    };

    LayoutSettings.prototype.viewDidRender = function() {
      var self;
      self = this;
      this.$el.find("[qm-input-type]").each(function(i) {
        var camelCased;
        camelCased = $(this).attr("qm-input-type").replace(/-([a-z])/g, function(g) {
          return g[1].toUpperCase();
        });
        $(this)[camelCased]();
        return $(this).on("change", self.handleChange);
      });
      this.$el.find(".preset-selector").on("change", this.changePreset);
      this.tempSettings = $.extend({}, quadrigram.router.dataModels.currentProject.get("layout-settings"));
      return this.showFormatProperties(this.tempSettings.layoutFormat);
    };

    LayoutSettings.prototype.handleChange = function(e) {
      var $target;
      $target = $(e.target);
      delete this.tempSettings[$target.attr("data-id")];
      this.tempSettings[$target.attr("data-id")] = $target.val();
      this.tempSettings = LayoutUtils.validateLayoutSettings(this.tempSettings);
      _.defer(this.updateProperties);
      return quadrigram.achievementTracker.trackDirectAction("changeLayoutSettings");
    };

    LayoutSettings.prototype.changePreset = function(e) {
      var newPreset;
      newPreset = $(e.currentTarget.selectedOptions[0]).attr("data-id");
      this.tempSettings.layoutPreset = newPreset;
      this.tempSettings = LayoutUtils.validateLayoutSettings(this.tempSettings, true);
      return this.showFormatProperties(this.tempSettings);
    };

    LayoutSettings.prototype.showAsTab = function() {};

    LayoutSettings.prototype.showFormatProperties = function() {
      /*
      if @$el.find(".preset-selector option[data-id='"+@tempSettings.layoutPreset+"']")
        @$el.find(".preset-selector option[data-id='"+@tempSettings.layoutPreset+"']").prop("selected",true)
      else
        @$el.find(".preset-selector").prepend("<option data-id='custom'>Custom (responsive)</option>")
        @$el.find(".preset-selector option[data-id='custom']").prop("selected",true)
      */

      this.$el.find(".layout-properties").addClass("hidden");
      this.$el.find(".layout-properties[data-id='" + this.tempSettings.layoutFormat + "']").removeClass("hidden");
      return this.updateProperties();
    };

    LayoutSettings.prototype.updateProperties = function() {
      var customMode;
      if (this.tempSettings.layoutPreset !== "custom") {
        this.$el.find(".preset-selector option[data-id='" + this.tempSettings.layoutPreset + "']").prop("selected", true);
      } else {
        switch (this.tempSettings.layoutFormat) {
          case "web-layout":
            customMode = "responsive";
            break;
          case "full-screen-layout":
            customMode = "fullscreen";
            break;
          case "embed-layout":
            customMode = "fixed";
        }
        this.$el.find(".preset-selector option[data-id='custom']").remove();
        this.$el.find(".preset-selector").prepend("<option data-id='custom'>Custom (" + customMode + ")</option>");
        this.$el.find(".preset-selector option[data-id='custom']").prop("selected", true);
      }
      if (this.tempSettings.heightMode === "Fixed") {
        this.$el.find(".height-prop").removeClass("disabled");
      } else {
        this.$el.find(".height-prop").addClass("disabled");
      }
      this.updateBkgProperties();
      return this.updateLayoutProperties();
    };

    LayoutSettings.prototype.updateBkgProperties = function() {
      this.$el.find("input[data-id='backgroundColor']").val(this.tempSettings["backgroundColor"], {
        "trigger": false
      });
      return this.$el.find("input[data-id='foregroundColor']").val(this.tempSettings["foregroundColor"], {
        "trigger": false
      });
    };

    LayoutSettings.prototype.updateLayoutProperties = function() {
      var $currentEl, propName, _results;
      $currentEl = this.$el.find(".layout-properties[data-id='" + this.tempSettings.layoutFormat + "']");
      _results = [];
      for (propName in this.tempSettings) {
        if ($currentEl.find("input[data-id='" + propName + "']").length) {
          _results.push($currentEl.find("input[data-id='" + propName + "']").val(this.tempSettings[propName], {
            "trigger": false
          }));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    LayoutSettings.prototype.collapseProperty = function(event) {
      $(event.currentTarget).parent().find('.propertyBody').slideToggle(300);
      $(event.currentTarget).toggleClass('selected');
      return $(event.currentTarget).parent().toggleClass('collapsed');
    };

    return LayoutSettings;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PagesSettings = (function(_super) {
    __extends(PagesSettings, _super);

    function PagesSettings() {
      this.collapseProperty = __bind(this.collapseProperty, this);
      this.deleteHeader = __bind(this.deleteHeader, this);
      this.createHeader = __bind(this.createHeader, this);
      this.toggleHeader = __bind(this.toggleHeader, this);
      this.showAsTab = __bind(this.showAsTab, this);
      this.viewDidRemove = __bind(this.viewDidRemove, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.handleChange = __bind(this.handleChange, this);
      this.updateHeaderProperties = __bind(this.updateHeaderProperties, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = PagesSettings.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PagesSettings.prototype.template = JST['app/scripts/templates/UI/dialogs/pagesSettingsTab.hbs'];

    PagesSettings.prototype.thumbTemplate = JST['app/scripts/templates/pageThumbTemplate.hbs'];

    PagesSettings.prototype.events = {
      "click .collapsable-toggle": "collapseProperty"
    };

    PagesSettings.prototype.viewWillRender = function() {
      var currentSettings;
      currentSettings = quadrigram.router.dataModels.currentProject.get("pages-settings");
      this.pagesCollection = quadrigram.router.dataModels.currentProject.get("pagesCollection");
      this.tempSettings = JSON.parse(JSON.stringify(currentSettings));
      return this.layoutSettings = quadrigram.router.dataModels.currentProject.get("layout-settings");
    };

    PagesSettings.prototype.viewDidRender = function() {
      var self;
      self = this;
      this.$el.find("[qm-input-type]").each(function(i) {
        var camelCased;
        camelCased = $(this).attr("qm-input-type").replace(/-([a-z])/g, function(g) {
          return g[1].toUpperCase();
        });
        $(this)[camelCased]();
        return $(this).on("change", self.handleChange);
      });
      this.$el.find(".header-checkbox").on("change", this.toggleHeader);
      this.$el.find(".transition-selector").on("change", this.handleChange);
      this.$el.find(".buttons-checkbox").on("change", this.handleChange);
      this.$el.find("input[data-id='showPageButtons']").val(String(this.tempSettings["showPageButtons"]));
      this.$el.find("input[data-id='transitionType']").val(this.tempSettings["transitionType"]);
      return this.updateHeaderProperties();
    };

    PagesSettings.prototype.updateHeaderProperties = function() {
      var headerNotEmpty, headerPageModel, v, _i, _len, _ref1;
      headerPageModel = this.pagesCollection.findWhere({
        id: "_headerPage"
      });
      this.$el.find(".header-checkbox").val(String(headerPageModel != null));
      if (headerPageModel != null) {
        _ref1 = quadrigram.router.dataModels.currentProject.get("visualizersCollection").models;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          v = _ref1[_i];
          if (v.getProperty("page").getValues() === "_headerPage") {
            headerNotEmpty = true;
          }
        }
        if (headerNotEmpty) {
          this.$el.find(".header-checkbox").prop("disabled", true);
        }
        this.$el.find("input[data-id='foregroundColor']").val(headerPageModel.get("foregroundColor"), {
          "trigger": false
        });
        return this.$el.find(".header-properties").removeClass("disabled");
      } else {
        return this.$el.find(".header-properties").addClass("disabled");
      }
    };

    PagesSettings.prototype.handleChange = function(e) {
      var $target;
      $target = $(e.currentTarget);
      if ($target.attr("data-id") === "foregroundColor") {
        this.pagesCollection.findWhere({
          id: "_headerPage"
        }).set("foregroundColor", $target.val());
        this.tempSettings.foregroundColor = $target.val();
      } else if ($target.attr("data-id") === "showPageButtons") {
        this.tempSettings[$target.attr("data-id")] = $target.val() === "true";
      } else if ($target.attr("data-id") === "transitionType") {
        this.tempSettings[$target.attr("data-id")] = $target.val();
      }
      if ($target.attr("data-id") === "useHeader") {
        quadrigram.achievementTracker.trackDirectAction("useHeader");
      }
      return quadrigram.router.dataModels.currentProject.set("pages-settings", JSON.parse(JSON.stringify(this.tempSettings)));
    };

    PagesSettings.prototype.viewWillRemove = function() {};

    PagesSettings.prototype.viewDidRemove = function() {
      return $(".project-content").hide().show(0);
    };

    PagesSettings.prototype.showAsTab = function() {};

    PagesSettings.prototype.toggleHeader = function(e) {
      if ($(e.target).val() === "true") {
        this.createHeader();
      } else {
        this.deleteHeader();
      }
      return this.updateHeaderProperties();
    };

    PagesSettings.prototype.createHeader = function() {
      var newPage;
      newPage = quadrigram.Models.Page.find("_headerPage");
      if (newPage == null) {
        newPage = new quadrigram.Models.Page({
          id: "_headerPage",
          foregroundColor: "#616161"
        });
      }
      return this.pagesCollection.add(newPage);
    };

    PagesSettings.prototype.deleteHeader = function() {
      return this.pagesCollection.remove("_headerPage");
    };

    PagesSettings.prototype.collapseProperty = function(event) {
      $(event.currentTarget).parent().find('.propertyBody').slideToggle(300);
      $(event.currentTarget).toggleClass('selected');
      return $(event.currentTarget).parent().toggleClass('collapsed');
    };

    return PagesSettings;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.StyleSettings = (function(_super) {
    __extends(StyleSettings, _super);

    function StyleSettings() {
      this.showAsTab = __bind(this.showAsTab, this);
      _ref = StyleSettings.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    StyleSettings.prototype.template = JST['app/scripts/templates/UI/dialogs/settingsTabs/styleSettings.hbs'];

    StyleSettings.prototype.showAsTab = function() {};

    return StyleSettings;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.TooltipSettings = (function(_super) {
    __extends(TooltipSettings, _super);

    function TooltipSettings() {
      this.getFontFamily = __bind(this.getFontFamily, this);
      this.injectStyles = __bind(this.injectStyles, this);
      this.bodyFunction = __bind(this.bodyFunction, this);
      this.titleFunction = __bind(this.titleFunction, this);
      this.showAsTab = __bind(this.showAsTab, this);
      this.getFakeTooltipObject = __bind(this.getFakeTooltipObject, this);
      this.updateTooltipBehavior = __bind(this.updateTooltipBehavior, this);
      this.initTooltipBehavior = __bind(this.initTooltipBehavior, this);
      this.updateProperties = __bind(this.updateProperties, this);
      this.updateQMInputs = __bind(this.updateQMInputs, this);
      this.updateQMInputsWithOptions = __bind(this.updateQMInputsWithOptions, this);
      this.updateFonts = __bind(this.updateFonts, this);
      this.updateFontFamilySelector = __bind(this.updateFontFamilySelector, this);
      this.changeFontFamily = __bind(this.changeFontFamily, this);
      this.changePreset = __bind(this.changePreset, this);
      this.changeQMInput = __bind(this.changeQMInput, this);
      this.updateBaseStyle = __bind(this.updateBaseStyle, this);
      this.changeBaseStyle = __bind(this.changeBaseStyle, this);
      this.collapseProperty = __bind(this.collapseProperty, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = TooltipSettings.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TooltipSettings.prototype.template = JST['app/scripts/templates/UI/dialogs/settingsTabs/tooltipSettings.hbs'];

    TooltipSettings.prototype.templateBody = JST['app/scripts/templates/visualizers/tooltipBody.hbs'];

    TooltipSettings.prototype.templateTitle = JST['app/scripts/templates/visualizers/tooltipTitle.hbs'];

    TooltipSettings.prototype.events = {
      "click .collapsable-toggle": "collapseProperty"
    };

    TooltipSettings.prototype.viewWillRender = function() {
      this.templateData.tooltipSettings = quadrigram.router.dataModels.currentProject.get("tooltip-settings");
      this.templateData.styles = quadrigram.Managers.ToolTipManager.listStyles();
      return this.templateData.fonts = quadrigram.router.managers.fontManager.fontsList();
    };

    TooltipSettings.prototype.viewDidRender = function() {
      if (!this.tooltipBehavior) {
        this.initTooltipBehavior();
      }
      this.$(".base-style-selector").on("change", this.changeBaseStyle);
      this.tempSettings = JSON.parse(JSON.stringify(quadrigram.router.dataModels.currentProject.get("tooltip-settings")));
      this.updateQMInputs();
      this.updateQMInputsWithOptions();
      this.updateProperties();
      this.updateTooltipBehavior();
      return this.updateBaseStyle();
    };

    TooltipSettings.prototype.collapseProperty = function(event) {
      $(event.currentTarget).parent().find('.propertyBody').slideToggle(300);
      $(event.currentTarget).toggleClass('selected');
      return $(event.currentTarget).parent().toggleClass('collapsed');
    };

    TooltipSettings.prototype.changeBaseStyle = function(e) {
      var newBaseStyle;
      newBaseStyle = $(e.currentTarget.selectedOptions[0]).attr("data-id");
      this.tempSettings = JSON.parse(JSON.stringify(quadrigram.router.appViews.projectView.toolTipManager.getStyle(newBaseStyle)));
      this.updateBaseStyle();
      this.updateProperties();
      this.updateTooltipBehavior();
      this.tip.qtip('show');
      return quadrigram.achievementTracker.trackDirectAction("tooltipStyle");
    };

    TooltipSettings.prototype.updateBaseStyle = function(e) {
      var presetName;
      this.$el.find(".preset-selector option[data-id='custom']").remove();
      presetName = this.tempSettings.name;
      if (presetName.indexOf("Custom") >= 0) {
        this.$el.find(".preset-selector").prepend("<option data-id='custom'>" + presetName + "</option>");
        return this.$el.find(".preset-selector option[data-id='custom']").prop("selected", true);
      } else {
        return this.$el.find(".preset-selector option[data-id='" + presetName + "']").prop("selected", true);
      }
    };

    TooltipSettings.prototype.changeQMInput = function(e) {
      var $target, preset, value;
      $target = $(e.target);
      value = $target.val();
      preset = $(e.target).attr("data-id");
      this.changePreset(preset, value);
      return this.updateFonts();
    };

    TooltipSettings.prototype.changePreset = function(preset, value) {
      var customName, text,
        _this = this;
      text = this.tempSettings.name;
      if (text.indexOf("Custom") === -1) {
        customName = "Custom (" + text + ")";
        this.$el.find(".preset-selector option[data-id='custom']").remove();
        this.$el.find(".preset-selector").prepend("<option data-id='custom'>" + customName + "</option>");
        this.$el.find(".preset-selector option[data-id='custom']").prop("selected", true);
        this.tempSettings.name = customName;
      }
      if (!this.tempSettings.body.label) {
        this.tempSettings.body.label = {};
      }
      if (!this.tempSettings.border) {
        this.tempSettings.border = {};
      }
      switch (preset) {
        case "borderColor":
          this.tempSettings.border.color = value;
          break;
        case "borderWidth":
          this.tempSettings.border.width = value;
          break;
        case "separatorColor":
          this.tempSettings.separatorColor = value;
          break;
        case "backgroundColorTitle":
          this.tempSettings.title.backgroundColor = value;
          break;
        case "textColorTitle":
          this.tempSettings.title.textColor = value;
          break;
        case "fontSizeTitle":
          this.tempSettings.title.fontSize = value;
          break;
        case "fontStyleTitle":
          this.tempSettings.title.fontStyle = value;
          break;
        case "backgroundColorValue":
          this.tempSettings.body.value.backgroundColor = value;
          break;
        case "textColorValue":
          this.tempSettings.body.value.textColor = value;
          break;
        case "fontSizeValue":
          this.tempSettings.body.value.fontSize = value;
          break;
        case "fontStyleValue":
          this.tempSettings.body.value.fontStyle = value;
          break;
        case "textColorLabel":
          this.tempSettings.body.label.textColor = value;
          break;
        case "fontSizeLabel":
          this.tempSettings.body.label.fontSize = value;
          break;
        case "fontStyleLabel":
          this.tempSettings.body.label.fontStyle = value;
          break;
        case "textColorDescription":
          this.tempSettings.body.description.textColor = value;
          break;
        case "fontSizeDescription":
          this.tempSettings.body.description.fontSize = value;
          break;
        case "lineHeightDescription":
          this.tempSettings.body.description.lineHeight = value;
          break;
        case "backgroundColorDescription":
          this.tempSettings.body.description.backgroundColor = value;
          break;
        case "fontStyleDescription":
          this.tempSettings.body.description.fontStyle = value;
          break;
        default:
          this.tempSettings[preset] = value;
      }
      return _.defer(function() {
        _this.updateTooltipBehavior();
        _this.updateProperties();
        return _this.tip.qtip('show');
      });
    };

    TooltipSettings.prototype.changeFontFamily = function(e) {
      var selectedOption, tooltipSettings;
      selectedOption = this.$el.find(".ql-font").val();
      tooltipSettings = this.tempSettings;
      this.$el.find(".ql-font .qm-input-element").css("font-family", selectedOption);
      this.changePreset("fontFamily", selectedOption);
      this.updateFontFamilySelector(".font-style-title-selector", selectedOption, tooltipSettings.title);
      this.updateFontFamilySelector(".font-style-value-selector", selectedOption, tooltipSettings.body);
      this.updateFontFamilySelector(".font-style-label-selector", selectedOption, tooltipSettings.body.label);
      return this.updateFontFamilySelector(".font-style-description-selector", selectedOption, tooltipSettings.body.description);
    };

    TooltipSettings.prototype.updateFontFamilySelector = function(className, fontFamily, value) {
      var contextual, fontFamilyStyles,
        _this = this;
      fontFamilyStyles = quadrigram.router.managers.fontManager.getFontStyles(fontFamily);
      value.fontStyle = fontFamilyStyles[0].styleName;
      this.$(className).inputWithOptions("instance").updateOptions(fontFamilyStyles, fontFamilyStyles[0].styleName);
      this.$el.find(className).closest(".property-group").find(".qm-input-element").css("font-family", fontFamily);
      contextual = this.$el.find(className).inputWithOptions("instance").contextual;
      return contextual.find("li").each(function(i, el) {
        var fontFamilyStyle;
        fontFamilyStyle = _this.getFontFamily(fontFamily, $(el).html());
        $(el).css("font-style", fontFamilyStyle.fontStyle);
        return $(el).css("font-weight", fontFamilyStyle.fontWeight);
      });
    };

    TooltipSettings.prototype.updateFonts = function() {};

    TooltipSettings.prototype.updateQMInputsWithOptions = function() {
      var contextual, fontFamilyStyles, selectedOption, tooltipSettings,
        _this = this;
      contextual = this.$el.find(".ql-font").inputWithOptions("instance").contextual;
      tooltipSettings = this.tempSettings;
      contextual.find("li").each(function(i, el) {
        return $(el).css("font-family", $(el).html());
      });
      this.$el.find(".ql-font").on("change", this.changeFontFamily);
      selectedOption = this.tempSettings.fontFamily;
      fontFamilyStyles = quadrigram.router.managers.fontManager.getFontStyles(selectedOption);
      this.$(".font-style-title-selector").inputWithOptions("instance").updateOptions(fontFamilyStyles, tooltipSettings.title.fontStyle);
      this.$(".font-style-value-selector").inputWithOptions("instance").updateOptions(fontFamilyStyles, tooltipSettings.body.value.fontStyle);
      this.$(".font-style-label-selector").inputWithOptions("instance").updateOptions(fontFamilyStyles, tooltipSettings.body.label.fontStyle);
      return this.$(".font-style-description-selector").inputWithOptions("instance").updateOptions(fontFamilyStyles, tooltipSettings.body.description.fontStyle);
    };

    TooltipSettings.prototype.updateQMInputs = function() {
      var self, targetFunction;
      self = this;
      targetFunction = this.changeQMInput;
      return this.$el.find("[qm-input-type]").each(function(i) {
        var camelCased;
        camelCased = $(this).attr("qm-input-type").replace(/-([a-z])/g, function(g) {
          return g[1].toUpperCase();
        });
        $(this)[camelCased]();
        return $(this).on("change", targetFunction);
      });
    };

    TooltipSettings.prototype._renderItem = function(ul, item) {
      var contentItem, domItem;
      domItem = $("<li>");
      contentItem = $("<div>").css("font-family", item.value).text(item.value);
      contentItem.appendTo(domItem);
      return domItem.appendTo(ul);
    };

    TooltipSettings.prototype.updateProperties = function() {
      this.$el.find(".ql-font").val(this.tempSettings.fontFamily);
      this.$el.find(".ql-font").css("font-family", this.tempSettings.fontFamily);
      this.$el.find("input[data-id='separatorColor']").val(this.tempSettings.separatorColor, {
        "trigger": false
      });
      if (this.tempSettings.border) {
        this.$el.find("input[data-id='borderColor']").val(this.tempSettings.border.color, {
          "trigger": false
        });
        this.$el.find("input[data-id='borderWidth']").val(this.tempSettings.border.width, {
          "trigger": false
        });
      } else {
        this.$el.find("input[data-id='borderColor']").val("none", {
          "trigger": false
        });
        this.$el.find("input[data-id='borderWidth']").val("0px", {
          "trigger": false
        });
      }
      this.$el.find("input[data-id='roundedCorner']").val(this.tempSettings.roundedCorner, {
        trigger: false
      });
      if (this.tempSettings.title) {
        this.$el.find("input[data-id='backgroundColorTitle']").val(this.tempSettings.title.backgroundColor, {
          trigger: false
        });
        this.$el.find("input[data-id='textColorTitle']").val(this.tempSettings.title.textColor, {
          trigger: false
        });
        this.$el.find("input[data-id='fontSizeTitle']").val(this.tempSettings.title.fontSize, {
          trigger: false
        });
        this.$el.find(".font-style-title-selector").val(this.tempSettings.title.fontStyle, {
          trigger: false
        });
      }
      if (this.tempSettings.body.value) {
        this.$el.find("input[data-id='backgroundColorValue']").val(this.tempSettings.body.value.backgroundColor, {
          trigger: false
        });
        this.$el.find("input[data-id='textColorValue']").val(this.tempSettings.body.value.textColor, {
          trigger: false
        });
        this.$el.find("input[data-id='fontSizeValue']").val(this.tempSettings.body.value.fontSize, {
          trigger: false
        });
        this.$el.find(".font-style-value-selector").val(this.tempSettings.body.value.fontStyle, {
          trigger: false
        });
      }
      if (this.tempSettings.body.label) {
        this.$el.find("input[data-id='textColorLabel']").val(this.tempSettings.body.label.textColor, {
          trigger: false
        });
        this.$el.find("input[data-id='fontSizeLabel']").val(this.tempSettings.body.label.fontSize, {
          trigger: false
        });
        this.$el.find(".font-style-label-selector").val(this.tempSettings.body.label.fontStyle, {
          trigger: false
        });
      }
      if (this.tempSettings.body.description) {
        this.$el.find("input[data-id='textColorDescription']").val(this.tempSettings.body.description.textColor, {
          trigger: false
        });
        this.$el.find("input[data-id='fontSizeDescription']").val(this.tempSettings.body.description.fontSize, {
          trigger: false
        });
        this.$el.find("input[data-id='backgroundColorDescription']").val(this.tempSettings.body.description.backgroundColor, {
          trigger: false
        });
        this.$el.find("input[data-id='lineHeightDescription']").val(this.tempSettings.body.description.lineHeight, {
          trigger: false
        });
        this.$(".font-weight-description-container").find(".ui-selectmenu-text").text(this.tempSettings.body.description.fontWeight);
        return this.$el.find(".font-style-description-selector").val(this.tempSettings.body.description.fontStyle, {
          trigger: false
        });
      }
    };

    TooltipSettings.prototype.initTooltipBehavior = function() {
      var target;
      target = d3.select(this.el).select(".tooltip-box");
      d3.select("body").on('mousemove', function() {
        var y;
        y = d3.mouse(this)[1];
        return target.style("top", (y - 75) + "px");
      });
      return this.tooltipBehavior = new quadrigram.Models.TooltipBehavior;
    };

    TooltipSettings.prototype.updateTooltipBehavior = function() {
      var tooltipOptions;
      tooltipOptions = this.tooltipBehavior.tooltipOptions({
        followMouse: true,
        titleFunction: this.titleFunction,
        bodyFunction: this.bodyFunction
      }, this.tempSettings);
      tooltipOptions.position = {
        target: this.$el.find(".tooltip-box-target"),
        container: this.$el.find(".tooltip-box"),
        my: "bottom center",
        at: "top center"
      };
      /*tooltipOptions.position.target = "mouse"
      tooltipOptions.position.adjust = {mouse:true}
      */

      tooltipOptions.content.text = this.bodyFunction;
      tooltipOptions.content.title = this.titleFunction;
      tooltipOptions.hide = false;
      return this.tip = this.$el.find(".tooltip-box").qtip(tooltipOptions);
    };

    TooltipSettings.prototype.getFakeTooltipObject = function() {
      return {
        title: "A title",
        metadata: {
          value: {
            label: "Example data"
          },
          dataDimensions: ["value"]
        },
        dataDimensions: {
          value: 50
        },
        value: [
          {
            label: "Value: ",
            prefix: "$",
            "value": "50",
            sufix: "cost"
          }
        ],
        description: "Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s"
      };
    };

    TooltipSettings.prototype.showAsTab = function() {
      return this.tip.qtip('show');
    };

    TooltipSettings.prototype.titleFunction = function(itemDOM, event, api) {
      var output, titleFontFamilyStyle, tooltipData, tooltipObject, tooltipSettings;
      tooltipSettings = JSON.parse(JSON.stringify(this.tempSettings));
      tooltipObject = this.getFakeTooltipObject();
      if (tooltipSettings.mainBackgroundColor) {
        tooltipSettings.title.backgroundColor = tooltipSettings.mainBackgroundColor;
        delete tooltipSettings.mainBackgroundColor;
      }
      if (tooltipSettings.mainTextColor) {
        tooltipSettings.title.textColor = tooltipSettings.textColor;
        delete tooltipSettings.mainBackgroundColor;
      }
      tooltipData = _.extend(tooltipObject, {
        fontSize: tooltipSettings.title.fontSize,
        titleStyle: {
          backgroundColor: tooltipSettings.title.backgroundColor,
          textColor: tooltipSettings.title.textColor
        },
        lineHeight: tooltipSettings.title.lineHeight,
        fontFamily: tooltipSettings.fontFamily,
        mainTextColor: tooltipSettings.mainTextColor
      });
      titleFontFamilyStyle = this.getFontFamily(tooltipSettings.fontFamily, tooltipSettings.title.fontStyle);
      tooltipData.fontStyle = titleFontFamilyStyle.fontStyle;
      tooltipData.fontWeight = titleFontFamilyStyle.fontWeight;
      output = this.templateTitle(tooltipData);
      return output;
    };

    TooltipSettings.prototype.bodyFunction = function(event, api) {
      var output, tooltipData, tooltipObject, tooltipSettings;
      tooltipSettings = JSON.parse(JSON.stringify(this.tempSettings));
      tooltipObject = this.getFakeTooltipObject();
      if (tooltipObject.description && tooltipObject.description.length > 250) {
        tooltipObject.description = tooltipObject.description.substr(0, 246) + "...";
      }
      tooltipData = this.injectStyles(JSON.parse(JSON.stringify(tooltipObject)));
      if (!tooltipSettings.separatorColor || tooltipSettings.separatorColor === "none") {
        tooltipData.style.separatorColor = "transparent";
      } else {
        tooltipData.style.separatorColor = tooltipSettings.separatorColor;
      }
      if (tooltipObject.description) {
        d3.select(api.tooltip[0]).style("background-color", tooltipSettings.body.description.backgroundColor);
        d3.select(api.tooltip[0]).classed("no-desc", false);
      } else {
        d3.select(api.tooltip[0]).style("background-color", tooltipSettings.body.value.backgroundColor);
        d3.select(api.tooltip[0]).classed("no-desc", true);
      }
      output = this.templateBody(tooltipData);
      return output;
    };

    TooltipSettings.prototype.injectStyles = function(tooltipObject) {
      var descriptionFontFamilyStyle, labelFontFamilyStyle, tooltipData, tooltipSettings, valueFontFamilyStyle;
      tooltipSettings = JSON.parse(JSON.stringify(this.tempSettings));
      tooltipData = _.extend(tooltipObject, {
        style: _.extend(tooltipSettings.body, {
          fontFamily: tooltipSettings.fontFamily,
          mainBackgroundColor: tooltipSettings.mainBackgroundColor,
          mainTextColor: tooltipSettings.mainTextColor
        })
      });
      descriptionFontFamilyStyle = this.getFontFamily(tooltipSettings.fontFamily, tooltipSettings.body.description.fontStyle);
      tooltipData.style.description.fontStyle = descriptionFontFamilyStyle.fontStyle;
      tooltipData.style.description.fontWeight = descriptionFontFamilyStyle.fontWeight;
      valueFontFamilyStyle = this.getFontFamily(tooltipSettings.fontFamily, tooltipSettings.body.value.fontStyle);
      tooltipData.style.value.fontStyle = valueFontFamilyStyle.fontStyle;
      tooltipData.style.value.fontWeight = valueFontFamilyStyle.fontWeight;
      labelFontFamilyStyle = this.getFontFamily(tooltipSettings.fontFamily, tooltipSettings.body.label.fontStyle);
      tooltipData.style.label.fontStyle = labelFontFamilyStyle.fontStyle;
      tooltipData.style.label.fontWeight = labelFontFamilyStyle.fontWeight;
      if ((tooltipSettings.separatorColor == null) || tooltipSettings.separatorColor === "none") {
        tooltipData.style.separatorColor = "transparent";
      } else {
        tooltipData.style.separatorColor = tooltipSettings.separatorColor;
      }
      return tooltipData;
    };

    TooltipSettings.prototype.getFontFamily = function(familyName, familyStyle) {
      var fontFamilyStyles, output;
      fontFamilyStyles = quadrigram.router.managers.fontManager.getFontStyles(familyName);
      output = _.findWhere(fontFamilyStyles, {
        styleName: familyStyle
      });
      if (!output) {
        output = fontFamilyStyles[0];
      }
      return output;
    };

    return TooltipSettings;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PageThumb = (function(_super) {
    __extends(PageThumb, _super);

    function PageThumb() {
      this.cloneNode = __bind(this.cloneNode, this);
      this.clonePage = __bind(this.clonePage, this);
      this.labelChanged = __bind(this.labelChanged, this);
      this.removeHandler = __bind(this.removeHandler, this);
      this.hideDeleteButton = __bind(this.hideDeleteButton, this);
      this.setDeletable = __bind(this.setDeletable, this);
      this.updateIndex = __bind(this.updateIndex, this);
      this.addLabel = __bind(this.addLabel, this);
      this.resizePage = __bind(this.resizePage, this);
      this.updateLayout = __bind(this.updateLayout, this);
      this.updateVizContent = __bind(this.updateVizContent, this);
      this.removeViz = __bind(this.removeViz, this);
      this.addViz = __bind(this.addViz, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = PageThumb.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PageThumb.prototype.template = JST['app/scripts/templates/pageThumbTemplate.hbs'];

    PageThumb.prototype.className = "thumb-item";

    PageThumb.prototype.tagName = "li";

    PageThumb.prototype.events = {
      "click .delete-button": "removeHandler"
    };

    PageThumb.prototype.viewWillRender = function() {
      this.vizViews = {};
      this.vizCollection = quadrigram.router.dataModels.currentProject.get("visualizersCollection");
      this.vizCollection.on("add", this.addViz);
      this.vizCollection.on("remove", this.removeViz);
      this.vizCollection.on("graphicalUpdate", this.updateVizContent);
      return quadrigram.router.dataModels.currentProject.on("change:layoutData", this.updateLayout);
    };

    PageThumb.prototype.viewDidRender = function() {
      var fg, v, _i, _len, _ref1,
        _this = this;
      this.$el.on("click", function() {
        if (!_this.$el.hasClass("dragging")) {
          return _this.trigger("selected", _this);
        }
      });
      this.$el.on("dblclick", function(e) {
        return _this.$el.find(".page-label-editable").editableSpan("startEditing");
      });
      this.$el.find(".delete-button").on("click", this.deleteHandler);
      this.$el.attr("id", this.model.get("id"));
      _ref1 = this.vizCollection.models;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        v = _ref1[_i];
        this.addViz(v);
      }
      this.updateLayout();
      this.$el.find(".thumb-container").css("height", "60px");
      this.$el.find(".thumb-container").css("width", "100px");
      fg = quadrigram.router.dataModels.currentProject.get("layout-settings").foregroundColor;
      return this.$el.find(".thumb-container").css("background-color", fg);
    };

    PageThumb.prototype.viewWillRemove = function() {
      this.vizCollection.off("add", this.addViz);
      this.vizCollection.off("remove", this.removeViz);
      this.vizCollection.off("graphicalUpdate", this.updateVizContent);
      quadrigram.router.dataModels.currentProject.off("change:layoutData", this.updateLayout);
      return this.$el.find(".delete-button").off("click", this.deleteHandler);
    };

    PageThumb.prototype.addViz = function(vizModel) {
      var pageId, vizView;
      pageId = vizModel.getProperty("page").getValues();
      if (pageId === this.model.get("id") || pageId === -1) {
        vizView = new quadrigram.Views.VizThumb({
          model: vizModel
        });
        this.vizViews[vizModel.get("id")] = vizView;
        vizView.render();
        return this.$el.find(".page-thumb-canvas").append(vizView.$el);
      }
    };

    PageThumb.prototype.removeViz = function(vizModel) {
      if (this.vizViews[vizModel.get("id")] != null) {
        this.vizViews[vizModel.get("id")].remove();
        return delete this.vizViews[vizModel.get("id")];
      }
    };

    PageThumb.prototype.updateVizContent = function(vizModel) {
      if (vizModel.getProperty("page").getValues() === this.model.get("id")) {
        return this.vizViews[vizModel.get("id")].refreshContent();
      }
    };

    PageThumb.prototype.updateLayout = function() {
      /*
      if this.$el.is(':hidden')
        return
      */

      var hasOne, layoutData, ld, _i, _len,
        _this = this;
      layoutData = quadrigram.router.dataModels.currentProject.get("layoutData");
      if (layoutData != null) {
        for (_i = 0, _len = layoutData.length; _i < _len; _i++) {
          ld = layoutData[_i];
          if (ld.page === this.model.get("id") && (this.vizViews[ld.vizID] != null)) {
            hasOne = true;
            this.vizViews[ld.vizID].updateLayout();
          }
        }
      }
      if (hasOne) {
        this.setDeletable(false);
      } else {
        this.setDeletable(true);
      }
      return _.delay(function() {
        return _this.resizePage();
      }, 500);
    };

    PageThumb.prototype.resizePage = function() {
      var fg, oh, originalPage, ow, scale, sideMargins, w;
      originalPage = $(".pages-collection-container .page[data-id=" + this.model.get("id") + "]");
      sideMargins = LayoutUtils.scrapPx(quadrigram.router.dataModels.currentProject.get("layout-settings").sideMargins);
      w = this.$el.find(".thumb-container").width();
      if (this.model.get("actualSize") != null) {
        ow = this.model.get("actualSize").width;
        oh = this.model.get("actualSize").height;
      } else {
        ow = this.model.get("gridsterSize").width;
        oh = this.model.get("gridsterSize").height;
      }
      scale = w / ow;
      this.$el.find(".page-thumb-canvas").css("transform", "scale(" + scale + ")");
      this.$el.find(".thumb-container").css("height", Math.ceil(oh * scale) + "px");
      this.$el.find(".thumb-container").css("width", Math.ceil(ow * scale) + "px");
      this.$el.find(".page-thumb-canvas").css("margin-left", sideMargins * scale + "px");
      fg = quadrigram.router.dataModels.currentProject.get("layout-settings").foregroundColor;
      return this.$el.find(".thumb-container").css("background-color", fg);
    };

    PageThumb.prototype.addLabel = function() {
      var label;
      this.$el.find(".label-container").css("display", "block");
      label = this.model.get("label");
      if (label == null) {
        label = this.model.get("id");
      }
      this.$el.find(".page-label-editable").val(label);
      this.$el.find(".page-label-editable").editableSpan({
        editOnDblClick: true
      });
      return this.$el.find(".page-label-editable").on("change", this.labelChanged);
    };

    PageThumb.prototype.updateIndex = function(value) {
      return this.$el.find(".index-container").html(value + ".");
    };

    PageThumb.prototype.setDeletable = function(value) {
      if (value) {
        return this.$el.find(".delete-button").removeClass("disabled");
      } else {
        return this.$el.find(".delete-button").addClass("disabled");
      }
    };

    PageThumb.prototype.hideDeleteButton = function() {
      return this.$el.find(".delete-button").css("display", "none");
    };

    PageThumb.prototype.removeHandler = function() {
      if (!this.$el.find(".delete-button").hasClass("disabled") && !this.isOnlyPage) {
        return this.trigger("delete", this.model.get("id"));
      }
    };

    PageThumb.prototype.labelChanged = function(e) {
      log("label changed to ", e.currentTarget.value);
      this.model.set("label", e.currentTarget.value);
      return this.trigger("labelChanged");
    };

    PageThumb.prototype.clonePage = function(pageEl) {
      return this.cloneNode(pageEl[0]);
    };

    PageThumb.prototype.cloneNode = function(node) {
      var child, result, _i, _len, _ref1;
      result = node.cloneNode(false);
      if (node.childNodes.length > 0) {
        _ref1 = node.childNodes;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          child = _ref1[_i];
          result.appendChild(this.cloneNode(child));
        }
      }
      return result;
    };

    return PageThumb;

  })(Backbone.SmoothElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.VizThumb = (function(_super) {
    __extends(VizThumb, _super);

    function VizThumb() {
      this.getOriginalViz = __bind(this.getOriginalViz, this);
      this.updateLayout = __bind(this.updateLayout, this);
      this.refreshContent = __bind(this.refreshContent, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = VizThumb.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VizThumb.prototype.template = JST['app/scripts/templates/vizThumbTemplate.hbs'];

    VizThumb.prototype.className = "viz-thumb";

    VizThumb.prototype.tagName = "div";

    VizThumb.prototype.events = {
      "click .delete-button": "removeHandler"
    };

    VizThumb.prototype._serializeData = function() {
      this.templateData = {};
      return this.templateData;
    };

    VizThumb.prototype.viewWillRender = function() {};

    VizThumb.prototype.viewDidRender = function() {};

    VizThumb.prototype.refreshContent = function() {
      var $cps, html, originalViz,
        _this = this;
      originalViz = this.getOriginalViz();
      if (originalViz != null) {
        if (this.model instanceof quadrigram.Models.IFrameControlModel) {
          html = "<div class='fake-content'><img src='images/control_thumbnails/media_thumbnails_iframe.svg'></div>";
        } else if (this.model instanceof quadrigram.Models.YoutubeControlModel) {
          html = "<div class='fake-content'><img src='images/control_thumbnails/media_thumbnails_video.svg'></div>";
        } else {
          html = $(originalViz.find(".viz-view").clone(false));
          html.css("opacity", "1");
          $cps = html.find("clipPath");
          $cps.each(function(i, el) {
            var newId, oldId;
            oldId = $(el).attr("id");
            newId = "thumb-" + oldId;
            $(el).attr("id", newId);
            return html.find('[clip-path="url(#' + oldId + ')"]').attr("clip-path", '"url(#' + newId + ')"]');
          });
        }
        this.$el.empty();
        return this.$el.append(html);
      }
    };

    VizThumb.prototype.updateLayout = function() {
      var baseSize, h, margin, originalViz, w, x, y;
      originalViz = this.getOriginalViz();
      if (originalViz != null) {
        baseSize = quadrigram.router.appViews.projectView.layoutManager.pages[0].BASE_DIMENSIONS;
        margin = 2 * baseSize * quadrigram.router.appViews.projectView.layoutManager.pages[0].MARGINS / 100;
        baseSize = baseSize + margin;
        x = 2 * margin + (this.model.getProperty("col").getValues() - 1) * baseSize;
        y = 2 * margin + (this.model.getProperty("row").getValues() - 1) * baseSize;
        w = this.model.getProperty("size_x").getValues() * baseSize - 2 * margin;
        h = this.model.getProperty("size_y").getValues() * baseSize - 2 * margin;
        this.$el.css("width", w + "px");
        this.$el.css("height", h + "px");
        this.$el.css("left", x + "px");
        return this.$el.css("top", y + "px");
      }
    };

    VizThumb.prototype.getOriginalViz = function() {
      var result;
      result = $(".pages-collection-container [viz-id=" + this.model.get("id") + "]");
      if (result.length > 0) {
        return result;
      } else {
        return null;
      }
    };

    return VizThumb;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.TableEditorView = (function(_super) {
    __extends(TableEditorView, _super);

    function TableEditorView() {
      this.copyTextToClipboard = __bind(this.copyTextToClipboard, this);
      this.copyIdsToClipboard = __bind(this.copyIdsToClipboard, this);
      this.close = __bind(this.close, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.updateModel = __bind(this.updateModel, this);
      this.saveAndClose = __bind(this.saveAndClose, this);
      this.qvViewisFilled = __bind(this.qvViewisFilled, this);
      this.qvisFilled = __bind(this.qvisFilled, this);
      this.changedValueOrId_OLD = __bind(this.changedValueOrId_OLD, this);
      this.changedValueOrId = __bind(this.changedValueOrId, this);
      this.renderTable = __bind(this.renderTable, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = TableEditorView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TableEditorView.prototype.template = JST['app/scripts/templates/blocks/tableEditor.hbs'];

    TableEditorView.prototype.className = "table-editor";

    TableEditorView.prototype.viewDidRender = function() {
      var parent;
      if (this.model.get("internalOfSlot").get("ownerSlotGroup") && this.model.get("internalOfSlot").get("ownerSlotGroup").getSourceIds) {
        this.sourceIds = this.model.get("internalOfSlot").get("ownerSlotGroup").getSourceIds(this.model.get("internalOfSlot").get("slotId"));
      } else {
        this.sourceIds = [];
      }
      $(".front-container").append(this.$el);
      this.renderTable();
      this.$el.draggable({
        handle: this.$el.find(".header")
      });
      if (this.owner.$el.closest(".viz-inspector-container").length > 0) {
        parent = this.owner.$el.closest(".viz-inspector-container")[0];
        this.$el.position({
          my: "right top",
          at: "left-5 top+30",
          of: parent,
          collision: "fit fit"
        });
      } else if (this.owner.$el.closest(".expression-container")) {
        parent = this.owner.$el.closest(".expression-container")[0];
        this.$el.position({
          my: "left top",
          at: "left+5 top+36",
          of: this.owner.$el,
          collision: "fit fit"
        });
      } else {
        this.$el.position({
          my: "right top",
          at: "left-40 top",
          of: this.owner.$el,
          collision: "fit fit"
        });
      }
      this.$el.find(".ok-button").on("click", this.saveAndClose);
      this.$el.find(".close").on("click", this.close);
      return this.$el.find(".ids-copy-button").on("click", this.copyIdsToClipboard);
    };

    TableEditorView.prototype.renderTable = function() {
      var candidate, id, idsToSource, qvalue, repetitions, _i, _len;
      repetitions = {};
      if (this.sourceIds.length === 0) {
        idsToSource = this.model.get("data").map(function(qv) {
          return qv.id;
        });
      } else {
        idsToSource = this.sourceIds;
      }
      this.qvalueModels = [];
      for (_i = 0, _len = idsToSource.length; _i < _len; _i++) {
        id = idsToSource[_i];
        if (repetitions[id] != null) {
          continue;
        } else {
          repetitions[id] = true;
        }
        candidate = _.findWhere(this.model.get("data"), {
          "id": String(id)
        });
        if (candidate) {
          qvalue = candidate.value;
        } else {
          qvalue = "";
        }
        if (id !== "") {
          this.qvalueModels.push(new Backbone.Model({
            "id": id,
            "value": qvalue,
            "type": this.model.get("internalOfSlot").get("dataType"),
            "internalOfSlot": this.model.get("internalOfSlot")
          }));
        }
      }
      this.qvalueModels.push(new Backbone.Model({
        "id": "",
        "": qvalue,
        "type": this.model.get("internalOfSlot").get("dataType"),
        "internalOfSlot": this.model.get("internalOfSlot")
      }));
      this.collectionView = new quadrigram.Views.EditableQValuesCollectionView({
        collection: this.qvalueModels,
        el: this.$el.find(".table-editor-body")
      });
      this.collectionView.changeFunction = this.changedValueOrId;
      return this.collectionView.render();
    };

    TableEditorView.prototype.changedValueOrId = function() {
      var allFilled, m, _i, _len, _ref1;
      allFilled = true;
      _ref1 = this.qvalueModels;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        m = _ref1[_i];
        if (!this.qvisFilled(m)) {
          allFilled = false;
        }
      }
      if (allFilled) {
        this.qvalueModels.push(new Backbone.Model({
          "id": "",
          "value": "",
          "type": this.model.get("internalOfSlot").get("dataType"),
          "internalOfSlot": this.model.get("internalOfSlot")
        }));
        this.collectionView.elementAdded();
        return this.$el.find(".table-editor-body").animate({
          "scrollTop": this.$el.find(".collection-element-container").height() + "px"
        });
      }
    };

    TableEditorView.prototype.changedValueOrId_OLD = function() {
      var _this = this;
      return;
      return _.delay(function() {
        var allFilled, child, editableInput, index, newId, _i, _len, _ref1;
        allFilled = true;
        _ref1 = _this.$el.find(".table-editor-body").children();
        for (index = _i = 0, _len = _ref1.length; _i < _len; index = ++_i) {
          child = _ref1[index];
          if (!_this.qvViewisFilled($(child))) {
            allFilled = false;
          }
        }
        if (allFilled) {
          if (_this.sourceIds[index] != null) {
            newId = _this.sourceIds[index];
          } else {
            newId = "";
          }
          editableInput = new quadrigram.Views.QValueEditableView({
            model: new Backbone.Model({
              "id": newId,
              "value": "",
              "type": _this.model.get("internalOfSlot").get("dataType")
            })
          });
          editableInput.render();
          editableInput.on("change", _this.changedValueOrId);
          _this.$el.find(".table-editor-body").append(editableInput.$el);
          return _this.$el.find(".table-container").animate({
            "scrollTop": _this.$el.find(".table-editor-body").height() + "px"
          });
        }
      }, 300);
    };

    TableEditorView.prototype.qvisFilled = function(qv) {
      var hasId, hasValue;
      hasId = qv.get("id") !== "" && qv.get("id") !== void 0;
      hasValue = qv.get("value") !== "" && qv.get("value") !== void 0;
      return hasId && hasValue;
    };

    TableEditorView.prototype.qvViewisFilled = function($qv) {
      var hasID, hasValue;
      hasID = $qv.find(".id-input").val() !== "" && $qv.find(".id-input").val() !== void 0;
      hasValue = $qv.find(".value-input").val() !== "" && $qv.find(".value-input").val() !== void 0;
      return hasID && hasValue;
    };

    TableEditorView.prototype.saveAndClose = function() {
      this.updateModel();
      return this.close();
    };

    TableEditorView.prototype.updateModel = function() {
      var m, qv, resultData, _i, _len, _ref1;
      resultData = [];
      _ref1 = this.qvalueModels;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        m = _ref1[_i];
        qv = {};
        qv.id = m.get("id");
        qv.value = m.get("value");
        if (qv.id !== "" && qv.value !== "") {
          resultData.push(qv);
        }
      }
      if (resultData.length > 1) {
        this.model.get("metaData").viewMode = "list";
      } else {
        this.model.get("metaData").viewMode = "cell";
      }
      return this.model.setDataManual(resultData);
    };

    TableEditorView.prototype.viewWillRemove = function() {
      this.$el.find(".ok-button").off("click", this.saveAndClose);
      return this.$el.find(".close").off("click", this.close);
    };

    TableEditorView.prototype.close = function() {
      return this.remove();
    };

    TableEditorView.prototype.copyIdsToClipboard = function() {
      var idsAsColString, m, _i, _len, _ref1;
      idsAsColString = "id" + "\n";
      _ref1 = this.qvalueModels;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        m = _ref1[_i];
        idsAsColString += m.get("id") + "\n";
      }
      return this.copyTextToClipboard(idsAsColString);
    };

    TableEditorView.prototype.copyTextToClipboard = function(text) {
      var err, msg, successful, textArea;
      textArea = document.createElement('textarea');
      textArea.style.position = 'fixed';
      textArea.style.top = 0;
      textArea.style.left = 0;
      textArea.style.width = '2em';
      textArea.style.height = '2em';
      textArea.style.padding = 0;
      textArea.style.border = 'none';
      textArea.style.outline = 'none';
      textArea.style.boxShadow = 'none';
      textArea.style.background = 'transparent';
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.select();
      try {
        successful = document.execCommand('copy');
        msg = successful ? 'successful' : 'unsuccessful';
        console.log('Copying text command was ' + msg);
      } catch (_error) {
        err = _error;
        console.log('Oops, unable to copy');
      }
      document.body.removeChild(textArea);
    };

    return TableEditorView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DataBlockEditableTable = (function(_super) {
    __extends(DataBlockEditableTable, _super);

    function DataBlockEditableTable() {
      this.startDrag = __bind(this.startDrag, this);
      this.stopDrag = __bind(this.stopDrag, this);
      this.viewWillRemove = __bind(this.viewWillRemove, this);
      this.previewBlock = __bind(this.previewBlock, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DataBlockEditableTable.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DataBlockEditableTable.prototype.template = JST['app/scripts/templates/blocks/dataBlock.hbs'];

    DataBlockEditableTable.prototype.className = 'data-block data-block-editable-table';

    DataBlockEditableTable.prototype.viewDidRender = function() {
      DataBlockEditableTable.__super__.viewDidRender.call(this);
      return this.$el.draggable("option", "revert", false);
    };

    DataBlockEditableTable.prototype.previewBlock = function() {
      if (this.editor == null) {
        this.editor = new quadrigram.Views.TableEditorView({
          model: this.model
        });
        this.editor.owner = this;
      }
      return this.editor.render();
    };

    DataBlockEditableTable.prototype.viewWillRemove = function() {
      if (this.editor) {
        return this.editor.close();
      }
    };

    DataBlockEditableTable.prototype.stopDrag = function(e, ui) {
      return DataBlockEditableTable.__super__.stopDrag.call(this, e, ui);
    };

    DataBlockEditableTable.prototype.startDrag = function(e, ui) {
      DataBlockEditableTable.__super__.startDrag.call(this, e, ui);
      return this.trigger("popped");
    };

    return DataBlockEditableTable;

  })(quadrigram.Views.DataBlockSourceView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.QValueEditableView = (function(_super) {
    __extends(QValueEditableView, _super);

    function QValueEditableView() {
      this.changeFromEditor = __bind(this.changeFromEditor, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = QValueEditableView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    QValueEditableView.prototype.template = JST['app/scripts/templates/blocks/QValueEditable.hbs'];

    QValueEditableView.prototype.tagName = 'tr';

    QValueEditableView.prototype.viewDidRender = function() {
      this.$el.find(".id-input").val(this.model.get("id"));
      this.inputEl = $("<input class='value-input'></input>");
      $(this.el).find(".value-input-container").append(this.inputEl);
      if (_.isArray(this.model.get("value"))) {
        log("WARINGIN: should render as another TableEditroBlock!!!");
      } else {
        switch (this.model.get("type")) {
          case "text":
            this.inputEl.inputWithFormat({
              "forceValueToFormat": /(.+)/
            });
            break;
          case "number":
            this.inputEl.inputWithFormat({
              "forceValueToFormat": /(-)?\s?(\d*[\.,]?\d*)/,
              "formatDefaults": "|"
            });
            break;
          case "number_px":
            this.inputEl.inputWithFormat({
              "forceValueToFormat": /(-)?(\d+)\s?(px)?/,
              "formatDefaults": "||px"
            });
            break;
          case "color":
            this.inputEl.colorInput({
              "contextualContainer": $('.front-container')
            });
            break;
          case "options":
            this.inputEl.inputWithOptions({
              "options": this.model.get("internalOfSlot").options,
              "autoOpenContextual": true,
              "forceValueToOption": true
            });
            break;
          case "percentage":
            this.inputEl.percentageInput();
            break;
          case "date":
            elog("input date not available");
            break;
          case "boolean":
            this.inputEl.booleanInput();
            break;
          default:
            this.inputEl.inputWithFormat({
              "forceValueToFormat": /(.+)/
            });
        }
      }
      this.inputEl.val(this.model.get("value"));
      if (this.model.get("type") === "options") {
        if (this.model.get("value") === "") {
          if (this.model.get("internalOfSlot").get("operationId") === "Aggregate") {
            this.model.set("value", "ignore", {
              silent: true
            });
            this.inputEl.val("ignore");
          } else {
            this.inputEl.val(this.model.get("internalOfSlot").options[0].value);
          }
        }
      }
      this.inputEl.on("change", this.changeFromEditor);
      return this.$el.find(".id-input").on("change", this.changeFromEditor);
    };

    QValueEditableView.prototype.changeFromEditor = function() {
      this.model.set("id", this.$el.find(".id-input").val());
      this.model.set("value", this.$el.find(".value-input").val());
      return this.trigger("change");
    };

    return QValueEditableView;

  })(Backbone.ElementView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.EditableQValuesCollectionView = (function(_super) {
    __extends(EditableQValuesCollectionView, _super);

    function EditableQValuesCollectionView() {
      this.elementViewDidRender = __bind(this.elementViewDidRender, this);
      _ref = EditableQValuesCollectionView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    EditableQValuesCollectionView.prototype.template = JST['app/scripts/templates/blocks/dataBlockCollection.hbs'];

    EditableQValuesCollectionView.prototype.modelView = quadrigram.Views.QValueEditableView;

    EditableQValuesCollectionView.prototype.bindModelViews = false;

    EditableQValuesCollectionView.prototype.elementViewDidRender = function(view) {
      EditableQValuesCollectionView.__super__.elementViewDidRender.call(this);
      return view.on("change", this.changeFunction);
    };

    return EditableQValuesCollectionView;

  })(Backbone.ArrayOfModelsView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.fileTypeOptions = (function(_super) {
    __extends(fileTypeOptions, _super);

    function fileTypeOptions() {
      this.handleTabSelected = __bind(this.handleTabSelected, this);
      this.changeIdKey = __bind(this.changeIdKey, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = fileTypeOptions.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    fileTypeOptions.prototype.template = JST['app/scripts/templates/UI/dialogs/BlockPreview/fileTypeOptions.hbs'];

    fileTypeOptions.prototype.className = "file-type-options";

    fileTypeOptions.prototype.viewDidRender = function() {
      var key, _i, _len, _ref1;
      _ref1 = this.parentGroup.sheetOptions;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        key = _ref1[_i];
        this.$el.find(".tabs-list").append($("<li class='sheet-tab' value='" + key + "'>" + key + "</li>"));
      }
      this.$el.find(".sheet-tab").on("click", this.handleTabSelected);
      return this.$el.find(".sheet-tab[value='" + this.parentGroup.get("currentSheet") + "']").addClass("selected");
      /*
      selectorEl.find("select").selectmenu({
          width:100
          change:@changeIdKey
        })
      */

    };

    fileTypeOptions.prototype.changeIdKey = function() {
      var selectorEl, sheetName;
      selectorEl = this.$el.find(".sheet-selector")[0];
      sheetName = selectorEl.options[selectorEl.selectedIndex].value;
      return this.trigger("change-sheet", sheetName);
    };

    fileTypeOptions.prototype.handleTabSelected = function(e) {
      var sheetName;
      this.$el.find(".sheet-tab").removeClass("selected");
      $(e.target).addClass("selected");
      sheetName = $(e.target).attr("value");
      return this.trigger("change-sheet", sheetName);
    };

    return fileTypeOptions;

  })(Backbone.ElementView);

}).call(this);

(function() {
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ListChartView = (function(_super) {
    __extends(ListChartView, _super);

    function ListChartView() {
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = ListChartView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ListChartView.prototype.followMouse = true;

    ListChartView.prototype.stylableTexts = [".title-text"];

    ListChartView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    ListChartView.prototype.viewDidRender = function() {
      return this.listContainer = this.behaviors.layout.root.append("div").attr("class", "list-visualizer-container");
    };

    ListChartView.prototype.updateItems = function() {
      var self;
      this.items = this.listContainer.selectAll(".item").data(this.values, function(d, i) {
        return d.id;
      });
      this.itemsEnter = this.items.enter().append("div").attr("class", "item list-visualizer-item-container");
      this.itemsEnter.append("div").attr("class", "item-child list-visualizer-item").append("div").attr("class", "title-text weighted-text");
      self = this;
      this.items.each(function(d, i) {
        self.$(this).detach();
        self.$(".list-visualizer-container").append($(this));
        return d3.select(this).select(".title-text").style("padding-left", "5px").style("padding-right", "5px").text(d.value);
      });
      return this.items.exit().remove();
    };

    ListChartView.prototype.visualizerDidUpdateItems = function() {
      var self;
      self = this;
      return this.items.selectAll(".item-child").style("height", function(d, i) {
        var cellHeight;
        cellHeight = self.behaviors.selection.behaviors.items.styleItems[d.id]["cellHeight"];
        cellHeight = cellHeight != null ? cellHeight : $(this).css('font-size');
        return cellHeight;
      });
    };

    return ListChartView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ListChartModel = (function(_super) {
    __extends(ListChartModel, _super);

    function ListChartModel() {
      _ref = ListChartModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ListChartModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TextListDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TextStyleBehavior", "quadrigram.Models.SelectionDOMBehavior"];

    ListChartModel.meta = {
      "name": "List",
      "properties": {
        "data": {
          "label": "Items to be shown",
          "family": "data",
          "hidden": false,
          "sortingWeight": "0",
          "formats": {
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": 1,
                    "value": "Item 01"
                  }, {
                    "id": 2,
                    "value": "Item 02"
                  }, {
                    "id": 3,
                    "value": "Item 03"
                  }, {
                    "id": 4,
                    "value": "Item 04"
                  }, {
                    "id": 5,
                    "value": "Item 05"
                  }, {
                    "id": 6,
                    "value": "Item 06"
                  }, {
                    "id": 7,
                    "value": "Item 07"
                  }
                ]
              }
            }
          }
        },
        "fillColors": {
          "label": "Fill color of each item",
          "family": "style",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#FFFFFF"
              }
            }
          }
        },
        "fillOpacities": {
          "label": "Fill opacity of each item",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "lineColors": {
          "label": "Outline color of each item",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "#DDDDDD"
              }
            }
          }
        },
        "lineThickness": {
          "label": "Outline thickness of each item",
          "formats": {
            "Px": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "1px"
              }
            }
          }
        },
        "lineOpacities": {
          "label": "Outline opacity of each item",
          "formats": {
            "Percentage": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "100"
              }
            }
          }
        },
        "cellHeight": {
          "label": "Height of cells",
          "family": "style",
          "sortingWeight": "27",
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "30px"
              }
            }
          }
        },
        "cellTextAlign": {
          "label": "Text align",
          "family": "style",
          "sortingWeight": "28",
          "hidden": true,
          "deprecated": true,
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "left"
              },
              "options": {
                "value": ["left", "center", "right"]
              }
            }
          }
        },
        "cellFontSize": {
          "label": "Font size",
          "family": "style",
          "sortingWeight": "29",
          "deprecated": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "12px"
              }
            }
          }
        },
        "labelColors": {
          "label": "Text color",
          "family": "style",
          "sortingWeight": "30",
          "deprecated": true,
          "formats": {
            "Color": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "#FFFFFF"
              }
            }
          }
        },
        "size_x": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "3"
              }
            }
          }
        },
        "size_y": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "4"
              }
            }
          }
        },
        "selectionBold": {
          "internal": false
        },
        "selectionLineThickness": {
          "formats": {
            "Px": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "2px"
              }
            },
            "Deactivated": {
              "multiValues": {
                "value": false
              }
            }
          }
        }
      }
    };

    ListChartModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ListChartModel.meta, ListChartModel.behaviors);
      return output;
    };

    return ListChartModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.LinkControlView = (function(_super) {
    __extends(LinkControlView, _super);

    function LinkControlView() {
      this.getValidUrl = __bind(this.getValidUrl, this);
      this.updateItems = __bind(this.updateItems, this);
      this.onOutLinkContainer = __bind(this.onOutLinkContainer, this);
      this.onOverLinkContainer = __bind(this.onOverLinkContainer, this);
      this.replaceStyleProperty = __bind(this.replaceStyleProperty, this);
      this.setVerticalAlignment = __bind(this.setVerticalAlignment, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = LinkControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LinkControlView.prototype.followMouse = false;

    LinkControlView.prototype.template = JST['app/scripts/templates/visualizers/linkControl.hbs'];

    LinkControlView.prototype.viewDidRender = function() {
      this.vizBackground = $(this.behaviors.layout.root).get(0);
      this.vizBackground = $(this.vizBackground).find(".viz-view-background");
      this.linkItem = this.behaviors.layout.root.append("div").attr("class", "link-control-container").append("a").attr("class", "link-control-item");
      this.linkItem = $(this.linkItem).get(0);
      this.linkContainer = $(this.behaviors.layout.root).get(0);
      this.linkContainer = $(this.linkContainer).find(".link-control-container");
      $(this.linkContainer).on("mouseover", this.onOverLinkContainer);
      $(this.linkContainer).on("mouseout", this.onOutLinkContainer);
      this.values = "fakeValues";
      return this.ids = "fakeIds";
    };

    LinkControlView.prototype.setVerticalAlignment = function(mouseState) {
      var modelProperty, vAlign;
      modelProperty = "";
      if (mouseState === "default") {
        modelProperty = this.model.get("verticalAlign");
      } else if (mouseState === "hover") {
        modelProperty = this.model.get("verticalAlignHover");
      }
      if (modelProperty === "top") {
        vAlign = "link-control-item-vaTop";
      }
      if (modelProperty === "middle") {
        vAlign = "link-control-item-vaMiddle";
      } else if (modelProperty === "bottom") {
        vAlign = "link-control-item-vaBottom";
      }
      return $(this.linkItem).removeClass("link-control-item-vaTop").removeClass("link-control-item-vaMiddle").removeClass("link-control-item-vaBottom").addClass(vAlign);
    };

    LinkControlView.prototype.replaceStyleProperty = function(styles, property, value) {
      var currentStyles, replacedProperty;
      currentStyles = styles.split(";");
      replacedProperty = null;
      currentStyles.forEach(function(styleItem, index) {
        if (styleItem.indexOf(property) !== -1) {
          replacedProperty = styleItem.split(":");
          if (replacedProperty[0] === "background-image") {
            replacedProperty = replacedProperty.slice(0, 2);
            replacedProperty[1] = "url(" + value + ")";
          } else {
            replacedProperty[1] = value;
          }
          replacedProperty = replacedProperty.join(":");
        }
      });
      currentStyles.forEach(function(val, index) {
        if (val.indexOf(property) !== -1 && replacedProperty !== null) {
          return currentStyles[index] = replacedProperty;
        }
      });
      currentStyles = currentStyles.join(";");
      return currentStyles;
    };

    LinkControlView.prototype.onOverLinkContainer = function(e) {
      var containerStyles, styles;
      containerStyles = $(this.vizBackground).attr("style");
      styles = $(this.linkItem).attr("style");
      if (this.model.get("fontFamilyHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        styles = this.replaceStyleProperty(styles, "font-family", this.model.get("fontFamilyHover"));
      }
      if (this.model.get("textSizeHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        styles = this.replaceStyleProperty(styles, "font-size", this.model.get("textSizeHover"));
      }
      if (this.model.get("textColorHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        styles = this.replaceStyleProperty(styles, "color", this.model.get("textColorHover"));
      }
      if (this.model.get("textWeightHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        styles = this.replaceStyleProperty(styles, "font-weight", this.model.get("textWeightHover"));
      }
      if (this.model.get("textStyleHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        styles = this.replaceStyleProperty(styles, "font-style", this.model.get("textStyleHover"));
      }
      if (this.model.get("textDecorationHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        styles = this.replaceStyleProperty(styles, "text-decoration", this.model.get("textDecorationHover") + " !important");
      }
      if (this.model.get("textAlignHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        styles = this.replaceStyleProperty(styles, "text-align", this.model.get("textAlignHover"));
      }
      if (this.model.get("verticalAlignHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        this.setVerticalAlignment("hover");
      }
      if (this.model.get("bgColorHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        containerStyles = this.replaceStyleProperty(containerStyles, "background-color", this.model.get("bgColorHover"));
      }
      if (this.model.get("bgImageHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        containerStyles = this.replaceStyleProperty(containerStyles, "background-image", this.model.get("bgImageHover"));
      }
      if (this.model.get("bgOpacityHover") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        containerStyles = this.replaceStyleProperty(containerStyles, "opacity", this.model.get("bgOpacityHover") / 100);
      }
      $(this.vizBackground).attr("style", containerStyles);
      return $(this.linkItem).attr("style", styles);
    };

    LinkControlView.prototype.onOutLinkContainer = function(e) {
      return this.updateItems();
    };

    LinkControlView.prototype.updateItems = function() {
      var containerStyles, styles;
      containerStyles = "background-color: " + this.model.get("bkg_color") + ";";
      if (this.model.get("bkg_image").currentFormat === "ImageUrl") {
        containerStyles += "background-image: url(" + this.model.get("bkg_image")[0] + ");";
      } else {
        containerStyles += "background-image: url(" + this.model.get("bkg_image") + ");";
      }
      containerStyles += "opacity: " + this.model.get("bkg_opacity") / 100 + ";";
      styles = "font-family: " + this.model.get("fontFamily") + ";";
      styles += "color: " + this.model.get("textColor") + ";";
      styles += "font-size: " + this.model.get("textSize") + ";";
      styles += "text-align: " + this.model.get("textAlign") + ";";
      styles += "font-weight: " + this.model.get("textWeight") + ";";
      styles += "font-style: " + this.model.get("textStyle") + ";";
      styles += "text-decoration: " + this.model.get("textDecoration") + " !important";
      $(this.vizBackground).attr("style", containerStyles);
      $(this.linkItem).html(this.model.get("data_text")).attr("href", this.getValidUrl(this.model.get("data_url"))).attr("target", this.model.get("data_target")).attr("style", styles);
      return this.setVerticalAlignment("default");
    };

    LinkControlView.prototype.getValidUrl = function(url) {
      if (!_.isString(url)) {
        return;
      }
      if (url.indexOf("http://") === -1) {
        if (url.indexOf("https://") === -1) {
          url = "http://" + url;
        }
      }
      return url;
    };

    return LinkControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.LinkControlModel = (function(_super) {
    __extends(LinkControlModel, _super);

    function LinkControlModel() {
      _ref = LinkControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LinkControlModel.behaviors = ["quadrigram.Models.LayoutBehavior"];

    LinkControlModel.meta = {
      name: "Link",
      properties: {
        data_text: {
          label: "Link text",
          family: "data",
          hidden: false,
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Link text to display"
              }
            }
          }
        },
        data_url: {
          label: "Link source URL",
          family: "data",
          hidden: false,
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        data_target: {
          label: "Link target",
          family: "data",
          hidden: false,
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "_blank"
              },
              options: {
                value: ["_blank", "_self", "_parent", "_top"]
              }
            }
          }
        },
        fontFamily: {
          label: "Font family",
          family: "style",
          hidden: false,
          sortingWeight: "24",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Roboto"
              },
              options: {
                value: ["Oswald", "Kreon", "Sans Serif", "Roboto", "Droid Sans", "Lato", "Titillium Web", "Open Sans Condensed", "Open Sans", "Ubuntu", "Verdana", "serif", "SlabSerif", "Droid Serif", "Roboto Slab", "EB Garamond", "Libre Baskerville", "Merriweather", "Georgia", "Display", "Playfair Display", "Playfair Display SC", "Old Standard TT"]
              }
            }
          }
        },
        textSize: {
          label: "Font size",
          family: "style",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Px: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "12px"
              }
            }
          }
        },
        textColor: {
          label: "Text color",
          family: "style",
          hidden: false,
          sortingWeight: "26",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#3d5afe"
              }
            }
          }
        },
        textWeight: {
          label: "Text weight",
          family: "style",
          hidden: false,
          sortingWeight: "27",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "normal"
              },
              options: {
                value: ["normal", "bold", "lighter"]
              }
            }
          }
        },
        textStyle: {
          label: "Text style",
          family: "style",
          hidden: false,
          sortingWeight: "28",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "normal"
              },
              options: {
                value: ["normal", "italic"]
              }
            }
          }
        },
        textDecoration: {
          label: "Text decoration",
          family: "style",
          hidden: false,
          sortingWeight: "29",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "underline"
              },
              options: {
                value: ["none", "underline", "overline", "line-through"]
              }
            }
          }
        },
        textAlign: {
          label: "Text align",
          family: "style",
          hidden: false,
          sortingWeight: "30",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "left"
              },
              options: {
                value: ["left", "center", "right"]
              }
            }
          }
        },
        verticalAlign: {
          label: "Vertical align",
          family: "style",
          hidden: false,
          sortingWeight: "31",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "top"
              },
              options: {
                value: ["top", "middle", "bottom"]
              }
            }
          }
        },
        fontFamilyHover: {
          label: "Font family",
          family: "over",
          hidden: false,
          sortingWeight: "24",
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Roboto"
              },
              options: {
                value: ["Oswald", "Kreon", "Sans Serif", "Roboto", "Droid Sans", "Lato", "Titillium Web", "Open Sans Condensed", "Open Sans", "Ubuntu", "Verdana", "serif", "SlabSerif", "Droid Serif", "Roboto Slab", "EB Garamond", "Libre Baskerville", "Merriweather", "Georgia", "Display", "Playfair Display", "Playfair Display SC", "Old Standard TT"]
              }
            }
          }
        },
        textSizeHover: {
          label: "Font size",
          family: "over",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Px: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "12px"
              }
            }
          }
        },
        textColorHover: {
          label: "Text color",
          family: "over",
          hidden: false,
          sortingWeight: "26",
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "##3d5afe"
              }
            }
          }
        },
        textWeightHover: {
          label: "Text weight",
          family: "over",
          hidden: false,
          sortingWeight: "27",
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "normal"
              },
              options: {
                value: ["normal", "bold", "lighter"]
              }
            }
          }
        },
        textStyleHover: {
          label: "Text style",
          family: "over",
          hidden: false,
          sortingWeight: "28",
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "normal"
              },
              options: {
                value: ["normal", "italic"]
              }
            }
          }
        },
        textDecorationHover: {
          label: "Text decoration",
          family: "over",
          hidden: false,
          sortingWeight: "29",
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "underline"
              },
              options: {
                value: ["none", "underline", "overline", "line-through"]
              }
            }
          }
        },
        textAlignHover: {
          label: "Text align",
          family: "over",
          hidden: false,
          sortingWeight: "30",
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "left"
              },
              options: {
                value: ["left", "center", "right"]
              }
            }
          }
        },
        verticalAlignHover: {
          label: "Vertical align",
          family: "over",
          hidden: false,
          sortingWeight: "31",
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "top"
              },
              options: {
                value: ["top", "middle", "bottom"]
              }
            }
          }
        },
        bgColorHover: {
          label: "Background Color",
          family: "over",
          hidden: true,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#ffffff"
              }
            }
          }
        },
        bgImageHover: {
          label: "Background Image URL",
          family: "over",
          hidden: true,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        bgOpacityHover: {
          label: "Background Opacity",
          family: "over",
          hidden: true,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Percentage: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "100"
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: 6
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: 1
              }
            }
          }
        }
      }
    };

    LinkControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(LinkControlModel.meta, LinkControlModel.behaviors);
      return output;
    };

    return LinkControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.SliderControlView = (function(_super) {
    __extends(SliderControlView, _super);

    function SliderControlView() {
      this.getLongestString = __bind(this.getLongestString, this);
      this.valFromSlider = __bind(this.valFromSlider, this);
      this.onValueChanged = __bind(this.onValueChanged, this);
      this.setValueToSlider = __bind(this.setValueToSlider, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = SliderControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SliderControlView.prototype.followMouse = false;

    SliderControlView.prototype.firstExec = true;

    SliderControlView.prototype.stylableTexts = [".feedback-text"];

    SliderControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    SliderControlView.prototype.viewDidRender = function() {
      var delayedChange;
      this.behaviors.layout.root.append("div").attr("class", "slider-container");
      this.original = $("<input class='original'></input>");
      this.feedbackText = $("<input class='feedback-text'></input>");
      this.$el.find(".slider-container").append(this.original);
      this.original.sliderInput();
      this.$el.find(".qm-input-wrapper").prepend(this.feedbackText);
      this.$el.find(".normalized-input").addClass("hidden");
      delayedChange = _.throttle(this.onValueChanged, 100);
      this.original.on("change", delayedChange);
      this.values = "something";
      return this.ids = "somethingElse";
    };

    SliderControlView.prototype.updateItems = function() {
      var array, longestString, newValue, prevValue, range, rangeSize, step, width;
      prevValue = this.original.val();
      if (this.model.get("range").currentFormat === "Range") {
        this.currentFormat = "Range";
        range = [Number(this.model.get("range")[0]), Number(this.model.get("range")[1])];
        rangeSize = range[1] - range[0];
        step = Number(this.model.get("range")[2]);
      } else if (this.model.get("range").currentFormat === "JustDrop" && this.model.get("range").length > 1) {
        this.currentFormat = "JustDrop";
        array = this.model.get("range");
        range = [0, array.length - 1];
        step = 1;
      }
      if (!range) {
        this.currentFormat = "Range";
        range = [0, 100];
        step = 1;
      }
      this.$el.find(".slider").slider("option", {
        "min": range[0],
        "max": range[1]
      });
      this.$el.find(".slider").slider("option", {
        "step": step
      });
      if ($(this.behaviors.layout.root[0]).width() < $(this.behaviors.layout.root[0]).height()) {
        this.$el.find(".slider").slider("option", {
          orientation: "vertical"
        });
        this.$el.find(".slider-container").addClass("vertical");
        this.$el.find(".slider-container").removeClass("horizontal");
        this.feedbackText.css("width", "100%");
      } else {
        this.$el.find(".slider").slider("option", {
          orientation: "horizontal"
        });
        this.$el.find(".slider-container").removeClass("vertical");
        this.$el.find(".slider-container").addClass("horizontal");
        longestString = this.getLongestString(range, step);
        this.feedbackText.val(longestString + "-");
        width = $.fn.textWidth(this.feedbackText);
        this.feedbackText.css("width", width + "px");
      }
      this.$el.find(".slider").slider("value", this.$el.find(".slider").slider("value"));
      newValue = this.$el.find(".slider").slider("value");
      this.original.val(newValue);
      this.feedbackText.val(this.valFromSlider(newValue));
      if (this.model.get("showNumber") === "true") {
        this.feedbackText.removeClass("hidden");
      } else {
        this.feedbackText.addClass("hidden");
      }
      if (this.original.val() < range[0]) {
        this.original.val(range[0]);
      } else if (this.original.val() > range[1]) {
        this.original.val(range[1]);
      }
      this.$el.find(".slider-input").css("display", "none");
      this.$el.find(".slider-input").css("display", "table");
      this.$el.find(".slider").css("background", this.model.get("grooveColor"));
      this.$el.find(".ui-slider-handle").css("background", this.model.get("handleColor"));
      this.$el.find(".ui-slider-handle").removeClass("shape-Circle");
      this.$el.find(".ui-slider-handle").removeClass("shape-Bar");
      this.$el.find(".ui-slider-handle").addClass("shape-" + this.model.get("handleShape"));
      if (this.firstExec || this.model.changed["initValue"]) {
        this.firstExec = false;
        this.setValueToSlider(this.model.get("initValue"));
      }
      return this.onValueChanged();
    };

    SliderControlView.prototype.setValueToSlider = function(input) {
      var index, max, min, value, valueEntry, _i, _len, _ref1;
      if (this.currentFormat === "JustDrop" && this.model.get("range").length > 0) {
        _ref1 = this.model.get("range");
        for (index = _i = 0, _len = _ref1.length; _i < _len; index = ++_i) {
          valueEntry = _ref1[index];
          if (valueEntry.id === input) {
            value = index;
            break;
          }
        }
      } else {
        min = this.model.get("range")[0];
        max = this.model.get("range")[1];
        input = parseFloat(input);
        if (!isNaN(input)) {
          value = Math.max(Math.min(max, input), min);
        }
      }
      if (value) {
        return this.original.val(value);
      }
    };

    SliderControlView.prototype.onValueChanged = function() {
      var finalValue, tempValue;
      tempValue = this.original.val();
      if (this.model.get("invert") === "true") {
        finalValue = this.$el.find(".slider").slider("option", "max") - (this.original.val() - this.$el.find(".slider").slider("option", "min"));
      } else {
        finalValue = tempValue;
      }
      if (this.lastValue !== this.valFromSlider(finalValue)) {
        this.feedbackText.val(this.valFromSlider(finalValue));
        this.updateOutput("value", this.valFromSlider(finalValue));
      }
      return this.lastValue = finalValue;
    };

    SliderControlView.prototype.valFromSlider = function(value) {
      if (this.currentFormat === "JustDrop" && this.model.get("range").length > 0) {
        return this.model.get("range")[value].value;
      } else {
        return value;
      }
    };

    SliderControlView.prototype.getLongestString = function(range, step) {
      var result;
      result = this.valFromSlider(range[0]);
      if (String(result).length < String(this.valFromSlider(range[1])).length) {
        result = this.valFromSlider(range[1]);
      }
      if (String(result).length < String(this.valFromSlider(range[1] - step)).length) {
        result = this.valFromSlider(range[1] - step);
      }
      return result;
    };

    return SliderControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.SliderControlModel = (function(_super) {
    __extends(SliderControlModel, _super);

    function SliderControlModel() {
      _ref = SliderControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    SliderControlModel.behaviors = ["quadrigram.Models.LayoutBehavior", "quadrigram.Models.TextStyleBehavior"];

    SliderControlModel.meta = {
      name: "Slider",
      outputs: {
        value: {
          outputType: "style",
          "default": 0,
          label: "Slider position"
        }
      },
      properties: {
        showNumber: {
          label: "Show selected value",
          family: "style",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        range: {
          label: "Range of the slider",
          family: "data",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Range: {
              multiValues: {
                start: false,
                end: false,
                step: false
              },
              defaults: {
                start: "0",
                end: "100",
                step: "1"
              }
            },
            JustDrop: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        initValue: {
          label: "Initial Value",
          family: "data",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        invert: {
          label: "Invert the direction of the range",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "false"
              }
            }
          }
        },
        handleShape: {
          label: "Handle shape",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Bar"
              },
              options: {
                value: ["Bar", "Circle"]
              }
            }
          }
        },
        handleColor: {
          label: "Handle color",
          family: "style",
          hidden: true,
          sortingWeight: "0",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#ddd"
              }
            }
          }
        },
        grooveColor: {
          label: "Track color",
          family: "style",
          hidden: true,
          sortingWeight: "0",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#616161"
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: 6
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: 1
              }
            }
          }
        }
      }
    };

    SliderControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(SliderControlModel.meta, SliderControlModel.behaviors);
      return output;
    };

    return SliderControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.RangeControlView = (function(_super) {
    __extends(RangeControlView, _super);

    function RangeControlView() {
      this.getLongestString = __bind(this.getLongestString, this);
      this.valFromSlider = __bind(this.valFromSlider, this);
      this.onValueChanged = __bind(this.onValueChanged, this);
      this.setValueToSlider = __bind(this.setValueToSlider, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = RangeControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RangeControlView.prototype.followMouse = false;

    RangeControlView.prototype.firstExec = true;

    RangeControlView.prototype.stylableTexts = [".feedback-text"];

    RangeControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    RangeControlView.prototype.viewDidRender = function() {
      var delayedChange;
      this.behaviors.layout.root.append("div").attr("class", "slider-container");
      this.original = $("<input class='original'></input>");
      this.feedbackTextMin = $("<input class='feedback-text min'></input>");
      this.feedbackTextMax = $("<input class='feedback-text max'></input>");
      this.$el.find(".slider-container").append(this.original);
      this.original.rangeInput();
      this.$el.find(".qm-input-wrapper").prepend(this.feedbackTextMin);
      this.$el.find(".qm-input-wrapper").append(this.feedbackTextMax);
      this.$el.find(".normalized-input").addClass("hidden");
      delayedChange = _.throttle(this.onValueChanged, 100);
      this.original.on("change", delayedChange);
      this.values = "something";
      return this.ids = "somethingElse";
    };

    RangeControlView.prototype.updateItems = function() {
      var array, longestString, newValues, range, rangeSize, step, width,
        _this = this;
      if (this.model.get("range").currentFormat === "Range") {
        this.currentFormat = "Range";
        this.range = range = [Number(this.model.get("range")[0]), Number(this.model.get("range")[1])];
        rangeSize = range[1] - range[0];
        step = Number(this.model.get("range")[2]);
      } else if (this.model.get("range").currentFormat === "JustDrop" && this.model.get("range").length > 1) {
        this.currentFormat = "JustDrop";
        array = this.model.get("range");
        range = [0, array.length - 1];
        step = 1;
      }
      if (!range) {
        this.currentFormat = "Range";
        range = [0, 100];
        step = 1;
      }
      this.$el.find(".slider").dragslider("option", {
        "min": range[0],
        "max": range[1]
      });
      this.$el.find(".slider").dragslider("option", {
        "step": step
      });
      this.$el.find(".slider").dragslider("values", this.$el.find(".slider").dragslider("values"));
      newValues = this.$el.find(".slider").dragslider("values");
      if (newValues[0] === newValues[1]) {
        this.$el.find(".slider").dragslider("option", {
          "values": range
        });
      }
      this.feedbackTextMin.val(this.valFromSlider(newValues[0]));
      this.feedbackTextMax.val(this.valFromSlider(newValues[1]));
      /*
      if  @original.val()<range[0] 
        @original.val(range[0])
      else if @original.val()>range[1]
        @original.val(range[1])
      */

      if ($(this.behaviors.layout.root[0]).width() < $(this.behaviors.layout.root[0]).height()) {
        this.$el.find(".slider").dragslider("option", {
          orientation: "vertical"
        });
        this.$el.find(".slider-container").addClass("vertical");
        this.$el.find(".slider-container").removeClass("horizontal");
        this.feedbackTextMin.css("width", "100%");
        this.feedbackTextMax.css("width", "100%");
      } else {
        this.$el.find(".slider").dragslider("option", {
          orientation: "horizontal"
        });
        this.$el.find(".slider-container").removeClass("vertical");
        this.$el.find(".slider-container").addClass("horizontal");
        longestString = this.getLongestString(range, step);
        this.feedbackTextMin.val(longestString + "-");
        width = $.fn.textWidth(this.feedbackTextMin);
        this.feedbackTextMin.css("width", width + "px");
        this.feedbackTextMax.css("width", width + "px");
      }
      if ((this.model.get("invert") === "true" && $(this.behaviors.layout.root[0]).width() > $(this.behaviors.layout.root[0]).height()) || (this.model.get("invert") === "false" && $(this.behaviors.layout.root[0]).width() < $(this.behaviors.layout.root[0]).height())) {
        this.feedbackTextMin = this.$el.find('.feedback-text.max');
        this.feedbackTextMax = this.$el.find('.feedback-text.min');
      } else {
        this.feedbackTextMin = this.$el.find('.feedback-text.min');
        this.feedbackTextMax = this.$el.find('.feedback-text.max');
      }
      this.$el.find(".slider").css("background", this.model.get("grooveColor"));
      this.$el.find(".ui-slider-handle").css("background", this.model.get("handleColor"));
      this.$el.find(".ui-slider-range-graphic").css("background", this.model.get("rangeColor"));
      this.$el.find(".ui-slider-handle").removeClass("shape-Circle");
      this.$el.find(".ui-slider-handle").removeClass("shape-Bar");
      this.$el.find(".ui-slider-handle").addClass("shape-" + this.model.get("handleShape"));
      if (this.firstExec || this.model.changed["initValue"]) {
        this.firstExec = false;
        this.setValueToSlider(this.model.get("initValue")[0], this.model.get("initValue")[1]);
      }
      this.onValueChanged();
      if (this.model.get("showNumber") === "true") {
        this.feedbackTextMin.removeClass("hidden");
        this.feedbackTextMax.removeClass("hidden");
      } else {
        this.feedbackTextMax.addClass("hidden");
        this.feedbackTextMin.addClass("hidden");
      }
      this.$el.find(".slider-input").css("display", "none");
      return _.defer(function() {
        return _this.$el.find(".slider-input").css("display", "table");
      });
    };

    RangeControlView.prototype.setValueToSlider = function(inputMin, inputMax) {
      var actualMax, actualMin, changed, index, max, min, newValues, realMax, realMin, valueEntry, _i, _len, _ref1;
      changed = false;
      if (this.currentFormat === "JustDrop" && this.model.get("range").length > 0) {
        _ref1 = this.model.get("range");
        for (index = _i = 0, _len = _ref1.length; _i < _len; index = ++_i) {
          valueEntry = _ref1[index];
          if (valueEntry.id === inputMin) {
            realMin = index;
            changed = true;
          }
          if (valueEntry.id === inputMax) {
            realMax = index;
            changed = true;
          }
        }
      } else {
        min = this.model.get("range")[0];
        max = this.model.get("range")[1];
        inputMin = parseFloat(inputMin);
        if (!isNaN(inputMin)) {
          changed = true;
          realMin = Math.max(Math.min(max, inputMin), min);
        }
        inputMax = parseFloat(inputMax);
        if (!isNaN(inputMax)) {
          changed = true;
          realMax = Math.max(Math.min(max, inputMax), min);
        }
      }
      if (changed) {
        newValues = this.$el.find(".slider").dragslider("values");
        if (!realMin) {
          actualMin = this.valFromSlider(newValues[0]);
          realMin = actualMin;
        }
        if (!realMax) {
          actualMax = this.valFromSlider(newValues[1]);
          realMax = actualMax;
        }
        return this.$el.find(".slider").dragslider("values", [realMin, realMax]);
      }
    };

    RangeControlView.prototype.onValueChanged = function() {
      var finalValues, tempValues;
      tempValues = this.$el.find(".slider").dragslider("option", "values");
      finalValues = [];
      if (this.model.get("invert") === "true") {
        finalValues[1] = this.$el.find(".slider").dragslider("option", "max") - (tempValues[0] - this.$el.find(".slider").dragslider("option", "min"));
        finalValues[0] = this.$el.find(".slider").dragslider("option", "max") - (tempValues[1] - this.$el.find(".slider").dragslider("option", "min"));
      } else {
        finalValues = tempValues;
      }
      this.feedbackTextMin.val(this.valFromSlider(finalValues[0]));
      this.feedbackTextMax.val(this.valFromSlider(finalValues[1]));
      this.updateOutput("min", this.valFromSlider(finalValues[0]));
      return this.updateOutput("max", this.valFromSlider(finalValues[1]));
    };

    RangeControlView.prototype.valFromSlider = function(value) {
      if (this.currentFormat === "JustDrop" && this.model.get("range").length > 0) {
        return this.model.get("range")[value].value;
      } else {
        return value;
      }
    };

    RangeControlView.prototype.getLongestString = function(range, step) {
      var result;
      result = this.valFromSlider(range[0]);
      if (String(result).length < String(this.valFromSlider(range[1])).length) {
        result = this.valFromSlider(range[1]);
      }
      if (String(result).length < String(this.valFromSlider(range[1] - step)).length) {
        result = this.valFromSlider(range[1] - step);
      }
      return result;
    };

    return RangeControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.RangeControlModel = (function(_super) {
    __extends(RangeControlModel, _super);

    function RangeControlModel() {
      _ref = RangeControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RangeControlModel.behaviors = ["quadrigram.Models.LayoutBehavior", "quadrigram.Models.TextStyleBehavior"];

    RangeControlModel.meta = {
      name: "Slider",
      outputs: {
        min: {
          outputType: "style",
          "default": 0,
          label: "Start value"
        },
        max: {
          outputType: "style",
          "default": 0,
          label: "End value"
        }
      },
      properties: {
        showNumber: {
          label: "Show selected value",
          family: "style",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        range: {
          label: "Range of the slider",
          family: "data",
          hidden: false,
          sortingWeight: "1",
          formats: {
            Range: {
              multiValues: {
                start: false,
                end: false,
                step: false
              },
              defaults: {
                start: "0",
                end: "100",
                step: "1"
              }
            },
            JustDrop: {
              multiValues: {
                value: false
              }
            }
          }
        },
        initValue: {
          label: "Init values",
          family: "data",
          hidden: false,
          sortingWeight: "2",
          formats: {
            SimpleRange: {
              multiValues: {
                min: false,
                max: false
              },
              defaults: {
                min: "",
                max: ""
              }
            },
            JustDrop: {
              multiValues: {
                value: false
              }
            }
          }
        },
        invert: {
          label: "Invert the direction of the range",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "false"
              }
            }
          }
        },
        handleColor: {
          label: "Handle color",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#ddd"
              }
            }
          }
        },
        handleShape: {
          label: "Handle shape",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Bar"
              },
              options: {
                value: ["Bar", "Circle"]
              }
            }
          }
        },
        grooveColor: {
          label: "Track color",
          family: "style",
          hidden: true,
          sortingWeight: "0",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#616161"
              }
            }
          }
        },
        rangeColor: {
          label: "Groove color",
          family: "style",
          hidden: true,
          sortingWeight: "0",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#aaa"
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: 6
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: 1
              }
            }
          }
        }
      }
    };

    RangeControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(RangeControlModel.meta, RangeControlModel.behaviors);
      return output;
    };

    return RangeControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.TableControlView = (function(_super) {
    __extends(TableControlView, _super);

    function TableControlView() {
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = TableControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TableControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    TableControlView.prototype.viewDidRender = function() {
      this.behaviors.layout.root.append("div").attr("class", "table-control");
      /*
      @hot = new Handsontable(@$el.find(".hot-container")[0],
          #data: fullData.contentData,
          #colHeaders:  fullData.headerData,
          #TAMAO CELDAS
          #colWidths: 150,
          #rowHeights: 40,
          
          fixedColumnsLeft: 1
          #afterGetColHeader: @headerPostRenderer,
          #afterRenderer: @addBlockIfNeeded,
          wordWrap: false,
          #multiSelect: false,
          fragmentSelection: true,
          #columns: columnsArray,
          manualColumnResize: true,
      
      
          cells: (row, col, prop) ->
            {readOnly: true}
        )
      */

      this.tableView = new quadrigram.Views.TableView;
      return this.$el.find(".table-control").append(this.tableView.$el);
    };

    TableControlView.prototype.updateItems = function() {
      var dataProp;
      dataProp = this.model.original.get("propertiesCollection").findWhere({
        "propId": "data"
      });
      if (dataProp != null) {
        this.tableView.model = dataProp.getBlocks()[0];
        return this.tableView.render();
      }
    };

    return TableControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.TableControlModel = (function(_super) {
    __extends(TableControlModel, _super);

    function TableControlModel() {
      _ref = TableControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    TableControlModel.behaviors = ["quadrigram.Models.LayoutBehavior", "quadrigram.Models.MessagesBehavior", "quadrigram.Models.TwoDimDataControllerBehavior"];

    TableControlModel.meta = {
      name: "Table",
      outputs: {
        value: {
          outputType: "style",
          "default": 0,
          label: "Slider position"
        }
      },
      properties: {
        "data": {
          "uiTipContent": "Insert a block with columns of numbers to be represented as a table",
          "label": "Data to plot in line",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "formats": {
            "Number": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example Data"
              },
              "defaults": {
                "value": [
                  {
                    "id": 1,
                    "name": "dummy data",
                    "value": [
                      {
                        "id": 1,
                        "value": 20
                      }, {
                        "id": 2,
                        "value": 10
                      }, {
                        "id": 3,
                        "value": 15
                      }, {
                        "id": 4,
                        "value": 30
                      }, {
                        "id": 5,
                        "value": 20
                      }, {
                        "id": 6,
                        "value": 50
                      }, {
                        "id": 7,
                        "value": 50
                      }, {
                        "id": 8,
                        "value": 60
                      }
                    ]
                  }, {
                    "id": 2,
                    "name": "dummy data",
                    "value": [
                      {
                        "id": 1,
                        "value": 10
                      }, {
                        "id": 2,
                        "value": 20
                      }, {
                        "id": 3,
                        "value": 25
                      }, {
                        "id": 4,
                        "value": 30
                      }, {
                        "id": 5,
                        "value": 30
                      }, {
                        "id": 6,
                        "value": 45
                      }, {
                        "id": 7,
                        "value": 51
                      }, {
                        "id": 8,
                        "value": 32
                      }
                    ]
                  }, {
                    "id": 3,
                    "name": "dummy data",
                    "value": [
                      {
                        "id": 1,
                        "value": 20
                      }, {
                        "id": 2,
                        "value": 12
                      }, {
                        "id": 3,
                        "value": 20
                      }, {
                        "id": 4,
                        "value": 40
                      }, {
                        "id": 5,
                        "value": 30
                      }, {
                        "id": 6,
                        "value": 25
                      }, {
                        "id": 7,
                        "value": 11
                      }, {
                        "id": 8,
                        "value": 22
                      }
                    ]
                  }
                ]
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: 4
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: 4
              }
            }
          }
        }
      }
    };

    TableControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(TableControlModel.meta, TableControlModel.behaviors);
      return output;
    };

    return TableControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DropDownView = (function(_super) {
    __extends(DropDownView, _super);

    function DropDownView() {
      this.visualizerParentChanged = __bind(this.visualizerParentChanged, this);
      this.visualizerAfterDidUpdateItems = __bind(this.visualizerAfterDidUpdateItems, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.visualizerDidResize = __bind(this.visualizerDidResize, this);
      this.updateItems = __bind(this.updateItems, this);
      this.highlightOption = __bind(this.highlightOption, this);
      this.selectOption = __bind(this.selectOption, this);
      this.handleChange = __bind(this.handleChange, this);
      this.handleKeyDown = __bind(this.handleKeyDown, this);
      this.showContent = __bind(this.showContent, this);
      this.hideContent = __bind(this.hideContent, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DropDownView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DropDownView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    DropDownView.prototype.stylableTexts = [];

    DropDownView.prototype.viewDidRender = function() {
      var dropDownGroup, dropdDownContainer,
        _this = this;
      dropdDownContainer = this.behaviors.layout.root.append("div").attr("class", "drop-down-container");
      dropDownGroup = dropdDownContainer.append("did").attr("class", "drop-down-group");
      dropDownGroup.append("div").attr("class", "dropdown-label");
      this.label = this.$el.find(".dropdown-label");
      this.label.html("Select one: ");
      dropDownGroup.append("select").attr("class", "original-dropdown");
      this.selector = this.$el.find(".original-dropdown");
      this.selector.selectmenu({
        change: this.handleChange,
        appendTo: this.$el.closest(".gridster"),
        position: {
          my: "left top",
          at: "left bottom",
          collision: "flip"
        },
        open: function() {
          return $(window).on("keyup", _this.handleKeyDown);
        },
        close: function() {
          return $(window).off("keyup", _this.handleKeyDown);
        }
      });
      this.$el.find(".ui-selectmenu-button").css("width", this.$el.find(".ui-selectmenu-text").width());
      return this.hideContent();
    };

    DropDownView.prototype.hideContent = function() {
      return this.$el.css("opacity", "0");
    };

    DropDownView.prototype.showContent = function() {
      return this.$el.css("opacity", "1");
    };

    DropDownView.prototype.handleKeyDown = function(e, ui) {
      return this.highlightOption();
    };

    DropDownView.prototype.handleChange = function(e, ui) {
      var id;
      id = decodeURI(this.selector.val());
      return this.selectOption(id);
    };

    DropDownView.prototype.selectOption = function(id) {
      var option, value;
      option = _.findWhere(this.values, {
        id: id
      });
      if ((option == null) || (option.value == null)) {
        return;
      }
      value = option.value;
      this.updateOutput("value", [
        {
          id: id,
          value: value
        }
      ]);
      this.updateOutput("id", [
        {
          id: id,
          value: id
        }
      ]);
      this.updateOutput("selectedValues", [
        {
          id: id,
          value: value
        }
      ]);
      this.updateOutput("selectedIndexes", [
        {
          id: id,
          value: id
        }
      ]);
      return this.highlightOption();
    };

    DropDownView.prototype.highlightOption = function() {
      this.selector.selectmenu("menuWidget").find("li").css("background", this.model.get("dropDownColor"));
      this.selector.selectmenu("instance").menuInstance.active.css("background", this.model.get("highlightColor"));
      return this.selector.selectmenu("instance").menuInstance.element.parent().scrollTop(this.selector.selectmenu("instance").menuInstance.element.parent().scrollTop() + this.selector.selectmenu("instance").menuInstance.active.position().top);
    };

    DropDownView.prototype.updateItems = function() {
      var key, _i, _len, _ref1;
      this.items = this.behaviors.layout.root.selectAll(".item");
      if (this.model.get("LabelText") === "") {
        this.$el.find(".dropdown-label").addClass("hidden");
      } else {
        this.$el.find(".dropdown-label").removeClass("hidden");
        this.$el.find(".dropdown-label").html(this.model.get("LabelText"));
      }
      this.selector.empty();
      _ref1 = this.values;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        key = _ref1[_i];
        if (key.value != null) {
          this.selector.append($('<option value="' + encodeURI(key.id) + '">' + key.value + "</option>"));
        }
      }
      /*
      if @model.get("defaultSelection")!=""
        defaultOption = this.model.get("defaultSelection")
      
        for key in @values
          if key.value == defaultOption
            defaultId1 = key.id
          if key.id == encodeURI(defaultOption)
            defaultId2 = key.id
      
        if defaultId1?
          this.selector.val(defaultId1)
        else if defaultId2?
          this.selector.val(defaultId2)
          #optionEl = this.selector.find("[value="+defaultId1+"]")
      
      @selector.selectmenu("refresh")
      */

      this.stylableTexts = [];
      this.stylableTexts.push(".dropdown-label");
      this.stylableTexts.push(".ui-widget");
      this.stylableTexts.push(".ui-selectmenu-text");
      this.stylableTexts.push(this.selector.selectmenu("menuWidget").find(".ui-menu-item"));
      this.$el.find(".ui-icon-triangle-1-s").css("background-color", this.model.get("bkg_color"));
      if (this.model.get("dropDownColor") != null) {
        this.$el.find(".ui-icon-triangle-1-s").css("background-color", this.model.get("dropDownColor"));
        this.selector.selectmenu("menuWidget").find(".ui-menu-item").css("background", this.model.get("dropDownColor"));
        this.$el.find(".ui-selectmenu-button").css("background", this.model.get("dropDownColor"));
      }
      if (this.model.get("borderColor") != null) {
        this.selector.selectmenu("menuWidget").find(".ui-menu-item").css("outline", "solid 1px " + this.model.get("borderColor"));
        this.selector.selectmenu("menuWidget").parent().css("border", "solid 1px " + this.model.get("borderColor"));
        return this.$el.find(".ui-selectmenu-button").css("border-color", this.model.get("borderColor"));
      }
    };

    DropDownView.prototype.visualizerDidResize = function() {
      return this.visualizerAfterDidUpdateItems();
    };

    DropDownView.prototype.visualizerDidUpdateItems = function() {
      var val;
      if (this.behaviors.selection.selectedItems.length === 0) {
        val = this.values[0].id;
      } else {
        val = this.behaviors.selection.selectedItems;
      }
      this.selector.val(encodeURI(val));
      this.selector.selectmenu('refresh');
      this.stylableTexts = [];
      this.stylableTexts.push(".dropdown-label");
      this.stylableTexts.push(".ui-widget");
      this.stylableTexts.push(".ui-selectmenu-text");
      this.stylableTexts.push(this.selector.selectmenu("menuWidget").find(".ui-menu-item"));
      return this.handleChange();
    };

    DropDownView.prototype.visualizerAfterDidUpdateItems = function() {
      var idx, left, longest, maxHeight, maxWidth, o, right, totalWidth, _i, _len, _ref1;
      left = 0;
      right = 0;
      maxWidth = 0;
      maxHeight = 0;
      totalWidth = 0;
      longest = {
        id: null,
        textLength: 0
      };
      _ref1 = this.values;
      for (idx = _i = 0, _len = _ref1.length; _i < _len; idx = ++_i) {
        o = _ref1[idx];
        if (longest.textLength < o.value.length) {
          longest.textLength = o.value.length;
          longest.id = o.id;
          longest.index = idx;
        }
      }
      maxWidth = $.fn.textWidth(this.selector.selectmenu("menuWidget").find(".ui-menu-item")[longest.index]);
      maxHeight = $.fn.textHeight(this.selector.selectmenu("menuWidget").find(".ui-menu-item")[longest.index]);
      left = maxHeight / 2 + maxHeight / 4;
      right = maxHeight;
      totalWidth = maxWidth + left + right;
      this.$el.find('.ui-selectmenu-button').css("width", Math.round(totalWidth) + "px");
      this.selector.selectmenu("menuWidget").parent().css("width", this.$el.find('.ui-selectmenu-button').css("width"));
      this.$el.find('.ui-icon').css("width", Math.round(maxHeight / 2) + "px");
      this.$el.find('.ui-icon').css("height", Math.round(maxHeight / 2) + "px");
      this.$el.find('.ui-icon').css("margin-right", Math.round(maxHeight / 4) + "px");
      this.$el.find('.ui-selectmenu-text').css("padding-left", Math.round(maxHeight / 2) + "px");
      this.$el.find('.ui-selectmenu-text').css("padding-right", Math.round(maxHeight) + "px");
      this.highlightOption();
      return this.showContent();
    };

    DropDownView.prototype.visualizerParentChanged = function() {
      return this.selector.selectmenu({
        appendTo: this.$currentParent
      });
    };

    return DropDownView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.DropDownModel = (function(_super) {
    __extends(DropDownModel, _super);

    function DropDownModel() {
      _ref = DropDownModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DropDownModel.behaviors = ["quadrigram.Models.TextListDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TextStyleBehavior", "quadrigram.Models.SelectionDOMBehavior"];

    DropDownModel.meta = {
      "name": "DropDown",
      outputs: {
        value: {
          deprecated: true,
          internal: true,
          outputType: "selection",
          "default": 0,
          label: "Selected option"
        },
        id: {
          deprecated: true,
          internal: true,
          outputType: "selection",
          "default": 0,
          label: "Selected option id"
        }
      },
      properties: {
        "data": {
          "label": "Items to be shown",
          "family": "data",
          "hidden": false,
          sortingWeight: "0",
          "formats": {
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": "Option 01"
                  }, {
                    "id": "2",
                    "value": "Option 02"
                  }, {
                    "id": "3",
                    "value": "Option 03"
                  }, {
                    "id": "4",
                    "value": "Option 04"
                  }, {
                    "id": "5",
                    "value": "Option 05"
                  }, {
                    "id": "6",
                    "value": "Option 06"
                  }, {
                    "id": "7",
                    "value": "Option 07"
                  }
                ]
              }
            }
          }
        },
        defaultSelection: {
          label: "Default selection",
          family: "selection",
          deprecated: true,
          internal: true,
          hidden: false,
          sortingWeight: "11",
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        LabelText: {
          label: "Title for the dropdown",
          family: "data",
          hidden: false,
          sortingWeight: "1",
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Select one: "
              }
            }
          }
        },
        borderColor: {
          label: "Outline color",
          family: "style",
          hidden: true,
          sortingWeight: "32",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#9e9e9e"
              }
            }
          }
        },
        dropDownColor: {
          label: "Dropdown background color",
          family: "style",
          hidden: true,
          sortingWeight: "31",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#fff"
              }
            }
          }
        },
        highlightColor: {
          label: "Selected item background color",
          family: "style",
          hidden: true,
          sortingWeight: "32",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#eee"
              }
            }
          }
        },
        "size_y": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "1"
              }
            }
          }
        },
        "size_x": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "3"
              }
            }
          }
        },
        "fillColors": {
          "internal": true
        },
        "fillOpacities": {
          "internal": true
        },
        "lineColors": {
          "internal": true
        },
        "lineThickness": {
          "internal": true
        },
        "lineOpacities": {
          "internal": true
        },
        "forceSelection": {
          "internal": true
        },
        "selectionMode": {
          "internal": true
        },
        "selectionFillColors": {
          "internal": true
        },
        "selectionFillOpacities": {
          "internal": true
        },
        "selectionLineColors": {
          "internal": true
        },
        "selectionLineThickness": {
          "internal": true
        },
        "selectionLineOpacities": {
          "internal": true
        },
        "selectionBold": {
          "internal": true
        }
      }
    };

    DropDownModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(DropDownModel.meta, DropDownModel.behaviors);
      return output;
    };

    return DropDownModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DynamicTextControlView = (function(_super) {
    __extends(DynamicTextControlView, _super);

    function DynamicTextControlView() {
      this.getScrollDomElement = __bind(this.getScrollDomElement, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = DynamicTextControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DynamicTextControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    DynamicTextControlView.prototype.stylableTexts = [".dynamic-text"];

    DynamicTextControlView.prototype.dontUseGif = true;

    DynamicTextControlView.prototype.viewDidRender = function() {
      return this.behaviors.layout.root.append("div").attr("class", "dynamic-text-container").append("div").attr("class", "dynamic-text");
    };

    DynamicTextControlView.prototype.updateItems = function() {
      var str, v, _i, _len, _ref1;
      str = "";
      _ref1 = this.values;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        v = _ref1[_i];
        str += v.value;
      }
      return this.$el.find(".dynamic-text").html(str);
    };

    DynamicTextControlView.prototype.getScrollDomElement = function() {
      return $(this.behaviors.layout.root[0]).find(".dynamic-text-container");
    };

    return DynamicTextControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.DynamicTextControlModel = (function(_super) {
    __extends(DynamicTextControlModel, _super);

    function DynamicTextControlModel() {
      _ref = DynamicTextControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DynamicTextControlModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TextListDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TextStyleBehavior"];

    DynamicTextControlModel.dontUseGif = true;

    DynamicTextControlModel.meta = {
      "name": "DynamicTextControl",
      properties: {
        "data": {
          "label": "Text",
          "family": "data",
          "hidden": false,
          "sortingWeight": "0",
          "formats": {
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "Dynamic text"
              }
            }
          }
        },
        "scroll_enabled": {
          "internal": false
        },
        "size_y": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "1"
              }
            }
          }
        },
        "size_x": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "3"
              }
            }
          }
        }
      }
    };

    DynamicTextControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(DynamicTextControlModel.meta, DynamicTextControlModel.behaviors);
      return output;
    };

    return DynamicTextControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PlayPauseControlView = (function(_super) {
    __extends(PlayPauseControlView, _super);

    function PlayPauseControlView() {
      this.valueChanged = __bind(this.valueChanged, this);
      this.handleButtonClicked = __bind(this.handleButtonClicked, this);
      this.checkAndUpdate = __bind(this.checkAndUpdate, this);
      this.prevStep = __bind(this.prevStep, this);
      this.nextStep = __bind(this.nextStep, this);
      this.stopInterval = __bind(this.stopInterval, this);
      this.pauseInterval = __bind(this.pauseInterval, this);
      this.resumeInterval = __bind(this.resumeInterval, this);
      this.setActiveColor = __bind(this.setActiveColor, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = PlayPauseControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PlayPauseControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    PlayPauseControlView.prototype.buttonTemplate = JST['app/scripts/templates/visualizers/playPauseButton.hbs'];

    PlayPauseControlView.prototype.viewDidRender = function() {
      var container, group,
        _this = this;
      container = this.behaviors.layout.root.append("div").attr("class", "play-pause-control");
      group = container.append("div").attr("class", "control-btn-group");
      this.group = this.$el.find(".control-btn-group");
      this.group.append(this.buttonTemplate("play"));
      this.group.append(this.buttonTemplate("pause"));
      this.group.append(this.buttonTemplate("stop"));
      this.group.append(this.buttonTemplate("prev"));
      this.group.append(this.buttonTemplate("next"));
      this.$el.find(".play-pause-control").append("<div class='progress-container'><div class='control-progress-bar progress-bar'></div></div>");
      this.group.find(".control-btn").on("click", this.handleButtonClicked);
      return this.$el.find("img").each(function(i, el) {
        return $.fn.convertToDynamicSvg($(el), _this.updateItems);
      });
    };

    PlayPauseControlView.prototype.updateItems = function() {
      this.step = 0;
      this.totalSteps = this.model.get("data").length - 1;
      this.timeStep = Number(this.model.get("timeStep")) * 1000;
      if (this.model.get("showProgress") === "true") {
        this.$el.find(".control-progress-bar").removeClass("hidden");
      } else {
        this.$el.find(".control-progress-bar").addClass("hidden");
      }
      if (this.model.get("showStepButtons") === "true") {
        this.$el.find(".prev-btn").removeClass("hidden");
        this.$el.find(".next-btn").removeClass("hidden");
      } else {
        this.$el.find(".prev-btn").addClass("hidden");
        this.$el.find(".next-btn").addClass("hidden");
      }
      if (this.model.get("iconSize") != null) {
        this.$el.find(".control-btn svg").attr("width", this.model.get("iconSize"));
        this.$el.find(".control-btn svg").attr("height", this.model.get("iconSize"));
        this.$el.find(".control-progress-bar").css("height", (this.model.get("iconSize").replace("px", "") / 20) + "px");
      }
      if (this.model.get("iconColor") != null) {
        this.$el.find(".svg-control-icon").find("path, rect, polygon").css("fill", this.model.get("iconColor"));
      }
      if (this.model.get("activeColor") != null) {
        this.$el.find(".control-progress-bar").css("background-color", this.model.get("activeColor"));
      }
      return this.valueChanged();
    };

    PlayPauseControlView.prototype.setActiveColor = function(className) {
      var activeColor, originalColor;
      activeColor = this.model.get("activeColor") || "#3D5AFE";
      originalColor = this.model.get("iconColor") || "#000";
      this.$el.find(".svg-control-icon").find("path, rect, polygon").css("fill", originalColor);
      if (className !== "") {
        return this.$el.find(className).find("path, rect, polygon").css("fill", activeColor);
      }
    };

    PlayPauseControlView.prototype.resumeInterval = function() {
      var _this = this;
      this.setActiveColor(".play-btn");
      this.paused = false;
      this.step++;
      this.checkAndUpdate();
      clearTimeout(this.timeout);
      return this.timeout = setTimeout(function() {
        if (!_this.paused) {
          return _this.resumeInterval();
        }
      }, this.timeStep);
    };

    PlayPauseControlView.prototype.pauseInterval = function() {
      this.paused = true;
      clearTimeout(this.timeout);
      if (this.step !== this.totalSteps && this.step !== 0) {
        this.setActiveColor(".pause-btn");
      } else {
        this.setActiveColor("");
      }
      return this.checkAndUpdate();
    };

    PlayPauseControlView.prototype.stopInterval = function() {
      this.setActiveColor("");
      this.step = 0;
      return this.pauseInterval();
    };

    PlayPauseControlView.prototype.nextStep = function() {
      this.setActiveColor("");
      this.step++;
      this.pauseInterval();
      return this.checkAndUpdate();
    };

    PlayPauseControlView.prototype.prevStep = function() {
      this.setActiveColor("");
      this.step--;
      this.pauseInterval();
      return this.checkAndUpdate();
    };

    PlayPauseControlView.prototype.checkAndUpdate = function() {
      if (this.step < 0) {
        this.step = 0;
      }
      if (this.step > this.totalSteps) {
        if (this.model.get("loop") === "true") {
          this.step = 0;
        } else {
          this.step = this.totalSteps;
        }
      }
      if (this.step === this.totalSteps) {
        this.setActiveColor(".pause-btn");
      }
      if (this.step === 0) {
        this.setActiveColor("");
      }
      this.$el.find(".control-progress-bar").css("width", (100 * this.step / this.totalSteps) + "%");
      return this.valueChanged();
    };

    PlayPauseControlView.prototype.handleButtonClicked = function(e) {
      var tragetId;
      tragetId = $(e.currentTarget).attr("data-id");
      switch (tragetId) {
        case "play":
          return this.resumeInterval();
        case "pause":
          return this.pauseInterval();
        case "stop":
          return this.stopInterval();
        case "next":
          return this.nextStep();
        case "prev":
          return this.prevStep();
      }
    };

    PlayPauseControlView.prototype.valueChanged = function() {
      log("updateing: ", this.model.get("data")[this.step]);
      if (this.model.get("data")[this.step]) {
        this.updateOutput("id", this.model.get("data")[this.step].id);
        if (_.isArray(this.model.get("data")[this.step].value)) {
          return this.updateOutput("value", this.model.get("data")[this.step].value, {
            valueLabel: this.model.get("data")[this.step].id,
            idLabel: "id"
          });
        } else {
          return this.updateOutput("value", this.model.get("data")[this.step].value);
        }
      } else {
        return this.updateOutput("value", "");
      }
    };

    return PlayPauseControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PlayPauseControlModel = (function(_super) {
    __extends(PlayPauseControlModel, _super);

    function PlayPauseControlModel() {
      _ref = PlayPauseControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PlayPauseControlModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TextListDataControllerBehavior", "quadrigram.Models.LayoutBehavior"];

    PlayPauseControlModel.meta = {
      name: "Slider",
      outputs: {
        value: {
          outputType: "data",
          "default": 0,
          label: "Current value"
        },
        id: {
          outputType: "data",
          "default": 0,
          label: "Current id"
        }
      },
      properties: {
        "data": {
          "uiTipContent": "List to iterate through",
          "label": "List of values",
          "family": "data",
          "sortingWeight": "1",
          "hidden": false,
          "formats": {
            "Text": {
              "multiValues": {
                "value": true
              },
              "defaultsNames": {
                "value": "Example data"
              },
              "defaults": {
                "value": [
                  {
                    "id": "1",
                    "value": 10
                  }, {
                    "id": "2",
                    "value": 20
                  }, {
                    "id": "3",
                    "value": 30
                  }, {
                    "id": "4",
                    "value": 40
                  }, {
                    "id": "5",
                    "value": 50
                  }
                ]
              }
            }
          }
        },
        iconColor: {
          label: "Icon color",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#444"
              }
            }
          }
        },
        activeColor: {
          label: "Color of the active icon",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#3D5AFE"
              }
            }
          }
        },
        iconSize: {
          label: "Icon size",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Px: {
              multiValues: {
                value: true
              },
              defaults: {
                value: "40px"
              }
            }
          }
        },
        timeStep: {
          label: "Step duration",
          uiTipContent: "Time (in seconds) between steps",
          family: "data",
          hidden: true,
          sortingWeight: "3",
          formats: {
            Number: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "2"
              }
            }
          }
        },
        loop: {
          label: "Loop",
          uiTipContent: "Loop the steps when finished",
          family: "data",
          hidden: true,
          sortingWeight: "4",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "false"
              }
            }
          }
        },
        showProgress: {
          label: "Show a progress bar",
          family: "style",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        showStepButtons: {
          label: "Show Next/Prev buttons",
          family: "style",
          hidden: false,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: 4
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: 1
              }
            }
          }
        }
      }
    };

    PlayPauseControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(PlayPauseControlModel.meta, PlayPauseControlModel.behaviors);
      return output;
    };

    return PlayPauseControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.LegendControlView = (function(_super) {
    __extends(LegendControlView, _super);

    function LegendControlView() {
      this.getScrollDomElement = __bind(this.getScrollDomElement, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = LegendControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LegendControlView.prototype.followMouse = false;

    LegendControlView.prototype.stylableTexts = [".legend-container", ".legend-label"];

    LegendControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    LegendControlView.prototype.mainColorDimension = "data";

    LegendControlView.prototype.viewDidRender = function() {
      this.legendContent = this.behaviors.layout.root.append("div").attr("class", "legend-content");
      this.tableContainer = this.legendContent.append("div").attr("class", "legend-table-wrapper");
      return this.legendContainer = this.tableContainer.append("div").attr("class", "legend-container");
    };

    LegendControlView.prototype.updateItems = function() {
      var iconClass, self;
      this.items = this.legendContainer.selectAll(".item").data(this.values, function(d, i) {
        return d.id;
      });
      this.items.exit().remove();
      this.itemsEnter = this.items.enter().append("div").attr("class", "item legend-item");
      this.itemsEnter.append("div").attr("class", "legend-icon-container").append("svg").attr("class", "legend-icon");
      this.itemsEnter.append("div").attr("class", "legend-label-container").append("div").attr("class", "legend-label weighted-text");
      iconClass = this.model.get("iconShape");
      self = this;
      if (this.model.get("data").currentFormat === "Color") {
        this.items.each(function(d, i) {
          return d3.select(this).select(".legend-label").text(d.id);
          /*
          d3.select(@).select(".legend-icon")
            .classed("line",iconClass=="line")
            .classed("circle",iconClass=="circle")
            .classed("square",iconClass=="square")
          */

        });
      } else if (this.model.get("data").currentFormat === "Number") {
        this.items.each(function(d, i) {
          d3.select(this).select(".legend-label").text(d.id);
          return d3.select(this).select(".legend-icon").style("width", d.value + "px").style("height", d.value + "px").classed("line", iconClass === "line").classed("circle", iconClass === "circle").classed("square", iconClass === "square");
        });
      }
      if (this.model.get("data").currentFormat === "Color") {
        this.model.set("fillColors", this.model.get("data"), {
          silent: true
        });
      } else if (this.model.get("data").currentFormat === "Number") {
        this.model.set("fillColors", "#ddd", {
          silent: true
        });
      }
      return this.items.each(function(d, i) {
        return $(this).parent().append(this);
      });
    };

    LegendControlView.prototype.visualizerDidUpdateItems = function() {
      var iconSize, maxHeight, maxWidth, self;
      maxWidth = 0;
      maxHeight = 0;
      this.items.each(function(d, i) {
        var h, w;
        w = d3.select(this).select(".legend-label")[0][0].clientWidth;
        h = d3.select(this).select(".legend-label")[0][0].clientHeight;
        if (maxWidth < Math.round(w)) {
          maxWidth = Math.round(w);
        }
        if (maxHeight < Math.round(h)) {
          return maxHeight = Math.round(h);
        }
      });
      if (this.model.get("data").currentFormat === "Number") {
        iconSize = 0;
        this.items.each(function(d, i) {
          if (Number(d.value) > iconSize) {
            return iconSize = Number(d.value);
          }
        });
      } else {
        iconSize = maxHeight;
      }
      self = this;
      this.items.each(function(d, i) {
        var shape, size;
        if (self.model.get("textAlign") === "left") {
          d3.select(this).style("width", (iconSize + maxWidth + 10) + "px");
          d3.select(this).style("height", iconSize + "px");
        } else {
          d3.select(this).style("width", "");
          d3.select(this).style("height", "");
        }
        d3.select(this).select(".legend-icon-container").style("width", iconSize + "px").style("height", iconSize + "px");
        d3.select(this).select(".legend-icon").style("width", Math.ceil(iconSize) + "px").style("height", Math.ceil(iconSize) + "px").style("margin-top", (iconSize - Math.ceil(0.85 * iconSize)) / 2 + "px");
        shape = self.behaviors.selection.behaviors.items.styleItems[d.id].shapeType;
        size = Math.ceil(0.85 * iconSize) / 2;
        self.behaviors.svgshapes.drawShape(d3.select(this).select(".legend-icon"), shape, size);
        d3.select(this).select(".legend-icon").select("path").attr("transform", "translate(" + Math.ceil(iconSize) / 2 + "," + Math.ceil(iconSize) / 2 + ")");
        return d3.select(this).select(".legend-icon").select("path").classed("item-child", true);
      });
      this.model.set("fillColors", this.model.get("data"), {
        silent: true
      });
      this.model.set("cellHeight", "100%", {
        silent: true
      });
      return this.behaviors.selection.behaviors.items.updateConfig({});
    };

    LegendControlView.prototype.getScrollDomElement = function() {
      return $(this.behaviors.layout.root[0]).find(".legend-container");
    };

    return LegendControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.LegendControlModel = (function(_super) {
    __extends(LegendControlModel, _super);

    function LegendControlModel() {
      _ref = LegendControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    LegendControlModel.behaviors = ["quadrigram.Models.MessagesBehavior", "quadrigram.Models.TextListDataControllerBehavior", "quadrigram.Models.LayoutBehavior", "quadrigram.Models.TextStyleBehavior", "quadrigram.Models.SVGShapesBehavior", "quadrigram.Models.SelectionDOMwithSVGBehavior"];

    LegendControlModel.meta = {
      name: "Legend",
      properties: {
        "data": {
          "label": "Items to be shown",
          "family": "data",
          "hidden": false,
          "sortingWeight": "0",
          "formats": {
            "Color": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": [
                  {
                    "id": "Item 1",
                    "value": "rgb(13, 113, 146)"
                  }, {
                    "id": "Item 2",
                    "value": "rgb(127, 204, 109)"
                  }, {
                    "id": "Item 3",
                    "value": "rgb(253, 216, 53)"
                  }, {
                    "id": "Item 4",
                    "value": "rgb(246, 149, 67)"
                  }, {
                    "id": "Item 5",
                    "value": "rgb(187, 48, 80)"
                  }
                ]
              }
            }
          }
        },
        iconShape: {
          internal: true,
          deprecated: true,
          label: "Shape of the icons",
          family: "style",
          hidden: true,
          sortingWeight: "28",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "circle"
              },
              options: {
                value: ["circle", "square", "line"]
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: 4
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: 1
              }
            }
          }
        },
        "fillColors": {
          "internal": true,
          "formats": {
            "Color": {
              "defaults": {
                "value": "#000"
              }
            }
          }
        },
        "fillOpacities": {
          "internal": true
        },
        "lineColors": {
          "internal": true
        },
        "lineThickness": {
          "internal": true,
          "formats": {
            "Px": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "0px"
              }
            }
          }
        },
        "lineOpacities": {
          "internal": true
        },
        "forceSelection": {
          "internal": true
        },
        "selectionMode": {
          "sortingWeight": "1",
          "formats": {
            "Options": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "no selection"
              }
            }
          }
        },
        "selectedItems": {
          "sortingWeight": "2",
          "hidden": true
        },
        "selectionFillColors": {
          "internal": true
        },
        "selectionFillOpacities": {
          "internal": true
        },
        "selectionLineColors": {
          "internal": false
        },
        "selectionLineThickness": {
          "internal": false,
          "formats": {
            "Px": {
              "multiValues": {
                "value": true
              },
              "defaults": {
                "value": "2px"
              }
            }
          }
        },
        "selectionLineOpacities": {
          "internal": true
        },
        "selectionBold": {
          "internal": true,
          "formats": {
            "Boolean": {
              "defaults": {
                "value": "true"
              }
            }
          }
        },
        "shapeSize": {
          "internal": true
        },
        "shapeType": {
          "label": "Shape of each icon"
        }
      }
    };

    LegendControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(LegendControlModel.meta, LegendControlModel.behaviors);
      return output;
    };

    return LegendControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

  /*
  "Number":
                  "multiValues":
                    "value": true
                  "defaults":
                        "value":
                            [
                                {
                                    "id": "Small",
                                    "value": "10"
                                },
                                {
                                    "id": "Medium",
                                    "value": "20"
                                },
                                {
                                    "id": "Large",
                                    "value": "30"
                                }
                            ]
  */


}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.IFrameControlView = (function(_super) {
    __extends(IFrameControlView, _super);

    function IFrameControlView() {
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = IFrameControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    IFrameControlView.prototype.template = JST['app/scripts/templates/visualizers/rectangle.hbs'];

    IFrameControlView.prototype.viewWillRender = function() {
      this.values = [];
      return this.ids = [];
    };

    IFrameControlView.prototype.viewDidRender = function() {
      this.$iframe = $("<iframe class='i-frame'/>");
      return this.$el.append(this.$iframe);
    };

    IFrameControlView.prototype.updateItems = function() {
      return this.$iframe.attr("src", this.model.get("iframeURL"));
    };

    return IFrameControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.IFrameControlModel = (function(_super) {
    __extends(IFrameControlModel, _super);

    function IFrameControlModel() {
      _ref = IFrameControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    IFrameControlModel.behaviors = ["quadrigram.Models.LayoutBehavior"];

    IFrameControlModel.meta = {
      "name": "iframe",
      "properties": {
        "iframeURL": {
          "uiTipContent": "URL to the iframe to be embeded",
          "label": "URL",
          "family": "data",
          "sortingWeight": "82",
          "hidden": false,
          "formats": {
            "Text": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "bkg_image": {
          internal: true
        },
        "bkg_color": {
          internal: true
        },
        "bkg_opacity": {
          internal: true
        }
      }
    };

    IFrameControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(IFrameControlModel.meta, IFrameControlModel.behaviors);
      return output;
    };

    return IFrameControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.YoutubeControlView = (function(_super) {
    __extends(YoutubeControlView, _super);

    function YoutubeControlView() {
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = YoutubeControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    YoutubeControlView.prototype.template = JST['app/scripts/templates/visualizers/rectangle.hbs'];

    YoutubeControlView.prototype.viewWillRender = function() {
      this.values = [];
      return this.ids = [];
    };

    YoutubeControlView.prototype.viewDidRender = function() {
      this.$iframe = $("<iframe class='i-frame'/>");
      return this.$el.append(this.$iframe);
    };

    YoutubeControlView.prototype.updateItems = function() {
      var ID, url;
      ID = this.YouTubeGetID(this.model.get("youtubeID"));
      url = "http://www.youtube.com/embed/" + ID;
      url += "?";
      if (this.model.get("autoPlay") === "true") {
        url += "autoplay=1;";
      }
      if (this.model.get("showControls") === "false") {
        url += "controls=0;";
      }
      url += "modestbranding=1;";
      url += "rel=0;";
      url += "showinfo=0;";
      return this.$iframe.attr("src", url);
    };

    YoutubeControlView.prototype.YouTubeGetID = function(url) {
      var ID;
      ID = '';
      url = url.replace(/(>|<)/gi, '').split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/);
      if (url[2] !== void 0) {
        ID = url[2].split(/[^0-9a-z_\-]/i);
        ID = ID[0];
      } else {
        ID = url;
      }
      return ID;
    };

    return YoutubeControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.YoutubeControlModel = (function(_super) {
    __extends(YoutubeControlModel, _super);

    function YoutubeControlModel() {
      _ref = YoutubeControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    YoutubeControlModel.behaviors = ["quadrigram.Models.LayoutBehavior"];

    YoutubeControlModel.meta = {
      "name": "iframe",
      "properties": {
        "youtubeID": {
          "uiTipContent": "Youtube id of the video to load",
          "label": "Youtube URL (or video Id)",
          "family": "data",
          "sortingWeight": "82",
          "hidden": false,
          "formats": {
            "Text": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": ""
              }
            }
          }
        },
        "showControls": {
          "uiTipContent": "Show or hide the play controls and progress bar",
          "label": "Show controls",
          "family": "style",
          "sortingWeight": "82",
          "hidden": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "false"
              }
            }
          }
        },
        "autoPlay": {
          "uiTipContent": "Start playing automaically when loaded",
          "label": "Auto play",
          "family": "data",
          "sortingWeight": "82",
          "hidden": false,
          "formats": {
            "Boolean": {
              "multiValues": {
                "value": false
              },
              "defaults": {
                "value": "false"
              }
            }
          }
        },
        "bkg_image": {
          internal: true
        },
        "bkg_color": {
          internal: true
        },
        "bkg_opacity": {
          internal: true
        }
      }
    };

    YoutubeControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(YoutubeControlModel.meta, YoutubeControlModel.behaviors);
      return output;
    };

    return YoutubeControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ImageControlView = (function(_super) {
    __extends(ImageControlView, _super);

    function ImageControlView() {
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ImageControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ImageControlView.prototype.template = JST['app/scripts/templates/visualizers/rectangle.hbs'];

    ImageControlView.prototype.viewWillRender = function() {
      this.values = [];
      return this.ids = [];
    };

    return ImageControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ImageControlModel = (function(_super) {
    __extends(ImageControlModel, _super);

    function ImageControlModel() {
      _ref = ImageControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ImageControlModel.behaviors = ["quadrigram.Models.LayoutBehavior"];

    ImageControlModel.meta = {
      "name": "Image",
      "properties": {
        "bkg_image": {
          "sortingWeight": "0",
          "hidden": false,
          "label": "Image"
        }
      }
    };

    ImageControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ImageControlModel.meta, ImageControlModel.behaviors);
      return output;
    };

    return ImageControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ShareButtonsControlView = (function(_super) {
    __extends(ShareButtonsControlView, _super);

    function ShareButtonsControlView() {
      this.setURLS = __bind(this.setURLS, this);
      this.updateItems = __bind(this.updateItems, this);
      this.clickHandler = __bind(this.clickHandler, this);
      this.handleMouseLeave = __bind(this.handleMouseLeave, this);
      this.handleMouseEnter = __bind(this.handleMouseEnter, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ShareButtonsControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ShareButtonsControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    ShareButtonsControlView.prototype.buttonTemplate = JST['app/scripts/templates/visualizers/shareButton.hbs'];

    ShareButtonsControlView.prototype.shareTypes = {
      Facebook: {
        defaultColor: "#3C5B99"
      },
      Twitter: {
        defaultColor: "#00ACED"
      },
      Google: {
        defaultColor: "#DC4B38"
      },
      Tumblr: {
        defaultColor: "#44546A"
      },
      Pinterest: {
        defaultColor: "#CA2027"
      },
      Reddit: {
        defaultColor: "#FF4500"
      },
      Linkedin: {
        defaultColor: "#007BB6"
      },
      Wordpress: {
        defaultColor: "#464646"
      }
    };

    ShareButtonsControlView.prototype.viewWillRender = function() {
      this.values = [];
      return this.ids = [];
    };

    ShareButtonsControlView.prototype.viewDidRender = function() {
      var container, group, type,
        _this = this;
      container = this.behaviors.layout.root.append("div").attr("class", "share-buttons-control");
      group = container.append("div").attr("class", "control-btn-group");
      this.group = this.$el.find(".control-btn-group");
      for (type in this.shareTypes) {
        this.group.append(this.buttonTemplate(type));
      }
      this.$el.find("img").each(function(i, el) {
        return $.fn.convertToDynamicSvg($(el), _this.updateItems);
      });
      this.$el.find(".control-btn").on("mouseenter", this.handleMouseEnter);
      return this.$el.find(".control-btn").on("mouseleave", this.handleMouseLeave);
    };

    ShareButtonsControlView.prototype.handleMouseEnter = function(e) {
      if (this.model.get("iconColor") !== "@QDeactivatedWord") {
        $(e.currentTarget).find(".circle").css("background", this.model.get("iconColor"));
      } else {
        $(e.currentTarget).find(".circle").css("background", this.shareTypes[$(e.currentTarget).attr("data-id")].defaultColor);
      }
      if (this.model.get("bkg_color") !== "none") {
        return $(e.currentTarget).find("svg").attr("fill", this.model.get("bkg_color"));
      } else {
        return $(e.currentTarget).find("svg").attr("fill", "#fff");
      }
    };

    ShareButtonsControlView.prototype.handleMouseLeave = function(e) {
      this.$el.find(".circle").css("background", "none");
      if (this.model.get("iconColor") !== "@QDeactivatedWord") {
        return $(e.currentTarget).find("svg").attr("fill", this.model.get("iconColor"));
      } else {
        return $(e.currentTarget).find("svg").attr("fill", this.shareTypes[$(e.currentTarget).attr("data-id")].defaultColor);
      }
    };

    ShareButtonsControlView.prototype.clickHandler = function(e) {};

    ShareButtonsControlView.prototype.updateItems = function() {
      var circleSize, size, svgSize, type, _results;
      this.setURLS();
      size = Number(this.model.get("iconSize").replace("px", ""));
      svgSize = Math.floor(size * 0.8);
      for (type in this.shareTypes) {
        if (this.model.get("show" + type) === "true") {
          this.$el.find("." + type + "-btn").removeClass("hidden");
        } else {
          this.$el.find("." + type + "-btn").addClass("hidden");
        }
        this.$el.find("." + type + "-btn").find("svg").attr("width", svgSize).attr("height", svgSize);
      }
      circleSize = size + "px";
      this.$el.find(".circle").css("width", circleSize).css("height", circleSize);
      if (this.model.get("iconColor") !== "@QDeactivatedWord") {
        this.$el.find(".circle").css("background", this.model.get("iconColor") + " !important");
        return this.$el.find("svg").attr("fill", this.model.get("iconColor"));
      } else {
        _results = [];
        for (type in this.shareTypes) {
          _results.push(this.$el.find("." + type + "-btn").find("svg").attr("fill", this.shareTypes[type].defaultColor));
        }
        return _results;
      }
    };

    ShareButtonsControlView.prototype.setURLS = function() {
      var projectTitle, projectURL, sourceURL;
      projectTitle = this.model.get("postTitle");
      projectURL = window.location.href;
      sourceURL = "http%3A%2F%2Fwww.quadrigram.com";
      this.$el.find(".Facebook-btn").attr("href", "https://www.facebook.com/sharer/sharer.php?u=" + projectURL + "&t=" + projectTitle);
      this.$el.find(".Twitter-btn").attr("href", "https://twitter.com/intent/tweet?source=" + sourceURL + "&text=" + projectTitle + "%20-%20" + projectURL);
      this.$el.find(".Google-btn").attr("href", "https://plus.google.com/share?url=" + projectURL);
      this.$el.find(".Tumblr-btn").attr("href", "http://www.tumblr.com/share?v=3&u=" + projectURL + "&t=" + projectTitle + "&s=");
      this.$el.find(".Pinterest-btn").attr("href", "http://pinterest.com/pin/create/button/?url=" + projectURL + "&description=" + projectTitle);
      this.$el.find(".Reddit-btn").attr("href", "http://www.reddit.com/submit?url=" + projectURL + "&title=" + projectTitle);
      this.$el.find(".Linkedin-btn").attr("href", "http://www.linkedin.com/shareArticle?mini=true&url=" + projectURL + "&title=" + projectTitle);
      return this.$el.find(".Wordpress-btn").attr("href", "http://wordpress.com/press-this.php?u=" + projectURL + "&t=" + projectTitle);
    };

    return ShareButtonsControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ShareButtonsControlModel = (function(_super) {
    __extends(ShareButtonsControlModel, _super);

    function ShareButtonsControlModel() {
      _ref = ShareButtonsControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ShareButtonsControlModel.behaviors = ["quadrigram.Models.LayoutBehavior"];

    ShareButtonsControlModel.meta = {
      name: "shareButtons",
      properties: {
        iconColor: {
          label: "Icon color",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Deactivated: {
              label: "Default colors",
              multiValues: {
                value: false
              }
            },
            Color: {
              label: "Single color",
              multiValues: {
                value: false
              },
              defaults: {
                value: "#000"
              }
            }
          }
        },
        iconSize: {
          label: "Icon size",
          family: "style",
          hidden: false,
          sortingWeight: "0",
          formats: {
            Px: {
              multiValues: {
                value: true
              },
              defaults: {
                value: "40px"
              }
            }
          }
        },
        showFacebook: {
          label: "Show Facebook button",
          family: "data",
          hidden: true,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        showTwitter: {
          label: "Show Facebook button",
          family: "data",
          hidden: true,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        showGoogle: {
          label: "Show Google+ button",
          family: "data",
          hidden: true,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        showTumblr: {
          label: "Show Tumblr button",
          family: "data",
          hidden: true,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        showPinterest: {
          label: "Show Pinterest button",
          family: "data",
          hidden: true,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        showReddit: {
          label: "Show Reddit button",
          family: "data",
          hidden: true,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        showLinkedin: {
          label: "Show Linkedin button",
          family: "data",
          hidden: true,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        showWordpress: {
          label: "Show Wordpress button",
          family: "data",
          hidden: true,
          sortingWeight: "25",
          formats: {
            Boolean: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "true"
              }
            }
          }
        },
        postTitle: {
          label: "Title to show in the shared link",
          uiTipContent: "The text that will appear by default in the post, entry or tweet",
          family: "data",
          hidden: false,
          sortingWeight: "1",
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Made with quadrigram"
              }
            }
          }
        },
        bkg_color: {
          formats: {
            Color: {
              defaults: {
                value: "#fff"
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: 7
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: 1
              }
            }
          }
        }
      }
    };

    ShareButtonsControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ShareButtonsControlModel.meta, ShareButtonsControlModel.behaviors);
      return output;
    };

    return ShareButtonsControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.PageNavControlView = (function(_super) {
    __extends(PageNavControlView, _super);

    function PageNavControlView() {
      this.getRealPagesArray = __bind(this.getRealPagesArray, this);
      this.getScrollDomElement = __bind(this.getScrollDomElement, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.selectById = __bind(this.selectById, this);
      this.handlePrevPage = __bind(this.handlePrevPage, this);
      this.handleNextPage = __bind(this.handleNextPage, this);
      this.handleItemClick = __bind(this.handleItemClick, this);
      this.handlePageChange = __bind(this.handlePageChange, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = PageNavControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PageNavControlView.prototype.followMouse = false;

    PageNavControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    PageNavControlView.prototype.stylableTexts = [".nav-label", ".nav-center-label"];

    PageNavControlView.prototype.viewWillRender = function() {
      this.values = [];
      return this.ids = [];
    };

    PageNavControlView.prototype.viewDidRender = function() {
      var mainContainer;
      mainContainer = this.behaviors.layout.root.append("div").attr("class", "page-nav-control");
      this.itemsContainer = mainContainer.append("ul").attr("class", "items-container");
      this.arrowsContainer = mainContainer.append("div").attr("class", "arrows-container");
      this.arrowsContainer.append("div").attr("class", "nav-item-arrow left").on("click", this.handlePrevPage);
      this.arrowsContainer.append("div").attr("class", "nav-center-container").append("div").attr("class", "nav-center-label");
      this.arrowsContainer.append("div").attr("class", "nav-item-arrow right").on("click", this.handleNextPage);
      this.updateItems();
      quadrigram.router.appViews.projectView.layoutManager.on("pageChanged", this.handlePageChange);
      return quadrigram.router.dataModels.currentProject.get("pagesCollection").on("add remove sort", this.updateItems);
    };

    PageNavControlView.prototype.updateItems = function() {
      var pagesArray, self;
      pagesArray = this.getRealPagesArray();
      this.items = this.itemsContainer.selectAll(".nav-item").data(pagesArray, function(d, i) {
        return d.get("id");
      });
      self = this;
      this.itemsEnter = this.items.enter().append("li").attr("class", "nav-item").attr("page-id", function(d, i) {
        return d.get("id");
      }).classed(this.model.get("type"), true).on("click", function(d, i) {
        return self.handleItemClick(d.get("id"));
      }).on("mouseenter", function(d, i) {
        if (!d3.select(this).classed("selected")) {
          return d3.select(this).style("background-color", self.model.get("colorHover"));
        }
      }).on("mouseleave", function(d, i) {
        var color;
        if (d3.select(this).classed("selected")) {
          color = self.model.get("colorDown");
        } else {
          color = self.model.get("buttonColor");
        }
        return d3.select(this).style("background-color", color);
      });
      this.itemsEnter.append("span").attr("class", "nav-label");
      this.items.classed("dots", false).classed("buttons", false).classed("arrows", false).classed(this.model.get("type"), true).style("background-color", this.model.get("buttonColor"));
      this.items.select(".nav-label").text(function(d, i) {
        return d.get("label");
      });
      this.items.order();
      this.items.exit().remove();
      if (this.model.get("type") === "arrows") {
        this.arrowsContainer.style("visibility", "visible");
        this.itemsContainer.style("visibility", "hidden");
      } else {
        this.arrowsContainer.style("visibility", "hidden");
        this.itemsContainer.style("visibility", "visible");
      }
      return this.handlePageChange();
    };

    PageNavControlView.prototype.handlePageChange = function() {
      var pageId;
      pageId = quadrigram.router.appViews.projectView.layoutManager.activePage.model.get("id");
      return this.selectById(pageId);
    };

    PageNavControlView.prototype.handleItemClick = function(pageId) {
      return quadrigram.router.appViews.projectView.layoutManager.navigateToPage(pageId);
    };

    PageNavControlView.prototype.handleNextPage = function() {
      var currentModel, index, newId, newIndex, pagesArray;
      pagesArray = this.getRealPagesArray();
      currentModel = quadrigram.router.appViews.projectView.layoutManager.activePage.model;
      index = pagesArray.indexOf(currentModel);
      newIndex = index + 1;
      if (newIndex < pagesArray.length) {
        newId = pagesArray[newIndex].get("id");
        return this.handleItemClick(newId);
      }
    };

    PageNavControlView.prototype.handlePrevPage = function() {
      var currentModel, index, newId, newIndex, pagesArray;
      pagesArray = this.getRealPagesArray();
      currentModel = quadrigram.router.appViews.projectView.layoutManager.activePage.model;
      index = pagesArray.indexOf(currentModel);
      newIndex = index - 1;
      if (newIndex >= 0) {
        newId = pagesArray[newIndex].get("id");
        return this.handleItemClick(newId);
      }
    };

    PageNavControlView.prototype.selectById = function(pageId) {
      var currentModel, index, pagesArray;
      this.$el.find(".nav-item").removeClass("selected");
      this.$el.find(".nav-item").css("background-color", this.model.get("buttonColor"));
      this.$el.find(".nav-item[page-id=" + pageId + "]").addClass("selected");
      this.$el.find(".nav-item[page-id=" + pageId + "]").css("background-color", this.model.get("colorDown"));
      if (this.model.get("type") === "arrows") {
        pagesArray = this.getRealPagesArray();
        this.arrowsContainer.select(".nav-center-label").text(_.findWhere(pagesArray, {
          id: pageId
        }).get("label"));
        currentModel = quadrigram.router.appViews.projectView.layoutManager.activePage.model;
        index = pagesArray.indexOf(currentModel);
        this.arrowsContainer.selectAll(".nav-item-arrow").classed("disabled", false);
        if (index === 0) {
          this.arrowsContainer.select(".nav-item-arrow.left").classed("disabled", true);
        }
        if (index === pagesArray.length - 1) {
          return this.arrowsContainer.select(".nav-item-arrow.right").classed("disabled", true);
        }
      }
    };

    PageNavControlView.prototype.visualizerDidUpdateItems = function() {};

    PageNavControlView.prototype.getScrollDomElement = function() {
      return $(this.behaviors.layout.root[0]).find(".page-nav-control");
    };

    PageNavControlView.prototype.getRealPagesArray = function() {
      var headerPageModel, realPages;
      headerPageModel = _.findWhere(quadrigram.router.dataModels.currentProject.get("pagesCollection").models, {
        "id": "_headerPage"
      });
      realPages = _.without(quadrigram.router.dataModels.currentProject.get("pagesCollection").models, headerPageModel);
      return realPages;
    };

    return PageNavControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.PageNavControlModel = (function(_super) {
    __extends(PageNavControlModel, _super);

    function PageNavControlModel() {
      _ref = PageNavControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    PageNavControlModel.behaviors = ["quadrigram.Models.LayoutBehavior", "quadrigram.Models.TextStyleBehavior"];

    PageNavControlModel.meta = {
      name: "PageNav",
      properties: {
        type: {
          label: "Type of menu",
          family: "style",
          hidden: true,
          sortingWeight: "28",
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "dots"
              },
              options: {
                value: ["dots", "buttons", "arrows"]
              }
            }
          }
        },
        "size_y": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "1"
              }
            }
          }
        },
        "size_x": {
          "formats": {
            "Number": {
              "defaults": {
                "value": "5"
              }
            }
          }
        },
        textAlign: {
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "center"
              },
              options: {
                value: ["left", "center", "right"]
              }
            }
          }
        },
        buttonColor: {
          label: "Buttons color",
          family: "style",
          hidden: false,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#aaa"
              }
            }
          }
        },
        colorHover: {
          label: "Buttons color when hovered",
          family: "style",
          hidden: false,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#ccc"
              }
            }
          }
        },
        colorDown: {
          label: "Buttons color when selected",
          family: "style",
          hidden: false,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#eee"
              }
            }
          }
        }
      }
    };

    PageNavControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(PageNavControlModel.meta, PageNavControlModel.behaviors);
      return output;
    };

    return PageNavControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.ButtonControlView = (function(_super) {
    __extends(ButtonControlView, _super);

    function ButtonControlView() {
      this.getValidUrl = __bind(this.getValidUrl, this);
      this.getScrollDomElement = __bind(this.getScrollDomElement, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.handleClick = __bind(this.handleClick, this);
      this.handleMouseUp = __bind(this.handleMouseUp, this);
      this.handleMouseDown = __bind(this.handleMouseDown, this);
      this.handleMouseLeave = __bind(this.handleMouseLeave, this);
      this.handleMouseEnter = __bind(this.handleMouseEnter, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      this.viewWillRender = __bind(this.viewWillRender, this);
      _ref = ButtonControlView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ButtonControlView.prototype.followMouse = false;

    ButtonControlView.prototype.stylableTexts = [".b-label"];

    ButtonControlView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    ButtonControlView.prototype.viewWillRender = function() {
      this.values = [];
      return this.ids = [];
    };

    ButtonControlView.prototype.viewDidRender = function() {
      var buttonContainer;
      this.behaviors.layout.root.append("div").attr("class", "button-control");
      buttonContainer = this.$el.find(".button-control");
      this.button = $("<div class='control-btn'><div class='b-label'></div></div>");
      buttonContainer.append(this.button);
      this.$el.find(".control-btn").on("mouseenter", this.handleMouseEnter);
      this.$el.find(".control-btn").on("mouseleave", this.handleMouseLeave);
      this.$el.find(".control-btn").on("mousedown", this.handleMouseDown);
      this.$el.find(".control-btn").on("mouseup", this.handleMouseUp);
      this.$el.find(".control-btn").on("click", this.handleClick);
      return this.updateItems();
    };

    ButtonControlView.prototype.updateItems = function() {
      this.button.css("background", this.model.get("color"));
      this.button.css("height", "calc( 100% - " + this.model.get("padding") + " )");
      this.button.css("width", "calc( 100% - " + this.model.get("padding") + " )");
      return this.button.find(".b-label").html(this.model.get("label"));
    };

    ButtonControlView.prototype.handleMouseEnter = function(e) {
      return $(e.currentTarget).css("background", this.model.get("colorHover"));
    };

    ButtonControlView.prototype.handleMouseLeave = function(e) {
      return $(e.currentTarget).css("background", this.model.get("color"));
    };

    ButtonControlView.prototype.handleMouseDown = function(e) {
      return $(e.currentTarget).css("background", this.model.get("colorDown"));
    };

    ButtonControlView.prototype.handleMouseUp = function(e) {
      return $(e.currentTarget).css("background", this.model.get("color"));
    };

    ButtonControlView.prototype.handleClick = function(e) {
      var url;
      this.updateOutput("trigger", [
        {
          id: this.model.get("outputValue"),
          value: this.model.get("outputValue")
        }
      ]);
      if (this.model.get("quickLink") !== quadrigram.Models.VisualizerModel.DEACTIVATED) {
        url = this.getValidUrl(this.model.get("quickLink"));
        return window.open(url, '_blank');
      }
    };

    ButtonControlView.prototype.visualizerDidUpdateItems = function() {};

    ButtonControlView.prototype.getScrollDomElement = function() {
      return $(this.behaviors.layout.root[0]).find(".button-container");
    };

    ButtonControlView.prototype.getValidUrl = function(url) {
      if (!_.isString(url)) {
        return;
      }
      if (url.indexOf("http://") === -1) {
        if (url.indexOf("https://") === -1) {
          url = "http://" + url;
        }
      }
      return url;
    };

    return ButtonControlView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Models.ButtonControlModel = (function(_super) {
    __extends(ButtonControlModel, _super);

    function ButtonControlModel() {
      _ref = ButtonControlModel.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    ButtonControlModel.behaviors = ["quadrigram.Models.LayoutBehavior", "quadrigram.Models.TextStyleBehavior"];

    ButtonControlModel.meta = {
      name: "Button",
      outputs: {
        trigger: {
          outputType: "selection",
          "default": 0,
          label: "Button clicked"
        }
      },
      properties: {
        label: {
          label: "Button label",
          family: "data",
          hidden: false,
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "Button"
              }
            }
          }
        },
        outputValue: {
          label: "Output value",
          family: "data",
          hidden: false,
          formats: {
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: ""
              }
            }
          }
        },
        quickLink: {
          label: "External Link",
          family: "data",
          hidden: false,
          formats: {
            Deactivated: {
              multiValues: {
                value: false
              }
            },
            Text: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "www.quadrigram.com"
              }
            }
          }
        },
        color: {
          label: "Button color",
          family: "style",
          hidden: false,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#ddd"
              }
            }
          }
        },
        colorHover: {
          label: "Button color when hovered",
          family: "style",
          hidden: false,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#eee"
              }
            }
          }
        },
        colorDown: {
          label: "Button color when clicked",
          family: "style",
          hidden: false,
          formats: {
            Color: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "#bbb"
              }
            }
          }
        },
        padding: {
          label: "Padding",
          family: "style",
          hidden: false,
          formats: {
            Px: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "0px"
              }
            }
          }
        },
        size_x: {
          formats: {
            Number: {
              defaults: {
                value: 2
              }
            }
          }
        },
        size_y: {
          formats: {
            Number: {
              defaults: {
                value: 1
              }
            }
          }
        },
        textAlign: {
          formats: {
            Options: {
              multiValues: {
                value: false
              },
              defaults: {
                value: "center"
              },
              options: {
                value: ["left", "center", "right"]
              }
            }
          }
        }
      }
    };

    ButtonControlModel.info = function() {
      var output;
      output = quadrigram.Models.VisualizerModel.mergeInfo(ButtonControlModel.meta, ButtonControlModel.behaviors);
      return output;
    };

    return ButtonControlModel;

  }).call(this, quadrigram.Models.VisualizerModel);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.NetworkVisualizerView = (function(_super) {
    __extends(NetworkVisualizerView, _super);

    function NetworkVisualizerView() {
      this.initForce = __bind(this.initForce, this);
      this.initNetworkStructure = __bind(this.initNetworkStructure, this);
      this.toggleCalculating = __bind(this.toggleCalculating, this);
      this.visualizerDidUpdateItems = __bind(this.visualizerDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.updateItems_OLD = __bind(this.updateItems_OLD, this);
      this.visualizerDidResize = __bind(this.visualizerDidResize, this);
      this.visualizerWillUpdateItems = __bind(this.visualizerWillUpdateItems, this);
      this.tickExecution = __bind(this.tickExecution, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = NetworkVisualizerView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    NetworkVisualizerView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    NetworkVisualizerView.prototype.linkStrengthRatio = 1;

    NetworkVisualizerView.prototype.linkDistance = 10;

    NetworkVisualizerView.prototype.firstExec = true;

    NetworkVisualizerView.prototype.viewDidRender = function() {
      var self;
      self = this;
      this.force = d3.layout.force();
      this.force.size([this.$el.width(), this.$el.height()]);
      this.force.on('tick', this.tickExecution);
      this.networkLayer = this.behaviors.svg.root.append("g").attr("id", 'graph-layer').attr("class", "zoomable-layer");
      this.backgroundLayer = this.networkLayer.append("rect").attr("width", "100%").attr("height", "100%").attr("fill", "rgba(0,0,0,0)").attr("class", "zoomable-area");
      this.linksLayer = this.networkLayer.append("g").attr("id", 'graph-layer-links').attr("class", "zoomable-target");
      return this.nodesLayer = this.networkLayer.append("g").attr("id", 'graph-layer-nodes').attr("class", "zoomable-target");
    };

    NetworkVisualizerView.prototype.tickExecution = function() {
      var graphHeight, graphWidth, self,
        _this = this;
      if (this.skipDrawing === true) {
        return;
      }
      graphWidth = this.$el.width();
      graphHeight = this.$el.height();
      this.force.size([graphWidth, graphHeight]);
      self = this;
      this.linksItems.each(function(d, i) {
        d3.select(this).select(".link-line").attr('x1', d.source.x).attr('y1', d.source.y).attr('x2', d.target.x).attr('y2', d.target.y);
        return d3.select(this).select(".link-aura").attr('x1', d.source.x).attr('y1', d.source.y).attr('x2', d.target.x).attr('y2', d.target.y);
      });
      return this.items.attr("transform", function(d) {
        if ((d.x != null) && (d.y != null)) {
          return "translate(" + d.x + "," + d.y + ")";
        }
      });
    };

    NetworkVisualizerView.prototype.visualizerWillUpdateItems = function() {
      var format, radiusDomain, radiusRange;
      this.behaviors.relations.setWeightScale();
      radiusDomain = this.calculateNumberDomain(this.radiusValues, 0, false);
      format = this.model.get("values").currentFormat;
      switch (format) {
        case "PxByValues":
          radiusRange = [this.model.get("values")[1], this.model.get("values")[2]];
          break;
        case "PxRange":
          radiusRange = [this.model.get("values")[0], this.model.get("values")[1]];
          break;
        default:
          radiusRange = [this.model.get("values"), this.model.get("values")];
      }
      return this.behaviors.circles.updateRadiusScale(radiusDomain, radiusRange);
    };

    NetworkVisualizerView.prototype.visualizerDidResize = function() {
      return this.force.start();
    };

    NetworkVisualizerView.prototype.updateItems_OLD = function() {
      var linkItemsEnter, size, transitionTime, transitionType, updateD3ObjectNodes, updateD3ObjectRelations,
        _this = this;
      if ((this.model.changed["network"] != null) || (this.linksItems == null) || (this.items == null)) {
        this.forceReady = false;
        this.linksItems = this.linksLayer.selectAll('.link').data(this.networkObject.relations, function(d) {
          return d.id;
        });
        this.items = this.nodesLayer.selectAll('.item').data(this.networkObject.nodes, function(d) {
          return d.id;
        });
      }
      this.linksItems.exit().remove();
      linkItemsEnter = this.linksItems.enter().append("g").attr("class", "link");
      linkItemsEnter.insert('line').attr('class', 'link-line');
      linkItemsEnter.insert('line').attr('class', 'link-aura').attr("stroke-width", "5px").attr("stroke", "rgba(0,0,0,0)");
      this.items.exit().remove();
      this.items.enter().insert('circle').attr('class', 'item');
      if (this.model.get("draggableNodes") === "true") {
        this.items.call(this.force.drag).on("mousedown", function() {
          return d3.event.stopPropagation();
        });
      } else {
        this.items.on(".drag", null);
      }
      size = this.items.size();
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3ObjectNodes = this.items.transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3ObjectNodes = this.items;
      }
      updateD3ObjectNodes.attr('r', function(d) {
        var value;
        value = _this.behaviors.circles.getRadiusFromValue(d.value);
        if (_.isNaN(value)) {
          value = 0;
        }
        return value;
      });
      size = this.linksItems.size();
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3ObjectRelations = this.linksItems.transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3ObjectRelations = this.linksItems;
      }
      updateD3ObjectRelations.attr("stroke-width", function(d) {
        return _this.behaviors.relations.strokeWidthScale(d.value);
      });
      this.force.linkStrength(1);
      this.force.friction(0.8);
      if (this.firstExec || (this.model.changed["charge"] != null) || (this.model.changed["network"] != null)) {
        this.force.charge(-1 * Math.max(1, parseInt(this.model.get("charge"))));
        if (this.forceReady = true) {
          this.force.start();
        }
      }
      if (this.firstExec || (this.model.changed["linkDistance"] != null) || (this.model.changed["network"] != null)) {
        this.force.linkDistance(100 - parseInt(this.model.get("linkDistance")));
        if (this.forceReady = true) {
          this.force.start();
        }
      }
      if (this.firstExec || (this.model.changed["network"] != null)) {
        this.initNetworkStructure();
      }
      return this.firstExec = false;
    };

    NetworkVisualizerView.prototype.updateItems = function() {
      var linkItemsEnter, size, transitionTime, transitionType, updateD3ObjectNodes, updateD3ObjectRelations,
        _this = this;
      if ((this.model.changed["network"] != null) || (this.linksItems == null) || (this.items == null)) {
        this.forceReady = false;
        this.linksItems = this.linksLayer.selectAll('.link').data(this.networkObject.relations, function(d) {
          return d.id;
        });
        this.items = this.nodesLayer.selectAll('.item').data(this.networkObject.nodes, function(d) {
          return d.id;
        });
      }
      if (this.model.changed["values"] != null) {
        this.items.each(function(d, i) {
          return d.value = _this.networkObject.nodes[i].value;
        });
      }
      if (this.model.changed["linkThickness"] != null) {
        this.linksItems.each(function(d, i) {
          return d.value = _this.networkObject.relations[i].value;
        });
      }
      this.linksItems.exit().remove();
      linkItemsEnter = this.linksItems.enter().append("g").attr("class", "link");
      linkItemsEnter.insert('line').attr('class', 'link-line');
      linkItemsEnter.insert('line').attr('class', 'link-aura').attr("stroke-width", "5px").attr("stroke", "rgba(0,0,0,0)");
      this.items.exit().remove();
      this.items.enter().insert('g').attr('class', 'item');
      if (this.model.get("draggableNodes") === "true") {
        this.items.call(this.force.drag).on("mousedown", function() {
          return d3.event.stopPropagation();
        });
      } else {
        this.items.on(".drag", null);
      }
      size = this.items.size();
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3ObjectNodes = this.items.transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3ObjectNodes = this.items;
      }
      /*
      updateD3ObjectNodes.attr('r', (d) =>
        value = @behaviors.circles.getRadiusFromValue(d.value)
        if _.isNaN(value)
          value = 0
        value
      )
      */

      size = this.linksItems.size();
      if (size < 1000 && this.animationActive) {
        transitionType = this.model.get("transition")[0];
        transitionTime = this.model.get("transition")[1];
        updateD3ObjectRelations = this.linksItems.transition().duration(transitionTime).ease(transitionType);
      } else {
        updateD3ObjectRelations = this.linksItems;
      }
      updateD3ObjectRelations.attr("stroke-width", function(d) {
        return _this.behaviors.relations.strokeWidthScale(d.value);
      });
      this.force.linkStrength(1);
      this.force.friction(0.8);
      if (this.firstExec || (this.model.changed["charge"] != null) || (this.model.changed["network"] != null)) {
        this.force.charge(-1 * Math.max(1, parseInt(this.model.get("charge"))));
        if (this.forceReady = true) {
          this.force.start();
        }
      }
      if (this.firstExec || (this.model.changed["linkDistance"] != null) || (this.model.changed["network"] != null)) {
        this.force.linkDistance(100 - parseInt(this.model.get("linkDistance")));
        if (this.forceReady = true) {
          this.force.start();
        }
      }
      if (this.firstExec || (this.model.changed["network"] != null)) {
        this.initNetworkStructure();
      }
      return this.firstExec = false;
    };

    NetworkVisualizerView.prototype.visualizerDidUpdateItems = function() {
      var self;
      self = this;
      return this.items.each(function(d) {
        var shape, size;
        shape = self.behaviors.selectionNetwork.behaviors.items.styleItems[d.id].shapeType;
        size = self.behaviors.circles.getRadiusFromValue(d.value);
        if (_.isNaN(size)) {
          size = 0;
        }
        if (size < 0) {
          size = 0;
        }
        return self.behaviors.svgshapes.drawShape(d3.select(this), shape, size);
      });
    };

    NetworkVisualizerView.prototype.toggleCalculating = function(value) {
      if (value) {
        this.trigger("vizMessage", "EmptyData");
        return this.behaviors.svg.root.style("visibility", "hidden");
      } else {
        this.trigger("vizMessage", "hide");
        return this.behaviors.svg.root.style("visibility", "visible");
      }
    };

    NetworkVisualizerView.prototype.initNetworkStructure = function() {
      var worker,
        _this = this;
      this.toggleCalculating(true);
      this.forceReady = false;
      worker = new Worker('scripts/managers/networkworker.js');
      worker.onmessage = function(e) {
        switch (e.data.t) {
          case 'e':
            elog(e.data.d);
            return quadrigram.tracker.sendEvent({
              event_type: 101,
              event_subtype: 2,
              error_code: "xls_error",
              error_data: {
                stack: e.data.d
              }
            });
          case 'ready':
            return worker.postMessage({
              t: "start-layout",
              networkObject: _this.networkObject,
              forceSettings: {
                size: _this.force.size(),
                charge: _this.force.charge(),
                linkDistance: _this.force.linkDistance()
              }
            });
          case 'layout-finished':
            _this.networkObject = e.data.d;
            worker.terminate();
            _this.initForce();
            return _this.toggleCalculating(false);
        }
      };
      return worker.postMessage({
        t: "isReady",
        d: this.networkObject
      });
    };

    NetworkVisualizerView.prototype.initForce = function() {
      var dx, dy, node, _i, _len, _ref1;
      this.linksItems = this.linksLayer.selectAll('.link').data(this.networkObject.relations, function(d) {
        return d.id;
      });
      this.items = this.nodesLayer.selectAll('.item').data(this.networkObject.nodes, function(d) {
        return d.id;
      });
      this.force.nodes(this.networkObject.nodes).links(this.networkObject.relations);
      this.force.start();
      if (this.linksItems.size() < 200) {
        _ref1 = this.networkObject.nodes;
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          node = _ref1[_i];
          dx = node.x - this.$el.width() / 2;
          dy = node.y - this.$el.height() / 2;
          dx *= 0.98;
          dy *= 0.98;
          node.x = this.$el.width() / 2 + dx;
          node.y = this.$el.height() / 2 + dy;
        }
      } else {
        this.force.tick();
        this.force.alpha(-1);
      }
      return this.forceReady = true;
    };

    return NetworkVisualizerView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.RadialNetworkVisualizerView = (function(_super) {
    __extends(RadialNetworkVisualizerView, _super);

    function RadialNetworkVisualizerView() {
      this.visualizerAfterDidUpdateItems = __bind(this.visualizerAfterDidUpdateItems, this);
      this.updateItems = __bind(this.updateItems, this);
      this.viewDidRender = __bind(this.viewDidRender, this);
      _ref = RadialNetworkVisualizerView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    RadialNetworkVisualizerView.prototype.template = JST['app/scripts/templates/visualizers/empty.hbs'];

    RadialNetworkVisualizerView.prototype.stylableTexts = ['.node'];

    RadialNetworkVisualizerView.prototype.viewDidRender = function() {
      this.networkLayer = this.behaviors.svg.root.append('g').attr('class', 'zoomable-layer radial-network-layer');
      this.backgroundLayer = this.networkLayer.append('rect').attr('width', '100%').attr('height', '100%').attr('fill', 'rgba(0,0,0,0)').attr('class', 'zoomable-area');
      this.linksLayer = this.networkLayer.append('g').attr('class', 'zoomable-target radial-network-links');
      return this.nodesLayer = this.networkLayer.append('g').attr('class', 'zoomable-target radial-network-nodes');
    };

    RadialNetworkVisualizerView.prototype.updateItems = function() {
      if ((this.model.changed["network"] != null) || (this.linksItems == null) || (this.items == null)) {
        this.behaviors.dataController.nodesAndLinksGeneration();
      }
      this.networkLayer.attr('transform', 'translate(' + (this.behaviors.svg.size.width / 2.0) + ',' + (this.behaviors.svg.size.height / 2.0) + ')');
      this.line = d3.svg.line.radial().interpolate('bundle').tension(.85).radius(function(d) {
        return d.y;
      }).angle(function(d) {
        return d.x / 180 * Math.PI;
      });
      this.linksItems = this.linksLayer.selectAll('.link').data(this.networkObject.bundleLinks, function(d) {
        return d.id;
      });
      this.items = this.nodesLayer.selectAll('.node').data(this.networkObject.nodes.children, function(d) {
        return d.id;
      });
      this.linksItems.exit().remove();
      this.linksItems.enter().append('path').attr('class', 'link');
      this.items.exit().remove();
      this.items.enter().append('text').attr('class', 'node item').attr('dy', '.31em');
      return this.items.text(function(d) {
        if (d.label !== "@QDeactivatedWord") {
          return d.label;
        } else {
          return d.key;
        }
      });
    };

    RadialNetworkVisualizerView.prototype.visualizerAfterDidUpdateItems = function() {
      var maxWidth,
        _this = this;
      maxWidth = 0;
      this.items.each(function() {
        var width;
        width = d3.select(this).node().getBBox().width;
        return maxWidth = Math.max(width, maxWidth);
      });
      this.bundle = d3.layout.bundle();
      this.radius = (Math.min(this.behaviors.svg.size.width, this.behaviors.svg.size.height)) / 2.0;
      this.cluster = d3.layout.cluster().size([360, this.radius - maxWidth - 20]).sort(null).value(function(d) {
        return d.size;
      });
      this.cluster.nodes(this.networkObject.nodes);
      this.linksItems.each(function(d) {
        d.source = d[0];
        return d.target = d[d.length - 1];
      }).attr('d', this.line);
      return this.items.attr('transform', function(d) {
        return 'rotate(' + (d.x - 90) + ')translate(' + (d.y + 8) + ',0)' + (d.x < 180 ? '' : 'rotate(180)');
      }).style('text-anchor', function(d) {
        if (d.x < 180) {
          return 'start';
        } else {
          return 'end';
        }
      });
    };

    return RadialNetworkVisualizerView;

  })(quadrigram.Views.VisualizerView);

}).call(this);

(function() {
  'use strict';
  var _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  quadrigram.Views.DisclaimerDeviceView = (function(_super) {
    __extends(DisclaimerDeviceView, _super);

    function DisclaimerDeviceView() {
      _ref = DisclaimerDeviceView.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    DisclaimerDeviceView.prototype.template = JST['app/scripts/templates/UI/disclaimerDeviceView.hbs'];

    return DisclaimerDeviceView;

  })(Backbone.ElementView);

}).call(this);
